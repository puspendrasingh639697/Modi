function lR(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function L0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function cR(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){var r=!1;try{r=this instanceof i}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var Gg={exports:{}},pu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bb;function uR(){if(Bb)return pu;Bb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,o){var c=null;if(o!==void 0&&(c=""+o),r.key!==void 0&&(c=""+r.key),"key"in r){o={};for(var h in r)h!=="key"&&(o[h]=r[h])}else o=r;return r=o.ref,{$$typeof:n,type:i,key:c,ref:r!==void 0?r:null,props:o}}return pu.Fragment=e,pu.jsx=t,pu.jsxs=t,pu}var Fb;function hR(){return Fb||(Fb=1,Gg.exports=uR()),Gg.exports}var _=hR(),Kg={exports:{}},He={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qb;function dR(){if(qb)return He;qb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),T=Symbol.iterator;function x(D){return D===null||typeof D!="object"?null:(D=T&&D[T]||D["@@iterator"],typeof D=="function"?D:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,O={};function Z(D,B,ee){this.props=D,this.context=B,this.refs=O,this.updater=ee||N}Z.prototype.isReactComponent={},Z.prototype.setState=function(D,B){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,B,"setState")},Z.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function Y(){}Y.prototype=Z.prototype;function H(D,B,ee){this.props=D,this.context=B,this.refs=O,this.updater=ee||N}var le=H.prototype=new Y;le.constructor=H,L(le,Z.prototype),le.isPureReactComponent=!0;var ve=Array.isArray;function oe(){}var I={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function R(D,B,ee){var he=ee.ref;return{$$typeof:n,type:D,key:B,ref:he!==void 0?he:null,props:ee}}function U(D,B){return R(D.type,B,D.props)}function V(D){return typeof D=="object"&&D!==null&&D.$$typeof===n}function F(D){var B={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ee){return B[ee]})}var k=/\/+/g;function ge(D,B){return typeof D=="object"&&D!==null&&D.key!=null?F(""+D.key):B.toString(36)}function Se(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(oe,oe):(D.status="pending",D.then(function(B){D.status==="pending"&&(D.status="fulfilled",D.value=B)},function(B){D.status==="pending"&&(D.status="rejected",D.reason=B)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function j(D,B,ee,he,ye){var ke=typeof D;(ke==="undefined"||ke==="boolean")&&(D=null);var je=!1;if(D===null)je=!0;else switch(ke){case"bigint":case"string":case"number":je=!0;break;case"object":switch(D.$$typeof){case n:case e:je=!0;break;case v:return je=D._init,j(je(D._payload),B,ee,he,ye)}}if(je)return ye=ye(D),je=he===""?"."+ge(D,0):he,ve(ye)?(ee="",je!=null&&(ee=je.replace(k,"$&/")+"/"),j(ye,B,ee,"",function(we){return we})):ye!=null&&(V(ye)&&(ye=U(ye,ee+(ye.key==null||D&&D.key===ye.key?"":(""+ye.key).replace(k,"$&/")+"/")+je)),B.push(ye)),1;je=0;var mt=he===""?".":he+":";if(ve(D))for(var te=0;te<D.length;te++)he=D[te],ke=mt+ge(he,te),je+=j(he,B,ee,ke,ye);else if(te=x(D),typeof te=="function")for(D=te.call(D),te=0;!(he=D.next()).done;)he=he.value,ke=mt+ge(he,te++),je+=j(he,B,ee,ke,ye);else if(ke==="object"){if(typeof D.then=="function")return j(Se(D),B,ee,he,ye);throw B=String(D),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.")}return je}function G(D,B,ee){if(D==null)return D;var he=[],ye=0;return j(D,he,"","",function(ke){return B.call(ee,ke,ye++)}),he}function ie(D){if(D._status===-1){var B=D._result;B=B(),B.then(function(ee){(D._status===0||D._status===-1)&&(D._status=1,D._result=ee)},function(ee){(D._status===0||D._status===-1)&&(D._status=2,D._result=ee)}),D._status===-1&&(D._status=0,D._result=B)}if(D._status===1)return D._result.default;throw D._result}var me=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var B=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(B))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},be={map:G,forEach:function(D,B,ee){G(D,function(){B.apply(this,arguments)},ee)},count:function(D){var B=0;return G(D,function(){B++}),B},toArray:function(D){return G(D,function(B){return B})||[]},only:function(D){if(!V(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return He.Activity=w,He.Children=be,He.Component=Z,He.Fragment=t,He.Profiler=r,He.PureComponent=H,He.StrictMode=i,He.Suspense=f,He.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,He.__COMPILER_RUNTIME={__proto__:null,c:function(D){return I.H.useMemoCache(D)}},He.cache=function(D){return function(){return D.apply(null,arguments)}},He.cacheSignal=function(){return null},He.cloneElement=function(D,B,ee){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var he=L({},D.props),ye=D.key;if(B!=null)for(ke in B.key!==void 0&&(ye=""+B.key),B)!A.call(B,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&B.ref===void 0||(he[ke]=B[ke]);var ke=arguments.length-2;if(ke===1)he.children=ee;else if(1<ke){for(var je=Array(ke),mt=0;mt<ke;mt++)je[mt]=arguments[mt+2];he.children=je}return R(D.type,ye,he)},He.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:o,_context:D},D},He.createElement=function(D,B,ee){var he,ye={},ke=null;if(B!=null)for(he in B.key!==void 0&&(ke=""+B.key),B)A.call(B,he)&&he!=="key"&&he!=="__self"&&he!=="__source"&&(ye[he]=B[he]);var je=arguments.length-2;if(je===1)ye.children=ee;else if(1<je){for(var mt=Array(je),te=0;te<je;te++)mt[te]=arguments[te+2];ye.children=mt}if(D&&D.defaultProps)for(he in je=D.defaultProps,je)ye[he]===void 0&&(ye[he]=je[he]);return R(D,ke,ye)},He.createRef=function(){return{current:null}},He.forwardRef=function(D){return{$$typeof:h,render:D}},He.isValidElement=V,He.lazy=function(D){return{$$typeof:v,_payload:{_status:-1,_result:D},_init:ie}},He.memo=function(D,B){return{$$typeof:m,type:D,compare:B===void 0?null:B}},He.startTransition=function(D){var B=I.T,ee={};I.T=ee;try{var he=D(),ye=I.S;ye!==null&&ye(ee,he),typeof he=="object"&&he!==null&&typeof he.then=="function"&&he.then(oe,me)}catch(ke){me(ke)}finally{B!==null&&ee.types!==null&&(B.types=ee.types),I.T=B}},He.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},He.use=function(D){return I.H.use(D)},He.useActionState=function(D,B,ee){return I.H.useActionState(D,B,ee)},He.useCallback=function(D,B){return I.H.useCallback(D,B)},He.useContext=function(D){return I.H.useContext(D)},He.useDebugValue=function(){},He.useDeferredValue=function(D,B){return I.H.useDeferredValue(D,B)},He.useEffect=function(D,B){return I.H.useEffect(D,B)},He.useEffectEvent=function(D){return I.H.useEffectEvent(D)},He.useId=function(){return I.H.useId()},He.useImperativeHandle=function(D,B,ee){return I.H.useImperativeHandle(D,B,ee)},He.useInsertionEffect=function(D,B){return I.H.useInsertionEffect(D,B)},He.useLayoutEffect=function(D,B){return I.H.useLayoutEffect(D,B)},He.useMemo=function(D,B){return I.H.useMemo(D,B)},He.useOptimistic=function(D,B){return I.H.useOptimistic(D,B)},He.useReducer=function(D,B,ee){return I.H.useReducer(D,B,ee)},He.useRef=function(D){return I.H.useRef(D)},He.useState=function(D){return I.H.useState(D)},He.useSyncExternalStore=function(D,B,ee){return I.H.useSyncExternalStore(D,B,ee)},He.useTransition=function(){return I.H.useTransition()},He.version="19.2.0",He}var Hb;function U0(){return Hb||(Hb=1,Kg.exports=dR()),Kg.exports}var P=U0();const rs=L0(P),fR=lR({__proto__:null,default:rs},[P]);var Wg={exports:{}},gu={},Yg={exports:{}},Qg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b;function mR(){return $b||($b=1,(function(n){function e(j,G){var ie=j.length;j.push(G);e:for(;0<ie;){var me=ie-1>>>1,be=j[me];if(0<r(be,G))j[me]=G,j[ie]=be,ie=me;else break e}}function t(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var G=j[0],ie=j.pop();if(ie!==G){j[0]=ie;e:for(var me=0,be=j.length,D=be>>>1;me<D;){var B=2*(me+1)-1,ee=j[B],he=B+1,ye=j[he];if(0>r(ee,ie))he<be&&0>r(ye,ee)?(j[me]=ye,j[he]=ie,me=he):(j[me]=ee,j[B]=ie,me=B);else if(he<be&&0>r(ye,ie))j[me]=ye,j[he]=ie,me=he;else break e}}return G}function r(j,G){var ie=j.sortIndex-G.sortIndex;return ie!==0?ie:j.id-G.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var f=[],m=[],v=1,w=null,T=3,x=!1,N=!1,L=!1,O=!1,Z=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function le(j){for(var G=t(m);G!==null;){if(G.callback===null)i(m);else if(G.startTime<=j)i(m),G.sortIndex=G.expirationTime,e(f,G);else break;G=t(m)}}function ve(j){if(L=!1,le(j),!N)if(t(f)!==null)N=!0,oe||(oe=!0,F());else{var G=t(m);G!==null&&Se(ve,G.startTime-j)}}var oe=!1,I=-1,A=5,R=-1;function U(){return O?!0:!(n.unstable_now()-R<A)}function V(){if(O=!1,oe){var j=n.unstable_now();R=j;var G=!0;try{e:{N=!1,L&&(L=!1,Y(I),I=-1),x=!0;var ie=T;try{t:{for(le(j),w=t(f);w!==null&&!(w.expirationTime>j&&U());){var me=w.callback;if(typeof me=="function"){w.callback=null,T=w.priorityLevel;var be=me(w.expirationTime<=j);if(j=n.unstable_now(),typeof be=="function"){w.callback=be,le(j),G=!0;break t}w===t(f)&&i(f),le(j)}else i(f);w=t(f)}if(w!==null)G=!0;else{var D=t(m);D!==null&&Se(ve,D.startTime-j),G=!1}}break e}finally{w=null,T=ie,x=!1}G=void 0}}finally{G?F():oe=!1}}}var F;if(typeof H=="function")F=function(){H(V)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,ge=k.port2;k.port1.onmessage=V,F=function(){ge.postMessage(null)}}else F=function(){Z(V,0)};function Se(j,G){I=Z(function(){j(n.unstable_now())},G)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(j){j.callback=null},n.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<j?Math.floor(1e3/j):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(j){switch(T){case 1:case 2:case 3:var G=3;break;default:G=T}var ie=T;T=G;try{return j()}finally{T=ie}},n.unstable_requestPaint=function(){O=!0},n.unstable_runWithPriority=function(j,G){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var ie=T;T=j;try{return G()}finally{T=ie}},n.unstable_scheduleCallback=function(j,G,ie){var me=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?me+ie:me):ie=me,j){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=ie+be,j={id:v++,callback:G,priorityLevel:j,startTime:ie,expirationTime:be,sortIndex:-1},ie>me?(j.sortIndex=ie,e(m,j),t(f)===null&&j===t(m)&&(L?(Y(I),I=-1):L=!0,Se(ve,ie-me))):(j.sortIndex=be,e(f,j),N||x||(N=!0,oe||(oe=!0,F()))),j},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(j){var G=T;return function(){var ie=T;T=G;try{return j.apply(this,arguments)}finally{T=ie}}}})(Qg)),Qg}var Gb;function pR(){return Gb||(Gb=1,Yg.exports=mR()),Yg.exports}var Xg={exports:{}},Wn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kb;function gR(){if(Kb)return Wn;Kb=1;var n=U0();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(f,m,v){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:w==null?null:""+w,children:f,containerInfo:m,implementation:v}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Wn.createPortal=function(f,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(f,m,null,v)},Wn.flushSync=function(f){var m=c.T,v=i.p;try{if(c.T=null,i.p=2,f)return f()}finally{c.T=m,i.p=v,i.d.f()}},Wn.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(f,m))},Wn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},Wn.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var v=m.as,w=h(v,m.crossOrigin),T=typeof m.integrity=="string"?m.integrity:void 0,x=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?i.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:w,integrity:T,fetchPriority:x}):v==="script"&&i.d.X(f,{crossOrigin:w,integrity:T,fetchPriority:x,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Wn.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=h(m.as,m.crossOrigin);i.d.M(f,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(f)},Wn.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,w=h(v,m.crossOrigin);i.d.L(f,v,{crossOrigin:w,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Wn.preloadModule=function(f,m){if(typeof f=="string")if(m){var v=h(m.as,m.crossOrigin);i.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(f)},Wn.requestFormReset=function(f){i.d.r(f)},Wn.unstable_batchedUpdates=function(f,m){return f(m)},Wn.useFormState=function(f,m,v){return c.H.useFormState(f,m,v)},Wn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Wn.version="19.2.0",Wn}var Wb;function HT(){if(Wb)return Xg.exports;Wb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Xg.exports=gR(),Xg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yb;function _R(){if(Yb)return gu;Yb=1;var n=pR(),e=U0(),t=HT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var a=s,l=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(l=a.return),s=a.return;while(s)}return a.tag===3?l:null}function c(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function h(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function f(s){if(o(s)!==s)throw Error(i(188))}function m(s){var a=s.alternate;if(!a){if(a=o(s),a===null)throw Error(i(188));return a!==s?null:s}for(var l=s,u=a;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(u=p.return,u!==null){l=u;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return f(p),s;if(g===u)return f(p),a;g=g.sibling}throw Error(i(188))}if(l.return!==u.return)l=p,u=g;else{for(var b=!1,S=p.child;S;){if(S===l){b=!0,l=p,u=g;break}if(S===u){b=!0,u=p,l=g;break}S=S.sibling}if(!b){for(S=g.child;S;){if(S===l){b=!0,l=g,u=p;break}if(S===u){b=!0,u=g,l=p;break}S=S.sibling}if(!b)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:a}function v(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=v(s),a!==null)return a;s=s.sibling}return null}var w=Object.assign,T=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),H=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),ve=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function F(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var k=Symbol.for("react.client.reference");function ge(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===k?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case L:return"Fragment";case Z:return"Profiler";case O:return"StrictMode";case ve:return"Suspense";case oe:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case N:return"Portal";case H:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case le:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case I:return a=s.displayName||null,a!==null?a:ge(s.type)||"Memo";case A:a=s._payload,s=s._init;try{return ge(s(a))}catch{}}return null}var Se=Array.isArray,j=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},me=[],be=-1;function D(s){return{current:s}}function B(s){0>be||(s.current=me[be],me[be]=null,be--)}function ee(s,a){be++,me[be]=s.current,s.current=a}var he=D(null),ye=D(null),ke=D(null),je=D(null);function mt(s,a){switch(ee(ke,a),ee(ye,s),ee(he,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?ub(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=ub(a),s=hb(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}B(he),ee(he,s)}function te(){B(he),B(ye),B(ke)}function we(s){s.memoizedState!==null&&ee(je,s);var a=he.current,l=hb(a,s.type);a!==l&&(ee(ye,s),ee(he,l))}function Je(s){ye.current===s&&(B(he),B(ye)),je.current===s&&(B(je),hu._currentValue=ie)}var Gt,Qt;function Lt(s){if(Gt===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Gt=a&&a[1]||"",Qt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gt+s+Qt}var An=!1;function rn(s,a){if(!s||An)return"";An=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(X){var Q=X}Reflect.construct(s,[],ae)}else{try{ae.call()}catch(X){Q=X}s.call(ae.prototype)}}else{try{throw Error()}catch(X){Q=X}(ae=s())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(X){if(X&&Q&&typeof X.stack=="string")return[X.stack,Q.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),b=g[0],S=g[1];if(b&&S){var M=b.split(`
`),W=S.split(`
`);for(p=u=0;u<M.length&&!M[u].includes("DetermineComponentFrameRoot");)u++;for(;p<W.length&&!W[p].includes("DetermineComponentFrameRoot");)p++;if(u===M.length||p===W.length)for(u=M.length-1,p=W.length-1;1<=u&&0<=p&&M[u]!==W[p];)p--;for(;1<=u&&0<=p;u--,p--)if(M[u]!==W[p]){if(u!==1||p!==1)do if(u--,p--,0>p||M[u]!==W[p]){var ne=`
`+M[u].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=u&&0<=p);break}}}finally{An=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Lt(l):""}function ki(s,a){switch(s.tag){case 26:case 27:case 5:return Lt(s.type);case 16:return Lt("Lazy");case 13:return s.child!==a&&a!==null?Lt("Suspense Fallback"):Lt("Suspense");case 19:return Lt("SuspenseList");case 0:case 15:return rn(s.type,!1);case 11:return rn(s.type.render,!1);case 1:return rn(s.type,!0);case 31:return Lt("Activity");default:return""}}function Ze(s){try{var a="",l=null;do a+=ki(s,l),l=s,s=s.return;while(s);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var gt=Object.prototype.hasOwnProperty,Ct=n.unstable_scheduleCallback,_e=n.unstable_cancelCallback,We=n.unstable_shouldYield,Et=n.unstable_requestPaint,pt=n.unstable_now,Xt=n.unstable_getCurrentPriorityLevel,dt=n.unstable_ImmediatePriority,Kt=n.unstable_UserBlockingPriority,In=n.unstable_NormalPriority,Oi=n.unstable_LowPriority,$i=n.unstable_IdlePriority,Ce=n.log,Pe=n.unstable_setDisableYieldValue,St=null,nt=null;function zt(s){if(typeof Ce=="function"&&Pe(s),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(St,s)}catch{}}var Bt=Math.clz32?Math.clz32:Er,ja=Math.log,us=Math.LN2;function Er(s){return s>>>=0,s===0?32:31-(ja(s)/us|0)|0}var ks=256,se=262144,pe=4194304;function Ie(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Re(s,a,l){var u=s.pendingLanes;if(u===0)return 0;var p=0,g=s.suspendedLanes,b=s.pingedLanes;s=s.warmLanes;var S=u&134217727;return S!==0?(u=S&~g,u!==0?p=Ie(u):(b&=S,b!==0?p=Ie(b):l||(l=S&~s,l!==0&&(p=Ie(l))))):(S=u&~g,S!==0?p=Ie(S):b!==0?p=Ie(b):l||(l=u&~s,l!==0&&(p=Ie(l)))),p===0?0:a!==0&&a!==p&&(a&g)===0&&(g=p&-p,l=a&-a,g>=l||g===32&&(l&4194048)!==0)?a:p}function Me(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Fe(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function At(){var s=pe;return pe<<=1,(pe&62914560)===0&&(pe=4194304),s}function kt(s){for(var a=[],l=0;31>l;l++)a.push(s);return a}function Gi(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function hn(s,a,l,u,p,g){var b=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var S=s.entanglements,M=s.expirationTimes,W=s.hiddenUpdates;for(l=b&~l;0<l;){var ne=31-Bt(l),ae=1<<ne;S[ne]=0,M[ne]=-1;var Q=W[ne];if(Q!==null)for(W[ne]=null,ne=0;ne<Q.length;ne++){var X=Q[ne];X!==null&&(X.lane&=-536870913)}l&=~ae}u!==0&&Ki(s,u,0),g!==0&&p===0&&s.tag!==0&&(s.suspendedLanes|=g&~(b&~a))}function Ki(s,a,l){s.pendingLanes|=a,s.suspendedLanes&=~a;var u=31-Bt(a);s.entangledLanes|=a,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function Tr(s,a){var l=s.entangledLanes|=a;for(s=s.entanglements;l;){var u=31-Bt(l),p=1<<u;p&a|s[u]&a&&(s[u]|=a),l&=~p}}function Sr(s,a){var l=a&-a;return l=(l&42)!==0?1:yc(l),(l&(s.suspendedLanes|a))!==0?0:l}function yc(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function wc(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Os(){var s=G.p;return s!==0?s:(s=window.event,s===void 0?32:jb(s.type))}function jh(s,a){var l=G.p;try{return G.p=s,a()}finally{G.p=l}}var hs=Math.random().toString(36).slice(2),Jt="__reactFiber$"+hs,Ln="__reactProps$"+hs,ds="__reactContainer$"+hs,xr="__reactEvents$"+hs,fs="__reactListeners$"+hs,Ph="__reactHandles$"+hs,bc="__reactResources$"+hs,Ds="__reactMarker$"+hs;function Pa(s){delete s[Jt],delete s[Ln],delete s[xr],delete s[fs],delete s[Ph]}function js(s){var a=s[Jt];if(a)return a;for(var l=s.parentNode;l;){if(a=l[ds]||l[Jt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(s=vb(s);s!==null;){if(l=s[Jt])return l;s=vb(s)}return a}s=l,l=s.parentNode}return null}function Ps(s){if(s=s[Jt]||s[ds]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Ma(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function Wi(s){var a=s[bc];return a||(a=s[bc]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function an(s){s[Ds]=!0}var Uo=new Set,Cr={};function ti(s,a){ms(s,a),ms(s+"Capture",a)}function ms(s,a){for(Cr[s]=a,s=0;s<a.length;s++)Uo.add(a[s])}var Km=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ec={},Tc={};function Mh(s){return gt.call(Tc,s)?!0:gt.call(Ec,s)?!1:Km.test(s)?Tc[s]=!0:(Ec[s]=!0,!1)}function Ar(s,a,l){if(Mh(a))if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+l)}}function Ir(s,a,l){if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+l)}}function Di(s,a,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(a,l,""+u)}}function ni(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Lh(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Wm(s,a,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,g=u.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return p.call(this)},set:function(b){l=""+b,g.call(this,b)}}),Object.defineProperty(s,a,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(b){l=""+b},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function Vo(s){if(!s._valueTracker){var a=Lh(s)?"checked":"value";s._valueTracker=Wm(s,a,""+s[a])}}function Sc(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return s&&(u=Lh(s)?s.checked?"true":"false":s.value),s=u,s!==l?(a.setValue(s),!0):!1}function zo(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Ms=/[\n"\\]/g;function Zt(s){return s.replace(Ms,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Rr(s,a,l,u,p,g,b,S){s.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?s.type=b:s.removeAttribute("type"),a!=null?b==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+ni(a)):s.value!==""+ni(a)&&(s.value=""+ni(a)):b!=="submit"&&b!=="reset"||s.removeAttribute("value"),a!=null?Bo(s,b,ni(a)):l!=null?Bo(s,b,ni(l)):u!=null&&s.removeAttribute("value"),p==null&&g!=null&&(s.defaultChecked=!!g),p!=null&&(s.checked=p&&typeof p!="function"&&typeof p!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+ni(S):s.removeAttribute("name")}function La(s,a,l,u,p,g,b,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),a!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||a!=null)){Vo(s);return}l=l!=null?""+ni(l):"",a=a!=null?""+ni(a):l,S||a===s.value||(s.value=a),s.defaultValue=a}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=S?s.checked:!!u,s.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.name=b),Vo(s)}function Bo(s,a,l){a==="number"&&zo(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function _t(s,a,l,u){if(s=s.options,a){a={};for(var p=0;p<l.length;p++)a["$"+l[p]]=!0;for(l=0;l<s.length;l++)p=a.hasOwnProperty("$"+s[l].value),s[l].selected!==p&&(s[l].selected=p),p&&u&&(s[l].defaultSelected=!0)}else{for(l=""+ni(l),a=null,p=0;p<s.length;p++){if(s[p].value===l){s[p].selected=!0,u&&(s[p].defaultSelected=!0);return}a!==null||s[p].disabled||(a=s[p])}a!==null&&(a.selected=!0)}}function Ua(s,a,l){if(a!=null&&(a=""+ni(a),a!==s.value&&(s.value=a),l==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=l!=null?""+ni(l):""}function Nr(s,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(i(92));if(Se(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=ni(a),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),Vo(s)}function ji(s,a){if(a){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=a;return}}s.textContent=a}var Ym=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xc(s,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":u?s.setProperty(a,l):typeof l!="number"||l===0||Ym.has(a)?a==="float"?s.cssFloat=l:s[a]=(""+l).trim():s[a]=l+"px"}function Uh(s,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var p in a)u=a[p],a.hasOwnProperty(p)&&l[p]!==u&&xc(s,p,u)}else for(var g in a)a.hasOwnProperty(g)&&xc(s,g,a[g])}function Cc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ps(s){return Xm.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Rn(){}var Fo=null;function qo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ls=null,yi=null;function Vh(s){var a=Ps(s);if(a&&(s=a.stateNode)){var l=s[Ln]||null;e:switch(s=a.stateNode,a.type){case"input":if(Rr(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Zt(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==s&&u.form===s.form){var p=u[Ln]||null;if(!p)throw Error(i(90));Rr(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===s.form&&Sc(u)}break e;case"textarea":Ua(s,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&_t(s,!!l.multiple,a,!1)}}}var Ac=!1;function zh(s,a,l){if(Ac)return s(a,l);Ac=!0;try{var u=s(a);return u}finally{if(Ac=!1,(Ls!==null||yi!==null)&&(Md(),Ls&&(a=Ls,s=yi,yi=Ls=null,Vh(a),s)))for(a=0;a<s.length;a++)Vh(s[a])}}function oi(s,a){var l=s.stateNode;if(l===null)return null;var u=l[Ln]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ic=!1;if(Yi)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){Ic=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{Ic=!1}var wi=null,Ho=null,_s=null;function kr(){if(_s)return _s;var s,a=Ho,l=a.length,u,p="value"in wi?wi.value:wi.textContent,g=p.length;for(s=0;s<l&&a[s]===p[s];s++);var b=l-s;for(u=1;u<=b&&a[l-u]===p[g-u];u++);return _s=p.slice(s,1<u?1-u:void 0)}function Va(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Or(){return!0}function Ft(){return!1}function Kn(s){function a(l,u,p,g,b){this._reactName=l,this._targetInst=p,this.type=u,this.nativeEvent=g,this.target=b,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(l=s[S],this[S]=l?l(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Or:Ft,this.isPropagationStopped=Ft,this}return w(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Or)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Or)},persist:function(){},isPersistent:Or}),a}var Us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},za=Kn(Us),Dr=w({},Us,{view:0,detail:0}),Bh=Kn(Dr),jr,$o,ii,Ba=w({},Dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ii&&(ii&&s.type==="mousemove"?(jr=s.screenX-ii.screenX,$o=s.screenY-ii.screenY):$o=jr=0,ii=s),jr)},movementY:function(s){return"movementY"in s?s.movementY:$o}}),Fh=Kn(Ba),Fa=w({},Ba,{dataTransfer:0}),qh=Kn(Fa),Rc=w({},Dr,{relatedTarget:0}),Pr=Kn(Rc),Hh=w({},Us,{animationName:0,elapsedTime:0,pseudoElement:0}),Go=Kn(Hh),Jm=w({},Us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),$h=Kn(Jm),qa=w({},Us,{data:0}),Nc=Kn(qa),Gh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Oc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Kh(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Oc[s])?!!a[s]:!1}function Mr(){return Kh}var Wh=w({},Dr,{key:function(s){if(s.key){var a=Gh[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Va(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?kc[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mr,charCode:function(s){return s.type==="keypress"?Va(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Va(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yh=Kn(Wh),Vs=w({},Ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dc=Kn(Vs),Qh=w({},Dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mr}),Xh=Kn(Qh),Jh=w({},Us,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ko=Kn(Jh),si=w({},Ba,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zh=Kn(si),ed=w({},Us,{newState:0,oldState:0}),Lr=Kn(ed),d=[9,13,27,32],y=Yi&&"CompositionEvent"in window,E=null;Yi&&"documentMode"in document&&(E=document.documentMode);var C=Yi&&"TextEvent"in window&&!E,$=Yi&&(!y||E&&8<E&&11>=E),J=" ",de=!1;function xt(s,a){switch(s){case"keyup":return d.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dn(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var et=!1;function Nn(s,a){switch(s){case"compositionend":return dn(a);case"keypress":return a.which!==32?null:(de=!0,J);case"textInput":return s=a.data,s===J&&de?null:s;default:return null}}function kn(s,a){if(et)return s==="compositionend"||!y&&xt(s,a)?(s=kr(),_s=Ho=wi=null,et=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return $&&a.locale!=="ko"?null:a.data;default:return null}}var Ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function li(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Ur[s.type]:a==="textarea"}function Ha(s,a,l,u){Ls?yi?yi.push(u):yi=[u]:Ls=u,a=qd(a,"onChange"),0<a.length&&(l=new za("onChange","change",null,l,u),s.push({event:l,listeners:a}))}var zs=null,jc=null;function P4(s){sb(s,0)}function td(s){var a=Ma(s);if(Sc(a))return s}function Ty(s,a){if(s==="change")return a}var Sy=!1;if(Yi){var Zm;if(Yi){var ep="oninput"in document;if(!ep){var xy=document.createElement("div");xy.setAttribute("oninput","return;"),ep=typeof xy.oninput=="function"}Zm=ep}else Zm=!1;Sy=Zm&&(!document.documentMode||9<document.documentMode)}function Cy(){zs&&(zs.detachEvent("onpropertychange",Ay),jc=zs=null)}function Ay(s){if(s.propertyName==="value"&&td(jc)){var a=[];Ha(a,jc,s,qo(s)),zh(P4,a)}}function M4(s,a,l){s==="focusin"?(Cy(),zs=a,jc=l,zs.attachEvent("onpropertychange",Ay)):s==="focusout"&&Cy()}function L4(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return td(jc)}function U4(s,a){if(s==="click")return td(a)}function V4(s,a){if(s==="input"||s==="change")return td(a)}function z4(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var bi=typeof Object.is=="function"?Object.is:z4;function Pc(s,a){if(bi(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var l=Object.keys(s),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var p=l[u];if(!gt.call(a,p)||!bi(s[p],a[p]))return!1}return!0}function Iy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ry(s,a){var l=Iy(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=a&&u>=a)return{node:l,offset:a-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Iy(l)}}function Ny(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Ny(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function ky(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=zo(s.document);a instanceof s.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)s=a.contentWindow;else break;a=zo(s.document)}return a}function tp(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var B4=Yi&&"documentMode"in document&&11>=document.documentMode,Wo=null,np=null,Mc=null,ip=!1;function Oy(s,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ip||Wo==null||Wo!==zo(u)||(u=Wo,"selectionStart"in u&&tp(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Mc&&Pc(Mc,u)||(Mc=u,u=qd(np,"onSelect"),0<u.length&&(a=new za("onSelect","select",null,a,l),s.push({event:a,listeners:u}),a.target=Wo)))}function $a(s,a){var l={};return l[s.toLowerCase()]=a.toLowerCase(),l["Webkit"+s]="webkit"+a,l["Moz"+s]="moz"+a,l}var Yo={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionrun:$a("Transition","TransitionRun"),transitionstart:$a("Transition","TransitionStart"),transitioncancel:$a("Transition","TransitionCancel"),transitionend:$a("Transition","TransitionEnd")},sp={},Dy={};Yi&&(Dy=document.createElement("div").style,"AnimationEvent"in window||(delete Yo.animationend.animation,delete Yo.animationiteration.animation,delete Yo.animationstart.animation),"TransitionEvent"in window||delete Yo.transitionend.transition);function Ga(s){if(sp[s])return sp[s];if(!Yo[s])return s;var a=Yo[s],l;for(l in a)if(a.hasOwnProperty(l)&&l in Dy)return sp[s]=a[l];return s}var jy=Ga("animationend"),Py=Ga("animationiteration"),My=Ga("animationstart"),F4=Ga("transitionrun"),q4=Ga("transitionstart"),H4=Ga("transitioncancel"),Ly=Ga("transitionend"),Uy=new Map,rp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rp.push("scrollEnd");function Qi(s,a){Uy.set(s,a),ti(a,[s])}var nd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Pi=[],Qo=0,ap=0;function id(){for(var s=Qo,a=ap=Qo=0;a<s;){var l=Pi[a];Pi[a++]=null;var u=Pi[a];Pi[a++]=null;var p=Pi[a];Pi[a++]=null;var g=Pi[a];if(Pi[a++]=null,u!==null&&p!==null){var b=u.pending;b===null?p.next=p:(p.next=b.next,b.next=p),u.pending=p}g!==0&&Vy(l,p,g)}}function sd(s,a,l,u){Pi[Qo++]=s,Pi[Qo++]=a,Pi[Qo++]=l,Pi[Qo++]=u,ap|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function op(s,a,l,u){return sd(s,a,l,u),rd(s)}function Ka(s,a){return sd(s,null,null,a),rd(s)}function Vy(s,a,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var p=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(p=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,p&&a!==null&&(p=31-Bt(l),s=g.hiddenUpdates,u=s[p],u===null?s[p]=[a]:u.push(a),a.lane=l|536870912),g):null}function rd(s){if(50<su)throw su=0,gg=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var Xo={};function $4(s,a,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ei(s,a,l,u){return new $4(s,a,l,u)}function lp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Bs(s,a){var l=s.alternate;return l===null?(l=Ei(s.tag,a,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=a,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,a=s.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function zy(s,a){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,a=l.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function ad(s,a,l,u,p,g){var b=0;if(u=s,typeof s=="function")lp(s)&&(b=1);else if(typeof s=="string")b=QI(s,l,he.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Ei(31,l,a,p),s.elementType=R,s.lanes=g,s;case L:return Wa(l.children,p,g,a);case O:b=8,p|=24;break;case Z:return s=Ei(12,l,a,p|2),s.elementType=Z,s.lanes=g,s;case ve:return s=Ei(13,l,a,p),s.elementType=ve,s.lanes=g,s;case oe:return s=Ei(19,l,a,p),s.elementType=oe,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case H:b=10;break e;case Y:b=9;break e;case le:b=11;break e;case I:b=14;break e;case A:b=16,u=null;break e}b=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return a=Ei(b,l,a,p),a.elementType=s,a.type=u,a.lanes=g,a}function Wa(s,a,l,u){return s=Ei(7,s,u,a),s.lanes=l,s}function cp(s,a,l){return s=Ei(6,s,null,a),s.lanes=l,s}function By(s){var a=Ei(18,null,null,0);return a.stateNode=s,a}function up(s,a,l){return a=Ei(4,s.children!==null?s.children:[],s.key,a),a.lanes=l,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var Fy=new WeakMap;function Mi(s,a){if(typeof s=="object"&&s!==null){var l=Fy.get(s);return l!==void 0?l:(a={value:s,source:a,stack:Ze(a)},Fy.set(s,a),a)}return{value:s,source:a,stack:Ze(a)}}var Jo=[],Zo=0,od=null,Lc=0,Li=[],Ui=0,Vr=null,vs=1,ys="";function Fs(s,a){Jo[Zo++]=Lc,Jo[Zo++]=od,od=s,Lc=a}function qy(s,a,l){Li[Ui++]=vs,Li[Ui++]=ys,Li[Ui++]=Vr,Vr=s;var u=vs;s=ys;var p=32-Bt(u)-1;u&=~(1<<p),l+=1;var g=32-Bt(a)+p;if(30<g){var b=p-p%5;g=(u&(1<<b)-1).toString(32),u>>=b,p-=b,vs=1<<32-Bt(a)+p|l<<p|u,ys=g+s}else vs=1<<g|l<<p|u,ys=s}function hp(s){s.return!==null&&(Fs(s,1),qy(s,1,0))}function dp(s){for(;s===od;)od=Jo[--Zo],Jo[Zo]=null,Lc=Jo[--Zo],Jo[Zo]=null;for(;s===Vr;)Vr=Li[--Ui],Li[Ui]=null,ys=Li[--Ui],Li[Ui]=null,vs=Li[--Ui],Li[Ui]=null}function Hy(s,a){Li[Ui++]=vs,Li[Ui++]=ys,Li[Ui++]=Vr,vs=a.id,ys=a.overflow,Vr=s}var Un=null,qt=null,ht=!1,zr=null,Vi=!1,fp=Error(i(519));function Br(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Uc(Mi(a,s)),fp}function $y(s){var a=s.stateNode,l=s.type,u=s.memoizedProps;switch(a[Jt]=s,a[Ln]=u,l){case"dialog":st("cancel",a),st("close",a);break;case"iframe":case"object":case"embed":st("load",a);break;case"video":case"audio":for(l=0;l<au.length;l++)st(au[l],a);break;case"source":st("error",a);break;case"img":case"image":case"link":st("error",a),st("load",a);break;case"details":st("toggle",a);break;case"input":st("invalid",a),La(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":st("invalid",a);break;case"textarea":st("invalid",a),Nr(a,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||lb(a.textContent,l)?(u.popover!=null&&(st("beforetoggle",a),st("toggle",a)),u.onScroll!=null&&st("scroll",a),u.onScrollEnd!=null&&st("scrollend",a),u.onClick!=null&&(a.onclick=Rn),a=!0):a=!1,a||Br(s,!0)}function Gy(s){for(Un=s.return;Un;)switch(Un.tag){case 5:case 31:case 13:Vi=!1;return;case 27:case 3:Vi=!0;return;default:Un=Un.return}}function el(s){if(s!==Un)return!1;if(!ht)return Gy(s),ht=!0,!1;var a=s.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||kg(s.type,s.memoizedProps)),l=!l),l&&qt&&Br(s),Gy(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));qt=_b(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));qt=_b(s)}else a===27?(a=qt,ta(s.type)?(s=Mg,Mg=null,qt=s):qt=a):qt=Un?Bi(s.stateNode.nextSibling):null;return!0}function Ya(){qt=Un=null,ht=!1}function mp(){var s=zr;return s!==null&&(di===null?di=s:di.push.apply(di,s),zr=null),s}function Uc(s){zr===null?zr=[s]:zr.push(s)}var pp=D(null),Qa=null,qs=null;function Fr(s,a,l){ee(pp,a._currentValue),a._currentValue=l}function Hs(s){s._currentValue=pp.current,B(pp)}function gp(s,a,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),s===l)break;s=s.return}}function _p(s,a,l,u){var p=s.child;for(p!==null&&(p.return=s);p!==null;){var g=p.dependencies;if(g!==null){var b=p.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=p;for(var M=0;M<a.length;M++)if(S.context===a[M]){g.lanes|=l,S=g.alternate,S!==null&&(S.lanes|=l),gp(g.return,l,s),u||(b=null);break e}g=S.next}}else if(p.tag===18){if(b=p.return,b===null)throw Error(i(341));b.lanes|=l,g=b.alternate,g!==null&&(g.lanes|=l),gp(b,l,s),b=null}else b=p.child;if(b!==null)b.return=p;else for(b=p;b!==null;){if(b===s){b=null;break}if(p=b.sibling,p!==null){p.return=b.return,b=p;break}b=b.return}p=b}}function tl(s,a,l,u){s=null;for(var p=a,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var b=p.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var S=p.type;bi(p.pendingProps.value,b.value)||(s!==null?s.push(S):s=[S])}}else if(p===je.current){if(b=p.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(s!==null?s.push(hu):s=[hu])}p=p.return}s!==null&&_p(a,s,l,u),a.flags|=262144}function ld(s){for(s=s.firstContext;s!==null;){if(!bi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Xa(s){Qa=s,qs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Vn(s){return Ky(Qa,s)}function cd(s,a){return Qa===null&&Xa(s),Ky(s,a)}function Ky(s,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},qs===null){if(s===null)throw Error(i(308));qs=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else qs=qs.next=a;return l}var G4=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){a.aborted=!0,s.forEach(function(l){return l()})}},K4=n.unstable_scheduleCallback,W4=n.unstable_NormalPriority,fn={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vp(){return{controller:new G4,data:new Map,refCount:0}}function Vc(s){s.refCount--,s.refCount===0&&K4(W4,function(){s.controller.abort()})}var zc=null,yp=0,nl=0,il=null;function Y4(s,a){if(zc===null){var l=zc=[];yp=0,nl=Eg(),il={status:"pending",value:void 0,then:function(u){l.push(u)}}}return yp++,a.then(Wy,Wy),a}function Wy(){if(--yp===0&&zc!==null){il!==null&&(il.status="fulfilled");var s=zc;zc=null,nl=0,il=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function Q4(s,a){var l=[],u={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return s.then(function(){u.status="fulfilled",u.value=a;for(var p=0;p<l.length;p++)(0,l[p])(a)},function(p){for(u.status="rejected",u.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),u}var Yy=j.S;j.S=function(s,a){O1=pt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Y4(s,a),Yy!==null&&Yy(s,a)};var Ja=D(null);function wp(){var s=Ja.current;return s!==null?s:Pt.pooledCache}function ud(s,a){a===null?ee(Ja,Ja.current):ee(Ja,a.pool)}function Qy(){var s=wp();return s===null?null:{parent:fn._currentValue,pool:s}}var sl=Error(i(460)),bp=Error(i(474)),hd=Error(i(542)),dd={then:function(){}};function Xy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Jy(s,a,l){switch(l=s[l],l===void 0?s.push(a):l!==a&&(a.then(Rn,Rn),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,ew(s),s;default:if(typeof a.status=="string")a.then(Rn,Rn);else{if(s=Pt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(u){if(a.status==="pending"){var p=a;p.status="fulfilled",p.value=u}},function(u){if(a.status==="pending"){var p=a;p.status="rejected",p.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,ew(s),s}throw eo=a,sl}}function Za(s){try{var a=s._init;return a(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(eo=l,sl):l}}var eo=null;function Zy(){if(eo===null)throw Error(i(459));var s=eo;return eo=null,s}function ew(s){if(s===sl||s===hd)throw Error(i(483))}var rl=null,Bc=0;function fd(s){var a=Bc;return Bc+=1,rl===null&&(rl=[]),Jy(rl,s,a)}function Fc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function md(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function tw(s){function a(q,z){if(s){var K=q.deletions;K===null?(q.deletions=[z],q.flags|=16):K.push(z)}}function l(q,z){if(!s)return null;for(;z!==null;)a(q,z),z=z.sibling;return null}function u(q){for(var z=new Map;q!==null;)q.key!==null?z.set(q.key,q):z.set(q.index,q),q=q.sibling;return z}function p(q,z){return q=Bs(q,z),q.index=0,q.sibling=null,q}function g(q,z,K){return q.index=K,s?(K=q.alternate,K!==null?(K=K.index,K<z?(q.flags|=67108866,z):K):(q.flags|=67108866,z)):(q.flags|=1048576,z)}function b(q){return s&&q.alternate===null&&(q.flags|=67108866),q}function S(q,z,K,re){return z===null||z.tag!==6?(z=cp(K,q.mode,re),z.return=q,z):(z=p(z,K),z.return=q,z)}function M(q,z,K,re){var Ne=K.type;return Ne===L?ne(q,z,K.props.children,re,K.key):z!==null&&(z.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===A&&Za(Ne)===z.type)?(z=p(z,K.props),Fc(z,K),z.return=q,z):(z=ad(K.type,K.key,K.props,null,q.mode,re),Fc(z,K),z.return=q,z)}function W(q,z,K,re){return z===null||z.tag!==4||z.stateNode.containerInfo!==K.containerInfo||z.stateNode.implementation!==K.implementation?(z=up(K,q.mode,re),z.return=q,z):(z=p(z,K.children||[]),z.return=q,z)}function ne(q,z,K,re,Ne){return z===null||z.tag!==7?(z=Wa(K,q.mode,re,Ne),z.return=q,z):(z=p(z,K),z.return=q,z)}function ae(q,z,K){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=cp(""+z,q.mode,K),z.return=q,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case x:return K=ad(z.type,z.key,z.props,null,q.mode,K),Fc(K,z),K.return=q,K;case N:return z=up(z,q.mode,K),z.return=q,z;case A:return z=Za(z),ae(q,z,K)}if(Se(z)||F(z))return z=Wa(z,q.mode,K,null),z.return=q,z;if(typeof z.then=="function")return ae(q,fd(z),K);if(z.$$typeof===H)return ae(q,cd(q,z),K);md(q,z)}return null}function Q(q,z,K,re){var Ne=z!==null?z.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return Ne!==null?null:S(q,z,""+K,re);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case x:return K.key===Ne?M(q,z,K,re):null;case N:return K.key===Ne?W(q,z,K,re):null;case A:return K=Za(K),Q(q,z,K,re)}if(Se(K)||F(K))return Ne!==null?null:ne(q,z,K,re,null);if(typeof K.then=="function")return Q(q,z,fd(K),re);if(K.$$typeof===H)return Q(q,z,cd(q,K),re);md(q,K)}return null}function X(q,z,K,re,Ne){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return q=q.get(K)||null,S(z,q,""+re,Ne);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case x:return q=q.get(re.key===null?K:re.key)||null,M(z,q,re,Ne);case N:return q=q.get(re.key===null?K:re.key)||null,W(z,q,re,Ne);case A:return re=Za(re),X(q,z,K,re,Ne)}if(Se(re)||F(re))return q=q.get(K)||null,ne(z,q,re,Ne,null);if(typeof re.then=="function")return X(q,z,K,fd(re),Ne);if(re.$$typeof===H)return X(q,z,K,cd(z,re),Ne);md(z,re)}return null}function Ee(q,z,K,re){for(var Ne=null,vt=null,Ae=z,Xe=z=0,lt=null;Ae!==null&&Xe<K.length;Xe++){Ae.index>Xe?(lt=Ae,Ae=null):lt=Ae.sibling;var yt=Q(q,Ae,K[Xe],re);if(yt===null){Ae===null&&(Ae=lt);break}s&&Ae&&yt.alternate===null&&a(q,Ae),z=g(yt,z,Xe),vt===null?Ne=yt:vt.sibling=yt,vt=yt,Ae=lt}if(Xe===K.length)return l(q,Ae),ht&&Fs(q,Xe),Ne;if(Ae===null){for(;Xe<K.length;Xe++)Ae=ae(q,K[Xe],re),Ae!==null&&(z=g(Ae,z,Xe),vt===null?Ne=Ae:vt.sibling=Ae,vt=Ae);return ht&&Fs(q,Xe),Ne}for(Ae=u(Ae);Xe<K.length;Xe++)lt=X(Ae,q,Xe,K[Xe],re),lt!==null&&(s&&lt.alternate!==null&&Ae.delete(lt.key===null?Xe:lt.key),z=g(lt,z,Xe),vt===null?Ne=lt:vt.sibling=lt,vt=lt);return s&&Ae.forEach(function(aa){return a(q,aa)}),ht&&Fs(q,Xe),Ne}function Le(q,z,K,re){if(K==null)throw Error(i(151));for(var Ne=null,vt=null,Ae=z,Xe=z=0,lt=null,yt=K.next();Ae!==null&&!yt.done;Xe++,yt=K.next()){Ae.index>Xe?(lt=Ae,Ae=null):lt=Ae.sibling;var aa=Q(q,Ae,yt.value,re);if(aa===null){Ae===null&&(Ae=lt);break}s&&Ae&&aa.alternate===null&&a(q,Ae),z=g(aa,z,Xe),vt===null?Ne=aa:vt.sibling=aa,vt=aa,Ae=lt}if(yt.done)return l(q,Ae),ht&&Fs(q,Xe),Ne;if(Ae===null){for(;!yt.done;Xe++,yt=K.next())yt=ae(q,yt.value,re),yt!==null&&(z=g(yt,z,Xe),vt===null?Ne=yt:vt.sibling=yt,vt=yt);return ht&&Fs(q,Xe),Ne}for(Ae=u(Ae);!yt.done;Xe++,yt=K.next())yt=X(Ae,q,Xe,yt.value,re),yt!==null&&(s&&yt.alternate!==null&&Ae.delete(yt.key===null?Xe:yt.key),z=g(yt,z,Xe),vt===null?Ne=yt:vt.sibling=yt,vt=yt);return s&&Ae.forEach(function(oR){return a(q,oR)}),ht&&Fs(q,Xe),Ne}function jt(q,z,K,re){if(typeof K=="object"&&K!==null&&K.type===L&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case x:e:{for(var Ne=K.key;z!==null;){if(z.key===Ne){if(Ne=K.type,Ne===L){if(z.tag===7){l(q,z.sibling),re=p(z,K.props.children),re.return=q,q=re;break e}}else if(z.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===A&&Za(Ne)===z.type){l(q,z.sibling),re=p(z,K.props),Fc(re,K),re.return=q,q=re;break e}l(q,z);break}else a(q,z);z=z.sibling}K.type===L?(re=Wa(K.props.children,q.mode,re,K.key),re.return=q,q=re):(re=ad(K.type,K.key,K.props,null,q.mode,re),Fc(re,K),re.return=q,q=re)}return b(q);case N:e:{for(Ne=K.key;z!==null;){if(z.key===Ne)if(z.tag===4&&z.stateNode.containerInfo===K.containerInfo&&z.stateNode.implementation===K.implementation){l(q,z.sibling),re=p(z,K.children||[]),re.return=q,q=re;break e}else{l(q,z);break}else a(q,z);z=z.sibling}re=up(K,q.mode,re),re.return=q,q=re}return b(q);case A:return K=Za(K),jt(q,z,K,re)}if(Se(K))return Ee(q,z,K,re);if(F(K)){if(Ne=F(K),typeof Ne!="function")throw Error(i(150));return K=Ne.call(K),Le(q,z,K,re)}if(typeof K.then=="function")return jt(q,z,fd(K),re);if(K.$$typeof===H)return jt(q,z,cd(q,K),re);md(q,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,z!==null&&z.tag===6?(l(q,z.sibling),re=p(z,K),re.return=q,q=re):(l(q,z),re=cp(K,q.mode,re),re.return=q,q=re),b(q)):l(q,z)}return function(q,z,K,re){try{Bc=0;var Ne=jt(q,z,K,re);return rl=null,Ne}catch(Ae){if(Ae===sl||Ae===hd)throw Ae;var vt=Ei(29,Ae,null,q.mode);return vt.lanes=re,vt.return=q,vt}finally{}}}var to=tw(!0),nw=tw(!1),qr=!1;function Ep(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Tp(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Hr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function $r(s,a,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(Tt&2)!==0){var p=u.pending;return p===null?a.next=a:(a.next=p.next,p.next=a),u.pending=a,a=rd(s),Vy(s,null,l),a}return sd(s,u,a,l),rd(s)}function qc(s,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=s.pendingLanes,l|=u,a.lanes=l,Tr(s,l)}}function Sp(s,a){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?p=g=b:g=g.next=b,l=l.next}while(l!==null);g===null?p=g=a:g=g.next=a}else p=g=a;l={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=a:s.next=a,l.lastBaseUpdate=a}var xp=!1;function Hc(){if(xp){var s=il;if(s!==null)throw s}}function $c(s,a,l,u){xp=!1;var p=s.updateQueue;qr=!1;var g=p.firstBaseUpdate,b=p.lastBaseUpdate,S=p.shared.pending;if(S!==null){p.shared.pending=null;var M=S,W=M.next;M.next=null,b===null?g=W:b.next=W,b=M;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,S=ne.lastBaseUpdate,S!==b&&(S===null?ne.firstBaseUpdate=W:S.next=W,ne.lastBaseUpdate=M))}if(g!==null){var ae=p.baseState;b=0,ne=W=M=null,S=g;do{var Q=S.lane&-536870913,X=Q!==S.lane;if(X?(ot&Q)===Q:(u&Q)===Q){Q!==0&&Q===nl&&(xp=!0),ne!==null&&(ne=ne.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ee=s,Le=S;Q=a;var jt=l;switch(Le.tag){case 1:if(Ee=Le.payload,typeof Ee=="function"){ae=Ee.call(jt,ae,Q);break e}ae=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Le.payload,Q=typeof Ee=="function"?Ee.call(jt,ae,Q):Ee,Q==null)break e;ae=w({},ae,Q);break e;case 2:qr=!0}}Q=S.callback,Q!==null&&(s.flags|=64,X&&(s.flags|=8192),X=p.callbacks,X===null?p.callbacks=[Q]:X.push(Q))}else X={lane:Q,tag:S.tag,payload:S.payload,callback:S.callback,next:null},ne===null?(W=ne=X,M=ae):ne=ne.next=X,b|=Q;if(S=S.next,S===null){if(S=p.shared.pending,S===null)break;X=S,S=X.next,X.next=null,p.lastBaseUpdate=X,p.shared.pending=null}}while(!0);ne===null&&(M=ae),p.baseState=M,p.firstBaseUpdate=W,p.lastBaseUpdate=ne,g===null&&(p.shared.lanes=0),Qr|=b,s.lanes=b,s.memoizedState=ae}}function iw(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function sw(s,a){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)iw(l[s],a)}var al=D(null),pd=D(0);function rw(s,a){s=Zs,ee(pd,s),ee(al,a),Zs=s|a.baseLanes}function Cp(){ee(pd,Zs),ee(al,al.current)}function Ap(){Zs=pd.current,B(al),B(pd)}var Ti=D(null),zi=null;function Gr(s){var a=s.alternate;ee(on,on.current&1),ee(Ti,s),zi===null&&(a===null||al.current!==null||a.memoizedState!==null)&&(zi=s)}function Ip(s){ee(on,on.current),ee(Ti,s),zi===null&&(zi=s)}function aw(s){s.tag===22?(ee(on,on.current),ee(Ti,s),zi===null&&(zi=s)):Kr()}function Kr(){ee(on,on.current),ee(Ti,Ti.current)}function Si(s){B(Ti),zi===s&&(zi=null),B(on)}var on=D(0);function gd(s){for(var a=s;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||jg(l)||Pg(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var $s=0,Qe=null,Ot=null,mn=null,_d=!1,ol=!1,no=!1,vd=0,Gc=0,ll=null,X4=0;function en(){throw Error(i(321))}function Rp(s,a){if(a===null)return!1;for(var l=0;l<a.length&&l<s.length;l++)if(!bi(s[l],a[l]))return!1;return!0}function Np(s,a,l,u,p,g){return $s=g,Qe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,j.H=s===null||s.memoizedState===null?qw:$p,no=!1,g=l(u,p),no=!1,ol&&(g=lw(a,l,u,p)),ow(s),g}function ow(s){j.H=Yc;var a=Ot!==null&&Ot.next!==null;if($s=0,mn=Ot=Qe=null,_d=!1,Gc=0,ll=null,a)throw Error(i(300));s===null||pn||(s=s.dependencies,s!==null&&ld(s)&&(pn=!0))}function lw(s,a,l,u){Qe=s;var p=0;do{if(ol&&(ll=null),Gc=0,ol=!1,25<=p)throw Error(i(301));if(p+=1,mn=Ot=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}j.H=Hw,g=a(l,u)}while(ol);return g}function J4(){var s=j.H,a=s.useState()[0];return a=typeof a.then=="function"?Kc(a):a,s=s.useState()[0],(Ot!==null?Ot.memoizedState:null)!==s&&(Qe.flags|=1024),a}function kp(){var s=vd!==0;return vd=0,s}function Op(s,a,l){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~l}function Dp(s){if(_d){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}_d=!1}$s=0,mn=Ot=Qe=null,ol=!1,Gc=vd=0,ll=null}function ri(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mn===null?Qe.memoizedState=mn=s:mn=mn.next=s,mn}function ln(){if(Ot===null){var s=Qe.alternate;s=s!==null?s.memoizedState:null}else s=Ot.next;var a=mn===null?Qe.memoizedState:mn.next;if(a!==null)mn=a,Ot=s;else{if(s===null)throw Qe.alternate===null?Error(i(467)):Error(i(310));Ot=s,s={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},mn===null?Qe.memoizedState=mn=s:mn=mn.next=s}return mn}function yd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Kc(s){var a=Gc;return Gc+=1,ll===null&&(ll=[]),s=Jy(ll,s,a),a=Qe,(mn===null?a.memoizedState:mn.next)===null&&(a=a.alternate,j.H=a===null||a.memoizedState===null?qw:$p),s}function wd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Kc(s);if(s.$$typeof===H)return Vn(s)}throw Error(i(438,String(s)))}function jp(s){var a=null,l=Qe.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Qe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(p){return p.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=yd(),Qe.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(s),u=0;u<s;u++)l[u]=U;return a.index++,l}function Gs(s,a){return typeof a=="function"?a(s):a}function bd(s){var a=ln();return Pp(a,Ot,s)}function Pp(s,a,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var p=s.baseQueue,g=u.pending;if(g!==null){if(p!==null){var b=p.next;p.next=g.next,g.next=b}a.baseQueue=p=g,u.pending=null}if(g=s.baseState,p===null)s.memoizedState=g;else{a=p.next;var S=b=null,M=null,W=a,ne=!1;do{var ae=W.lane&-536870913;if(ae!==W.lane?(ot&ae)===ae:($s&ae)===ae){var Q=W.revertLane;if(Q===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),ae===nl&&(ne=!0);else if(($s&Q)===Q){W=W.next,Q===nl&&(ne=!0);continue}else ae={lane:0,revertLane:W.revertLane,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},M===null?(S=M=ae,b=g):M=M.next=ae,Qe.lanes|=Q,Qr|=Q;ae=W.action,no&&l(g,ae),g=W.hasEagerState?W.eagerState:l(g,ae)}else Q={lane:ae,revertLane:W.revertLane,gesture:W.gesture,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},M===null?(S=M=Q,b=g):M=M.next=Q,Qe.lanes|=ae,Qr|=ae;W=W.next}while(W!==null&&W!==a);if(M===null?b=g:M.next=S,!bi(g,s.memoizedState)&&(pn=!0,ne&&(l=il,l!==null)))throw l;s.memoizedState=g,s.baseState=b,s.baseQueue=M,u.lastRenderedState=g}return p===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Mp(s){var a=ln(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,p=l.pending,g=a.memoizedState;if(p!==null){l.pending=null;var b=p=p.next;do g=s(g,b.action),b=b.next;while(b!==p);bi(g,a.memoizedState)||(pn=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),l.lastRenderedState=g}return[g,u]}function cw(s,a,l){var u=Qe,p=ln(),g=ht;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=a();var b=!bi((Ot||p).memoizedState,l);if(b&&(p.memoizedState=l,pn=!0),p=p.queue,Vp(dw.bind(null,u,p,s),[s]),p.getSnapshot!==a||b||mn!==null&&mn.memoizedState.tag&1){if(u.flags|=2048,cl(9,{destroy:void 0},hw.bind(null,u,p,l,a),null),Pt===null)throw Error(i(349));g||($s&127)!==0||uw(u,a,l)}return l}function uw(s,a,l){s.flags|=16384,s={getSnapshot:a,value:l},a=Qe.updateQueue,a===null?(a=yd(),Qe.updateQueue=a,a.stores=[s]):(l=a.stores,l===null?a.stores=[s]:l.push(s))}function hw(s,a,l,u){a.value=l,a.getSnapshot=u,fw(a)&&mw(s)}function dw(s,a,l){return l(function(){fw(a)&&mw(s)})}function fw(s){var a=s.getSnapshot;s=s.value;try{var l=a();return!bi(s,l)}catch{return!0}}function mw(s){var a=Ka(s,2);a!==null&&fi(a,s,2)}function Lp(s){var a=ri();if(typeof s=="function"){var l=s;if(s=l(),no){zt(!0);try{l()}finally{zt(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:s},a}function pw(s,a,l,u){return s.baseState=l,Pp(s,Ot,typeof u=="function"?u:Gs)}function Z4(s,a,l,u,p){if(Sd(s))throw Error(i(485));if(s=a.action,s!==null){var g={payload:p,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){g.listeners.push(b)}};j.T!==null?l(!0):g.isTransition=!1,u(g),l=a.pending,l===null?(g.next=a.pending=g,gw(a,g)):(g.next=l.next,a.pending=l.next=g)}}function gw(s,a){var l=a.action,u=a.payload,p=s.state;if(a.isTransition){var g=j.T,b={};j.T=b;try{var S=l(p,u),M=j.S;M!==null&&M(b,S),_w(s,a,S)}catch(W){Up(s,a,W)}finally{g!==null&&b.types!==null&&(g.types=b.types),j.T=g}}else try{g=l(p,u),_w(s,a,g)}catch(W){Up(s,a,W)}}function _w(s,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){vw(s,a,u)},function(u){return Up(s,a,u)}):vw(s,a,l)}function vw(s,a,l){a.status="fulfilled",a.value=l,yw(a),s.state=l,a=s.pending,a!==null&&(l=a.next,l===a?s.pending=null:(l=l.next,a.next=l,gw(s,l)))}function Up(s,a,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,yw(a),a=a.next;while(a!==u)}s.action=null}function yw(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function ww(s,a){return a}function bw(s,a){if(ht){var l=Pt.formState;if(l!==null){e:{var u=Qe;if(ht){if(qt){t:{for(var p=qt,g=Vi;p.nodeType!==8;){if(!g){p=null;break t}if(p=Bi(p.nextSibling),p===null){p=null;break t}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){qt=Bi(p.nextSibling),u=p.data==="F!";break e}}Br(u)}u=!1}u&&(a=l[0])}}return l=ri(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ww,lastRenderedState:a},l.queue=u,l=zw.bind(null,Qe,u),u.dispatch=l,u=Lp(!1),g=Hp.bind(null,Qe,!1,u.queue),u=ri(),p={state:a,dispatch:null,action:s,pending:null},u.queue=p,l=Z4.bind(null,Qe,p,g,l),p.dispatch=l,u.memoizedState=s,[a,l,!1]}function Ew(s){var a=ln();return Tw(a,Ot,s)}function Tw(s,a,l){if(a=Pp(s,a,ww)[0],s=bd(Gs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=Kc(a)}catch(b){throw b===sl?hd:b}else u=a;a=ln();var p=a.queue,g=p.dispatch;return l!==a.memoizedState&&(Qe.flags|=2048,cl(9,{destroy:void 0},eI.bind(null,p,l),null)),[u,g,s]}function eI(s,a){s.action=a}function Sw(s){var a=ln(),l=Ot;if(l!==null)return Tw(a,l,s);ln(),a=a.memoizedState,l=ln();var u=l.queue.dispatch;return l.memoizedState=s,[a,u,!1]}function cl(s,a,l,u){return s={tag:s,create:l,deps:u,inst:a,next:null},a=Qe.updateQueue,a===null&&(a=yd(),Qe.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,a.lastEffect=s),s}function xw(){return ln().memoizedState}function Ed(s,a,l,u){var p=ri();Qe.flags|=s,p.memoizedState=cl(1|a,{destroy:void 0},l,u===void 0?null:u)}function Td(s,a,l,u){var p=ln();u=u===void 0?null:u;var g=p.memoizedState.inst;Ot!==null&&u!==null&&Rp(u,Ot.memoizedState.deps)?p.memoizedState=cl(a,g,l,u):(Qe.flags|=s,p.memoizedState=cl(1|a,g,l,u))}function Cw(s,a){Ed(8390656,8,s,a)}function Vp(s,a){Td(2048,8,s,a)}function tI(s){Qe.flags|=4;var a=Qe.updateQueue;if(a===null)a=yd(),Qe.updateQueue=a,a.events=[s];else{var l=a.events;l===null?a.events=[s]:l.push(s)}}function Aw(s){var a=ln().memoizedState;return tI({ref:a,nextImpl:s}),function(){if((Tt&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function Iw(s,a){return Td(4,2,s,a)}function Rw(s,a){return Td(4,4,s,a)}function Nw(s,a){if(typeof a=="function"){s=s();var l=a(s);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function kw(s,a,l){l=l!=null?l.concat([s]):null,Td(4,4,Nw.bind(null,a,s),l)}function zp(){}function Ow(s,a){var l=ln();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&Rp(a,u[1])?u[0]:(l.memoizedState=[s,a],s)}function Dw(s,a){var l=ln();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&Rp(a,u[1]))return u[0];if(u=s(),no){zt(!0);try{s()}finally{zt(!1)}}return l.memoizedState=[u,a],u}function Bp(s,a,l){return l===void 0||($s&1073741824)!==0&&(ot&261930)===0?s.memoizedState=a:(s.memoizedState=l,s=j1(),Qe.lanes|=s,Qr|=s,l)}function jw(s,a,l,u){return bi(l,a)?l:al.current!==null?(s=Bp(s,l,u),bi(s,a)||(pn=!0),s):($s&42)===0||($s&1073741824)!==0&&(ot&261930)===0?(pn=!0,s.memoizedState=l):(s=j1(),Qe.lanes|=s,Qr|=s,a)}function Pw(s,a,l,u,p){var g=G.p;G.p=g!==0&&8>g?g:8;var b=j.T,S={};j.T=S,Hp(s,!1,a,l);try{var M=p(),W=j.S;if(W!==null&&W(S,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var ne=Q4(M,u);Wc(s,a,ne,Ai(s))}else Wc(s,a,u,Ai(s))}catch(ae){Wc(s,a,{then:function(){},status:"rejected",reason:ae},Ai())}finally{G.p=g,b!==null&&S.types!==null&&(b.types=S.types),j.T=b}}function nI(){}function Fp(s,a,l,u){if(s.tag!==5)throw Error(i(476));var p=Mw(s).queue;Pw(s,p,a,ie,l===null?nI:function(){return Lw(s),l(u)})}function Mw(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:ie},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:l},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function Lw(s){var a=Mw(s);a.next===null&&(a=s.alternate.memoizedState),Wc(s,a.next.queue,{},Ai())}function qp(){return Vn(hu)}function Uw(){return ln().memoizedState}function Vw(){return ln().memoizedState}function iI(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var l=Ai();s=Hr(l);var u=$r(a,s,l);u!==null&&(fi(u,a,l),qc(u,a,l)),a={cache:vp()},s.payload=a;return}a=a.return}}function sI(s,a,l){var u=Ai();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Sd(s)?Bw(a,l):(l=op(s,a,l,u),l!==null&&(fi(l,s,u),Fw(l,a,u)))}function zw(s,a,l){var u=Ai();Wc(s,a,l,u)}function Wc(s,a,l,u){var p={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Sd(s))Bw(a,p);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var b=a.lastRenderedState,S=g(b,l);if(p.hasEagerState=!0,p.eagerState=S,bi(S,b))return sd(s,a,p,0),Pt===null&&id(),!1}catch{}finally{}if(l=op(s,a,p,u),l!==null)return fi(l,s,u),Fw(l,a,u),!0}return!1}function Hp(s,a,l,u){if(u={lane:2,revertLane:Eg(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Sd(s)){if(a)throw Error(i(479))}else a=op(s,l,u,2),a!==null&&fi(a,s,2)}function Sd(s){var a=s.alternate;return s===Qe||a!==null&&a===Qe}function Bw(s,a){ol=_d=!0;var l=s.pending;l===null?a.next=a:(a.next=l.next,l.next=a),s.pending=a}function Fw(s,a,l){if((l&4194048)!==0){var u=a.lanes;u&=s.pendingLanes,l|=u,a.lanes=l,Tr(s,l)}}var Yc={readContext:Vn,use:wd,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useLayoutEffect:en,useInsertionEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useSyncExternalStore:en,useId:en,useHostTransitionStatus:en,useFormState:en,useActionState:en,useOptimistic:en,useMemoCache:en,useCacheRefresh:en};Yc.useEffectEvent=en;var qw={readContext:Vn,use:wd,useCallback:function(s,a){return ri().memoizedState=[s,a===void 0?null:a],s},useContext:Vn,useEffect:Cw,useImperativeHandle:function(s,a,l){l=l!=null?l.concat([s]):null,Ed(4194308,4,Nw.bind(null,a,s),l)},useLayoutEffect:function(s,a){return Ed(4194308,4,s,a)},useInsertionEffect:function(s,a){Ed(4,2,s,a)},useMemo:function(s,a){var l=ri();a=a===void 0?null:a;var u=s();if(no){zt(!0);try{s()}finally{zt(!1)}}return l.memoizedState=[u,a],u},useReducer:function(s,a,l){var u=ri();if(l!==void 0){var p=l(a);if(no){zt(!0);try{l(a)}finally{zt(!1)}}}else p=a;return u.memoizedState=u.baseState=p,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:p},u.queue=s,s=s.dispatch=sI.bind(null,Qe,s),[u.memoizedState,s]},useRef:function(s){var a=ri();return s={current:s},a.memoizedState=s},useState:function(s){s=Lp(s);var a=s.queue,l=zw.bind(null,Qe,a);return a.dispatch=l,[s.memoizedState,l]},useDebugValue:zp,useDeferredValue:function(s,a){var l=ri();return Bp(l,s,a)},useTransition:function(){var s=Lp(!1);return s=Pw.bind(null,Qe,s.queue,!0,!1),ri().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,l){var u=Qe,p=ri();if(ht){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),Pt===null)throw Error(i(349));(ot&127)!==0||uw(u,a,l)}p.memoizedState=l;var g={value:l,getSnapshot:a};return p.queue=g,Cw(dw.bind(null,u,g,s),[s]),u.flags|=2048,cl(9,{destroy:void 0},hw.bind(null,u,g,l,a),null),l},useId:function(){var s=ri(),a=Pt.identifierPrefix;if(ht){var l=ys,u=vs;l=(u&~(1<<32-Bt(u)-1)).toString(32)+l,a="_"+a+"R_"+l,l=vd++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=X4++,a="_"+a+"r_"+l.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:qp,useFormState:bw,useActionState:bw,useOptimistic:function(s){var a=ri();a.memoizedState=a.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Hp.bind(null,Qe,!0,l),l.dispatch=a,[s,a]},useMemoCache:jp,useCacheRefresh:function(){return ri().memoizedState=iI.bind(null,Qe)},useEffectEvent:function(s){var a=ri(),l={impl:s};return a.memoizedState=l,function(){if((Tt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},$p={readContext:Vn,use:wd,useCallback:Ow,useContext:Vn,useEffect:Vp,useImperativeHandle:kw,useInsertionEffect:Iw,useLayoutEffect:Rw,useMemo:Dw,useReducer:bd,useRef:xw,useState:function(){return bd(Gs)},useDebugValue:zp,useDeferredValue:function(s,a){var l=ln();return jw(l,Ot.memoizedState,s,a)},useTransition:function(){var s=bd(Gs)[0],a=ln().memoizedState;return[typeof s=="boolean"?s:Kc(s),a]},useSyncExternalStore:cw,useId:Uw,useHostTransitionStatus:qp,useFormState:Ew,useActionState:Ew,useOptimistic:function(s,a){var l=ln();return pw(l,Ot,s,a)},useMemoCache:jp,useCacheRefresh:Vw};$p.useEffectEvent=Aw;var Hw={readContext:Vn,use:wd,useCallback:Ow,useContext:Vn,useEffect:Vp,useImperativeHandle:kw,useInsertionEffect:Iw,useLayoutEffect:Rw,useMemo:Dw,useReducer:Mp,useRef:xw,useState:function(){return Mp(Gs)},useDebugValue:zp,useDeferredValue:function(s,a){var l=ln();return Ot===null?Bp(l,s,a):jw(l,Ot.memoizedState,s,a)},useTransition:function(){var s=Mp(Gs)[0],a=ln().memoizedState;return[typeof s=="boolean"?s:Kc(s),a]},useSyncExternalStore:cw,useId:Uw,useHostTransitionStatus:qp,useFormState:Sw,useActionState:Sw,useOptimistic:function(s,a){var l=ln();return Ot!==null?pw(l,Ot,s,a):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:jp,useCacheRefresh:Vw};Hw.useEffectEvent=Aw;function Gp(s,a,l,u){a=s.memoizedState,l=l(u,a),l=l==null?a:w({},a,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Kp={enqueueSetState:function(s,a,l){s=s._reactInternals;var u=Ai(),p=Hr(u);p.payload=a,l!=null&&(p.callback=l),a=$r(s,p,u),a!==null&&(fi(a,s,u),qc(a,s,u))},enqueueReplaceState:function(s,a,l){s=s._reactInternals;var u=Ai(),p=Hr(u);p.tag=1,p.payload=a,l!=null&&(p.callback=l),a=$r(s,p,u),a!==null&&(fi(a,s,u),qc(a,s,u))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var l=Ai(),u=Hr(l);u.tag=2,a!=null&&(u.callback=a),a=$r(s,u,l),a!==null&&(fi(a,s,l),qc(a,s,l))}};function $w(s,a,l,u,p,g,b){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,b):a.prototype&&a.prototype.isPureReactComponent?!Pc(l,u)||!Pc(p,g):!0}function Gw(s,a,l,u){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==s&&Kp.enqueueReplaceState(a,a.state,null)}function io(s,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(s=s.defaultProps){l===a&&(l=w({},l));for(var p in s)l[p]===void 0&&(l[p]=s[p])}return l}function Kw(s){nd(s)}function Ww(s){console.error(s)}function Yw(s){nd(s)}function xd(s,a){try{var l=s.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function Qw(s,a,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Wp(s,a,l){return l=Hr(l),l.tag=3,l.payload={element:null},l.callback=function(){xd(s,a)},l}function Xw(s){return s=Hr(s),s.tag=3,s}function Jw(s,a,l,u){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var g=u.value;s.payload=function(){return p(g)},s.callback=function(){Qw(a,l,u)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(s.callback=function(){Qw(a,l,u),typeof p!="function"&&(Xr===null?Xr=new Set([this]):Xr.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function rI(s,a,l,u,p){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&tl(a,l,p,!0),l=Ti.current,l!==null){switch(l.tag){case 31:case 13:return zi===null?Ld():l.alternate===null&&tn===0&&(tn=3),l.flags&=-257,l.flags|=65536,l.lanes=p,u===dd?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),yg(s,u,p)),!1;case 22:return l.flags|=65536,u===dd?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),yg(s,u,p)),!1}throw Error(i(435,l.tag))}return yg(s,u,p),Ld(),!1}if(ht)return a=Ti.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=p,u!==fp&&(s=Error(i(422),{cause:u}),Uc(Mi(s,l)))):(u!==fp&&(a=Error(i(423),{cause:u}),Uc(Mi(a,l))),s=s.current.alternate,s.flags|=65536,p&=-p,s.lanes|=p,u=Mi(u,l),p=Wp(s.stateNode,u,p),Sp(s,p),tn!==4&&(tn=2)),!1;var g=Error(i(520),{cause:u});if(g=Mi(g,l),iu===null?iu=[g]:iu.push(g),tn!==4&&(tn=2),a===null)return!0;u=Mi(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,s=p&-p,l.lanes|=s,s=Wp(l.stateNode,u,s),Sp(l,s),!1;case 1:if(a=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Xr===null||!Xr.has(g))))return l.flags|=65536,p&=-p,l.lanes|=p,p=Xw(p),Jw(p,s,l,u),Sp(l,p),!1}l=l.return}while(l!==null);return!1}var Yp=Error(i(461)),pn=!1;function zn(s,a,l,u){a.child=s===null?nw(a,null,l,u):to(a,s.child,l,u)}function Zw(s,a,l,u,p){l=l.render;var g=a.ref;if("ref"in u){var b={};for(var S in u)S!=="ref"&&(b[S]=u[S])}else b=u;return Xa(a),u=Np(s,a,l,b,g,p),S=kp(),s!==null&&!pn?(Op(s,a,p),Ks(s,a,p)):(ht&&S&&hp(a),a.flags|=1,zn(s,a,u,p),a.child)}function e1(s,a,l,u,p){if(s===null){var g=l.type;return typeof g=="function"&&!lp(g)&&g.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=g,t1(s,a,g,u,p)):(s=ad(l.type,null,u,a,a.mode,p),s.ref=a.ref,s.return=a,a.child=s)}if(g=s.child,!ig(s,p)){var b=g.memoizedProps;if(l=l.compare,l=l!==null?l:Pc,l(b,u)&&s.ref===a.ref)return Ks(s,a,p)}return a.flags|=1,s=Bs(g,u),s.ref=a.ref,s.return=a,a.child=s}function t1(s,a,l,u,p){if(s!==null){var g=s.memoizedProps;if(Pc(g,u)&&s.ref===a.ref)if(pn=!1,a.pendingProps=u=g,ig(s,p))(s.flags&131072)!==0&&(pn=!0);else return a.lanes=s.lanes,Ks(s,a,p)}return Qp(s,a,l,u,p)}function n1(s,a,l,u){var p=u.children,g=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((a.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,s!==null){for(u=a.child=s.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~g}else u=0,a.child=null;return i1(s,a,g,l,u)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ud(a,g!==null?g.cachePool:null),g!==null?rw(a,g):Cp(),aw(a);else return u=a.lanes=536870912,i1(s,a,g!==null?g.baseLanes|l:l,l,u)}else g!==null?(ud(a,g.cachePool),rw(a,g),Kr(),a.memoizedState=null):(s!==null&&ud(a,null),Cp(),Kr());return zn(s,a,p,l),a.child}function Qc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function i1(s,a,l,u,p){var g=wp();return g=g===null?null:{parent:fn._currentValue,pool:g},a.memoizedState={baseLanes:l,cachePool:g},s!==null&&ud(a,null),Cp(),aw(a),s!==null&&tl(s,a,u,!0),a.childLanes=p,null}function Cd(s,a){return a=Id({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function s1(s,a,l){return to(a,s.child,null,l),s=Cd(a,a.pendingProps),s.flags|=2,Si(a),a.memoizedState=null,s}function aI(s,a,l){var u=a.pendingProps,p=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ht){if(u.mode==="hidden")return s=Cd(a,u),a.lanes=536870912,Qc(null,s);if(Ip(a),(s=qt)?(s=gb(s,Vi),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Vr!==null?{id:vs,overflow:ys}:null,retryLane:536870912,hydrationErrors:null},l=By(s),l.return=a,a.child=l,Un=a,qt=null)):s=null,s===null)throw Br(a);return a.lanes=536870912,null}return Cd(a,u)}var g=s.memoizedState;if(g!==null){var b=g.dehydrated;if(Ip(a),p)if(a.flags&256)a.flags&=-257,a=s1(s,a,l);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(pn||tl(s,a,l,!1),p=(l&s.childLanes)!==0,pn||p){if(u=Pt,u!==null&&(b=Sr(u,l),b!==0&&b!==g.retryLane))throw g.retryLane=b,Ka(s,b),fi(u,s,b),Yp;Ld(),a=s1(s,a,l)}else s=g.treeContext,qt=Bi(b.nextSibling),Un=a,ht=!0,zr=null,Vi=!1,s!==null&&Hy(a,s),a=Cd(a,u),a.flags|=4096;return a}return s=Bs(s.child,{mode:u.mode,children:u.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Ad(s,a){var l=a.ref;if(l===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(a.flags|=4194816)}}function Qp(s,a,l,u,p){return Xa(a),l=Np(s,a,l,u,void 0,p),u=kp(),s!==null&&!pn?(Op(s,a,p),Ks(s,a,p)):(ht&&u&&hp(a),a.flags|=1,zn(s,a,l,p),a.child)}function r1(s,a,l,u,p,g){return Xa(a),a.updateQueue=null,l=lw(a,u,l,p),ow(s),u=kp(),s!==null&&!pn?(Op(s,a,g),Ks(s,a,g)):(ht&&u&&hp(a),a.flags|=1,zn(s,a,l,g),a.child)}function a1(s,a,l,u,p){if(Xa(a),a.stateNode===null){var g=Xo,b=l.contextType;typeof b=="object"&&b!==null&&(g=Vn(b)),g=new l(u,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Kp,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=u,g.state=a.memoizedState,g.refs={},Ep(a),b=l.contextType,g.context=typeof b=="object"&&b!==null?Vn(b):Xo,g.state=a.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(Gp(a,l,b,u),g.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(b=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),b!==g.state&&Kp.enqueueReplaceState(g,g.state,null),$c(a,u,g,p),Hc(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(s===null){g=a.stateNode;var S=a.memoizedProps,M=io(l,S);g.props=M;var W=g.context,ne=l.contextType;b=Xo,typeof ne=="object"&&ne!==null&&(b=Vn(ne));var ae=l.getDerivedStateFromProps;ne=typeof ae=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,ne||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||W!==b)&&Gw(a,g,u,b),qr=!1;var Q=a.memoizedState;g.state=Q,$c(a,u,g,p),Hc(),W=a.memoizedState,S||Q!==W||qr?(typeof ae=="function"&&(Gp(a,l,ae,u),W=a.memoizedState),(M=qr||$w(a,l,M,u,Q,W,b))?(ne||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=W),g.props=u,g.state=W,g.context=b,u=M):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{g=a.stateNode,Tp(s,a),b=a.memoizedProps,ne=io(l,b),g.props=ne,ae=a.pendingProps,Q=g.context,W=l.contextType,M=Xo,typeof W=="object"&&W!==null&&(M=Vn(W)),S=l.getDerivedStateFromProps,(W=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b!==ae||Q!==M)&&Gw(a,g,u,M),qr=!1,Q=a.memoizedState,g.state=Q,$c(a,u,g,p),Hc();var X=a.memoizedState;b!==ae||Q!==X||qr||s!==null&&s.dependencies!==null&&ld(s.dependencies)?(typeof S=="function"&&(Gp(a,l,S,u),X=a.memoizedState),(ne=qr||$w(a,l,ne,u,Q,X,M)||s!==null&&s.dependencies!==null&&ld(s.dependencies))?(W||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,X,M),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,X,M)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||b===s.memoizedProps&&Q===s.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&Q===s.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=X),g.props=u,g.state=X,g.context=M,u=ne):(typeof g.componentDidUpdate!="function"||b===s.memoizedProps&&Q===s.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&Q===s.memoizedState||(a.flags|=1024),u=!1)}return g=u,Ad(s,a),u=(a.flags&128)!==0,g||u?(g=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,s!==null&&u?(a.child=to(a,s.child,null,p),a.child=to(a,null,l,p)):zn(s,a,l,p),a.memoizedState=g.state,s=a.child):s=Ks(s,a,p),s}function o1(s,a,l,u){return Ya(),a.flags|=256,zn(s,a,l,u),a.child}var Xp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jp(s){return{baseLanes:s,cachePool:Qy()}}function Zp(s,a,l){return s=s!==null?s.childLanes&~l:0,a&&(s|=Ci),s}function l1(s,a,l){var u=a.pendingProps,p=!1,g=(a.flags&128)!==0,b;if((b=g)||(b=s!==null&&s.memoizedState===null?!1:(on.current&2)!==0),b&&(p=!0,a.flags&=-129),b=(a.flags&32)!==0,a.flags&=-33,s===null){if(ht){if(p?Gr(a):Kr(),(s=qt)?(s=gb(s,Vi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Vr!==null?{id:vs,overflow:ys}:null,retryLane:536870912,hydrationErrors:null},l=By(s),l.return=a,a.child=l,Un=a,qt=null)):s=null,s===null)throw Br(a);return Pg(s)?a.lanes=32:a.lanes=536870912,null}var S=u.children;return u=u.fallback,p?(Kr(),p=a.mode,S=Id({mode:"hidden",children:S},p),u=Wa(u,p,l,null),S.return=a,u.return=a,S.sibling=u,a.child=S,u=a.child,u.memoizedState=Jp(l),u.childLanes=Zp(s,b,l),a.memoizedState=Xp,Qc(null,u)):(Gr(a),eg(a,S))}var M=s.memoizedState;if(M!==null&&(S=M.dehydrated,S!==null)){if(g)a.flags&256?(Gr(a),a.flags&=-257,a=tg(s,a,l)):a.memoizedState!==null?(Kr(),a.child=s.child,a.flags|=128,a=null):(Kr(),S=u.fallback,p=a.mode,u=Id({mode:"visible",children:u.children},p),S=Wa(S,p,l,null),S.flags|=2,u.return=a,S.return=a,u.sibling=S,a.child=u,to(a,s.child,null,l),u=a.child,u.memoizedState=Jp(l),u.childLanes=Zp(s,b,l),a.memoizedState=Xp,a=Qc(null,u));else if(Gr(a),Pg(S)){if(b=S.nextSibling&&S.nextSibling.dataset,b)var W=b.dgst;b=W,u=Error(i(419)),u.stack="",u.digest=b,Uc({value:u,source:null,stack:null}),a=tg(s,a,l)}else if(pn||tl(s,a,l,!1),b=(l&s.childLanes)!==0,pn||b){if(b=Pt,b!==null&&(u=Sr(b,l),u!==0&&u!==M.retryLane))throw M.retryLane=u,Ka(s,u),fi(b,s,u),Yp;jg(S)||Ld(),a=tg(s,a,l)}else jg(S)?(a.flags|=192,a.child=s.child,a=null):(s=M.treeContext,qt=Bi(S.nextSibling),Un=a,ht=!0,zr=null,Vi=!1,s!==null&&Hy(a,s),a=eg(a,u.children),a.flags|=4096);return a}return p?(Kr(),S=u.fallback,p=a.mode,M=s.child,W=M.sibling,u=Bs(M,{mode:"hidden",children:u.children}),u.subtreeFlags=M.subtreeFlags&65011712,W!==null?S=Bs(W,S):(S=Wa(S,p,l,null),S.flags|=2),S.return=a,u.return=a,u.sibling=S,a.child=u,Qc(null,u),u=a.child,S=s.child.memoizedState,S===null?S=Jp(l):(p=S.cachePool,p!==null?(M=fn._currentValue,p=p.parent!==M?{parent:M,pool:M}:p):p=Qy(),S={baseLanes:S.baseLanes|l,cachePool:p}),u.memoizedState=S,u.childLanes=Zp(s,b,l),a.memoizedState=Xp,Qc(s.child,u)):(Gr(a),l=s.child,s=l.sibling,l=Bs(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,s!==null&&(b=a.deletions,b===null?(a.deletions=[s],a.flags|=16):b.push(s)),a.child=l,a.memoizedState=null,l)}function eg(s,a){return a=Id({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Id(s,a){return s=Ei(22,s,null,a),s.lanes=0,s}function tg(s,a,l){return to(a,s.child,null,l),s=eg(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function c1(s,a,l){s.lanes|=a;var u=s.alternate;u!==null&&(u.lanes|=a),gp(s.return,a,l)}function ng(s,a,l,u,p,g){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:p,treeForkCount:g}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=l,b.tailMode=p,b.treeForkCount=g)}function u1(s,a,l){var u=a.pendingProps,p=u.revealOrder,g=u.tail;u=u.children;var b=on.current,S=(b&2)!==0;if(S?(b=b&1|2,a.flags|=128):b&=1,ee(on,b),zn(s,a,u,l),u=ht?Lc:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&c1(s,l,a);else if(s.tag===19)c1(s,l,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(p){case"forwards":for(l=a.child,p=null;l!==null;)s=l.alternate,s!==null&&gd(s)===null&&(p=l),l=l.sibling;l=p,l===null?(p=a.child,a.child=null):(p=l.sibling,l.sibling=null),ng(a,!1,p,l,g,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,p=a.child,a.child=null;p!==null;){if(s=p.alternate,s!==null&&gd(s)===null){a.child=p;break}s=p.sibling,p.sibling=l,l=p,p=s}ng(a,!0,l,null,g,u);break;case"together":ng(a,!1,null,null,void 0,u);break;default:a.memoizedState=null}return a.child}function Ks(s,a,l){if(s!==null&&(a.dependencies=s.dependencies),Qr|=a.lanes,(l&a.childLanes)===0)if(s!==null){if(tl(s,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,l=Bs(s,s.pendingProps),a.child=l,l.return=a;s.sibling!==null;)s=s.sibling,l=l.sibling=Bs(s,s.pendingProps),l.return=a;l.sibling=null}return a.child}function ig(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ld(s)))}function oI(s,a,l){switch(a.tag){case 3:mt(a,a.stateNode.containerInfo),Fr(a,fn,s.memoizedState.cache),Ya();break;case 27:case 5:we(a);break;case 4:mt(a,a.stateNode.containerInfo);break;case 10:Fr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Ip(a),null;break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(Gr(a),a.flags|=128,null):(l&a.child.childLanes)!==0?l1(s,a,l):(Gr(a),s=Ks(s,a,l),s!==null?s.sibling:null);Gr(a);break;case 19:var p=(s.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(tl(s,a,l,!1),u=(l&a.childLanes)!==0),p){if(u)return u1(s,a,l);a.flags|=128}if(p=a.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ee(on,on.current),u)break;return null;case 22:return a.lanes=0,n1(s,a,l,a.pendingProps);case 24:Fr(a,fn,s.memoizedState.cache)}return Ks(s,a,l)}function h1(s,a,l){if(s!==null)if(s.memoizedProps!==a.pendingProps)pn=!0;else{if(!ig(s,l)&&(a.flags&128)===0)return pn=!1,oI(s,a,l);pn=(s.flags&131072)!==0}else pn=!1,ht&&(a.flags&1048576)!==0&&qy(a,Lc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var u=a.pendingProps;if(s=Za(a.elementType),a.type=s,typeof s=="function")lp(s)?(u=io(s,u),a.tag=1,a=a1(null,a,s,u,l)):(a.tag=0,a=Qp(null,a,s,u,l));else{if(s!=null){var p=s.$$typeof;if(p===le){a.tag=11,a=Zw(null,a,s,u,l);break e}else if(p===I){a.tag=14,a=e1(null,a,s,u,l);break e}}throw a=ge(s)||s,Error(i(306,a,""))}}return a;case 0:return Qp(s,a,a.type,a.pendingProps,l);case 1:return u=a.type,p=io(u,a.pendingProps),a1(s,a,u,p,l);case 3:e:{if(mt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));u=a.pendingProps;var g=a.memoizedState;p=g.element,Tp(s,a),$c(a,u,null,l);var b=a.memoizedState;if(u=b.cache,Fr(a,fn,u),u!==g.cache&&_p(a,[fn],l,!0),Hc(),u=b.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:b.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=o1(s,a,u,l);break e}else if(u!==p){p=Mi(Error(i(424)),a),Uc(p),a=o1(s,a,u,l);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(qt=Bi(s.firstChild),Un=a,ht=!0,zr=null,Vi=!0,l=nw(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Ya(),u===p){a=Ks(s,a,l);break e}zn(s,a,u,l)}a=a.child}return a;case 26:return Ad(s,a),s===null?(l=Eb(a.type,null,a.pendingProps,null))?a.memoizedState=l:ht||(l=a.type,s=a.pendingProps,u=Hd(ke.current).createElement(l),u[Jt]=a,u[Ln]=s,Bn(u,l,s),an(u),a.stateNode=u):a.memoizedState=Eb(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return we(a),s===null&&ht&&(u=a.stateNode=yb(a.type,a.pendingProps,ke.current),Un=a,Vi=!0,p=qt,ta(a.type)?(Mg=p,qt=Bi(u.firstChild)):qt=p),zn(s,a,a.pendingProps.children,l),Ad(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ht&&((p=u=qt)&&(u=LI(u,a.type,a.pendingProps,Vi),u!==null?(a.stateNode=u,Un=a,qt=Bi(u.firstChild),Vi=!1,p=!0):p=!1),p||Br(a)),we(a),p=a.type,g=a.pendingProps,b=s!==null?s.memoizedProps:null,u=g.children,kg(p,g)?u=null:b!==null&&kg(p,b)&&(a.flags|=32),a.memoizedState!==null&&(p=Np(s,a,J4,null,null,l),hu._currentValue=p),Ad(s,a),zn(s,a,u,l),a.child;case 6:return s===null&&ht&&((s=l=qt)&&(l=UI(l,a.pendingProps,Vi),l!==null?(a.stateNode=l,Un=a,qt=null,s=!0):s=!1),s||Br(a)),null;case 13:return l1(s,a,l);case 4:return mt(a,a.stateNode.containerInfo),u=a.pendingProps,s===null?a.child=to(a,null,u,l):zn(s,a,u,l),a.child;case 11:return Zw(s,a,a.type,a.pendingProps,l);case 7:return zn(s,a,a.pendingProps,l),a.child;case 8:return zn(s,a,a.pendingProps.children,l),a.child;case 12:return zn(s,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,Fr(a,a.type,u.value),zn(s,a,u.children,l),a.child;case 9:return p=a.type._context,u=a.pendingProps.children,Xa(a),p=Vn(p),u=u(p),a.flags|=1,zn(s,a,u,l),a.child;case 14:return e1(s,a,a.type,a.pendingProps,l);case 15:return t1(s,a,a.type,a.pendingProps,l);case 19:return u1(s,a,l);case 31:return aI(s,a,l);case 22:return n1(s,a,l,a.pendingProps);case 24:return Xa(a),u=Vn(fn),s===null?(p=wp(),p===null&&(p=Pt,g=vp(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=l),p=g),a.memoizedState={parent:u,cache:p},Ep(a),Fr(a,fn,p)):((s.lanes&l)!==0&&(Tp(s,a),$c(a,null,null,l),Hc()),p=s.memoizedState,g=a.memoizedState,p.parent!==u?(p={parent:u,cache:u},a.memoizedState=p,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=p),Fr(a,fn,u)):(u=g.cache,Fr(a,fn,u),u!==p.cache&&_p(a,[fn],l,!0))),zn(s,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Ws(s){s.flags|=4}function sg(s,a,l,u,p){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(p&335544128)===p)if(s.stateNode.complete)s.flags|=8192;else if(U1())s.flags|=8192;else throw eo=dd,bp}else s.flags&=-16777217}function d1(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Ab(a))if(U1())s.flags|=8192;else throw eo=dd,bp}function Rd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?At():536870912,s.lanes|=a,fl|=a)}function Xc(s,a){if(!ht)switch(s.tailMode){case"hidden":a=s.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Ht(s){var a=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(a)for(var p=s.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=u,s.childLanes=l,a}function lI(s,a,l){var u=a.pendingProps;switch(dp(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(a),null;case 1:return Ht(a),null;case 3:return l=a.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Hs(fn),te(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(el(a)?Ws(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,mp())),Ht(a),null;case 26:var p=a.type,g=a.memoizedState;return s===null?(Ws(a),g!==null?(Ht(a),d1(a,g)):(Ht(a),sg(a,p,null,u,l))):g?g!==s.memoizedState?(Ws(a),Ht(a),d1(a,g)):(Ht(a),a.flags&=-16777217):(s=s.memoizedProps,s!==u&&Ws(a),Ht(a),sg(a,p,s,u,l)),null;case 27:if(Je(a),l=ke.current,p=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==u&&Ws(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return Ht(a),null}s=he.current,el(a)?$y(a):(s=yb(p,u,l),a.stateNode=s,Ws(a))}return Ht(a),null;case 5:if(Je(a),p=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==u&&Ws(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return Ht(a),null}if(g=he.current,el(a))$y(a);else{var b=Hd(ke.current);switch(g){case 1:g=b.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:g=b.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":g=b.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":g=b.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":g=b.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof u.is=="string"?b.createElement("select",{is:u.is}):b.createElement("select"),u.multiple?g.multiple=!0:u.size&&(g.size=u.size);break;default:g=typeof u.is=="string"?b.createElement(p,{is:u.is}):b.createElement(p)}}g[Jt]=a,g[Ln]=u;e:for(b=a.child;b!==null;){if(b.tag===5||b.tag===6)g.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===a)break e;for(;b.sibling===null;){if(b.return===null||b.return===a)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}a.stateNode=g;e:switch(Bn(g,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Ws(a)}}return Ht(a),sg(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,l),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==u&&Ws(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(i(166));if(s=ke.current,el(a)){if(s=a.stateNode,l=a.memoizedProps,u=null,p=Un,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}s[Jt]=a,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||lb(s.nodeValue,l)),s||Br(a,!0)}else s=Hd(s).createTextNode(u),s[Jt]=a,a.stateNode=s}return Ht(a),null;case 31:if(l=a.memoizedState,s===null||s.memoizedState!==null){if(u=el(a),l!==null){if(s===null){if(!u)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Jt]=a}else Ya(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ht(a),s=!1}else l=mp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return a.flags&256?(Si(a),a):(Si(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Ht(a),null;case 13:if(u=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(p=el(a),u!==null&&u.dehydrated!==null){if(s===null){if(!p)throw Error(i(318));if(p=a.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Jt]=a}else Ya(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ht(a),p=!1}else p=mp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),p=!0;if(!p)return a.flags&256?(Si(a),a):(Si(a),null)}return Si(a),(a.flags&128)!==0?(a.lanes=l,a):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=a.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==p&&(u.flags|=2048)),l!==s&&l&&(a.child.flags|=8192),Rd(a,a.updateQueue),Ht(a),null);case 4:return te(),s===null&&Cg(a.stateNode.containerInfo),Ht(a),null;case 10:return Hs(a.type),Ht(a),null;case 19:if(B(on),u=a.memoizedState,u===null)return Ht(a),null;if(p=(a.flags&128)!==0,g=u.rendering,g===null)if(p)Xc(u,!1);else{if(tn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(g=gd(s),g!==null){for(a.flags|=128,Xc(u,!1),s=g.updateQueue,a.updateQueue=s,Rd(a,s),a.subtreeFlags=0,s=l,l=a.child;l!==null;)zy(l,s),l=l.sibling;return ee(on,on.current&1|2),ht&&Fs(a,u.treeForkCount),a.child}s=s.sibling}u.tail!==null&&pt()>jd&&(a.flags|=128,p=!0,Xc(u,!1),a.lanes=4194304)}else{if(!p)if(s=gd(g),s!==null){if(a.flags|=128,p=!0,s=s.updateQueue,a.updateQueue=s,Rd(a,s),Xc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!g.alternate&&!ht)return Ht(a),null}else 2*pt()-u.renderingStartTime>jd&&l!==536870912&&(a.flags|=128,p=!0,Xc(u,!1),a.lanes=4194304);u.isBackwards?(g.sibling=a.child,a.child=g):(s=u.last,s!==null?s.sibling=g:a.child=g,u.last=g)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=pt(),s.sibling=null,l=on.current,ee(on,p?l&1|2:l&1),ht&&Fs(a,u.treeForkCount),s):(Ht(a),null);case 22:case 23:return Si(a),Ap(),u=a.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(Ht(a),a.subtreeFlags&6&&(a.flags|=8192)):Ht(a),l=a.updateQueue,l!==null&&Rd(a,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),s!==null&&B(Ja),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Hs(fn),Ht(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function cI(s,a){switch(dp(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Hs(fn),te(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Je(a),null;case 31:if(a.memoizedState!==null){if(Si(a),a.alternate===null)throw Error(i(340));Ya()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Si(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Ya()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return B(on),null;case 4:return te(),null;case 10:return Hs(a.type),null;case 22:case 23:return Si(a),Ap(),s!==null&&B(Ja),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Hs(fn),null;case 25:return null;default:return null}}function f1(s,a){switch(dp(a),a.tag){case 3:Hs(fn),te();break;case 26:case 27:case 5:Je(a);break;case 4:te();break;case 31:a.memoizedState!==null&&Si(a);break;case 13:Si(a);break;case 19:B(on);break;case 10:Hs(a.type);break;case 22:case 23:Si(a),Ap(),s!==null&&B(Ja);break;case 24:Hs(fn)}}function Jc(s,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var p=u.next;l=p;do{if((l.tag&s)===s){u=void 0;var g=l.create,b=l.inst;u=g(),b.destroy=u}l=l.next}while(l!==p)}}catch(S){Rt(a,a.return,S)}}function Wr(s,a,l){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var g=p.next;u=g;do{if((u.tag&s)===s){var b=u.inst,S=b.destroy;if(S!==void 0){b.destroy=void 0,p=a;var M=l,W=S;try{W()}catch(ne){Rt(p,M,ne)}}}u=u.next}while(u!==g)}}catch(ne){Rt(a,a.return,ne)}}function m1(s){var a=s.updateQueue;if(a!==null){var l=s.stateNode;try{sw(a,l)}catch(u){Rt(s,s.return,u)}}}function p1(s,a,l){l.props=io(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){Rt(s,a,u)}}function Zc(s,a){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(p){Rt(s,a,p)}}function ws(s,a){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(p){Rt(s,a,p)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){Rt(s,a,p)}else l.current=null}function g1(s){var a=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(p){Rt(s,s.return,p)}}function rg(s,a,l){try{var u=s.stateNode;kI(u,s.type,l,a),u[Ln]=a}catch(p){Rt(s,s.return,p)}}function _1(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ta(s.type)||s.tag===4}function ag(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||_1(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ta(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function og(s,a,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(s),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Rn));else if(u!==4&&(u===27&&ta(s.type)&&(l=s.stateNode,a=null),s=s.child,s!==null))for(og(s,a,l),s=s.sibling;s!==null;)og(s,a,l),s=s.sibling}function Nd(s,a,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,a?l.insertBefore(s,a):l.appendChild(s);else if(u!==4&&(u===27&&ta(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Nd(s,a,l),s=s.sibling;s!==null;)Nd(s,a,l),s=s.sibling}function v1(s){var a=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,p=a.attributes;p.length;)a.removeAttributeNode(p[0]);Bn(a,u,l),a[Jt]=s,a[Ln]=l}catch(g){Rt(s,s.return,g)}}var Ys=!1,gn=!1,lg=!1,y1=typeof WeakSet=="function"?WeakSet:Set,On=null;function uI(s,a){if(s=s.containerInfo,Rg=Xd,s=ky(s),tp(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var p=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var b=0,S=-1,M=-1,W=0,ne=0,ae=s,Q=null;t:for(;;){for(var X;ae!==l||p!==0&&ae.nodeType!==3||(S=b+p),ae!==g||u!==0&&ae.nodeType!==3||(M=b+u),ae.nodeType===3&&(b+=ae.nodeValue.length),(X=ae.firstChild)!==null;)Q=ae,ae=X;for(;;){if(ae===s)break t;if(Q===l&&++W===p&&(S=b),Q===g&&++ne===u&&(M=b),(X=ae.nextSibling)!==null)break;ae=Q,Q=ae.parentNode}ae=X}l=S===-1||M===-1?null:{start:S,end:M}}else l=null}l=l||{start:0,end:0}}else l=null;for(Ng={focusedElem:s,selectionRange:l},Xd=!1,On=a;On!==null;)if(a=On,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,On=s;else for(;On!==null;){switch(a=On,g=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)p=s[l],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=a,p=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var Ee=io(l.type,p);s=u.getSnapshotBeforeUpdate(Ee,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(Le){Rt(l,l.return,Le)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,l=s.nodeType,l===9)Dg(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Dg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,On=s;break}On=a.return}}function w1(s,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Xs(s,l),u&4&&Jc(5,l);break;case 1:if(Xs(s,l),u&4)if(s=l.stateNode,a===null)try{s.componentDidMount()}catch(b){Rt(l,l.return,b)}else{var p=io(l.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(p,a,s.__reactInternalSnapshotBeforeUpdate)}catch(b){Rt(l,l.return,b)}}u&64&&m1(l),u&512&&Zc(l,l.return);break;case 3:if(Xs(s,l),u&64&&(s=l.updateQueue,s!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{sw(s,a)}catch(b){Rt(l,l.return,b)}}break;case 27:a===null&&u&4&&v1(l);case 26:case 5:Xs(s,l),a===null&&u&4&&g1(l),u&512&&Zc(l,l.return);break;case 12:Xs(s,l);break;case 31:Xs(s,l),u&4&&T1(s,l);break;case 13:Xs(s,l),u&4&&S1(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=yI.bind(null,l),VI(s,l))));break;case 22:if(u=l.memoizedState!==null||Ys,!u){a=a!==null&&a.memoizedState!==null||gn,p=Ys;var g=gn;Ys=u,(gn=a)&&!g?Js(s,l,(l.subtreeFlags&8772)!==0):Xs(s,l),Ys=p,gn=g}break;case 30:break;default:Xs(s,l)}}function b1(s){var a=s.alternate;a!==null&&(s.alternate=null,b1(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Pa(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Wt=null,ci=!1;function Qs(s,a,l){for(l=l.child;l!==null;)E1(s,a,l),l=l.sibling}function E1(s,a,l){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(St,l)}catch{}switch(l.tag){case 26:gn||ws(l,a),Qs(s,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:gn||ws(l,a);var u=Wt,p=ci;ta(l.type)&&(Wt=l.stateNode,ci=!1),Qs(s,a,l),lu(l.stateNode),Wt=u,ci=p;break;case 5:gn||ws(l,a);case 6:if(u=Wt,p=ci,Wt=null,Qs(s,a,l),Wt=u,ci=p,Wt!==null)if(ci)try{(Wt.nodeType===9?Wt.body:Wt.nodeName==="HTML"?Wt.ownerDocument.body:Wt).removeChild(l.stateNode)}catch(g){Rt(l,a,g)}else try{Wt.removeChild(l.stateNode)}catch(g){Rt(l,a,g)}break;case 18:Wt!==null&&(ci?(s=Wt,mb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),bl(s)):mb(Wt,l.stateNode));break;case 4:u=Wt,p=ci,Wt=l.stateNode.containerInfo,ci=!0,Qs(s,a,l),Wt=u,ci=p;break;case 0:case 11:case 14:case 15:Wr(2,l,a),gn||Wr(4,l,a),Qs(s,a,l);break;case 1:gn||(ws(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&p1(l,a,u)),Qs(s,a,l);break;case 21:Qs(s,a,l);break;case 22:gn=(u=gn)||l.memoizedState!==null,Qs(s,a,l),gn=u;break;default:Qs(s,a,l)}}function T1(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{bl(s)}catch(l){Rt(a,a.return,l)}}}function S1(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{bl(s)}catch(l){Rt(a,a.return,l)}}function hI(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new y1),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new y1),a;default:throw Error(i(435,s.tag))}}function kd(s,a){var l=hI(s);a.forEach(function(u){if(!l.has(u)){l.add(u);var p=wI.bind(null,s,u);u.then(p,p)}})}function ui(s,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var p=l[u],g=s,b=a,S=b;e:for(;S!==null;){switch(S.tag){case 27:if(ta(S.type)){Wt=S.stateNode,ci=!1;break e}break;case 5:Wt=S.stateNode,ci=!1;break e;case 3:case 4:Wt=S.stateNode.containerInfo,ci=!0;break e}S=S.return}if(Wt===null)throw Error(i(160));E1(g,b,p),Wt=null,ci=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)x1(a,s),a=a.sibling}var Xi=null;function x1(s,a){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ui(a,s),hi(s),u&4&&(Wr(3,s,s.return),Jc(3,s),Wr(5,s,s.return));break;case 1:ui(a,s),hi(s),u&512&&(gn||l===null||ws(l,l.return)),u&64&&Ys&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var p=Xi;if(ui(a,s),hi(s),u&512&&(gn||l===null||ws(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":g=p.getElementsByTagName("title")[0],(!g||g[Ds]||g[Jt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(u),p.head.insertBefore(g,p.querySelector("head > title"))),Bn(g,u,l),g[Jt]=s,an(g),u=g;break e;case"link":var b=xb("link","href",p).get(u+(l.href||""));if(b){for(var S=0;S<b.length;S++)if(g=b[S],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(S,1);break t}}g=p.createElement(u),Bn(g,u,l),p.head.appendChild(g);break;case"meta":if(b=xb("meta","content",p).get(u+(l.content||""))){for(S=0;S<b.length;S++)if(g=b[S],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(S,1);break t}}g=p.createElement(u),Bn(g,u,l),p.head.appendChild(g);break;default:throw Error(i(468,u))}g[Jt]=s,an(g),u=g}s.stateNode=u}else Cb(p,s.type,s.stateNode);else s.stateNode=Sb(p,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?Cb(p,s.type,s.stateNode):Sb(p,u,s.memoizedProps)):u===null&&s.stateNode!==null&&rg(s,s.memoizedProps,l.memoizedProps)}break;case 27:ui(a,s),hi(s),u&512&&(gn||l===null||ws(l,l.return)),l!==null&&u&4&&rg(s,s.memoizedProps,l.memoizedProps);break;case 5:if(ui(a,s),hi(s),u&512&&(gn||l===null||ws(l,l.return)),s.flags&32){p=s.stateNode;try{ji(p,"")}catch(Ee){Rt(s,s.return,Ee)}}u&4&&s.stateNode!=null&&(p=s.memoizedProps,rg(s,p,l!==null?l.memoizedProps:p)),u&1024&&(lg=!0);break;case 6:if(ui(a,s),hi(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(Ee){Rt(s,s.return,Ee)}}break;case 3:if(Kd=null,p=Xi,Xi=$d(a.containerInfo),ui(a,s),Xi=p,hi(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{bl(a.containerInfo)}catch(Ee){Rt(s,s.return,Ee)}lg&&(lg=!1,C1(s));break;case 4:u=Xi,Xi=$d(s.stateNode.containerInfo),ui(a,s),hi(s),Xi=u;break;case 12:ui(a,s),hi(s);break;case 31:ui(a,s),hi(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,kd(s,u)));break;case 13:ui(a,s),hi(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Dd=pt()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,kd(s,u)));break;case 22:p=s.memoizedState!==null;var M=l!==null&&l.memoizedState!==null,W=Ys,ne=gn;if(Ys=W||p,gn=ne||M,ui(a,s),gn=ne,Ys=W,hi(s),u&8192)e:for(a=s.stateNode,a._visibility=p?a._visibility&-2:a._visibility|1,p&&(l===null||M||Ys||gn||so(s)),l=null,a=s;;){if(a.tag===5||a.tag===26){if(l===null){M=l=a;try{if(g=M.stateNode,p)b=g.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{S=M.stateNode;var ae=M.memoizedProps.style,Q=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;S.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(Ee){Rt(M,M.return,Ee)}}}else if(a.tag===6){if(l===null){M=a;try{M.stateNode.nodeValue=p?"":M.memoizedProps}catch(Ee){Rt(M,M.return,Ee)}}}else if(a.tag===18){if(l===null){M=a;try{var X=M.stateNode;p?pb(X,!0):pb(M.stateNode,!1)}catch(Ee){Rt(M,M.return,Ee)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,kd(s,l))));break;case 19:ui(a,s),hi(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,kd(s,u)));break;case 30:break;case 21:break;default:ui(a,s),hi(s)}}function hi(s){var a=s.flags;if(a&2){try{for(var l,u=s.return;u!==null;){if(_1(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var p=l.stateNode,g=ag(s);Nd(s,g,p);break;case 5:var b=l.stateNode;l.flags&32&&(ji(b,""),l.flags&=-33);var S=ag(s);Nd(s,S,b);break;case 3:case 4:var M=l.stateNode.containerInfo,W=ag(s);og(s,W,M);break;default:throw Error(i(161))}}catch(ne){Rt(s,s.return,ne)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function C1(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;C1(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function Xs(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)w1(s,a.alternate,a),a=a.sibling}function so(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Wr(4,a,a.return),so(a);break;case 1:ws(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&p1(a,a.return,l),so(a);break;case 27:lu(a.stateNode);case 26:case 5:ws(a,a.return),so(a);break;case 22:a.memoizedState===null&&so(a);break;case 30:so(a);break;default:so(a)}s=s.sibling}}function Js(s,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,p=s,g=a,b=g.flags;switch(g.tag){case 0:case 11:case 15:Js(p,g,l),Jc(4,g);break;case 1:if(Js(p,g,l),u=g,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(W){Rt(u,u.return,W)}if(u=g,p=u.updateQueue,p!==null){var S=u.stateNode;try{var M=p.shared.hiddenCallbacks;if(M!==null)for(p.shared.hiddenCallbacks=null,p=0;p<M.length;p++)iw(M[p],S)}catch(W){Rt(u,u.return,W)}}l&&b&64&&m1(g),Zc(g,g.return);break;case 27:v1(g);case 26:case 5:Js(p,g,l),l&&u===null&&b&4&&g1(g),Zc(g,g.return);break;case 12:Js(p,g,l);break;case 31:Js(p,g,l),l&&b&4&&T1(p,g);break;case 13:Js(p,g,l),l&&b&4&&S1(p,g);break;case 22:g.memoizedState===null&&Js(p,g,l),Zc(g,g.return);break;case 30:break;default:Js(p,g,l)}a=a.sibling}}function cg(s,a){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Vc(l))}function ug(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Vc(s))}function Ji(s,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)A1(s,a,l,u),a=a.sibling}function A1(s,a,l,u){var p=a.flags;switch(a.tag){case 0:case 11:case 15:Ji(s,a,l,u),p&2048&&Jc(9,a);break;case 1:Ji(s,a,l,u);break;case 3:Ji(s,a,l,u),p&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Vc(s)));break;case 12:if(p&2048){Ji(s,a,l,u),s=a.stateNode;try{var g=a.memoizedProps,b=g.id,S=g.onPostCommit;typeof S=="function"&&S(b,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(M){Rt(a,a.return,M)}}else Ji(s,a,l,u);break;case 31:Ji(s,a,l,u);break;case 13:Ji(s,a,l,u);break;case 23:break;case 22:g=a.stateNode,b=a.alternate,a.memoizedState!==null?g._visibility&2?Ji(s,a,l,u):eu(s,a):g._visibility&2?Ji(s,a,l,u):(g._visibility|=2,ul(s,a,l,u,(a.subtreeFlags&10256)!==0||!1)),p&2048&&cg(b,a);break;case 24:Ji(s,a,l,u),p&2048&&ug(a.alternate,a);break;default:Ji(s,a,l,u)}}function ul(s,a,l,u,p){for(p=p&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var g=s,b=a,S=l,M=u,W=b.flags;switch(b.tag){case 0:case 11:case 15:ul(g,b,S,M,p),Jc(8,b);break;case 23:break;case 22:var ne=b.stateNode;b.memoizedState!==null?ne._visibility&2?ul(g,b,S,M,p):eu(g,b):(ne._visibility|=2,ul(g,b,S,M,p)),p&&W&2048&&cg(b.alternate,b);break;case 24:ul(g,b,S,M,p),p&&W&2048&&ug(b.alternate,b);break;default:ul(g,b,S,M,p)}a=a.sibling}}function eu(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=s,u=a,p=u.flags;switch(u.tag){case 22:eu(l,u),p&2048&&cg(u.alternate,u);break;case 24:eu(l,u),p&2048&&ug(u.alternate,u);break;default:eu(l,u)}a=a.sibling}}var tu=8192;function hl(s,a,l){if(s.subtreeFlags&tu)for(s=s.child;s!==null;)I1(s,a,l),s=s.sibling}function I1(s,a,l){switch(s.tag){case 26:hl(s,a,l),s.flags&tu&&s.memoizedState!==null&&XI(l,Xi,s.memoizedState,s.memoizedProps);break;case 5:hl(s,a,l);break;case 3:case 4:var u=Xi;Xi=$d(s.stateNode.containerInfo),hl(s,a,l),Xi=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=tu,tu=16777216,hl(s,a,l),tu=u):hl(s,a,l));break;default:hl(s,a,l)}}function R1(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function nu(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];On=u,k1(u,s)}R1(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)N1(s),s=s.sibling}function N1(s){switch(s.tag){case 0:case 11:case 15:nu(s),s.flags&2048&&Wr(9,s,s.return);break;case 3:nu(s);break;case 12:nu(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Od(s)):nu(s);break;default:nu(s)}}function Od(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];On=u,k1(u,s)}R1(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Wr(8,a,a.return),Od(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Od(a));break;default:Od(a)}s=s.sibling}}function k1(s,a){for(;On!==null;){var l=On;switch(l.tag){case 0:case 11:case 15:Wr(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Vc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,On=u;else e:for(l=s;On!==null;){u=On;var p=u.sibling,g=u.return;if(b1(u),u===l){On=null;break e}if(p!==null){p.return=g,On=p;break e}On=g}}}var dI={getCacheForType:function(s){var a=Vn(fn),l=a.data.get(s);return l===void 0&&(l=s(),a.data.set(s,l)),l},cacheSignal:function(){return Vn(fn).controller.signal}},fI=typeof WeakMap=="function"?WeakMap:Map,Tt=0,Pt=null,it=null,ot=0,It=0,xi=null,Yr=!1,dl=!1,hg=!1,Zs=0,tn=0,Qr=0,ro=0,dg=0,Ci=0,fl=0,iu=null,di=null,fg=!1,Dd=0,O1=0,jd=1/0,Pd=null,Xr=null,bn=0,Jr=null,ml=null,er=0,mg=0,pg=null,D1=null,su=0,gg=null;function Ai(){return(Tt&2)!==0&&ot!==0?ot&-ot:j.T!==null?Eg():Os()}function j1(){if(Ci===0)if((ot&536870912)===0||ht){var s=se;se<<=1,(se&3932160)===0&&(se=262144),Ci=s}else Ci=536870912;return s=Ti.current,s!==null&&(s.flags|=32),Ci}function fi(s,a,l){(s===Pt&&(It===2||It===9)||s.cancelPendingCommit!==null)&&(pl(s,0),Zr(s,ot,Ci,!1)),Gi(s,l),((Tt&2)===0||s!==Pt)&&(s===Pt&&((Tt&2)===0&&(ro|=l),tn===4&&Zr(s,ot,Ci,!1)),bs(s))}function P1(s,a,l){if((Tt&6)!==0)throw Error(i(327));var u=!l&&(a&127)===0&&(a&s.expiredLanes)===0||Me(s,a),p=u?gI(s,a):vg(s,a,!0),g=u;do{if(p===0){dl&&!u&&Zr(s,a,0,!1);break}else{if(l=s.current.alternate,g&&!mI(l)){p=vg(s,a,!1),g=!1;continue}if(p===2){if(g=a,s.errorRecoveryDisabledLanes&g)var b=0;else b=s.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){a=b;e:{var S=s;p=iu;var M=S.current.memoizedState.isDehydrated;if(M&&(pl(S,b).flags|=256),b=vg(S,b,!1),b!==2){if(hg&&!M){S.errorRecoveryDisabledLanes|=g,ro|=g,p=4;break e}g=di,di=p,g!==null&&(di===null?di=g:di.push.apply(di,g))}p=b}if(g=!1,p!==2)continue}}if(p===1){pl(s,0),Zr(s,a,0,!0);break}e:{switch(u=s,g=p,g){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Zr(u,a,Ci,!Yr);break e;case 2:di=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(p=Dd+300-pt(),10<p)){if(Zr(u,a,Ci,!Yr),Re(u,0,!0)!==0)break e;er=a,u.timeoutHandle=db(M1.bind(null,u,l,di,Pd,fg,a,Ci,ro,fl,Yr,g,"Throttled",-0,0),p);break e}M1(u,l,di,Pd,fg,a,Ci,ro,fl,Yr,g,null,-0,0)}}break}while(!0);bs(s)}function M1(s,a,l,u,p,g,b,S,M,W,ne,ae,Q,X){if(s.timeoutHandle=-1,ae=a.subtreeFlags,ae&8192||(ae&16785408)===16785408){ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rn},I1(a,g,ae);var Ee=(g&62914560)===g?Dd-pt():(g&4194048)===g?O1-pt():0;if(Ee=JI(ae,Ee),Ee!==null){er=g,s.cancelPendingCommit=Ee(H1.bind(null,s,a,g,l,u,p,b,S,M,ne,ae,null,Q,X)),Zr(s,g,b,!W);return}}H1(s,a,g,l,u,p,b,S,M)}function mI(s){for(var a=s;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var p=l[u],g=p.getSnapshot;p=p.value;try{if(!bi(g(),p))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Zr(s,a,l,u){a&=~dg,a&=~ro,s.suspendedLanes|=a,s.pingedLanes&=~a,u&&(s.warmLanes|=a),u=s.expirationTimes;for(var p=a;0<p;){var g=31-Bt(p),b=1<<g;u[g]=-1,p&=~b}l!==0&&Ki(s,l,a)}function Md(){return(Tt&6)===0?(ru(0),!1):!0}function _g(){if(it!==null){if(It===0)var s=it.return;else s=it,qs=Qa=null,Dp(s),rl=null,Bc=0,s=it;for(;s!==null;)f1(s.alternate,s),s=s.return;it=null}}function pl(s,a){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,jI(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),er=0,_g(),Pt=s,it=l=Bs(s.current,null),ot=a,It=0,xi=null,Yr=!1,dl=Me(s,a),hg=!1,fl=Ci=dg=ro=Qr=tn=0,di=iu=null,fg=!1,(a&8)!==0&&(a|=a&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=a;0<u;){var p=31-Bt(u),g=1<<p;a|=s[p],u&=~g}return Zs=a,id(),l}function L1(s,a){Qe=null,j.H=Yc,a===sl||a===hd?(a=Zy(),It=3):a===bp?(a=Zy(),It=4):It=a===Yp?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,xi=a,it===null&&(tn=1,xd(s,Mi(a,s.current)))}function U1(){var s=Ti.current;return s===null?!0:(ot&4194048)===ot?zi===null:(ot&62914560)===ot||(ot&536870912)!==0?s===zi:!1}function V1(){var s=j.H;return j.H=Yc,s===null?Yc:s}function z1(){var s=j.A;return j.A=dI,s}function Ld(){tn=4,Yr||(ot&4194048)!==ot&&Ti.current!==null||(dl=!0),(Qr&134217727)===0&&(ro&134217727)===0||Pt===null||Zr(Pt,ot,Ci,!1)}function vg(s,a,l){var u=Tt;Tt|=2;var p=V1(),g=z1();(Pt!==s||ot!==a)&&(Pd=null,pl(s,a)),a=!1;var b=tn;e:do try{if(It!==0&&it!==null){var S=it,M=xi;switch(It){case 8:_g(),b=6;break e;case 3:case 2:case 9:case 6:Ti.current===null&&(a=!0);var W=It;if(It=0,xi=null,gl(s,S,M,W),l&&dl){b=0;break e}break;default:W=It,It=0,xi=null,gl(s,S,M,W)}}pI(),b=tn;break}catch(ne){L1(s,ne)}while(!0);return a&&s.shellSuspendCounter++,qs=Qa=null,Tt=u,j.H=p,j.A=g,it===null&&(Pt=null,ot=0,id()),b}function pI(){for(;it!==null;)B1(it)}function gI(s,a){var l=Tt;Tt|=2;var u=V1(),p=z1();Pt!==s||ot!==a?(Pd=null,jd=pt()+500,pl(s,a)):dl=Me(s,a);e:do try{if(It!==0&&it!==null){a=it;var g=xi;t:switch(It){case 1:It=0,xi=null,gl(s,a,g,1);break;case 2:case 9:if(Xy(g)){It=0,xi=null,F1(a);break}a=function(){It!==2&&It!==9||Pt!==s||(It=7),bs(s)},g.then(a,a);break e;case 3:It=7;break e;case 4:It=5;break e;case 7:Xy(g)?(It=0,xi=null,F1(a)):(It=0,xi=null,gl(s,a,g,7));break;case 5:var b=null;switch(it.tag){case 26:b=it.memoizedState;case 5:case 27:var S=it;if(b?Ab(b):S.stateNode.complete){It=0,xi=null;var M=S.sibling;if(M!==null)it=M;else{var W=S.return;W!==null?(it=W,Ud(W)):it=null}break t}}It=0,xi=null,gl(s,a,g,5);break;case 6:It=0,xi=null,gl(s,a,g,6);break;case 8:_g(),tn=6;break e;default:throw Error(i(462))}}_I();break}catch(ne){L1(s,ne)}while(!0);return qs=Qa=null,j.H=u,j.A=p,Tt=l,it!==null?0:(Pt=null,ot=0,id(),tn)}function _I(){for(;it!==null&&!We();)B1(it)}function B1(s){var a=h1(s.alternate,s,Zs);s.memoizedProps=s.pendingProps,a===null?Ud(s):it=a}function F1(s){var a=s,l=a.alternate;switch(a.tag){case 15:case 0:a=r1(l,a,a.pendingProps,a.type,void 0,ot);break;case 11:a=r1(l,a,a.pendingProps,a.type.render,a.ref,ot);break;case 5:Dp(a);default:f1(l,a),a=it=zy(a,Zs),a=h1(l,a,Zs)}s.memoizedProps=s.pendingProps,a===null?Ud(s):it=a}function gl(s,a,l,u){qs=Qa=null,Dp(a),rl=null,Bc=0;var p=a.return;try{if(rI(s,p,a,l,ot)){tn=1,xd(s,Mi(l,s.current)),it=null;return}}catch(g){if(p!==null)throw it=p,g;tn=1,xd(s,Mi(l,s.current)),it=null;return}a.flags&32768?(ht||u===1?s=!0:dl||(ot&536870912)!==0?s=!1:(Yr=s=!0,(u===2||u===9||u===3||u===6)&&(u=Ti.current,u!==null&&u.tag===13&&(u.flags|=16384))),q1(a,s)):Ud(a)}function Ud(s){var a=s;do{if((a.flags&32768)!==0){q1(a,Yr);return}s=a.return;var l=lI(a.alternate,a,Zs);if(l!==null){it=l;return}if(a=a.sibling,a!==null){it=a;return}it=a=s}while(a!==null);tn===0&&(tn=5)}function q1(s,a){do{var l=cI(s.alternate,s);if(l!==null){l.flags&=32767,it=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(s=s.sibling,s!==null)){it=s;return}it=s=l}while(s!==null);tn=6,it=null}function H1(s,a,l,u,p,g,b,S,M){s.cancelPendingCommit=null;do Vd();while(bn!==0);if((Tt&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(g=a.lanes|a.childLanes,g|=ap,hn(s,l,g,b,S,M),s===Pt&&(it=Pt=null,ot=0),ml=a,Jr=s,er=l,mg=g,pg=p,D1=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,bI(In,function(){return Y1(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=j.T,j.T=null,p=G.p,G.p=2,b=Tt,Tt|=4;try{uI(s,a,l)}finally{Tt=b,G.p=p,j.T=u}}bn=1,$1(),G1(),K1()}}function $1(){if(bn===1){bn=0;var s=Jr,a=ml,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=j.T,j.T=null;var u=G.p;G.p=2;var p=Tt;Tt|=4;try{x1(a,s);var g=Ng,b=ky(s.containerInfo),S=g.focusedElem,M=g.selectionRange;if(b!==S&&S&&S.ownerDocument&&Ny(S.ownerDocument.documentElement,S)){if(M!==null&&tp(S)){var W=M.start,ne=M.end;if(ne===void 0&&(ne=W),"selectionStart"in S)S.selectionStart=W,S.selectionEnd=Math.min(ne,S.value.length);else{var ae=S.ownerDocument||document,Q=ae&&ae.defaultView||window;if(Q.getSelection){var X=Q.getSelection(),Ee=S.textContent.length,Le=Math.min(M.start,Ee),jt=M.end===void 0?Le:Math.min(M.end,Ee);!X.extend&&Le>jt&&(b=jt,jt=Le,Le=b);var q=Ry(S,Le),z=Ry(S,jt);if(q&&z&&(X.rangeCount!==1||X.anchorNode!==q.node||X.anchorOffset!==q.offset||X.focusNode!==z.node||X.focusOffset!==z.offset)){var K=ae.createRange();K.setStart(q.node,q.offset),X.removeAllRanges(),Le>jt?(X.addRange(K),X.extend(z.node,z.offset)):(K.setEnd(z.node,z.offset),X.addRange(K))}}}}for(ae=[],X=S;X=X.parentNode;)X.nodeType===1&&ae.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<ae.length;S++){var re=ae[S];re.element.scrollLeft=re.left,re.element.scrollTop=re.top}}Xd=!!Rg,Ng=Rg=null}finally{Tt=p,G.p=u,j.T=l}}s.current=a,bn=2}}function G1(){if(bn===2){bn=0;var s=Jr,a=ml,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=j.T,j.T=null;var u=G.p;G.p=2;var p=Tt;Tt|=4;try{w1(s,a.alternate,a)}finally{Tt=p,G.p=u,j.T=l}}bn=3}}function K1(){if(bn===4||bn===3){bn=0,Et();var s=Jr,a=ml,l=er,u=D1;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?bn=5:(bn=0,ml=Jr=null,W1(s,s.pendingLanes));var p=s.pendingLanes;if(p===0&&(Xr=null),wc(l),a=a.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(St,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=j.T,p=G.p,G.p=2,j.T=null;try{for(var g=s.onRecoverableError,b=0;b<u.length;b++){var S=u[b];g(S.value,{componentStack:S.stack})}}finally{j.T=a,G.p=p}}(er&3)!==0&&Vd(),bs(s),p=s.pendingLanes,(l&261930)!==0&&(p&42)!==0?s===gg?su++:(su=0,gg=s):su=0,ru(0)}}function W1(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Vc(a)))}function Vd(){return $1(),G1(),K1(),Y1()}function Y1(){if(bn!==5)return!1;var s=Jr,a=mg;mg=0;var l=wc(er),u=j.T,p=G.p;try{G.p=32>l?32:l,j.T=null,l=pg,pg=null;var g=Jr,b=er;if(bn=0,ml=Jr=null,er=0,(Tt&6)!==0)throw Error(i(331));var S=Tt;if(Tt|=4,N1(g.current),A1(g,g.current,b,l),Tt=S,ru(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(St,g)}catch{}return!0}finally{G.p=p,j.T=u,W1(s,a)}}function Q1(s,a,l){a=Mi(l,a),a=Wp(s.stateNode,a,2),s=$r(s,a,2),s!==null&&(Gi(s,2),bs(s))}function Rt(s,a,l){if(s.tag===3)Q1(s,s,l);else for(;a!==null;){if(a.tag===3){Q1(a,s,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Xr===null||!Xr.has(u))){s=Mi(l,s),l=Xw(2),u=$r(a,l,2),u!==null&&(Jw(l,u,a,s),Gi(u,2),bs(u));break}}a=a.return}}function yg(s,a,l){var u=s.pingCache;if(u===null){u=s.pingCache=new fI;var p=new Set;u.set(a,p)}else p=u.get(a),p===void 0&&(p=new Set,u.set(a,p));p.has(l)||(hg=!0,p.add(l),s=vI.bind(null,s,a,l),a.then(s,s))}function vI(s,a,l){var u=s.pingCache;u!==null&&u.delete(a),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Pt===s&&(ot&l)===l&&(tn===4||tn===3&&(ot&62914560)===ot&&300>pt()-Dd?(Tt&2)===0&&pl(s,0):dg|=l,fl===ot&&(fl=0)),bs(s)}function X1(s,a){a===0&&(a=At()),s=Ka(s,a),s!==null&&(Gi(s,a),bs(s))}function yI(s){var a=s.memoizedState,l=0;a!==null&&(l=a.retryLane),X1(s,l)}function wI(s,a){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,p=s.memoizedState;p!==null&&(l=p.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(a),X1(s,l)}function bI(s,a){return Ct(s,a)}var zd=null,_l=null,wg=!1,Bd=!1,bg=!1,ea=0;function bs(s){s!==_l&&s.next===null&&(_l===null?zd=_l=s:_l=_l.next=s),Bd=!0,wg||(wg=!0,TI())}function ru(s,a){if(!bg&&Bd){bg=!0;do for(var l=!1,u=zd;u!==null;){if(s!==0){var p=u.pendingLanes;if(p===0)var g=0;else{var b=u.suspendedLanes,S=u.pingedLanes;g=(1<<31-Bt(42|s)+1)-1,g&=p&~(b&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,tb(u,g))}else g=ot,g=Re(u,u===Pt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Me(u,g)||(l=!0,tb(u,g));u=u.next}while(l);bg=!1}}function EI(){J1()}function J1(){Bd=wg=!1;var s=0;ea!==0&&DI()&&(s=ea);for(var a=pt(),l=null,u=zd;u!==null;){var p=u.next,g=Z1(u,a);g===0?(u.next=null,l===null?zd=p:l.next=p,p===null&&(_l=l)):(l=u,(s!==0||(g&3)!==0)&&(Bd=!0)),u=p}bn!==0&&bn!==5||ru(s),ea!==0&&(ea=0)}function Z1(s,a){for(var l=s.suspendedLanes,u=s.pingedLanes,p=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var b=31-Bt(g),S=1<<b,M=p[b];M===-1?((S&l)===0||(S&u)!==0)&&(p[b]=Fe(S,a)):M<=a&&(s.expiredLanes|=S),g&=~S}if(a=Pt,l=ot,l=Re(s,s===a?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===a&&(It===2||It===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&_e(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Me(s,l)){if(a=l&-l,a===s.callbackPriority)return a;switch(u!==null&&_e(u),wc(l)){case 2:case 8:l=Kt;break;case 32:l=In;break;case 268435456:l=$i;break;default:l=In}return u=eb.bind(null,s),l=Ct(l,u),s.callbackPriority=a,s.callbackNode=l,a}return u!==null&&u!==null&&_e(u),s.callbackPriority=2,s.callbackNode=null,2}function eb(s,a){if(bn!==0&&bn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Vd()&&s.callbackNode!==l)return null;var u=ot;return u=Re(s,s===Pt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(P1(s,u,a),Z1(s,pt()),s.callbackNode!=null&&s.callbackNode===l?eb.bind(null,s):null)}function tb(s,a){if(Vd())return null;P1(s,a,!0)}function TI(){PI(function(){(Tt&6)!==0?Ct(dt,EI):J1()})}function Eg(){if(ea===0){var s=nl;s===0&&(s=ks,ks<<=1,(ks&261888)===0&&(ks=256)),ea=s}return ea}function nb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ps(""+s)}function ib(s,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,s.id&&l.setAttribute("form",s.id),a.parentNode.insertBefore(l,a),s=new FormData(s),l.parentNode.removeChild(l),s}function SI(s,a,l,u,p){if(a==="submit"&&l&&l.stateNode===p){var g=nb((p[Ln]||null).action),b=u.submitter;b&&(a=(a=b[Ln]||null)?nb(a.formAction):b.getAttribute("formAction"),a!==null&&(g=a,b=null));var S=new za("action","action",null,u,p);s.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ea!==0){var M=b?ib(p,b):new FormData(p);Fp(l,{pending:!0,data:M,method:p.method,action:g},null,M)}}else typeof g=="function"&&(S.preventDefault(),M=b?ib(p,b):new FormData(p),Fp(l,{pending:!0,data:M,method:p.method,action:g},g,M))},currentTarget:p}]})}}for(var Tg=0;Tg<rp.length;Tg++){var Sg=rp[Tg],xI=Sg.toLowerCase(),CI=Sg[0].toUpperCase()+Sg.slice(1);Qi(xI,"on"+CI)}Qi(jy,"onAnimationEnd"),Qi(Py,"onAnimationIteration"),Qi(My,"onAnimationStart"),Qi("dblclick","onDoubleClick"),Qi("focusin","onFocus"),Qi("focusout","onBlur"),Qi(F4,"onTransitionRun"),Qi(q4,"onTransitionStart"),Qi(H4,"onTransitionCancel"),Qi(Ly,"onTransitionEnd"),ms("onMouseEnter",["mouseout","mouseover"]),ms("onMouseLeave",["mouseout","mouseover"]),ms("onPointerEnter",["pointerout","pointerover"]),ms("onPointerLeave",["pointerout","pointerover"]),ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ti("onBeforeInput",["compositionend","keypress","textInput","paste"]),ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(au));function sb(s,a){a=(a&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],p=u.event;u=u.listeners;e:{var g=void 0;if(a)for(var b=u.length-1;0<=b;b--){var S=u[b],M=S.instance,W=S.currentTarget;if(S=S.listener,M!==g&&p.isPropagationStopped())break e;g=S,p.currentTarget=W;try{g(p)}catch(ne){nd(ne)}p.currentTarget=null,g=M}else for(b=0;b<u.length;b++){if(S=u[b],M=S.instance,W=S.currentTarget,S=S.listener,M!==g&&p.isPropagationStopped())break e;g=S,p.currentTarget=W;try{g(p)}catch(ne){nd(ne)}p.currentTarget=null,g=M}}}}function st(s,a){var l=a[xr];l===void 0&&(l=a[xr]=new Set);var u=s+"__bubble";l.has(u)||(rb(a,s,2,!1),l.add(u))}function xg(s,a,l){var u=0;a&&(u|=4),rb(l,s,u,a)}var Fd="_reactListening"+Math.random().toString(36).slice(2);function Cg(s){if(!s[Fd]){s[Fd]=!0,Uo.forEach(function(l){l!=="selectionchange"&&(AI.has(l)||xg(l,!1,s),xg(l,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Fd]||(a[Fd]=!0,xg("selectionchange",!1,a))}}function rb(s,a,l,u){switch(jb(a)){case 2:var p=tR;break;case 8:p=nR;break;default:p=Bg}l=p.bind(null,a,l,s),p=void 0,!Ic||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(p=!0),u?p!==void 0?s.addEventListener(a,l,{capture:!0,passive:p}):s.addEventListener(a,l,!0):p!==void 0?s.addEventListener(a,l,{passive:p}):s.addEventListener(a,l,!1)}function Ag(s,a,l,u,p){var g=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var S=u.stateNode.containerInfo;if(S===p)break;if(b===4)for(b=u.return;b!==null;){var M=b.tag;if((M===3||M===4)&&b.stateNode.containerInfo===p)return;b=b.return}for(;S!==null;){if(b=js(S),b===null)return;if(M=b.tag,M===5||M===6||M===26||M===27){u=g=b;continue e}S=S.parentNode}}u=u.return}zh(function(){var W=g,ne=qo(l),ae=[];e:{var Q=Uy.get(s);if(Q!==void 0){var X=za,Ee=s;switch(s){case"keypress":if(Va(l)===0)break e;case"keydown":case"keyup":X=Yh;break;case"focusin":Ee="focus",X=Pr;break;case"focusout":Ee="blur",X=Pr;break;case"beforeblur":case"afterblur":X=Pr;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=Fh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=qh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=Xh;break;case jy:case Py:case My:X=Go;break;case Ly:X=Ko;break;case"scroll":case"scrollend":X=Bh;break;case"wheel":X=Zh;break;case"copy":case"cut":case"paste":X=$h;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Dc;break;case"toggle":case"beforetoggle":X=Lr}var Le=(a&4)!==0,jt=!Le&&(s==="scroll"||s==="scrollend"),q=Le?Q!==null?Q+"Capture":null:Q;Le=[];for(var z=W,K;z!==null;){var re=z;if(K=re.stateNode,re=re.tag,re!==5&&re!==26&&re!==27||K===null||q===null||(re=oi(z,q),re!=null&&Le.push(ou(z,re,K))),jt)break;z=z.return}0<Le.length&&(Q=new X(Q,Ee,null,l,ne),ae.push({event:Q,listeners:Le}))}}if((a&7)===0){e:{if(Q=s==="mouseover"||s==="pointerover",X=s==="mouseout"||s==="pointerout",Q&&l!==Fo&&(Ee=l.relatedTarget||l.fromElement)&&(js(Ee)||Ee[ds]))break e;if((X||Q)&&(Q=ne.window===ne?ne:(Q=ne.ownerDocument)?Q.defaultView||Q.parentWindow:window,X?(Ee=l.relatedTarget||l.toElement,X=W,Ee=Ee?js(Ee):null,Ee!==null&&(jt=o(Ee),Le=Ee.tag,Ee!==jt||Le!==5&&Le!==27&&Le!==6)&&(Ee=null)):(X=null,Ee=W),X!==Ee)){if(Le=Fh,re="onMouseLeave",q="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Le=Dc,re="onPointerLeave",q="onPointerEnter",z="pointer"),jt=X==null?Q:Ma(X),K=Ee==null?Q:Ma(Ee),Q=new Le(re,z+"leave",X,l,ne),Q.target=jt,Q.relatedTarget=K,re=null,js(ne)===W&&(Le=new Le(q,z+"enter",Ee,l,ne),Le.target=K,Le.relatedTarget=jt,re=Le),jt=re,X&&Ee)t:{for(Le=II,q=X,z=Ee,K=0,re=q;re;re=Le(re))K++;re=0;for(var Ne=z;Ne;Ne=Le(Ne))re++;for(;0<K-re;)q=Le(q),K--;for(;0<re-K;)z=Le(z),re--;for(;K--;){if(q===z||z!==null&&q===z.alternate){Le=q;break t}q=Le(q),z=Le(z)}Le=null}else Le=null;X!==null&&ab(ae,Q,X,Le,!1),Ee!==null&&jt!==null&&ab(ae,jt,Ee,Le,!0)}}e:{if(Q=W?Ma(W):window,X=Q.nodeName&&Q.nodeName.toLowerCase(),X==="select"||X==="input"&&Q.type==="file")var vt=Ty;else if(li(Q))if(Sy)vt=V4;else{vt=L4;var Ae=M4}else X=Q.nodeName,!X||X.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?W&&Cc(W.elementType)&&(vt=Ty):vt=U4;if(vt&&(vt=vt(s,W))){Ha(ae,vt,l,ne);break e}Ae&&Ae(s,Q,W),s==="focusout"&&W&&Q.type==="number"&&W.memoizedProps.value!=null&&Bo(Q,"number",Q.value)}switch(Ae=W?Ma(W):window,s){case"focusin":(li(Ae)||Ae.contentEditable==="true")&&(Wo=Ae,np=W,Mc=null);break;case"focusout":Mc=np=Wo=null;break;case"mousedown":ip=!0;break;case"contextmenu":case"mouseup":case"dragend":ip=!1,Oy(ae,l,ne);break;case"selectionchange":if(B4)break;case"keydown":case"keyup":Oy(ae,l,ne)}var Xe;if(y)e:{switch(s){case"compositionstart":var lt="onCompositionStart";break e;case"compositionend":lt="onCompositionEnd";break e;case"compositionupdate":lt="onCompositionUpdate";break e}lt=void 0}else et?xt(s,l)&&(lt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(lt="onCompositionStart");lt&&($&&l.locale!=="ko"&&(et||lt!=="onCompositionStart"?lt==="onCompositionEnd"&&et&&(Xe=kr()):(wi=ne,Ho="value"in wi?wi.value:wi.textContent,et=!0)),Ae=qd(W,lt),0<Ae.length&&(lt=new Nc(lt,s,null,l,ne),ae.push({event:lt,listeners:Ae}),Xe?lt.data=Xe:(Xe=dn(l),Xe!==null&&(lt.data=Xe)))),(Xe=C?Nn(s,l):kn(s,l))&&(lt=qd(W,"onBeforeInput"),0<lt.length&&(Ae=new Nc("onBeforeInput","beforeinput",null,l,ne),ae.push({event:Ae,listeners:lt}),Ae.data=Xe)),SI(ae,s,W,l,ne)}sb(ae,a)})}function ou(s,a,l){return{instance:s,listener:a,currentTarget:l}}function qd(s,a){for(var l=a+"Capture",u=[];s!==null;){var p=s,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=oi(s,l),p!=null&&u.unshift(ou(s,p,g)),p=oi(s,a),p!=null&&u.push(ou(s,p,g))),s.tag===3)return u;s=s.return}return[]}function II(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function ab(s,a,l,u,p){for(var g=a._reactName,b=[];l!==null&&l!==u;){var S=l,M=S.alternate,W=S.stateNode;if(S=S.tag,M!==null&&M===u)break;S!==5&&S!==26&&S!==27||W===null||(M=W,p?(W=oi(l,g),W!=null&&b.unshift(ou(l,W,M))):p||(W=oi(l,g),W!=null&&b.push(ou(l,W,M)))),l=l.return}b.length!==0&&s.push({event:a,listeners:b})}var RI=/\r\n?/g,NI=/\u0000|\uFFFD/g;function ob(s){return(typeof s=="string"?s:""+s).replace(RI,`
`).replace(NI,"")}function lb(s,a){return a=ob(a),ob(s)===a}function Dt(s,a,l,u,p,g){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||ji(s,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&ji(s,""+u);break;case"className":Ir(s,"class",u);break;case"tabIndex":Ir(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ir(s,l,u);break;case"style":Uh(s,u,g);break;case"data":if(a!=="object"){Ir(s,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=ps(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(a!=="input"&&Dt(s,a,"name",p.name,p,null),Dt(s,a,"formEncType",p.formEncType,p,null),Dt(s,a,"formMethod",p.formMethod,p,null),Dt(s,a,"formTarget",p.formTarget,p,null)):(Dt(s,a,"encType",p.encType,p,null),Dt(s,a,"method",p.method,p,null),Dt(s,a,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=ps(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Rn);break;case"onScroll":u!=null&&st("scroll",s);break;case"onScrollEnd":u!=null&&st("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=ps(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":st("beforetoggle",s),st("toggle",s),Ar(s,"popover",u);break;case"xlinkActuate":Di(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Di(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Di(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Di(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Di(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Di(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Di(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Di(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Di(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ar(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Qm.get(l)||l,Ar(s,l,u))}}function Ig(s,a,l,u,p,g){switch(l){case"style":Uh(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?ji(s,u):(typeof u=="number"||typeof u=="bigint")&&ji(s,""+u);break;case"onScroll":u!=null&&st("scroll",s);break;case"onScrollEnd":u!=null&&st("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Rn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Cr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),a=l.slice(2,p?l.length-7:void 0),g=s[Ln]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(a,g,p),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(a,u,p);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Ar(s,l,u)}}}function Bn(s,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":st("error",s),st("load",s);var u=!1,p=!1,g;for(g in l)if(l.hasOwnProperty(g)){var b=l[g];if(b!=null)switch(g){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Dt(s,a,g,b,l,null)}}p&&Dt(s,a,"srcSet",l.srcSet,l,null),u&&Dt(s,a,"src",l.src,l,null);return;case"input":st("invalid",s);var S=g=b=p=null,M=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var ne=l[u];if(ne!=null)switch(u){case"name":p=ne;break;case"type":b=ne;break;case"checked":M=ne;break;case"defaultChecked":W=ne;break;case"value":g=ne;break;case"defaultValue":S=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,a));break;default:Dt(s,a,u,ne,l,null)}}La(s,g,S,M,W,b,p,!1);return;case"select":st("invalid",s),u=b=g=null;for(p in l)if(l.hasOwnProperty(p)&&(S=l[p],S!=null))switch(p){case"value":g=S;break;case"defaultValue":b=S;break;case"multiple":u=S;default:Dt(s,a,p,S,l,null)}a=g,l=b,s.multiple=!!u,a!=null?_t(s,!!u,a,!1):l!=null&&_t(s,!!u,l,!0);return;case"textarea":st("invalid",s),g=p=u=null;for(b in l)if(l.hasOwnProperty(b)&&(S=l[b],S!=null))switch(b){case"value":u=S;break;case"defaultValue":p=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Dt(s,a,b,S,l,null)}Nr(s,u,p,g);return;case"option":for(M in l)if(l.hasOwnProperty(M)&&(u=l[M],u!=null))switch(M){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Dt(s,a,M,u,l,null)}return;case"dialog":st("beforetoggle",s),st("toggle",s),st("cancel",s),st("close",s);break;case"iframe":case"object":st("load",s);break;case"video":case"audio":for(u=0;u<au.length;u++)st(au[u],s);break;case"image":st("error",s),st("load",s);break;case"details":st("toggle",s);break;case"embed":case"source":case"link":st("error",s),st("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Dt(s,a,W,u,l,null)}return;default:if(Cc(a)){for(ne in l)l.hasOwnProperty(ne)&&(u=l[ne],u!==void 0&&Ig(s,a,ne,u,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(u=l[S],u!=null&&Dt(s,a,S,u,l,null))}function kI(s,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,b=null,S=null,M=null,W=null,ne=null;for(X in l){var ae=l[X];if(l.hasOwnProperty(X)&&ae!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":M=ae;default:u.hasOwnProperty(X)||Dt(s,a,X,null,u,ae)}}for(var Q in u){var X=u[Q];if(ae=l[Q],u.hasOwnProperty(Q)&&(X!=null||ae!=null))switch(Q){case"type":g=X;break;case"name":p=X;break;case"checked":W=X;break;case"defaultChecked":ne=X;break;case"value":b=X;break;case"defaultValue":S=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,a));break;default:X!==ae&&Dt(s,a,Q,X,u,ae)}}Rr(s,b,S,M,W,ne,g,p);return;case"select":X=b=S=Q=null;for(g in l)if(M=l[g],l.hasOwnProperty(g)&&M!=null)switch(g){case"value":break;case"multiple":X=M;default:u.hasOwnProperty(g)||Dt(s,a,g,null,u,M)}for(p in u)if(g=u[p],M=l[p],u.hasOwnProperty(p)&&(g!=null||M!=null))switch(p){case"value":Q=g;break;case"defaultValue":S=g;break;case"multiple":b=g;default:g!==M&&Dt(s,a,p,g,u,M)}a=S,l=b,u=X,Q!=null?_t(s,!!l,Q,!1):!!u!=!!l&&(a!=null?_t(s,!!l,a,!0):_t(s,!!l,l?[]:"",!1));return;case"textarea":X=Q=null;for(S in l)if(p=l[S],l.hasOwnProperty(S)&&p!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Dt(s,a,S,null,u,p)}for(b in u)if(p=u[b],g=l[b],u.hasOwnProperty(b)&&(p!=null||g!=null))switch(b){case"value":Q=p;break;case"defaultValue":X=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==g&&Dt(s,a,b,p,u,g)}Ua(s,Q,X);return;case"option":for(var Ee in l)if(Q=l[Ee],l.hasOwnProperty(Ee)&&Q!=null&&!u.hasOwnProperty(Ee))switch(Ee){case"selected":s.selected=!1;break;default:Dt(s,a,Ee,null,u,Q)}for(M in u)if(Q=u[M],X=l[M],u.hasOwnProperty(M)&&Q!==X&&(Q!=null||X!=null))switch(M){case"selected":s.selected=Q&&typeof Q!="function"&&typeof Q!="symbol";break;default:Dt(s,a,M,Q,u,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Le in l)Q=l[Le],l.hasOwnProperty(Le)&&Q!=null&&!u.hasOwnProperty(Le)&&Dt(s,a,Le,null,u,Q);for(W in u)if(Q=u[W],X=l[W],u.hasOwnProperty(W)&&Q!==X&&(Q!=null||X!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(i(137,a));break;default:Dt(s,a,W,Q,u,X)}return;default:if(Cc(a)){for(var jt in l)Q=l[jt],l.hasOwnProperty(jt)&&Q!==void 0&&!u.hasOwnProperty(jt)&&Ig(s,a,jt,void 0,u,Q);for(ne in u)Q=u[ne],X=l[ne],!u.hasOwnProperty(ne)||Q===X||Q===void 0&&X===void 0||Ig(s,a,ne,Q,u,X);return}}for(var q in l)Q=l[q],l.hasOwnProperty(q)&&Q!=null&&!u.hasOwnProperty(q)&&Dt(s,a,q,null,u,Q);for(ae in u)Q=u[ae],X=l[ae],!u.hasOwnProperty(ae)||Q===X||Q==null&&X==null||Dt(s,a,ae,Q,u,X)}function cb(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function OI(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var p=l[u],g=p.transferSize,b=p.initiatorType,S=p.duration;if(g&&S&&cb(b)){for(b=0,S=p.responseEnd,u+=1;u<l.length;u++){var M=l[u],W=M.startTime;if(W>S)break;var ne=M.transferSize,ae=M.initiatorType;ne&&cb(ae)&&(M=M.responseEnd,b+=ne*(M<S?1:(S-W)/(M-W)))}if(--u,a+=8*(g+b)/(p.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Rg=null,Ng=null;function Hd(s){return s.nodeType===9?s:s.ownerDocument}function ub(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hb(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function kg(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Og=null;function DI(){var s=window.event;return s&&s.type==="popstate"?s===Og?!1:(Og=s,!0):(Og=null,!1)}var db=typeof setTimeout=="function"?setTimeout:void 0,jI=typeof clearTimeout=="function"?clearTimeout:void 0,fb=typeof Promise=="function"?Promise:void 0,PI=typeof queueMicrotask=="function"?queueMicrotask:typeof fb<"u"?function(s){return fb.resolve(null).then(s).catch(MI)}:db;function MI(s){setTimeout(function(){throw s})}function ta(s){return s==="head"}function mb(s,a){var l=a,u=0;do{var p=l.nextSibling;if(s.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(p),bl(a);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")lu(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,lu(l);for(var g=l.firstChild;g;){var b=g.nextSibling,S=g.nodeName;g[Ds]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=b}}else l==="body"&&lu(s.ownerDocument.body);l=p}while(l);bl(a)}function pb(s,a){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function Dg(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Dg(l),Pa(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function LI(s,a,l,u){for(;s.nodeType===1;){var p=l;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Ds])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==p.rel||s.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||s.getAttribute("title")!==(p.title==null?null:p.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(p.src==null?null:p.src)||s.getAttribute("type")!==(p.type==null?null:p.type)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=Bi(s.nextSibling),s===null)break}return null}function UI(s,a,l){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Bi(s.nextSibling),s===null))return null;return s}function gb(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Bi(s.nextSibling),s===null))return null;return s}function jg(s){return s.data==="$?"||s.data==="$~"}function Pg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function VI(s,a){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||l.readyState!=="loading")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function Bi(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var Mg=null;function _b(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(a===0)return Bi(s.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}s=s.nextSibling}return null}function vb(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return s;a--}else l!=="/$"&&l!=="/&"||a++}s=s.previousSibling}return null}function yb(s,a,l){switch(a=Hd(l),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function lu(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Pa(s)}var Fi=new Map,wb=new Set;function $d(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var tr=G.d;G.d={f:zI,r:BI,D:FI,C:qI,L:HI,m:$I,X:KI,S:GI,M:WI};function zI(){var s=tr.f(),a=Md();return s||a}function BI(s){var a=Ps(s);a!==null&&a.tag===5&&a.type==="form"?Lw(a):tr.r(s)}var vl=typeof document>"u"?null:document;function bb(s,a,l){var u=vl;if(u&&typeof a=="string"&&a){var p=Zt(a);p='link[rel="'+s+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),wb.has(p)||(wb.add(p),s={rel:s,crossOrigin:l,href:a},u.querySelector(p)===null&&(a=u.createElement("link"),Bn(a,"link",s),an(a),u.head.appendChild(a)))}}function FI(s){tr.D(s),bb("dns-prefetch",s,null)}function qI(s,a){tr.C(s,a),bb("preconnect",s,a)}function HI(s,a,l){tr.L(s,a,l);var u=vl;if(u&&s&&a){var p='link[rel="preload"][as="'+Zt(a)+'"]';a==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+Zt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+Zt(l.imageSizes)+'"]')):p+='[href="'+Zt(s)+'"]';var g=p;switch(a){case"style":g=yl(s);break;case"script":g=wl(s)}Fi.has(g)||(s=w({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:s,as:a},l),Fi.set(g,s),u.querySelector(p)!==null||a==="style"&&u.querySelector(cu(g))||a==="script"&&u.querySelector(uu(g))||(a=u.createElement("link"),Bn(a,"link",s),an(a),u.head.appendChild(a)))}}function $I(s,a){tr.m(s,a);var l=vl;if(l&&s){var u=a&&typeof a.as=="string"?a.as:"script",p='link[rel="modulepreload"][as="'+Zt(u)+'"][href="'+Zt(s)+'"]',g=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=wl(s)}if(!Fi.has(g)&&(s=w({rel:"modulepreload",href:s},a),Fi.set(g,s),l.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(uu(g)))return}u=l.createElement("link"),Bn(u,"link",s),an(u),l.head.appendChild(u)}}}function GI(s,a,l){tr.S(s,a,l);var u=vl;if(u&&s){var p=Wi(u).hoistableStyles,g=yl(s);a=a||"default";var b=p.get(g);if(!b){var S={loading:0,preload:null};if(b=u.querySelector(cu(g)))S.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":a},l),(l=Fi.get(g))&&Lg(s,l);var M=b=u.createElement("link");an(M),Bn(M,"link",s),M._p=new Promise(function(W,ne){M.onload=W,M.onerror=ne}),M.addEventListener("load",function(){S.loading|=1}),M.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Gd(b,a,u)}b={type:"stylesheet",instance:b,count:1,state:S},p.set(g,b)}}}function KI(s,a){tr.X(s,a);var l=vl;if(l&&s){var u=Wi(l).hoistableScripts,p=wl(s),g=u.get(p);g||(g=l.querySelector(uu(p)),g||(s=w({src:s,async:!0},a),(a=Fi.get(p))&&Ug(s,a),g=l.createElement("script"),an(g),Bn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function WI(s,a){tr.M(s,a);var l=vl;if(l&&s){var u=Wi(l).hoistableScripts,p=wl(s),g=u.get(p);g||(g=l.querySelector(uu(p)),g||(s=w({src:s,async:!0,type:"module"},a),(a=Fi.get(p))&&Ug(s,a),g=l.createElement("script"),an(g),Bn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function Eb(s,a,l,u){var p=(p=ke.current)?$d(p):null;if(!p)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=yl(l.href),l=Wi(p).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=yl(l.href);var g=Wi(p).hoistableStyles,b=g.get(s);if(b||(p=p.ownerDocument||p,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,b),(g=p.querySelector(cu(s)))&&!g._p&&(b.instance=g,b.state.loading=5),Fi.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Fi.set(s,l),g||YI(p,s,l,b.state))),a&&u===null)throw Error(i(528,""));return b}if(a&&u!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=wl(l),l=Wi(p).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function yl(s){return'href="'+Zt(s)+'"'}function cu(s){return'link[rel="stylesheet"]['+s+"]"}function Tb(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function YI(s,a,l,u){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=s.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),Bn(a,"link",l),an(a),s.head.appendChild(a))}function wl(s){return'[src="'+Zt(s)+'"]'}function uu(s){return"script[async]"+s}function Sb(s,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=s.querySelector('style[data-href~="'+Zt(l.href)+'"]');if(u)return a.instance=u,an(u),u;var p=w({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),an(u),Bn(u,"style",p),Gd(u,l.precedence,s),a.instance=u;case"stylesheet":p=yl(l.href);var g=s.querySelector(cu(p));if(g)return a.state.loading|=4,a.instance=g,an(g),g;u=Tb(l),(p=Fi.get(p))&&Lg(u,p),g=(s.ownerDocument||s).createElement("link"),an(g);var b=g;return b._p=new Promise(function(S,M){b.onload=S,b.onerror=M}),Bn(g,"link",u),a.state.loading|=4,Gd(g,l.precedence,s),a.instance=g;case"script":return g=wl(l.src),(p=s.querySelector(uu(g)))?(a.instance=p,an(p),p):(u=l,(p=Fi.get(g))&&(u=w({},l),Ug(u,p)),s=s.ownerDocument||s,p=s.createElement("script"),an(p),Bn(p,"link",u),s.head.appendChild(p),a.instance=p);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,Gd(u,l.precedence,s));return a.instance}function Gd(s,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,g=p,b=0;b<u.length;b++){var S=u[b];if(S.dataset.precedence===a)g=S;else if(g!==p)break}g?g.parentNode.insertBefore(s,g.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(s,a.firstChild))}function Lg(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function Ug(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Kd=null;function xb(s,a,l){if(Kd===null){var u=new Map,p=Kd=new Map;p.set(l,u)}else p=Kd,u=p.get(l),u||(u=new Map,p.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),p=0;p<l.length;p++){var g=l[p];if(!(g[Ds]||g[Jt]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var b=g.getAttribute(a)||"";b=s+b;var S=u.get(b);S?S.push(g):u.set(b,[g])}}return u}function Cb(s,a,l){s=s.ownerDocument||s,s.head.insertBefore(l,a==="title"?s.querySelector("head > title"):null)}function QI(s,a,l){if(l===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Ab(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function XI(s,a,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var p=yl(u.href),g=a.querySelector(cu(p));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Wd.bind(s),a.then(s,s)),l.state.loading|=4,l.instance=g,an(g);return}g=a.ownerDocument||a,u=Tb(u),(p=Fi.get(p))&&Lg(u,p),g=g.createElement("link"),an(g);var b=g;b._p=new Promise(function(S,M){b.onload=S,b.onerror=M}),Bn(g,"link",u),l.instance=g}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=Wd.bind(s),a.addEventListener("load",l),a.addEventListener("error",l))}}var Vg=0;function JI(s,a){return s.stylesheets&&s.count===0&&Qd(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend){var g=s.unsuspend;s.unsuspend=null,g()}},6e4+a);0<s.imgBytes&&Vg===0&&(Vg=62500*OI());var p=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend)){var g=s.unsuspend;s.unsuspend=null,g()}},(s.imgBytes>Vg?50:800)+a);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function Wd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Qd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Yd=null;function Qd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Yd=new Map,a.forEach(ZI,s),Yd=null,Wd.call(s))}function ZI(s,a){if(!(a.state.loading&4)){var l=Yd.get(s);if(l)var u=l.get(null);else{l=new Map,Yd.set(s,l);for(var p=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var b=p[g];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),u=b)}u&&l.set(null,u)}p=a.instance,b=p.getAttribute("data-precedence"),g=l.get(b)||u,g===u&&l.set(null,p),l.set(b,p),this.count++,u=Wd.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),g?g.parentNode.insertBefore(p,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(p,s.firstChild)),a.state.loading|=4}}var hu={$$typeof:H,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function eR(s,a,l,u,p,g,b,S,M){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=kt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kt(0),this.hiddenUpdates=kt(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function Ib(s,a,l,u,p,g,b,S,M,W,ne,ae){return s=new eR(s,a,l,b,M,W,ne,ae,S),a=1,g===!0&&(a|=24),g=Ei(3,null,null,a),s.current=g,g.stateNode=s,a=vp(),a.refCount++,s.pooledCache=a,a.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:a},Ep(g),s}function Rb(s){return s?(s=Xo,s):Xo}function Nb(s,a,l,u,p,g){p=Rb(p),u.context===null?u.context=p:u.pendingContext=p,u=Hr(a),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=$r(s,u,a),l!==null&&(fi(l,s,a),qc(l,s,a))}function kb(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<a?l:a}}function zg(s,a){kb(s,a),(s=s.alternate)&&kb(s,a)}function Ob(s){if(s.tag===13||s.tag===31){var a=Ka(s,67108864);a!==null&&fi(a,s,67108864),zg(s,67108864)}}function Db(s){if(s.tag===13||s.tag===31){var a=Ai();a=yc(a);var l=Ka(s,a);l!==null&&fi(l,s,a),zg(s,a)}}var Xd=!0;function tR(s,a,l,u){var p=j.T;j.T=null;var g=G.p;try{G.p=2,Bg(s,a,l,u)}finally{G.p=g,j.T=p}}function nR(s,a,l,u){var p=j.T;j.T=null;var g=G.p;try{G.p=8,Bg(s,a,l,u)}finally{G.p=g,j.T=p}}function Bg(s,a,l,u){if(Xd){var p=Fg(u);if(p===null)Ag(s,a,u,Jd,l),Pb(s,u);else if(sR(p,s,a,l,u))u.stopPropagation();else if(Pb(s,u),a&4&&-1<iR.indexOf(s)){for(;p!==null;){var g=Ps(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var b=Ie(g.pendingLanes);if(b!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;b;){var M=1<<31-Bt(b);S.entanglements[1]|=M,b&=~M}bs(g),(Tt&6)===0&&(jd=pt()+500,ru(0))}}break;case 31:case 13:S=Ka(g,2),S!==null&&fi(S,g,2),Md(),zg(g,2)}if(g=Fg(u),g===null&&Ag(s,a,u,Jd,l),g===p)break;p=g}p!==null&&u.stopPropagation()}else Ag(s,a,u,null,l)}}function Fg(s){return s=qo(s),qg(s)}var Jd=null;function qg(s){if(Jd=null,s=js(s),s!==null){var a=o(s);if(a===null)s=null;else{var l=a.tag;if(l===13){if(s=c(a),s!==null)return s;s=null}else if(l===31){if(s=h(a),s!==null)return s;s=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Jd=s,null}function jb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xt()){case dt:return 2;case Kt:return 8;case In:case Oi:return 32;case $i:return 268435456;default:return 32}default:return 32}}var Hg=!1,na=null,ia=null,sa=null,du=new Map,fu=new Map,ra=[],iR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pb(s,a){switch(s){case"focusin":case"focusout":na=null;break;case"dragenter":case"dragleave":ia=null;break;case"mouseover":case"mouseout":sa=null;break;case"pointerover":case"pointerout":du.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":fu.delete(a.pointerId)}}function mu(s,a,l,u,p,g){return s===null||s.nativeEvent!==g?(s={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[p]},a!==null&&(a=Ps(a),a!==null&&Ob(a)),s):(s.eventSystemFlags|=u,a=s.targetContainers,p!==null&&a.indexOf(p)===-1&&a.push(p),s)}function sR(s,a,l,u,p){switch(a){case"focusin":return na=mu(na,s,a,l,u,p),!0;case"dragenter":return ia=mu(ia,s,a,l,u,p),!0;case"mouseover":return sa=mu(sa,s,a,l,u,p),!0;case"pointerover":var g=p.pointerId;return du.set(g,mu(du.get(g)||null,s,a,l,u,p)),!0;case"gotpointercapture":return g=p.pointerId,fu.set(g,mu(fu.get(g)||null,s,a,l,u,p)),!0}return!1}function Mb(s){var a=js(s.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){s.blockedOn=a,jh(s.priority,function(){Db(l)});return}}else if(a===31){if(a=h(l),a!==null){s.blockedOn=a,jh(s.priority,function(){Db(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Zd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var l=Fg(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);Fo=u,l.target.dispatchEvent(u),Fo=null}else return a=Ps(l),a!==null&&Ob(a),s.blockedOn=l,!1;a.shift()}return!0}function Lb(s,a,l){Zd(s)&&l.delete(a)}function rR(){Hg=!1,na!==null&&Zd(na)&&(na=null),ia!==null&&Zd(ia)&&(ia=null),sa!==null&&Zd(sa)&&(sa=null),du.forEach(Lb),fu.forEach(Lb)}function ef(s,a){s.blockedOn===a&&(s.blockedOn=null,Hg||(Hg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,rR)))}var tf=null;function Ub(s){tf!==s&&(tf=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){tf===s&&(tf=null);for(var a=0;a<s.length;a+=3){var l=s[a],u=s[a+1],p=s[a+2];if(typeof u!="function"){if(qg(u||l)===null)continue;break}var g=Ps(l);g!==null&&(s.splice(a,3),a-=3,Fp(g,{pending:!0,data:p,method:l.method,action:u},u,p))}}))}function bl(s){function a(M){return ef(M,s)}na!==null&&ef(na,s),ia!==null&&ef(ia,s),sa!==null&&ef(sa,s),du.forEach(a),fu.forEach(a);for(var l=0;l<ra.length;l++){var u=ra[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<ra.length&&(l=ra[0],l.blockedOn===null);)Mb(l),l.blockedOn===null&&ra.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var p=l[u],g=l[u+1],b=p[Ln]||null;if(typeof g=="function")b||Ub(l);else if(b){var S=null;if(g&&g.hasAttribute("formAction")){if(p=g,b=g[Ln]||null)S=b.formAction;else if(qg(p)!==null)continue}else S=b.action;typeof S=="function"?l[u+1]=S:(l.splice(u,3),u-=3),Ub(l)}}}function Vb(){function s(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(b){return p=b})},focusReset:"manual",scroll:"manual"})}function a(){p!==null&&(p(),p=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),p!==null&&(p(),p=null)}}}function $g(s){this._internalRoot=s}nf.prototype.render=$g.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,u=Ai();Nb(l,u,s,a,null,null)},nf.prototype.unmount=$g.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Nb(s.current,2,null,s,null,null),Md(),a[ds]=null}};function nf(s){this._internalRoot=s}nf.prototype.unstable_scheduleHydration=function(s){if(s){var a=Os();s={blockedOn:null,target:s,priority:a};for(var l=0;l<ra.length&&a!==0&&a<ra[l].priority;l++);ra.splice(l,0,s),l===0&&Mb(s)}};var zb=e.version;if(zb!=="19.2.0")throw Error(i(527,zb,"19.2.0"));G.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(a),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var aR={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sf.isDisabled&&sf.supportsFiber)try{St=sf.inject(aR),nt=sf}catch{}}return gu.createRoot=function(s,a){if(!r(s))throw Error(i(299));var l=!1,u="",p=Kw,g=Ww,b=Yw;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(b=a.onRecoverableError)),a=Ib(s,1,!1,null,null,l,u,null,p,g,b,Vb),s[ds]=a.current,Cg(s),new $g(a)},gu.hydrateRoot=function(s,a,l){if(!r(s))throw Error(i(299));var u=!1,p="",g=Kw,b=Ww,S=Yw,M=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.formState!==void 0&&(M=l.formState)),a=Ib(s,1,!0,a,l??null,u,p,M,g,b,S,Vb),a.context=Rb(null),l=a.current,u=Ai(),u=yc(u),p=Hr(u),p.callback=null,$r(l,p,u),l=u,a.current.lanes=l,Gi(a,l),bs(a),s[ds]=a.current,Cg(s),new nf(a)},gu.version="19.2.0",gu}var Qb;function vR(){if(Qb)return Wg.exports;Qb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Wg.exports=_R(),Wg.exports}var yR=vR();const wR=L0(yR);HT();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fu(){return Fu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Fu.apply(this,arguments)}var pa;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(pa||(pa={}));const Xb="popstate";function bR(n){n===void 0&&(n={});function e(i,r){let{pathname:o,search:c,hash:h}=i.location;return M_("",{pathname:o,search:c,hash:h},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:xf(r)}return TR(e,t,null,n)}function un(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function $T(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ER(){return Math.random().toString(36).substr(2,8)}function Jb(n,e){return{usr:n.state,key:n.key,idx:e}}function M_(n,e,t,i){return t===void 0&&(t=null),Fu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?lc(e):e,{state:t,key:e&&e.key||i||ER()})}function xf(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function lc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function TR(n,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:o=!1}=i,c=r.history,h=pa.Pop,f=null,m=v();m==null&&(m=0,c.replaceState(Fu({},c.state,{idx:m}),""));function v(){return(c.state||{idx:null}).idx}function w(){h=pa.Pop;let O=v(),Z=O==null?null:O-m;m=O,f&&f({action:h,location:L.location,delta:Z})}function T(O,Z){h=pa.Push;let Y=M_(L.location,O,Z);m=v()+1;let H=Jb(Y,m),le=L.createHref(Y);try{c.pushState(H,"",le)}catch(ve){if(ve instanceof DOMException&&ve.name==="DataCloneError")throw ve;r.location.assign(le)}o&&f&&f({action:h,location:L.location,delta:1})}function x(O,Z){h=pa.Replace;let Y=M_(L.location,O,Z);m=v();let H=Jb(Y,m),le=L.createHref(Y);c.replaceState(H,"",le),o&&f&&f({action:h,location:L.location,delta:0})}function N(O){let Z=r.location.origin!=="null"?r.location.origin:r.location.href,Y=typeof O=="string"?O:xf(O);return Y=Y.replace(/ $/,"%20"),un(Z,"No window.location.(origin|href) available to create URL for href: "+Y),new URL(Y,Z)}let L={get action(){return h},get location(){return n(r,c)},listen(O){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(Xb,w),f=O,()=>{r.removeEventListener(Xb,w),f=null}},createHref(O){return e(r,O)},createURL:N,encodeLocation(O){let Z=N(O);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:T,replace:x,go(O){return c.go(O)}};return L}var Zb;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Zb||(Zb={}));function SR(n,e,t){return t===void 0&&(t="/"),xR(n,e,t)}function xR(n,e,t,i){let r=typeof e=="string"?lc(e):e,o=V0(r.pathname||"/",t);if(o==null)return null;let c=GT(n);CR(c);let h=null;for(let f=0;h==null&&f<c.length;++f){let m=UR(o);h=PR(c[f],m)}return h}function GT(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(o,c,h)=>{let f={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};f.relativePath.startsWith("/")&&(un(f.relativePath.startsWith(i),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(i.length));let m=_a([i,f.relativePath]),v=t.concat(f);o.children&&o.children.length>0&&(un(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),GT(o.children,e,v,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:DR(m,o.index),routesMeta:v})};return n.forEach((o,c)=>{var h;if(o.path===""||!((h=o.path)!=null&&h.includes("?")))r(o,c);else for(let f of KT(o.path))r(o,c,f)}),e}function KT(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return r?[o,""]:[o];let c=KT(i.join("/")),h=[];return h.push(...c.map(f=>f===""?o:[o,f].join("/"))),r&&h.push(...c),h.map(f=>n.startsWith("/")&&f===""?"/":f)}function CR(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:jR(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const AR=/^:[\w-]+$/,IR=3,RR=2,NR=1,kR=10,OR=-2,eE=n=>n==="*";function DR(n,e){let t=n.split("/"),i=t.length;return t.some(eE)&&(i+=OR),e&&(i+=RR),t.filter(r=>!eE(r)).reduce((r,o)=>r+(AR.test(o)?IR:o===""?NR:kR),i)}function jR(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function PR(n,e,t){let{routesMeta:i}=n,r={},o="/",c=[];for(let h=0;h<i.length;++h){let f=i[h],m=h===i.length-1,v=o==="/"?e:e.slice(o.length)||"/",w=MR({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},v),T=f.route;if(!w)return null;Object.assign(r,w.params),c.push({params:r,pathname:_a([o,w.pathname]),pathnameBase:FR(_a([o,w.pathnameBase])),route:T}),w.pathnameBase!=="/"&&(o=_a([o,w.pathnameBase]))}return c}function MR(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=LR(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let o=r[0],c=o.replace(/(.)\/+$/,"$1"),h=r.slice(1);return{params:i.reduce((m,v,w)=>{let{paramName:T,isOptional:x}=v;if(T==="*"){let L=h[w]||"";c=o.slice(0,o.length-L.length).replace(/(.)\/+$/,"$1")}const N=h[w];return x&&!N?m[T]=void 0:m[T]=(N||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:c,pattern:n}}function LR(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),$T(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,f)=>(i.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function UR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return $T(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function V0(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function VR(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?lc(n):n;return{pathname:t?t.startsWith("/")?t:zR(t,e):e,search:qR(i),hash:HR(r)}}function zR(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function Jg(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BR(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function z0(n,e){let t=BR(n);return e?t.map((i,r)=>r===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function B0(n,e,t,i){i===void 0&&(i=!1);let r;typeof n=="string"?r=lc(n):(r=Fu({},n),un(!r.pathname||!r.pathname.includes("?"),Jg("?","pathname","search",r)),un(!r.pathname||!r.pathname.includes("#"),Jg("#","pathname","hash",r)),un(!r.search||!r.search.includes("#"),Jg("#","search","hash",r)));let o=n===""||r.pathname==="",c=o?"/":r.pathname,h;if(c==null)h=t;else{let w=e.length-1;if(!i&&c.startsWith("..")){let T=c.split("/");for(;T[0]==="..";)T.shift(),w-=1;r.pathname=T.join("/")}h=w>=0?e[w]:"/"}let f=VR(r,h),m=c&&c!=="/"&&c.endsWith("/"),v=(o||c===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(m||v)&&(f.pathname+="/"),f}const _a=n=>n.join("/").replace(/\/\/+/g,"/"),FR=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),qR=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,HR=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function $R(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const WT=["post","put","patch","delete"];new Set(WT);const GR=["get",...WT];new Set(GR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qu(){return qu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},qu.apply(this,arguments)}const F0=P.createContext(null),KR=P.createContext(null),Ra=P.createContext(null),fm=P.createContext(null),Na=P.createContext({outlet:null,matches:[],isDataRoute:!1}),YT=P.createContext(null);function WR(n,e){let{relative:t}=e===void 0?{}:e;cc()||un(!1);let{basename:i,navigator:r}=P.useContext(Ra),{hash:o,pathname:c,search:h}=XT(n,{relative:t}),f=c;return i!=="/"&&(f=c==="/"?i:_a([i,c])),r.createHref({pathname:f,search:h,hash:o})}function cc(){return P.useContext(fm)!=null}function vr(){return cc()||un(!1),P.useContext(fm).location}function QT(n){P.useContext(Ra).static||P.useLayoutEffect(n)}function cs(){let{isDataRoute:n}=P.useContext(Na);return n?oN():YR()}function YR(){cc()||un(!1);let n=P.useContext(F0),{basename:e,future:t,navigator:i}=P.useContext(Ra),{matches:r}=P.useContext(Na),{pathname:o}=vr(),c=JSON.stringify(z0(r,t.v7_relativeSplatPath)),h=P.useRef(!1);return QT(()=>{h.current=!0}),P.useCallback(function(m,v){if(v===void 0&&(v={}),!h.current)return;if(typeof m=="number"){i.go(m);return}let w=B0(m,JSON.parse(c),o,v.relative==="path");n==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:_a([e,w.pathname])),(v.replace?i.replace:i.push)(w,v.state,v)},[e,i,c,o,n])}function XT(n,e){let{relative:t}=e===void 0?{}:e,{future:i}=P.useContext(Ra),{matches:r}=P.useContext(Na),{pathname:o}=vr(),c=JSON.stringify(z0(r,i.v7_relativeSplatPath));return P.useMemo(()=>B0(n,JSON.parse(c),o,t==="path"),[n,c,o,t])}function QR(n,e){return XR(n,e)}function XR(n,e,t,i){cc()||un(!1);let{navigator:r}=P.useContext(Ra),{matches:o}=P.useContext(Na),c=o[o.length-1],h=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let m=vr(),v;if(e){var w;let O=typeof e=="string"?lc(e):e;f==="/"||(w=O.pathname)!=null&&w.startsWith(f)||un(!1),v=O}else v=m;let T=v.pathname||"/",x=T;if(f!=="/"){let O=f.replace(/^\//,"").split("/");x="/"+T.replace(/^\//,"").split("/").slice(O.length).join("/")}let N=SR(n,{pathname:x}),L=nN(N&&N.map(O=>Object.assign({},O,{params:Object.assign({},h,O.params),pathname:_a([f,r.encodeLocation?r.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?f:_a([f,r.encodeLocation?r.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),o,t,i);return e&&L?P.createElement(fm.Provider,{value:{location:qu({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:pa.Pop}},L):L}function JR(){let n=aN(),e=$R(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:r},t):null,null)}const ZR=P.createElement(JR,null);class eN extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?P.createElement(Na.Provider,{value:this.props.routeContext},P.createElement(YT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function tN(n){let{routeContext:e,match:t,children:i}=n,r=P.useContext(F0);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),P.createElement(Na.Provider,{value:e},i)}function nN(n,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var o;if(!t)return null;if(t.errors)n=t.matches;else if((o=i)!=null&&o.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,h=(r=t)==null?void 0:r.errors;if(h!=null){let v=c.findIndex(w=>w.route.id&&h?.[w.route.id]!==void 0);v>=0||un(!1),c=c.slice(0,Math.min(c.length,v+1))}let f=!1,m=-1;if(t&&i&&i.v7_partialHydration)for(let v=0;v<c.length;v++){let w=c[v];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(m=v),w.route.id){let{loaderData:T,errors:x}=t,N=w.route.loader&&T[w.route.id]===void 0&&(!x||x[w.route.id]===void 0);if(w.route.lazy||N){f=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((v,w,T)=>{let x,N=!1,L=null,O=null;t&&(x=h&&w.route.id?h[w.route.id]:void 0,L=w.route.errorElement||ZR,f&&(m<0&&T===0?(lN("route-fallback"),N=!0,O=null):m===T&&(N=!0,O=w.route.hydrateFallbackElement||null)));let Z=e.concat(c.slice(0,T+1)),Y=()=>{let H;return x?H=L:N?H=O:w.route.Component?H=P.createElement(w.route.Component,null):w.route.element?H=w.route.element:H=v,P.createElement(tN,{match:w,routeContext:{outlet:v,matches:Z,isDataRoute:t!=null},children:H})};return t&&(w.route.ErrorBoundary||w.route.errorElement||T===0)?P.createElement(eN,{location:t.location,revalidation:t.revalidation,component:L,error:x,children:Y(),routeContext:{outlet:null,matches:Z,isDataRoute:!0}}):Y()},null)}var JT=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(JT||{}),ZT=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(ZT||{});function iN(n){let e=P.useContext(F0);return e||un(!1),e}function sN(n){let e=P.useContext(KR);return e||un(!1),e}function rN(n){let e=P.useContext(Na);return e||un(!1),e}function eS(n){let e=rN(),t=e.matches[e.matches.length-1];return t.route.id||un(!1),t.route.id}function aN(){var n;let e=P.useContext(YT),t=sN(),i=eS();return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function oN(){let{router:n}=iN(JT.UseNavigateStable),e=eS(ZT.UseNavigateStable),t=P.useRef(!1);return QT(()=>{t.current=!0}),P.useCallback(function(r,o){o===void 0&&(o={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,qu({fromRouteId:e},o)))},[n,e])}const tE={};function lN(n,e,t){tE[n]||(tE[n]=!0)}function cN(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function L_(n){let{to:e,replace:t,state:i,relative:r}=n;cc()||un(!1);let{future:o,static:c}=P.useContext(Ra),{matches:h}=P.useContext(Na),{pathname:f}=vr(),m=cs(),v=B0(e,z0(h,o.v7_relativeSplatPath),f,r==="path"),w=JSON.stringify(v);return P.useEffect(()=>m(JSON.parse(w),{replace:t,state:i,relative:r}),[m,w,r,t,i]),null}function pi(n){un(!1)}function uN(n){let{basename:e="/",children:t=null,location:i,navigationType:r=pa.Pop,navigator:o,static:c=!1,future:h}=n;cc()&&un(!1);let f=e.replace(/^\/*/,"/"),m=P.useMemo(()=>({basename:f,navigator:o,static:c,future:qu({v7_relativeSplatPath:!1},h)}),[f,h,o,c]);typeof i=="string"&&(i=lc(i));let{pathname:v="/",search:w="",hash:T="",state:x=null,key:N="default"}=i,L=P.useMemo(()=>{let O=V0(v,f);return O==null?null:{location:{pathname:O,search:w,hash:T,state:x,key:N},navigationType:r}},[f,v,w,T,x,N,r]);return L==null?null:P.createElement(Ra.Provider,{value:m},P.createElement(fm.Provider,{children:t,value:L}))}function tS(n){let{children:e,location:t}=n;return QR(U_(e),t)}new Promise(()=>{});function U_(n,e){e===void 0&&(e=[]);let t=[];return P.Children.forEach(n,(i,r)=>{if(!P.isValidElement(i))return;let o=[...e,r];if(i.type===P.Fragment){t.push.apply(t,U_(i.props.children,o));return}i.type!==pi&&un(!1),!i.props.index||!i.props.children||un(!1);let c={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=U_(i.props.children,o)),t.push(c)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function V_(){return V_=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},V_.apply(this,arguments)}function hN(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,o;for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function dN(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function fN(n,e){return n.button===0&&(!e||e==="_self")&&!dN(n)}const mN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],pN="6";try{window.__reactRouterVersion=pN}catch{}const gN="startTransition",nE=fR[gN];function _N(n){let{basename:e,children:t,future:i,window:r}=n,o=P.useRef();o.current==null&&(o.current=bR({window:r,v5Compat:!0}));let c=o.current,[h,f]=P.useState({action:c.action,location:c.location}),{v7_startTransition:m}=i||{},v=P.useCallback(w=>{m&&nE?nE(()=>f(w)):f(w)},[f,m]);return P.useLayoutEffect(()=>c.listen(v),[c,v]),P.useEffect(()=>cN(i),[i]),P.createElement(uN,{basename:e,children:t,location:h.location,navigationType:h.action,navigator:c,future:i})}const vN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,z_=P.forwardRef(function(e,t){let{onClick:i,relative:r,reloadDocument:o,replace:c,state:h,target:f,to:m,preventScrollReset:v,viewTransition:w}=e,T=hN(e,mN),{basename:x}=P.useContext(Ra),N,L=!1;if(typeof m=="string"&&yN.test(m)&&(N=m,vN))try{let H=new URL(window.location.href),le=m.startsWith("//")?new URL(H.protocol+m):new URL(m),ve=V0(le.pathname,x);le.origin===H.origin&&ve!=null?m=ve+le.search+le.hash:L=!0}catch{}let O=WR(m,{relative:r}),Z=wN(m,{replace:c,state:h,target:f,preventScrollReset:v,relative:r,viewTransition:w});function Y(H){i&&i(H),H.defaultPrevented||Z(H)}return P.createElement("a",V_({},T,{href:N||O,onClick:L||o?i:Y,ref:t,target:f}))});var iE;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(iE||(iE={}));var sE;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(sE||(sE={}));function wN(n,e){let{target:t,replace:i,state:r,preventScrollReset:o,relative:c,viewTransition:h}=e===void 0?{}:e,f=cs(),m=vr(),v=XT(n,{relative:c});return P.useCallback(w=>{if(fN(w,t)){w.preventDefault();let T=i!==void 0?i:xf(m)===xf(v);f(n,{replace:T,state:r,preventScrollReset:o,relative:c,viewTransition:h})}},[m,f,v,i,r,t,n,o,c,h])}var rE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe=function(n,e){if(!n)throw uc(e)},uc=function(n){return new Error("Firebase Database ("+nS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},bN=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=n[t++],c=n[t++],h=n[t++],f=((r&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const o=n[t++],c=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|c&63)}}return e.join("")},q0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const o=n[r],c=r+1<n.length,h=c?n[r+1]:0,f=r+2<n.length,m=f?n[r+2]:0,v=o>>2,w=(o&3)<<4|h>>4;let T=(h&15)<<2|m>>6,x=m&63;f||(x=64,c||(T=64)),i.push(t[v],t[w],t[T],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(iS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):bN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const o=t[n.charAt(r++)],h=r<n.length?t[n.charAt(r)]:0;++r;const m=r<n.length?t[n.charAt(r)]:64;++r;const w=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||h==null||m==null||w==null)throw new EN;const T=o<<2|h>>4;if(i.push(T),m!==64){const x=h<<4&240|m>>2;if(i.push(x),w!==64){const N=m<<6&192|w;i.push(N)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class EN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sS=function(n){const e=iS(n);return q0.encodeByteArray(e,!0)},Cf=function(n){return sS(n).replace(/\./g,"")},Af=function(n){try{return q0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n){return rS(void 0,n)}function rS(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!SN(t)||(n[t]=rS(n[t],e[t]));return n}function SN(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN=()=>xN().__FIREBASE_DEFAULTS__,AN=()=>{if(typeof process>"u"||typeof rE>"u")return;const n=rE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},IN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Af(n[1]);return e&&JSON.parse(e)},mm=()=>{try{return CN()||AN()||IN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},aS=n=>{var e,t;return(t=(e=mm())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},oS=n=>{const e=aS(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},lS=()=>{var n;return(n=mm())===null||n===void 0?void 0:n.config},cS=n=>{var e;return(e=mm())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H0=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Cf(JSON.stringify(t)),Cf(JSON.stringify(c)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ei())}function RN(){var n;const e=(n=mm())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function hS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ON(){const n=ei();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function DN(){return nS.NODE_ADMIN===!0}function jN(){return!RN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dS(){try{return typeof indexedDB=="object"}catch{return!1}}function fS(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var o;e(((o=r.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}function PN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN="FirebaseError";class Ns extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=MN,Object.setPrototypeOf(this,Ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ro.prototype.create)}}class Ro{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],c=o?LN(o,i):"Error",h=`${this.serviceName}: ${c} (${r}).`;return new Ns(r,h,i)}}function LN(n,e){return n.replace(UN,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const UN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(n){return JSON.parse(n)}function Tn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS=function(n){let e={},t={},i={},r="";try{const o=n.split(".");e=Hu(Af(o[0])||""),t=Hu(Af(o[1])||""),r=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}},VN=function(n){const e=mS(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},zN=function(n){const e=mS(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Yl(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function B_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function If(n,e,t){const i={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function Rf(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const o=n[r],c=e[r];if(aE(o)&&aE(c)){if(!Rf(o,c))return!1}else if(o!==c)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function aE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Tu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,o]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function Su(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let w=0;w<16;w++)i[w]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let w=0;w<16;w++)i[w]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let w=16;w<80;w++){const T=i[w-3]^i[w-8]^i[w-14]^i[w-16];i[w]=(T<<1|T>>>31)&4294967295}let r=this.chain_[0],o=this.chain_[1],c=this.chain_[2],h=this.chain_[3],f=this.chain_[4],m,v;for(let w=0;w<80;w++){w<40?w<20?(m=h^o&(c^h),v=1518500249):(m=o^c^h,v=1859775393):w<60?(m=o&c|h&(o|c),v=2400959708):(m=o^c^h,v=3395469782);const T=(r<<5|r>>>27)+m+f+v+i[w]&4294967295;f=h,h=c,c=(o<<30|o>>>2)&4294967295,o=r,r=T}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let r=0;const o=this.buf_;let c=this.inbuf_;for(;r<t;){if(c===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(o[c]=e.charCodeAt(r),++c,++r,c===this.blockSize){this.compress_(o),c=0;break}}else for(;r<t;)if(o[c]=e[r],++c,++r,c===this.blockSize){this.compress_(o),c=0;break}}this.inbuf_=c,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[r]>>o&255,++i;return e}}function FN(n,e){const t=new qN(n,e);return t.subscribe.bind(t)}class qN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");HN(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Zg),r.error===void 0&&(r.error=Zg),r.complete===void 0&&(r.complete=Zg);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Zg(){}function pS(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){const o=r-55296;i++,fe(i<n.length,"Surrogate pair missing trail surrogate.");const c=n.charCodeAt(i)-56320;r=65536+(o<<10)+c}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},pm=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yt(n){return n&&n._delegate?n._delegate:n}class Hi{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new H0;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(WN(e))try{this.getOrInitializeService({instanceIdentifier:lo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=lo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=lo){return this.instances.has(e)}getOptions(e=lo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&c.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(r,o);const c=this.instances.get(r);return c&&e(c,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:KN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=lo){return this.component?this.component.multipleInstances?e:lo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function KN(n){return n===lo?void 0:n}function WN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new GN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ct||(ct={}));const QN={debug:ct.DEBUG,verbose:ct.VERBOSE,info:ct.INFO,warn:ct.WARN,error:ct.ERROR,silent:ct.SILENT},XN=ct.INFO,JN={[ct.DEBUG]:"log",[ct.VERBOSE]:"log",[ct.INFO]:"info",[ct.WARN]:"warn",[ct.ERROR]:"error"},ZN=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=JN[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gm{constructor(e){this.name=e,this._logLevel=XN,this._logHandler=ZN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?QN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ct.DEBUG,...e),this._logHandler(this,ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ct.VERBOSE,...e),this._logHandler(this,ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ct.INFO,...e),this._logHandler(this,ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ct.WARN,...e),this._logHandler(this,ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ct.ERROR,...e),this._logHandler(this,ct.ERROR,...e)}}const e3=(n,e)=>e.some(t=>n instanceof t);let oE,lE;function t3(){return oE||(oE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function n3(){return lE||(lE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gS=new WeakMap,F_=new WeakMap,_S=new WeakMap,e_=new WeakMap,G0=new WeakMap;function i3(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(cr(n.result)),r()},c=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&gS.set(t,n)}).catch(()=>{}),G0.set(e,n),e}function s3(n){if(F_.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),r()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});F_.set(n,e)}let q_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return F_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_S.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return cr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function r3(n){q_=n(q_)}function a3(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(t_(this),e,...t);return _S.set(i,e.sort?e.sort():[e]),cr(i)}:n3().includes(n)?function(...e){return n.apply(t_(this),e),cr(gS.get(this))}:function(...e){return cr(n.apply(t_(this),e))}}function o3(n){return typeof n=="function"?a3(n):(n instanceof IDBTransaction&&s3(n),e3(n,t3())?new Proxy(n,q_):n)}function cr(n){if(n instanceof IDBRequest)return i3(n);if(e_.has(n))return e_.get(n);const e=o3(n);return e!==n&&(e_.set(n,e),G0.set(e,n)),e}const t_=n=>G0.get(n);function _m(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){const c=indexedDB.open(n,e),h=cr(c);return i&&c.addEventListener("upgradeneeded",f=>{i(cr(c.result),f.oldVersion,f.newVersion,cr(c.transaction),f)}),t&&c.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),h.then(f=>{o&&f.addEventListener("close",()=>o()),r&&f.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}function n_(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),cr(t).then(()=>{})}const l3=["get","getKey","getAll","getAllKeys","count"],c3=["put","add","delete","clear"],i_=new Map;function cE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(i_.get(e))return i_.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=c3.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||l3.includes(t)))return;const o=async function(c,...h){const f=this.transaction(c,r?"readwrite":"readonly");let m=f.store;return i&&(m=m.index(h.shift())),(await Promise.all([m[t](...h),r&&f.done]))[0]};return i_.set(e,o),o}r3(n=>({...n,get:(e,t,i)=>cE(e,t)||n.get(e,t,i),has:(e,t)=>!!cE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(h3(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function h3(n){const e=n.getComponent();return e?.type==="VERSION"}const H_="@firebase/app",uE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr=new gm("@firebase/app"),d3="@firebase/app-compat",f3="@firebase/analytics-compat",m3="@firebase/analytics",p3="@firebase/app-check-compat",g3="@firebase/app-check",_3="@firebase/auth",v3="@firebase/auth-compat",y3="@firebase/database",w3="@firebase/data-connect",b3="@firebase/database-compat",E3="@firebase/functions",T3="@firebase/functions-compat",S3="@firebase/installations",x3="@firebase/installations-compat",C3="@firebase/messaging",A3="@firebase/messaging-compat",I3="@firebase/performance",R3="@firebase/performance-compat",N3="@firebase/remote-config",k3="@firebase/remote-config-compat",O3="@firebase/storage",D3="@firebase/storage-compat",j3="@firebase/firestore",P3="@firebase/vertexai-preview",M3="@firebase/firestore-compat",L3="firebase",U3="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_="[DEFAULT]",V3={[H_]:"fire-core",[d3]:"fire-core-compat",[m3]:"fire-analytics",[f3]:"fire-analytics-compat",[g3]:"fire-app-check",[p3]:"fire-app-check-compat",[_3]:"fire-auth",[v3]:"fire-auth-compat",[y3]:"fire-rtdb",[w3]:"fire-data-connect",[b3]:"fire-rtdb-compat",[E3]:"fire-fn",[T3]:"fire-fn-compat",[S3]:"fire-iid",[x3]:"fire-iid-compat",[C3]:"fire-fcm",[A3]:"fire-fcm-compat",[I3]:"fire-perf",[R3]:"fire-perf-compat",[N3]:"fire-rc",[k3]:"fire-rc-compat",[O3]:"fire-gcs",[D3]:"fire-gcs-compat",[j3]:"fire-fst",[M3]:"fire-fst-compat",[P3]:"fire-vertex","fire-js":"fire-js",[L3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf=new Map,z3=new Map,G_=new Map;function hE(n,e){try{n.container.addComponent(e)}catch(t){fr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function os(n){const e=n.name;if(G_.has(e))return fr.debug(`There were multiple attempts to register component ${e}.`),!1;G_.set(e,n);for(const t of Nf.values())hE(t,n);for(const t of z3.values())hE(t,n);return!0}function No(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ts(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},va=new Ro("app","Firebase",B3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Hi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw va.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko=U3;function vS(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:$_,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw va.create("bad-app-name",{appName:String(r)});if(t||(t=lS()),!t)throw va.create("no-options");const o=Nf.get(r);if(o){if(Rf(t,o.options)&&Rf(i,o.config))return o;throw va.create("duplicate-app",{appName:r})}const c=new YN(r);for(const f of G_.values())c.addComponent(f);const h=new F3(t,i,c);return Nf.set(r,h),h}function vm(n=$_){const e=Nf.get(n);if(!e&&n===$_&&lS())return vS();if(!e)throw va.create("no-app",{appName:n});return e}function _i(n,e,t){var i;let r=(i=V3[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const o=r.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const h=[`Unable to register library "${r}" with version "${e}":`];o&&h.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&c&&h.push("and"),c&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fr.warn(h.join(" "));return}os(new Hi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3="firebase-heartbeat-database",H3=1,$u="firebase-heartbeat-store";let s_=null;function yS(){return s_||(s_=_m(q3,H3,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($u)}catch(t){console.warn(t)}}}}).catch(n=>{throw va.create("idb-open",{originalErrorMessage:n.message})})),s_}async function $3(n){try{const t=(await yS()).transaction($u),i=await t.objectStore($u).get(wS(n));return await t.done,i}catch(e){if(e instanceof Ns)fr.warn(e.message);else{const t=va.create("idb-get",{originalErrorMessage:e?.message});fr.warn(t.message)}}}async function dE(n,e){try{const i=(await yS()).transaction($u,"readwrite");await i.objectStore($u).put(e,wS(n)),await i.done}catch(t){if(t instanceof Ns)fr.warn(t.message);else{const i=va.create("idb-set",{originalErrorMessage:t?.message});fr.warn(i.message)}}}function wS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3=1024,K3=720*60*60*1e3;class W3{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Q3(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=fE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const h=new Date(c.date).valueOf();return Date.now()-h<=K3}),this._storage.overwrite(this._heartbeatsCache))}catch(i){fr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=fE(),{heartbeatsToSend:i,unsentEntries:r}=Y3(this._heartbeatsCache.heartbeats),o=Cf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return fr.warn(t),""}}}function fE(){return new Date().toISOString().substring(0,10)}function Y3(n,e=G3){const t=[];let i=n.slice();for(const r of n){const o=t.find(c=>c.agent===r.agent);if(o){if(o.dates.push(r.date),mE(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),mE(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Q3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dS()?fS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await $3(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return dE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return dE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function mE(n){return Cf(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(n){os(new Hi("platform-logger",e=>new u3(e),"PRIVATE")),os(new Hi("heartbeat",e=>new W3(e),"PRIVATE")),_i(H_,uE,n),_i(H_,uE,"esm2017"),_i("fire-js","")}X3("");function K0(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function bS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const J3=bS,ES=new Ro("auth","Firebase",bS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf=new gm("@firebase/auth");function Z3(n,...e){kf.logLevel<=ct.WARN&&kf.warn(`Auth (${ko}): ${n}`,...e)}function gf(n,...e){kf.logLevel<=ct.ERROR&&kf.error(`Auth (${ko}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n,...e){throw W0(n,...e)}function Ss(n,...e){return W0(n,...e)}function TS(n,e,t){const i=Object.assign(Object.assign({},J3()),{[e]:t});return new Ro("auth","Firebase",i).create(e,{appName:n.name})}function ur(n){return TS(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function W0(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ES.create(n,...e)}function Be(n,e,...t){if(!n)throw W0(e,...t)}function rr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw gf(e),new Error(e)}function mr(n,e){n||rr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function e6(){return pE()==="http:"||pE()==="https:"}function pE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(e6()||kN()||"connection"in navigator)?navigator.onLine:!0}function n6(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,t){this.shortDelay=e,this.longDelay=t,mr(t>e,"Short delay should be less than long delay!"),this.isMobile=$0()||hS()}get(){return t6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(n,e){mr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;rr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;rr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;rr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=new gh(3e4,6e4);function ka(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function wr(n,e,t,i,r={}){return xS(n,r,async()=>{let o={},c={};i&&(e==="GET"?c=i:o={body:JSON.stringify(i)});const h=hc(Object.assign({key:n.config.apiKey},c)).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:f},o);return NN()||(m.referrerPolicy="no-referrer"),SS.fetch()(CS(n,n.config.apiHost,t,h),m)})}async function xS(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},i6),e);try{const r=new a6(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw rf(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const h=o.ok?c.errorMessage:c.error.message,[f,m]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw rf(n,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw rf(n,"email-already-in-use",c);if(f==="USER_DISABLED")throw rf(n,"user-disabled",c);const v=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw TS(n,v,m);ls(n,v)}}catch(r){if(r instanceof Ns)throw r;ls(n,"network-request-failed",{message:String(r)})}}async function _h(n,e,t,i,r={}){const o=await wr(n,e,t,i,r);return"mfaPendingCredential"in o&&ls(n,"multi-factor-auth-required",{_serverResponse:o}),o}function CS(n,e,t,i){const r=`${e}${t}?${i}`;return n.config.emulator?Y0(n.config,r):`${n.config.apiScheme}://${r}`}function r6(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class a6{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ss(this.auth,"network-request-failed")),s6.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rf(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Ss(n,e,i);return r.customData._tokenResponse=t,r}function gE(n){return n!==void 0&&n.enterprise!==void 0}class o6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return r6(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function l6(n,e){return wr(n,"GET","/v2/recaptchaConfig",ka(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c6(n,e){return wr(n,"POST","/v1/accounts:delete",e)}async function AS(n,e){return wr(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function u6(n,e=!1){const t=Yt(n),i=await t.getIdToken(e),r=Q0(i);Be(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const o=typeof r.firebase=="object"?r.firebase:void 0,c=o?.sign_in_provider;return{claims:r,token:i,authTime:Ru(r_(r.auth_time)),issuedAtTime:Ru(r_(r.iat)),expirationTime:Ru(r_(r.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function r_(n){return Number(n)*1e3}function Q0(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return gf("JWT malformed, contained fewer than 3 sections"),null;try{const r=Af(t);return r?JSON.parse(r):(gf("Failed to decode base64 JWT payload"),null)}catch(r){return gf("Caught error parsing JWT payload as JSON",r?.toString()),null}}function _E(n){const e=Q0(n);return Be(e,"internal-error"),Be(typeof e.exp<"u","internal-error"),Be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ql(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ns&&h6(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function h6({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ru(this.lastLoginAt),this.creationTime=Ru(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Of(n){var e;const t=n.auth,i=await n.getIdToken(),r=await Ql(n,AS(t,{idToken:i}));Be(r?.users.length,t,"internal-error");const o=r.users[0];n._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?IS(o.providerUserInfo):[],h=m6(n.providerData,c),f=n.isAnonymous,m=!(n.email&&o.passwordHash)&&!h?.length,v=f?m:!1,w={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new W_(o.createdAt,o.lastLoginAt),isAnonymous:v};Object.assign(n,w)}async function f6(n){const e=Yt(n);await Of(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function m6(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function IS(n){return n.map(e=>{var{providerId:t}=e,i=K0(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p6(n,e){const t=await xS(n,{},async()=>{const i=hc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,c=CS(n,r,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",SS.fetch()(c,{method:"POST",headers:h,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function g6(n,e){return wr(n,"POST","/v2/accounts:revokeToken",ka(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Be(e.idToken,"internal-error"),Be(typeof e.idToken<"u","internal-error"),Be(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_E(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Be(e.length!==0,"internal-error");const t=_E(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:o}=await p6(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:o}=t,c=new Fl;return i&&(Be(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),r&&(Be(typeof r=="string","internal-error",{appName:e}),c.accessToken=r),o&&(Be(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fl,this.toJSON())}_performRefresh(){return rr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(n,e){Be(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ar{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,o=K0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new d6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new W_(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Ql(this,this.stsTokenManager.getToken(this.auth,e));return Be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return u6(this,e)}reload(){return f6(this)}_assign(e){this!==e&&(Be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ar(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Of(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ts(this.auth.app))return Promise.reject(ur(this.auth));const e=await this.getIdToken();return await Ql(this,c6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,o,c,h,f,m,v;const w=(i=t.displayName)!==null&&i!==void 0?i:void 0,T=(r=t.email)!==null&&r!==void 0?r:void 0,x=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,N=(c=t.photoURL)!==null&&c!==void 0?c:void 0,L=(h=t.tenantId)!==null&&h!==void 0?h:void 0,O=(f=t._redirectEventId)!==null&&f!==void 0?f:void 0,Z=(m=t.createdAt)!==null&&m!==void 0?m:void 0,Y=(v=t.lastLoginAt)!==null&&v!==void 0?v:void 0,{uid:H,emailVerified:le,isAnonymous:ve,providerData:oe,stsTokenManager:I}=t;Be(H&&I,e,"internal-error");const A=Fl.fromJSON(this.name,I);Be(typeof H=="string",e,"internal-error"),oa(w,e.name),oa(T,e.name),Be(typeof le=="boolean",e,"internal-error"),Be(typeof ve=="boolean",e,"internal-error"),oa(x,e.name),oa(N,e.name),oa(L,e.name),oa(O,e.name),oa(Z,e.name),oa(Y,e.name);const R=new ar({uid:H,auth:e,email:T,emailVerified:le,displayName:w,isAnonymous:ve,photoURL:N,phoneNumber:x,tenantId:L,stsTokenManager:A,createdAt:Z,lastLoginAt:Y});return oe&&Array.isArray(oe)&&(R.providerData=oe.map(U=>Object.assign({},U))),O&&(R._redirectEventId=O),R}static async _fromIdTokenResponse(e,t,i=!1){const r=new Fl;r.updateFromServerResponse(t);const o=new ar({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Of(o),o}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Be(r.localId!==void 0,"internal-error");const o=r.providerUserInfo!==void 0?IS(r.providerUserInfo):[],c=!(r.email&&r.passwordHash)&&!o?.length,h=new Fl;h.updateFromIdToken(i);const f=new ar({uid:r.localId,auth:e,stsTokenManager:h,isAnonymous:c}),m={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new W_(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE=new Map;function or(n){mr(n instanceof Function,"Expected a class definition");let e=vE.get(n);return e?(mr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,vE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}RS.type="NONE";const yE=RS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(n,e,t){return`firebase:${n}:${e}:${t}`}class ql{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:o}=this.auth;this.fullUserKey=_f(this.userKey,r.apiKey,o),this.fullPersistenceKey=_f("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ar._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ql(or(yE),e,i);const r=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=r[0]||or(yE);const c=_f(i,e.config.apiKey,e.name);let h=null;for(const m of t)try{const v=await m._get(c);if(v){const w=ar._fromJSON(e,v);m!==o&&(h=w),o=m;break}}catch{}const f=r.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new ql(o,e,i):(o=f[0],h&&await o._set(c,h.toJSON()),await Promise.all(t.map(async m=>{if(m!==o)try{await m._remove(c)}catch{}})),new ql(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(PS(e))return"Blackberry";if(MS(e))return"Webos";if(kS(e))return"Safari";if((e.includes("chrome/")||OS(e))&&!e.includes("edge/"))return"Chrome";if(jS(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function NS(n=ei()){return/firefox\//i.test(n)}function kS(n=ei()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OS(n=ei()){return/crios\//i.test(n)}function DS(n=ei()){return/iemobile/i.test(n)}function jS(n=ei()){return/android/i.test(n)}function PS(n=ei()){return/blackberry/i.test(n)}function MS(n=ei()){return/webos/i.test(n)}function X0(n=ei()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function _6(n=ei()){var e;return X0(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function v6(){return ON()&&document.documentMode===10}function LS(n=ei()){return X0(n)||jS(n)||MS(n)||PS(n)||/windows phone/i.test(n)||DS(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(n,e=[]){let t;switch(n){case"Browser":t=wE(ei());break;case"Worker":t=`${wE(ei())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ko}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((c,h)=>{try{const f=e(o);c(f)}catch(f){h(f)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w6(n,e={}){return wr(n,"GET","/v2/passwordPolicy",ka(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6=6;class E6{constructor(e){var t,i,r,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:b6,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,o,c,h;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(t=f.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),f.isValid&&(f.isValid=(i=f.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),f.isValid&&(f.isValid=(r=f.containsLowercaseLetter)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(o=f.containsUppercaseLetter)!==null&&o!==void 0?o:!0),f.isValid&&(f.isValid=(c=f.containsNumericCharacter)!==null&&c!==void 0?c:!0),f.isValid&&(f.isValid=(h=f.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),f}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bE(this),this.idTokenSubscription=new bE(this),this.beforeStateQueue=new y6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ES,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=or(t)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await ql.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await AS(this,{idToken:e}),i=await ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ts(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,h=r?._redirectEventId,f=await this.tryRedirectSignIn(e);(!c||c===h)&&f?.user&&(r=f.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(c){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Of(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=n6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ts(this.app))return Promise.reject(ur(this));const t=e?Yt(e):null;return t&&Be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ts(this.app)?Promise.reject(ur(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ts(this.app)?Promise.reject(ur(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await w6(this),t=new E6(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ro("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await g6(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&or(e)||this._popupRedirectResolver;Be(t,this,"argument-error"),this.redirectPersistenceManager=await ql.create(this,[or(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Be(h,this,"internal-error"),h.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,i,r);return()=>{c=!0,f()}}else{const f=e.addObserver(t);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=US(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&Z3(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Oo(n){return Yt(n)}class bE{constructor(e){this.auth=e,this.observer=null,this.addObserver=FN(t=>this.observer=t)}get next(){return Be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ym={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function S6(n){ym=n}function VS(n){return ym.loadJS(n)}function x6(){return ym.recaptchaEnterpriseScript}function C6(){return ym.gapiScript}function A6(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const I6="recaptcha-enterprise",R6="NO_RECAPTCHA";class N6{constructor(e){this.type=I6,this.auth=Oo(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,h)=>{l6(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new o6(f);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,c(m.siteKey)}}).catch(f=>{h(f)})})}function r(o,c,h){const f=window.grecaptcha;gE(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(m=>{c(m)}).catch(()=>{c(R6)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,c)=>{i(this.auth).then(h=>{if(!t&&gE(window.grecaptcha))r(h,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=x6();f.length!==0&&(f+=h),VS(f).then(()=>{r(h,o,c)}).catch(m=>{c(m)})}}).catch(h=>{c(h)})})}}async function EE(n,e,t,i=!1){const r=new N6(n);let o;try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const c=Object.assign({},e);return i?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Y_(n,e,t,i){var r;if(!((r=n._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await EE(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await EE(n,e,t,t==="getOobCode");return i(n,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k6(n,e){const t=No(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),o=t.getOptions();if(Rf(o,e??{}))return r;ls(r,"already-initialized")}return t.initialize({options:e})}function O6(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(or);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function D6(n,e,t){const i=Oo(n);Be(i._canInitEmulator,i,"emulator-config-failed"),Be(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,o=zS(e),{host:c,port:h}=j6(e),f=h===null?"":`:${h}`;i.config.emulator={url:`${o}//${c}${f}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:c,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})}),P6()}function zS(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function j6(n){const e=zS(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const o=r[1];return{host:o,port:TE(i.substr(o.length+1))}}else{const[o,c]=i.split(":");return{host:o,port:TE(c)}}}function TE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function P6(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return rr("not implemented")}_getIdTokenResponse(e){return rr("not implemented")}_linkToIdToken(e,t){return rr("not implemented")}_getReauthenticationResolver(e){return rr("not implemented")}}async function M6(n,e){return wr(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L6(n,e){return _h(n,"POST","/v1/accounts:signInWithPassword",ka(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U6(n,e){return _h(n,"POST","/v1/accounts:signInWithEmailLink",ka(n,e))}async function V6(n,e){return _h(n,"POST","/v1/accounts:signInWithEmailLink",ka(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu extends J0{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Gu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Gu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Y_(e,t,"signInWithPassword",L6);case"emailLink":return U6(e,{email:this._email,oobCode:this._password});default:ls(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Y_(e,i,"signUpPassword",M6);case"emailLink":return V6(e,{idToken:t,email:this._email,oobCode:this._password});default:ls(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hl(n,e){return _h(n,"POST","/v1/accounts:signInWithIdp",ka(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6="http://localhost";class yo extends J0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ls("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,o=K0(t,["providerId","signInMethod"]);if(!i||!r)return null;const c=new yo(i,r);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Hl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hl(e,t)}buildRequest(){const e={requestUri:z6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=hc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function F6(n){const e=Tu(Su(n)).link,t=e?Tu(Su(e)).deep_link_id:null,i=Tu(Su(n)).deep_link_id;return(i?Tu(Su(i)).link:null)||i||t||e||n}class Z0{constructor(e){var t,i,r,o,c,h;const f=Tu(Su(e)),m=(t=f.apiKey)!==null&&t!==void 0?t:null,v=(i=f.oobCode)!==null&&i!==void 0?i:null,w=B6((r=f.mode)!==null&&r!==void 0?r:null);Be(m&&v&&w,"argument-error"),this.apiKey=m,this.operation=w,this.code=v,this.continueUrl=(o=f.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=f.languageCode)!==null&&c!==void 0?c:null,this.tenantId=(h=f.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const t=F6(e);try{return new Z0(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(){this.providerId=dc.PROVIDER_ID}static credential(e,t){return Gu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Z0.parseLink(t);return Be(i,"argument-error"),Gu._fromEmailAndCode(e,i.code,i.tenantId)}}dc.PROVIDER_ID="password";dc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";dc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh extends BS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua extends vh{constructor(){super("facebook.com")}static credential(e){return yo._fromParams({providerId:ua.PROVIDER_ID,signInMethod:ua.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ua.credentialFromTaggedObject(e)}static credentialFromError(e){return ua.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ua.credential(e.oauthAccessToken)}catch{return null}}}ua.FACEBOOK_SIGN_IN_METHOD="facebook.com";ua.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha extends vh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yo._fromParams({providerId:ha.PROVIDER_ID,signInMethod:ha.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ha.credentialFromTaggedObject(e)}static credentialFromError(e){return ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ha.credential(t,i)}catch{return null}}}ha.GOOGLE_SIGN_IN_METHOD="google.com";ha.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends vh{constructor(){super("github.com")}static credential(e){return yo._fromParams({providerId:da.PROVIDER_ID,signInMethod:da.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return da.credentialFromTaggedObject(e)}static credentialFromError(e){return da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return da.credential(e.oauthAccessToken)}catch{return null}}}da.GITHUB_SIGN_IN_METHOD="github.com";da.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa extends vh{constructor(){super("twitter.com")}static credential(e,t){return yo._fromParams({providerId:fa.PROVIDER_ID,signInMethod:fa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return fa.credentialFromTaggedObject(e)}static credentialFromError(e){return fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return fa.credential(t,i)}catch{return null}}}fa.TWITTER_SIGN_IN_METHOD="twitter.com";fa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q6(n,e){return _h(n,"POST","/v1/accounts:signUp",ka(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const o=await ar._fromIdTokenResponse(e,i,r),c=SE(i);return new wo({user:o,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=SE(i);return new wo({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function SE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df extends Ns{constructor(e,t,i,r){var o;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Df.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Df(e,t,i,r)}}function FS(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Df._fromErrorAndOperation(n,o,e,i):o})}async function H6(n,e,t=!1){const i=await Ql(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $6(n,e,t=!1){const{auth:i}=n;if(Ts(i.app))return Promise.reject(ur(i));const r="reauthenticate";try{const o=await Ql(n,FS(i,r,e,n),t);Be(o.idToken,i,"internal-error");const c=Q0(o.idToken);Be(c,i,"internal-error");const{sub:h}=c;return Be(n.uid===h,i,"user-mismatch"),wo._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&ls(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qS(n,e,t=!1){if(Ts(n.app))return Promise.reject(ur(n));const i="signIn",r=await FS(n,i,e),o=await wo._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}async function G6(n,e){return qS(Oo(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HS(n){const e=Oo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function K6(n,e,t){if(Ts(n.app))return Promise.reject(ur(n));const i=Oo(n),c=await Y_(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",q6).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&HS(n),f}),h=await wo._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(h.user),h}function W6(n,e,t){return Ts(n.app)?Promise.reject(ur(n)):G6(Yt(n),dc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&HS(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y6(n,e){return wr(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q6(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=Yt(n),o={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await Ql(i,Y6(i.auth,o));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const h=i.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=i.displayName,h.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X6(n,e){return Yt(n).setPersistence(e)}function J6(n,e,t,i){return Yt(n).onIdTokenChanged(e,t,i)}function Z6(n,e,t){return Yt(n).beforeAuthStateChanged(e,t)}const jf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(jf,"1"),this.storage.removeItem(jf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=1e3,tk=10;class GS extends $S{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=LS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,h,f)=>{this.notifyListeners(c,f)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);v6()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,tk):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},ek)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}GS.type="LOCAL";const nk=GS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS extends $S{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}KS.type="SESSION";const ev=KS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new wm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:o}=t.data,c=this.handlersMap[r];if(!c?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const h=Array.from(c).map(async m=>m(t.origin,o)),f=await ik(h);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,c;return new Promise((h,f)=>{const m=tv("",20);r.port1.start();const v=setTimeout(()=>{f(new Error("unsupported_event"))},i);c={messageChannel:r,onMessage(w){const T=w;if(T.data.eventId===m)switch(T.data.status){case"ack":clearTimeout(v),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(T.data.response);break;default:clearTimeout(v),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(c),r.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[r.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(){return window}function rk(n){xs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WS(){return typeof xs().WorkerGlobalScope<"u"&&typeof xs().importScripts=="function"}async function ak(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ok(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function lk(){return WS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="firebaseLocalStorageDb",ck=1,Pf="firebaseLocalStorage",QS="fbase_key";class yh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function bm(n,e){return n.transaction([Pf],e?"readwrite":"readonly").objectStore(Pf)}function uk(){const n=indexedDB.deleteDatabase(YS);return new yh(n).toPromise()}function Q_(){const n=indexedDB.open(YS,ck);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Pf,{keyPath:QS})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Pf)?e(i):(i.close(),await uk(),e(await Q_()))})})}async function xE(n,e,t){const i=bm(n,!0).put({[QS]:e,value:t});return new yh(i).toPromise()}async function hk(n,e){const t=bm(n,!1).get(e),i=await new yh(t).toPromise();return i===void 0?null:i.value}function CE(n,e){const t=bm(n,!0).delete(e);return new yh(t).toPromise()}const dk=800,fk=3;class XS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Q_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>fk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return WS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wm._getInstance(lk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await ak(),!this.activeServiceWorker)return;this.sender=new sk(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ok()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Q_();return await xE(e,jf,"1"),await CE(e,jf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>xE(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>hk(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>CE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const o=bm(r,!1).getAll();return new yh(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:o}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XS.type="LOCAL";const mk=XS;new gh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(n,e){return e?or(e):(Be(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv extends J0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function gk(n){return qS(n.auth,new nv(n),n.bypassAuthState)}function _k(n){const{auth:e,user:t}=n;return Be(t,e,"internal-error"),$6(t,new nv(n),n.bypassAuthState)}async function vk(n){const{auth:e,user:t}=n;return Be(t,e,"internal-error"),H6(t,new nv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:c,type:h}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return gk;case"linkViaPopup":case"linkViaRedirect":return vk;case"reauthViaPopup":case"reauthViaRedirect":return _k;default:ls(this.auth,"internal-error")}}resolve(e){mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk=new gh(2e3,1e4);class Vl extends JS{constructor(e,t,i,r,o){super(e,t,r,o),this.provider=i,this.authWindow=null,this.pollId=null,Vl.currentPopupAction&&Vl.currentPopupAction.cancel(),Vl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Be(e,this.auth,"internal-error"),e}async onExecution(){mr(this.filter.length===1,"Popup operations only handle one event");const e=tv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ss(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ss(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ss(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,yk.get())};e()}}Vl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk="pendingRedirect",vf=new Map;class bk extends JS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=vf.get(this.auth._key());if(!e){try{const i=await Ek(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}vf.set(this.auth._key(),e)}return this.bypassAuthState||vf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ek(n,e){const t=xk(e),i=Sk(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function Tk(n,e){vf.set(n._key(),e)}function Sk(n){return or(n._redirectPersistence)}function xk(n){return _f(wk,n.config.apiKey,n.name)}async function Ck(n,e,t=!1){if(Ts(n.app))return Promise.reject(ur(n));const i=Oo(n),r=pk(i,e),c=await new bk(i,r,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=600*1e3;class Ik{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Rk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!ZS(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Ss(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ak&&this.cachedEventUids.clear(),this.cachedEventUids.has(AE(e))}saveEventToCache(e){this.cachedEventUids.add(AE(e)),this.lastProcessedEventTime=Date.now()}}function AE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ZS({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Rk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nk(n,e={}){return wr(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ok=/^https?/;async function Dk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Nk(n);for(const t of e)try{if(jk(t))return}catch{}ls(n,"unauthorized-domain")}function jk(n){const e=K_(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!Ok.test(t))return!1;if(kk.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=new gh(3e4,6e4);function IE(){const n=xs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Mk(n){return new Promise((e,t)=>{var i,r,o;function c(){IE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{IE(),t(Ss(n,"network-request-failed"))},timeout:Pk.get()})}if(!((r=(i=xs().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((o=xs().gapi)===null||o===void 0)&&o.load)c();else{const h=A6("iframefcb");return xs()[h]=()=>{gapi.load?c():t(Ss(n,"network-request-failed"))},VS(`${C6()}?onload=${h}`).catch(f=>t(f))}}).catch(e=>{throw yf=null,e})}let yf=null;function Lk(n){return yf=yf||Mk(n),yf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk=new gh(5e3,15e3),Vk="__/auth/iframe",zk="emulator/auth/iframe",Bk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Fk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qk(n){const e=n.config;Be(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Y0(e,zk):`https://${n.config.authDomain}/${Vk}`,i={apiKey:e.apiKey,appName:n.name,v:ko},r=Fk.get(n.config.apiHost);r&&(i.eid=r);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${hc(i).slice(1)}`}async function Hk(n){const e=await Lk(n),t=xs().gapi;return Be(t,n,"internal-error"),e.open({where:document.body,url:qk(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Bk,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});const c=Ss(n,"network-request-failed"),h=xs().setTimeout(()=>{o(c)},Uk.get());function f(){xs().clearTimeout(h),r(i)}i.ping(f).then(f,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Gk=500,Kk=600,Wk="_blank",Yk="http://localhost";class RE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Qk(n,e,t,i=Gk,r=Kk){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const f=Object.assign(Object.assign({},$k),{width:i.toString(),height:r.toString(),top:o,left:c}),m=ei().toLowerCase();t&&(h=OS(m)?Wk:t),NS(m)&&(e=e||Yk,f.scrollbars="yes");const v=Object.entries(f).reduce((T,[x,N])=>`${T}${x}=${N},`,"");if(_6(m)&&h!=="_self")return Xk(e||"",h),new RE(null);const w=window.open(e||"",h,v);Be(w,n,"popup-blocked");try{w.focus()}catch{}return new RE(w)}function Xk(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk="__/auth/handler",Zk="emulator/auth/handler",eO=encodeURIComponent("fac");async function NE(n,e,t,i,r,o){Be(n.config.authDomain,n,"auth-domain-config-required"),Be(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ko,eventId:r};if(e instanceof BS){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",B_(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,w]of Object.entries({}))c[v]=w}if(e instanceof vh){const v=e.getScopes().filter(w=>w!=="");v.length>0&&(c.scopes=v.join(","))}n.tenantId&&(c.tid=n.tenantId);const h=c;for(const v of Object.keys(h))h[v]===void 0&&delete h[v];const f=await n._getAppCheckToken(),m=f?`#${eO}=${encodeURIComponent(f)}`:"";return`${tO(n)}?${hc(h).slice(1)}${m}`}function tO({config:n}){return n.emulator?Y0(n,Zk):`https://${n.authDomain}/${Jk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_="webStorageSupport";class nO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ev,this._completeRedirectFn=Ck,this._overrideRedirectResult=Tk}async _openPopup(e,t,i,r){var o;mr((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await NE(e,t,i,K_(),r);return Qk(e,c,tv())}async _openRedirect(e,t,i,r){await this._originValidation(e);const o=await NE(e,t,i,K_(),r);return rk(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(mr(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Hk(e),i=new Ik(e);return t.register("authEvent",r=>(Be(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(a_,{type:a_},r=>{var o;const c=(o=r?.[0])===null||o===void 0?void 0:o[a_];c!==void 0&&t(!!c),ls(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Dk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return LS()||kS()||X0()}}const iO=nO;var kE="@firebase/auth",OE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aO(n){os(new Hi("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;Be(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:c,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:US(n)},m=new T6(i,r,o,f);return O6(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),os(new Hi("auth-internal",e=>{const t=Oo(e.getProvider("auth").getImmediate());return(i=>new sO(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),_i(kE,OE,rO(n)),_i(kE,OE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=300,lO=cS("authIdTokenMaxAge")||oO;let DE=null;const cO=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>lO)return;const r=t?.token;DE!==r&&(DE=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function uO(n=vm()){const e=No(n,"auth");if(e.isInitialized())return e.getImmediate();const t=k6(n,{popupRedirectResolver:iO,persistence:[mk,nk,ev]}),i=cS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const c=cO(o.toString());Z6(t,c,()=>c(t.currentUser)),J6(t,h=>c(h))}}const r=aS("auth");return r&&D6(t,`http://${r}`),t}function hO(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}S6({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const o=Ss("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",hO().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aO("Browser");var dO="firebase",fO="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_i(dO,fO,"app");var jE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vo,ex;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,A){function R(){}R.prototype=A.prototype,I.D=A.prototype,I.prototype=new R,I.prototype.constructor=I,I.C=function(U,V,F){for(var k=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)k[ge-2]=arguments[ge];return A.prototype[V].apply(U,k)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(I,A,R){R||(R=0);var U=Array(16);if(typeof A=="string")for(var V=0;16>V;++V)U[V]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(V=0;16>V;++V)U[V]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=I.g[0],R=I.g[1],V=I.g[2];var F=I.g[3],k=A+(F^R&(V^F))+U[0]+3614090360&4294967295;A=R+(k<<7&4294967295|k>>>25),k=F+(V^A&(R^V))+U[1]+3905402710&4294967295,F=A+(k<<12&4294967295|k>>>20),k=V+(R^F&(A^R))+U[2]+606105819&4294967295,V=F+(k<<17&4294967295|k>>>15),k=R+(A^V&(F^A))+U[3]+3250441966&4294967295,R=V+(k<<22&4294967295|k>>>10),k=A+(F^R&(V^F))+U[4]+4118548399&4294967295,A=R+(k<<7&4294967295|k>>>25),k=F+(V^A&(R^V))+U[5]+1200080426&4294967295,F=A+(k<<12&4294967295|k>>>20),k=V+(R^F&(A^R))+U[6]+2821735955&4294967295,V=F+(k<<17&4294967295|k>>>15),k=R+(A^V&(F^A))+U[7]+4249261313&4294967295,R=V+(k<<22&4294967295|k>>>10),k=A+(F^R&(V^F))+U[8]+1770035416&4294967295,A=R+(k<<7&4294967295|k>>>25),k=F+(V^A&(R^V))+U[9]+2336552879&4294967295,F=A+(k<<12&4294967295|k>>>20),k=V+(R^F&(A^R))+U[10]+4294925233&4294967295,V=F+(k<<17&4294967295|k>>>15),k=R+(A^V&(F^A))+U[11]+2304563134&4294967295,R=V+(k<<22&4294967295|k>>>10),k=A+(F^R&(V^F))+U[12]+1804603682&4294967295,A=R+(k<<7&4294967295|k>>>25),k=F+(V^A&(R^V))+U[13]+4254626195&4294967295,F=A+(k<<12&4294967295|k>>>20),k=V+(R^F&(A^R))+U[14]+2792965006&4294967295,V=F+(k<<17&4294967295|k>>>15),k=R+(A^V&(F^A))+U[15]+1236535329&4294967295,R=V+(k<<22&4294967295|k>>>10),k=A+(V^F&(R^V))+U[1]+4129170786&4294967295,A=R+(k<<5&4294967295|k>>>27),k=F+(R^V&(A^R))+U[6]+3225465664&4294967295,F=A+(k<<9&4294967295|k>>>23),k=V+(A^R&(F^A))+U[11]+643717713&4294967295,V=F+(k<<14&4294967295|k>>>18),k=R+(F^A&(V^F))+U[0]+3921069994&4294967295,R=V+(k<<20&4294967295|k>>>12),k=A+(V^F&(R^V))+U[5]+3593408605&4294967295,A=R+(k<<5&4294967295|k>>>27),k=F+(R^V&(A^R))+U[10]+38016083&4294967295,F=A+(k<<9&4294967295|k>>>23),k=V+(A^R&(F^A))+U[15]+3634488961&4294967295,V=F+(k<<14&4294967295|k>>>18),k=R+(F^A&(V^F))+U[4]+3889429448&4294967295,R=V+(k<<20&4294967295|k>>>12),k=A+(V^F&(R^V))+U[9]+568446438&4294967295,A=R+(k<<5&4294967295|k>>>27),k=F+(R^V&(A^R))+U[14]+3275163606&4294967295,F=A+(k<<9&4294967295|k>>>23),k=V+(A^R&(F^A))+U[3]+4107603335&4294967295,V=F+(k<<14&4294967295|k>>>18),k=R+(F^A&(V^F))+U[8]+1163531501&4294967295,R=V+(k<<20&4294967295|k>>>12),k=A+(V^F&(R^V))+U[13]+2850285829&4294967295,A=R+(k<<5&4294967295|k>>>27),k=F+(R^V&(A^R))+U[2]+4243563512&4294967295,F=A+(k<<9&4294967295|k>>>23),k=V+(A^R&(F^A))+U[7]+1735328473&4294967295,V=F+(k<<14&4294967295|k>>>18),k=R+(F^A&(V^F))+U[12]+2368359562&4294967295,R=V+(k<<20&4294967295|k>>>12),k=A+(R^V^F)+U[5]+4294588738&4294967295,A=R+(k<<4&4294967295|k>>>28),k=F+(A^R^V)+U[8]+2272392833&4294967295,F=A+(k<<11&4294967295|k>>>21),k=V+(F^A^R)+U[11]+1839030562&4294967295,V=F+(k<<16&4294967295|k>>>16),k=R+(V^F^A)+U[14]+4259657740&4294967295,R=V+(k<<23&4294967295|k>>>9),k=A+(R^V^F)+U[1]+2763975236&4294967295,A=R+(k<<4&4294967295|k>>>28),k=F+(A^R^V)+U[4]+1272893353&4294967295,F=A+(k<<11&4294967295|k>>>21),k=V+(F^A^R)+U[7]+4139469664&4294967295,V=F+(k<<16&4294967295|k>>>16),k=R+(V^F^A)+U[10]+3200236656&4294967295,R=V+(k<<23&4294967295|k>>>9),k=A+(R^V^F)+U[13]+681279174&4294967295,A=R+(k<<4&4294967295|k>>>28),k=F+(A^R^V)+U[0]+3936430074&4294967295,F=A+(k<<11&4294967295|k>>>21),k=V+(F^A^R)+U[3]+3572445317&4294967295,V=F+(k<<16&4294967295|k>>>16),k=R+(V^F^A)+U[6]+76029189&4294967295,R=V+(k<<23&4294967295|k>>>9),k=A+(R^V^F)+U[9]+3654602809&4294967295,A=R+(k<<4&4294967295|k>>>28),k=F+(A^R^V)+U[12]+3873151461&4294967295,F=A+(k<<11&4294967295|k>>>21),k=V+(F^A^R)+U[15]+530742520&4294967295,V=F+(k<<16&4294967295|k>>>16),k=R+(V^F^A)+U[2]+3299628645&4294967295,R=V+(k<<23&4294967295|k>>>9),k=A+(V^(R|~F))+U[0]+4096336452&4294967295,A=R+(k<<6&4294967295|k>>>26),k=F+(R^(A|~V))+U[7]+1126891415&4294967295,F=A+(k<<10&4294967295|k>>>22),k=V+(A^(F|~R))+U[14]+2878612391&4294967295,V=F+(k<<15&4294967295|k>>>17),k=R+(F^(V|~A))+U[5]+4237533241&4294967295,R=V+(k<<21&4294967295|k>>>11),k=A+(V^(R|~F))+U[12]+1700485571&4294967295,A=R+(k<<6&4294967295|k>>>26),k=F+(R^(A|~V))+U[3]+2399980690&4294967295,F=A+(k<<10&4294967295|k>>>22),k=V+(A^(F|~R))+U[10]+4293915773&4294967295,V=F+(k<<15&4294967295|k>>>17),k=R+(F^(V|~A))+U[1]+2240044497&4294967295,R=V+(k<<21&4294967295|k>>>11),k=A+(V^(R|~F))+U[8]+1873313359&4294967295,A=R+(k<<6&4294967295|k>>>26),k=F+(R^(A|~V))+U[15]+4264355552&4294967295,F=A+(k<<10&4294967295|k>>>22),k=V+(A^(F|~R))+U[6]+2734768916&4294967295,V=F+(k<<15&4294967295|k>>>17),k=R+(F^(V|~A))+U[13]+1309151649&4294967295,R=V+(k<<21&4294967295|k>>>11),k=A+(V^(R|~F))+U[4]+4149444226&4294967295,A=R+(k<<6&4294967295|k>>>26),k=F+(R^(A|~V))+U[11]+3174756917&4294967295,F=A+(k<<10&4294967295|k>>>22),k=V+(A^(F|~R))+U[2]+718787259&4294967295,V=F+(k<<15&4294967295|k>>>17),k=R+(F^(V|~A))+U[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(V+(k<<21&4294967295|k>>>11))&4294967295,I.g[2]=I.g[2]+V&4294967295,I.g[3]=I.g[3]+F&4294967295}i.prototype.u=function(I,A){A===void 0&&(A=I.length);for(var R=A-this.blockSize,U=this.B,V=this.h,F=0;F<A;){if(V==0)for(;F<=R;)r(this,I,F),F+=this.blockSize;if(typeof I=="string"){for(;F<A;)if(U[V++]=I.charCodeAt(F++),V==this.blockSize){r(this,U),V=0;break}}else for(;F<A;)if(U[V++]=I[F++],V==this.blockSize){r(this,U),V=0;break}}this.h=V,this.o+=A},i.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;var R=8*this.o;for(A=I.length-8;A<I.length;++A)I[A]=R&255,R/=256;for(this.u(I),I=Array(16),A=R=0;4>A;++A)for(var U=0;32>U;U+=8)I[R++]=this.g[A]>>>U&255;return I};function o(I,A){var R=h;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=A(I)}function c(I,A){this.h=A;for(var R=[],U=!0,V=I.length-1;0<=V;V--){var F=I[V]|0;U&&F==A||(R[V]=F,U=!1)}this.g=R}var h={};function f(I){return-128<=I&&128>I?o(I,function(A){return new c([A|0],0>A?-1:0)}):new c([I|0],0>I?-1:0)}function m(I){if(isNaN(I)||!isFinite(I))return w;if(0>I)return O(m(-I));for(var A=[],R=1,U=0;I>=R;U++)A[U]=I/R|0,R*=4294967296;return new c(A,0)}function v(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return O(v(I.substring(1),A));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(A,8)),U=w,V=0;V<I.length;V+=8){var F=Math.min(8,I.length-V),k=parseInt(I.substring(V,V+F),A);8>F?(F=m(Math.pow(A,F)),U=U.j(F).add(m(k))):(U=U.j(R),U=U.add(m(k)))}return U}var w=f(0),T=f(1),x=f(16777216);n=c.prototype,n.m=function(){if(L(this))return-O(this).m();for(var I=0,A=1,R=0;R<this.g.length;R++){var U=this.i(R);I+=(0<=U?U:4294967296+U)*A,A*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(N(this))return"0";if(L(this))return"-"+O(this).toString(I);for(var A=m(Math.pow(I,6)),R=this,U="";;){var V=le(R,A).g;R=Z(R,V.j(A));var F=((0<R.g.length?R.g[0]:R.h)>>>0).toString(I);if(R=V,N(R))return F+U;for(;6>F.length;)F="0"+F;U=F+U}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function N(I){if(I.h!=0)return!1;for(var A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function L(I){return I.h==-1}n.l=function(I){return I=Z(this,I),L(I)?-1:N(I)?0:1};function O(I){for(var A=I.g.length,R=[],U=0;U<A;U++)R[U]=~I.g[U];return new c(R,~I.h).add(T)}n.abs=function(){return L(this)?O(this):this},n.add=function(I){for(var A=Math.max(this.g.length,I.g.length),R=[],U=0,V=0;V<=A;V++){var F=U+(this.i(V)&65535)+(I.i(V)&65535),k=(F>>>16)+(this.i(V)>>>16)+(I.i(V)>>>16);U=k>>>16,F&=65535,k&=65535,R[V]=k<<16|F}return new c(R,R[R.length-1]&-2147483648?-1:0)};function Z(I,A){return I.add(O(A))}n.j=function(I){if(N(this)||N(I))return w;if(L(this))return L(I)?O(this).j(O(I)):O(O(this).j(I));if(L(I))return O(this.j(O(I)));if(0>this.l(x)&&0>I.l(x))return m(this.m()*I.m());for(var A=this.g.length+I.g.length,R=[],U=0;U<2*A;U++)R[U]=0;for(U=0;U<this.g.length;U++)for(var V=0;V<I.g.length;V++){var F=this.i(U)>>>16,k=this.i(U)&65535,ge=I.i(V)>>>16,Se=I.i(V)&65535;R[2*U+2*V]+=k*Se,Y(R,2*U+2*V),R[2*U+2*V+1]+=F*Se,Y(R,2*U+2*V+1),R[2*U+2*V+1]+=k*ge,Y(R,2*U+2*V+1),R[2*U+2*V+2]+=F*ge,Y(R,2*U+2*V+2)}for(U=0;U<A;U++)R[U]=R[2*U+1]<<16|R[2*U];for(U=A;U<2*A;U++)R[U]=0;return new c(R,0)};function Y(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function H(I,A){this.g=I,this.h=A}function le(I,A){if(N(A))throw Error("division by zero");if(N(I))return new H(w,w);if(L(I))return A=le(O(I),A),new H(O(A.g),O(A.h));if(L(A))return A=le(I,O(A)),new H(O(A.g),A.h);if(30<I.g.length){if(L(I)||L(A))throw Error("slowDivide_ only works with positive integers.");for(var R=T,U=A;0>=U.l(I);)R=ve(R),U=ve(U);var V=oe(R,1),F=oe(U,1);for(U=oe(U,2),R=oe(R,2);!N(U);){var k=F.add(U);0>=k.l(I)&&(V=V.add(R),F=k),U=oe(U,1),R=oe(R,1)}return A=Z(I,V.j(A)),new H(V,A)}for(V=w;0<=I.l(A);){for(R=Math.max(1,Math.floor(I.m()/A.m())),U=Math.ceil(Math.log(R)/Math.LN2),U=48>=U?1:Math.pow(2,U-48),F=m(R),k=F.j(A);L(k)||0<k.l(I);)R-=U,F=m(R),k=F.j(A);N(F)&&(F=T),V=V.add(F),I=Z(I,k)}return new H(V,I)}n.A=function(I){return le(this,I).h},n.and=function(I){for(var A=Math.max(this.g.length,I.g.length),R=[],U=0;U<A;U++)R[U]=this.i(U)&I.i(U);return new c(R,this.h&I.h)},n.or=function(I){for(var A=Math.max(this.g.length,I.g.length),R=[],U=0;U<A;U++)R[U]=this.i(U)|I.i(U);return new c(R,this.h|I.h)},n.xor=function(I){for(var A=Math.max(this.g.length,I.g.length),R=[],U=0;U<A;U++)R[U]=this.i(U)^I.i(U);return new c(R,this.h^I.h)};function ve(I){for(var A=I.g.length+1,R=[],U=0;U<A;U++)R[U]=I.i(U)<<1|I.i(U-1)>>>31;return new c(R,I.h)}function oe(I,A){var R=A>>5;A%=32;for(var U=I.g.length-R,V=[],F=0;F<U;F++)V[F]=0<A?I.i(F+R)>>>A|I.i(F+R+1)<<32-A:I.i(F+R);return new c(V,I.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,ex=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=v,vo=c}).apply(typeof jE<"u"?jE:typeof self<"u"?self:typeof window<"u"?window:{});var af=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var tx,xu,nx,wf,X_,ix,sx,rx;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,y,E){return d==Array.prototype||d==Object.prototype||(d[y]=E.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof af=="object"&&af];for(var y=0;y<d.length;++y){var E=d[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function r(d,y){if(y)e:{var E=i;d=d.split(".");for(var C=0;C<d.length-1;C++){var $=d[C];if(!($ in E))break e;E=E[$]}d=d[d.length-1],C=E[d],y=y(C),y!=C&&y!=null&&e(E,d,{configurable:!0,writable:!0,value:y})}}function o(d,y){d instanceof String&&(d+="");var E=0,C=!1,$={next:function(){if(!C&&E<d.length){var J=E++;return{value:y(J,d[J]),done:!1}}return C=!0,{done:!0,value:void 0}}};return $[Symbol.iterator]=function(){return $},$}r("Array.prototype.values",function(d){return d||function(){return o(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},h=this||self;function f(d){var y=typeof d;return y=y!="object"?y:d?Array.isArray(d)?"array":y:"null",y=="array"||y=="object"&&typeof d.length=="number"}function m(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function v(d,y,E){return d.call.apply(d.bind,arguments)}function w(d,y,E){if(!d)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var $=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply($,C),d.apply(y,$)}}return function(){return d.apply(y,arguments)}}function T(d,y,E){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:w,T.apply(null,arguments)}function x(d,y){var E=Array.prototype.slice.call(arguments,1);return function(){var C=E.slice();return C.push.apply(C,arguments),d.apply(this,C)}}function N(d,y){function E(){}E.prototype=y.prototype,d.aa=y.prototype,d.prototype=new E,d.prototype.constructor=d,d.Qb=function(C,$,J){for(var de=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)de[xt-2]=arguments[xt];return y.prototype[$].apply(C,de)}}function L(d){const y=d.length;if(0<y){const E=Array(y);for(let C=0;C<y;C++)E[C]=d[C];return E}return[]}function O(d,y){for(let E=1;E<arguments.length;E++){const C=arguments[E];if(f(C)){const $=d.length||0,J=C.length||0;d.length=$+J;for(let de=0;de<J;de++)d[$+de]=C[de]}else d.push(C)}}class Z{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function Y(d){return/^[\s\xa0]*$/.test(d)}function H(){var d=h.navigator;return d&&(d=d.userAgent)?d:""}function le(d){return le[" "](d),d}le[" "]=function(){};var ve=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function oe(d,y,E){for(const C in d)y.call(E,d[C],C,d)}function I(d,y){for(const E in d)y.call(void 0,d[E],E,d)}function A(d){const y={};for(const E in d)y[E]=d[E];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(d,y){let E,C;for(let $=1;$<arguments.length;$++){C=arguments[$];for(E in C)d[E]=C[E];for(let J=0;J<R.length;J++)E=R[J],Object.prototype.hasOwnProperty.call(C,E)&&(d[E]=C[E])}}function V(d){var y=1;d=d.split(":");const E=[];for(;0<y&&d.length;)E.push(d.shift()),y--;return d.length&&E.push(d.join(":")),E}function F(d){h.setTimeout(()=>{throw d},0)}function k(){var d=me;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class ge{constructor(){this.h=this.g=null}add(y,E){const C=Se.get();C.set(y,E),this.h?this.h.next=C:this.g=C,this.h=C}}var Se=new Z(()=>new j,d=>d.reset());class j{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let G,ie=!1,me=new ge,be=()=>{const d=h.Promise.resolve(void 0);G=()=>{d.then(D)}};var D=()=>{for(var d;d=k();){try{d.h.call(d.g)}catch(E){F(E)}var y=Se;y.j(d),100>y.h&&(y.h++,d.next=y.g,y.g=d)}ie=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ee(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var he=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const E=()=>{};h.addEventListener("test",E,y),h.removeEventListener("test",E,y)}catch{}return d})();function ye(d,y){if(ee.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var E=this.type=d.type,C=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget){if(ve){e:{try{le(y.nodeName);var $=!0;break e}catch{}$=!1}$||(y=null)}}else E=="mouseover"?y=d.fromElement:E=="mouseout"&&(y=d.toElement);this.relatedTarget=y,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ke[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&ye.aa.h.call(this)}}N(ye,ee);var ke={2:"touch",3:"pen",4:"mouse"};ye.prototype.h=function(){ye.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var je="closure_listenable_"+(1e6*Math.random()|0),mt=0;function te(d,y,E,C,$){this.listener=d,this.proxy=null,this.src=y,this.type=E,this.capture=!!C,this.ha=$,this.key=++mt,this.da=this.fa=!1}function we(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Je(d){this.src=d,this.g={},this.h=0}Je.prototype.add=function(d,y,E,C,$){var J=d.toString();d=this.g[J],d||(d=this.g[J]=[],this.h++);var de=Qt(d,y,C,$);return-1<de?(y=d[de],E||(y.fa=!1)):(y=new te(y,this.src,J,!!C,$),y.fa=E,d.push(y)),y};function Gt(d,y){var E=y.type;if(E in d.g){var C=d.g[E],$=Array.prototype.indexOf.call(C,y,void 0),J;(J=0<=$)&&Array.prototype.splice.call(C,$,1),J&&(we(y),d.g[E].length==0&&(delete d.g[E],d.h--))}}function Qt(d,y,E,C){for(var $=0;$<d.length;++$){var J=d[$];if(!J.da&&J.listener==y&&J.capture==!!E&&J.ha==C)return $}return-1}var Lt="closure_lm_"+(1e6*Math.random()|0),An={};function rn(d,y,E,C,$){if(Array.isArray(y)){for(var J=0;J<y.length;J++)rn(d,y[J],E,C,$);return null}return E=Xt(E),d&&d[je]?d.K(y,E,m(C)?!!C.capture:!1,$):ki(d,y,E,!1,C,$)}function ki(d,y,E,C,$,J){if(!y)throw Error("Invalid event type");var de=m($)?!!$.capture:!!$,xt=Et(d);if(xt||(d[Lt]=xt=new Je(d)),E=xt.add(y,E,C,de,J),E.proxy)return E;if(C=Ze(),E.proxy=C,C.src=d,C.listener=E,d.addEventListener)he||($=de),$===void 0&&($=!1),d.addEventListener(y.toString(),C,$);else if(d.attachEvent)d.attachEvent(_e(y.toString()),C);else if(d.addListener&&d.removeListener)d.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Ze(){function d(E){return y.call(d.src,d.listener,E)}const y=We;return d}function gt(d,y,E,C,$){if(Array.isArray(y))for(var J=0;J<y.length;J++)gt(d,y[J],E,C,$);else C=m(C)?!!C.capture:!!C,E=Xt(E),d&&d[je]?(d=d.i,y=String(y).toString(),y in d.g&&(J=d.g[y],E=Qt(J,E,C,$),-1<E&&(we(J[E]),Array.prototype.splice.call(J,E,1),J.length==0&&(delete d.g[y],d.h--)))):d&&(d=Et(d))&&(y=d.g[y.toString()],d=-1,y&&(d=Qt(y,E,C,$)),(E=-1<d?y[d]:null)&&Ct(E))}function Ct(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[je])Gt(y.i,d);else{var E=d.type,C=d.proxy;y.removeEventListener?y.removeEventListener(E,C,d.capture):y.detachEvent?y.detachEvent(_e(E),C):y.addListener&&y.removeListener&&y.removeListener(C),(E=Et(y))?(Gt(E,d),E.h==0&&(E.src=null,y[Lt]=null)):we(d)}}}function _e(d){return d in An?An[d]:An[d]="on"+d}function We(d,y){if(d.da)d=!0;else{y=new ye(y,this);var E=d.listener,C=d.ha||d.src;d.fa&&Ct(d),d=E.call(C,y)}return d}function Et(d){return d=d[Lt],d instanceof Je?d:null}var pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xt(d){return typeof d=="function"?d:(d[pt]||(d[pt]=function(y){return d.handleEvent(y)}),d[pt])}function dt(){B.call(this),this.i=new Je(this),this.M=this,this.F=null}N(dt,B),dt.prototype[je]=!0,dt.prototype.removeEventListener=function(d,y,E,C){gt(this,d,y,E,C)};function Kt(d,y){var E,C=d.F;if(C)for(E=[];C;C=C.F)E.push(C);if(d=d.M,C=y.type||y,typeof y=="string")y=new ee(y,d);else if(y instanceof ee)y.target=y.target||d;else{var $=y;y=new ee(C,d),U(y,$)}if($=!0,E)for(var J=E.length-1;0<=J;J--){var de=y.g=E[J];$=In(de,C,!0,y)&&$}if(de=y.g=d,$=In(de,C,!0,y)&&$,$=In(de,C,!1,y)&&$,E)for(J=0;J<E.length;J++)de=y.g=E[J],$=In(de,C,!1,y)&&$}dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var d=this.i,y;for(y in d.g){for(var E=d.g[y],C=0;C<E.length;C++)we(E[C]);delete d.g[y],d.h--}}this.F=null},dt.prototype.K=function(d,y,E,C){return this.i.add(String(d),y,!1,E,C)},dt.prototype.L=function(d,y,E,C){return this.i.add(String(d),y,!0,E,C)};function In(d,y,E,C){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();for(var $=!0,J=0;J<y.length;++J){var de=y[J];if(de&&!de.da&&de.capture==E){var xt=de.listener,dn=de.ha||de.src;de.fa&&Gt(d.i,de),$=xt.call(dn,C)!==!1&&$}}return $&&!C.defaultPrevented}function Oi(d,y,E){if(typeof d=="function")E&&(d=T(d,E));else if(d&&typeof d.handleEvent=="function")d=T(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:h.setTimeout(d,y||0)}function $i(d){d.g=Oi(()=>{d.g=null,d.i&&(d.i=!1,$i(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class Ce extends B{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:$i(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pe(d){B.call(this),this.h=d,this.g={}}N(Pe,B);var St=[];function nt(d){oe(d.g,function(y,E){this.g.hasOwnProperty(E)&&Ct(y)},d),d.g={}}Pe.prototype.N=function(){Pe.aa.N.call(this),nt(this)},Pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var zt=h.JSON.stringify,Bt=h.JSON.parse,ja=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function us(){}us.prototype.h=null;function Er(d){return d.h||(d.h=d.i())}function ks(){}var se={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pe(){ee.call(this,"d")}N(pe,ee);function Ie(){ee.call(this,"c")}N(Ie,ee);var Re={},Me=null;function Fe(){return Me=Me||new dt}Re.La="serverreachability";function At(d){ee.call(this,Re.La,d)}N(At,ee);function kt(d){const y=Fe();Kt(y,new At(y))}Re.STAT_EVENT="statevent";function Gi(d,y){ee.call(this,Re.STAT_EVENT,d),this.stat=y}N(Gi,ee);function hn(d){const y=Fe();Kt(y,new Gi(y,d))}Re.Ma="timingevent";function Ki(d,y){ee.call(this,Re.Ma,d),this.size=y}N(Ki,ee);function Tr(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},y)}function Sr(){this.g=!0}Sr.prototype.xa=function(){this.g=!1};function yc(d,y,E,C,$,J){d.info(function(){if(d.g)if(J)for(var de="",xt=J.split("&"),dn=0;dn<xt.length;dn++){var et=xt[dn].split("=");if(1<et.length){var Nn=et[0];et=et[1];var kn=Nn.split("_");de=2<=kn.length&&kn[1]=="type"?de+(Nn+"="+et+"&"):de+(Nn+"=redacted&")}}else de=null;else de=J;return"XMLHTTP REQ ("+C+") [attempt "+$+"]: "+y+`
`+E+`
`+de})}function wc(d,y,E,C,$,J,de){d.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+$+"]: "+y+`
`+E+`
`+J+" "+de})}function Os(d,y,E,C){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+hs(d,E)+(C?" "+C:"")})}function jh(d,y){d.info(function(){return"TIMEOUT: "+y})}Sr.prototype.info=function(){};function hs(d,y){if(!d.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(d=0;d<E.length;d++)if(Array.isArray(E[d])){var C=E[d];if(!(2>C.length)){var $=C[1];if(Array.isArray($)&&!(1>$.length)){var J=$[0];if(J!="noop"&&J!="stop"&&J!="close")for(var de=1;de<$.length;de++)$[de]=""}}}}return zt(E)}catch{return y}}var Jt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ln={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ds;function xr(){}N(xr,us),xr.prototype.g=function(){return new XMLHttpRequest},xr.prototype.i=function(){return{}},ds=new xr;function fs(d,y,E,C){this.j=d,this.i=y,this.l=E,this.R=C||1,this.U=new Pe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ph}function Ph(){this.i=null,this.g="",this.h=!1}var bc={},Ds={};function Pa(d,y,E){d.L=1,d.v=Ua(Zt(y)),d.m=E,d.P=!0,js(d,null)}function js(d,y){d.F=Date.now(),Wi(d),d.A=Zt(d.v);var E=d.A,C=d.R;Array.isArray(C)||(C=[String(C)]),Ls(E.i,"t",C),d.C=0,E=d.j.J,d.h=new Ph,d.g=Xh(d.j,E?y:null,!d.m),0<d.O&&(d.M=new Ce(T(d.Y,d,d.g),d.O)),y=d.U,E=d.g,C=d.ca;var $="readystatechange";Array.isArray($)||($&&(St[0]=$.toString()),$=St);for(var J=0;J<$.length;J++){var de=rn(E,$[J],C||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=d.H?A(d.H):{},d.m?(d.u||(d.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,y)):(d.u="GET",d.g.ea(d.A,d.u,null,y)),kt(),yc(d.i,d.u,d.A,d.l,d.R,d.m)}fs.prototype.ca=function(d){d=d.target;const y=this.M;y&&ii(d)==3?y.j():this.Y(d)},fs.prototype.Y=function(d){try{if(d==this.g)e:{const kn=ii(this.g);var y=this.g.Ba();const Ur=this.g.Z();if(!(3>kn)&&(kn!=3||this.g&&(this.h.h||this.g.oa()||Ba(this.g)))){this.J||kn!=4||y==7||(y==8||0>=Ur?kt(3):kt(2)),Uo(this);var E=this.g.Z();this.X=E;t:if(Ps(this)){var C=Ba(this.g);d="";var $=C.length,J=ii(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ti(this),Cr(this);var de="";break t}this.h.i=new h.TextDecoder}for(y=0;y<$;y++)this.h.h=!0,d+=this.h.i.decode(C[y],{stream:!(J&&y==$-1)});C.length=0,this.h.g+=d,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,wc(this.i,this.u,this.A,this.l,this.R,kn,E),this.o){if(this.T&&!this.K){t:{if(this.g){var xt,dn=this.g;if((xt=dn.g?dn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(xt)){var et=xt;break t}}et=null}if(E=et)Os(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ms(this,E);else{this.o=!1,this.s=3,hn(12),ti(this),Cr(this);break e}}if(this.P){E=!0;let li;for(;!this.J&&this.C<de.length;)if(li=Ma(this,de),li==Ds){kn==4&&(this.s=4,hn(14),E=!1),Os(this.i,this.l,null,"[Incomplete Response]");break}else if(li==bc){this.s=4,hn(15),Os(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else Os(this.i,this.l,li,null),ms(this,li);if(Ps(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),kn!=4||de.length!=0||this.h.h||(this.s=1,hn(16),E=!1),this.o=this.o&&E,!E)Os(this.i,this.l,de,"[Invalid Chunked Response]"),ti(this),Cr(this);else if(0<de.length&&!this.W){this.W=!0;var Nn=this.j;Nn.g==this&&Nn.ba&&!Nn.M&&(Nn.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),Oc(Nn),Nn.M=!0,hn(11))}}else Os(this.i,this.l,de,null),ms(this,de);kn==4&&ti(this),this.o&&!this.J&&(kn==4?Wh(this.j,this):(this.o=!1,Wi(this)))}else Fh(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,hn(12)):(this.s=0,hn(13)),ti(this),Cr(this)}}}catch{}finally{}};function Ps(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Ma(d,y){var E=d.C,C=y.indexOf(`
`,E);return C==-1?Ds:(E=Number(y.substring(E,C)),isNaN(E)?bc:(C+=1,C+E>y.length?Ds:(y=y.slice(C,C+E),d.C=C+E,y)))}fs.prototype.cancel=function(){this.J=!0,ti(this)};function Wi(d){d.S=Date.now()+d.I,an(d,d.I)}function an(d,y){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Tr(T(d.ba,d),y)}function Uo(d){d.B&&(h.clearTimeout(d.B),d.B=null)}fs.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(jh(this.i,this.A),this.L!=2&&(kt(),hn(17)),ti(this),this.s=2,Cr(this)):an(this,this.S-d)};function Cr(d){d.j.G==0||d.J||Wh(d.j,d)}function ti(d){Uo(d);var y=d.M;y&&typeof y.ma=="function"&&y.ma(),d.M=null,nt(d.U),d.g&&(y=d.g,d.g=null,y.abort(),y.ma())}function ms(d,y){try{var E=d.j;if(E.G!=0&&(E.g==d||Ar(E.h,d))){if(!d.K&&Ar(E.h,d)&&E.G==3){try{var C=E.Da.g.parse(y)}catch{C=null}if(Array.isArray(C)&&C.length==3){var $=C;if($[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<d.F)Mr(E),Pr(E);else break e;kc(E),hn(18)}}else E.za=$[1],0<E.za-E.T&&37500>$[2]&&E.F&&E.v==0&&!E.C&&(E.C=Tr(T(E.Za,E),6e3));if(1>=Mh(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else Vs(E,11)}else if((d.K||E.g==d)&&Mr(E),!Y(y))for($=E.Da.g.parse(y),y=0;y<$.length;y++){let et=$[y];if(E.T=et[0],et=et[1],E.G==2)if(et[0]=="c"){E.K=et[1],E.ia=et[2];const Nn=et[3];Nn!=null&&(E.la=Nn,E.j.info("VER="+E.la));const kn=et[4];kn!=null&&(E.Aa=kn,E.j.info("SVER="+E.Aa));const Ur=et[5];Ur!=null&&typeof Ur=="number"&&0<Ur&&(C=1.5*Ur,E.L=C,E.j.info("backChannelRequestTimeoutMs_="+C)),C=E;const li=d.g;if(li){const Ha=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ha){var J=C.h;J.g||Ha.indexOf("spdy")==-1&&Ha.indexOf("quic")==-1&&Ha.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Ir(J,J.h),J.h=null))}if(C.D){const zs=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;zs&&(C.ya=zs,_t(C.I,C.D,zs))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-d.F,E.j.info("Handshake RTT: "+E.R+"ms")),C=E;var de=d;if(C.qa=Qh(C,C.J?C.ia:null,C.W),de.K){Di(C.h,de);var xt=de,dn=C.L;dn&&(xt.I=dn),xt.B&&(Uo(xt),Wi(xt)),C.g=de}else Gh(C);0<E.i.length&&Go(E)}else et[0]!="stop"&&et[0]!="close"||Vs(E,7);else E.G==3&&(et[0]=="stop"||et[0]=="close"?et[0]=="stop"?Vs(E,7):Rc(E):et[0]!="noop"&&E.l&&E.l.ta(et),E.v=0)}}kt(4)}catch{}}var Km=class{constructor(d,y){this.g=d,this.map=y}};function Ec(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tc(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Mh(d){return d.h?1:d.g?d.g.size:0}function Ar(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function Ir(d,y){d.g?d.g.add(y):d.h=y}function Di(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}Ec.prototype.cancel=function(){if(this.i=ni(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function ni(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const E of d.g.values())y=y.concat(E.D);return y}return L(d.i)}function Lh(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(f(d)){for(var y=[],E=d.length,C=0;C<E;C++)y.push(d[C]);return y}y=[],E=0;for(C in d)y[E++]=d[C];return y}function Wm(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(f(d)||typeof d=="string"){var y=[];d=d.length;for(var E=0;E<d;E++)y.push(E);return y}y=[],E=0;for(const C in d)y[E++]=C;return y}}}function Vo(d,y){if(d.forEach&&typeof d.forEach=="function")d.forEach(y,void 0);else if(f(d)||typeof d=="string")Array.prototype.forEach.call(d,y,void 0);else for(var E=Wm(d),C=Lh(d),$=C.length,J=0;J<$;J++)y.call(void 0,C[J],E&&E[J],d)}var Sc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zo(d,y){if(d){d=d.split("&");for(var E=0;E<d.length;E++){var C=d[E].indexOf("="),$=null;if(0<=C){var J=d[E].substring(0,C);$=d[E].substring(C+1)}else J=d[E];y(J,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function Ms(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ms){this.h=d.h,Rr(this,d.j),this.o=d.o,this.g=d.g,La(this,d.s),this.l=d.l;var y=d.i,E=new ps;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),Bo(this,E),this.m=d.m}else d&&(y=String(d).match(Sc))?(this.h=!1,Rr(this,y[1]||"",!0),this.o=Nr(y[2]||""),this.g=Nr(y[3]||"",!0),La(this,y[4]),this.l=Nr(y[5]||"",!0),Bo(this,y[6]||"",!0),this.m=Nr(y[7]||"")):(this.h=!1,this.i=new ps(null,this.h))}Ms.prototype.toString=function(){var d=[],y=this.j;y&&d.push(ji(y,xc,!0),":");var E=this.g;return(E||y=="file")&&(d.push("//"),(y=this.o)&&d.push(ji(y,xc,!0),"@"),d.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&d.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&d.push("/"),d.push(ji(E,E.charAt(0)=="/"?Cc:Uh,!0))),(E=this.i.toString())&&d.push("?",E),(E=this.m)&&d.push("#",ji(E,Xm)),d.join("")};function Zt(d){return new Ms(d)}function Rr(d,y,E){d.j=E?Nr(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function La(d,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);d.s=y}else d.s=null}function Bo(d,y,E){y instanceof ps?(d.i=y,Vh(d.i,d.h)):(E||(y=ji(y,Qm)),d.i=new ps(y,d.h))}function _t(d,y,E){d.i.set(y,E)}function Ua(d){return _t(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Nr(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ji(d,y,E){return typeof d=="string"?(d=encodeURI(d).replace(y,Ym),E&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Ym(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var xc=/[#\/\?@]/g,Uh=/[#\?:]/g,Cc=/[#\?]/g,Qm=/[#\?@]/g,Xm=/#/g;function ps(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function Rn(d){d.g||(d.g=new Map,d.h=0,d.i&&zo(d.i,function(y,E){d.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}n=ps.prototype,n.add=function(d,y){Rn(this),this.i=null,d=yi(this,d);var E=this.g.get(d);return E||this.g.set(d,E=[]),E.push(y),this.h+=1,this};function Fo(d,y){Rn(d),y=yi(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function qo(d,y){return Rn(d),y=yi(d,y),d.g.has(y)}n.forEach=function(d,y){Rn(this),this.g.forEach(function(E,C){E.forEach(function($){d.call(y,$,C,this)},this)},this)},n.na=function(){Rn(this);const d=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let C=0;C<y.length;C++){const $=d[C];for(let J=0;J<$.length;J++)E.push(y[C])}return E},n.V=function(d){Rn(this);let y=[];if(typeof d=="string")qo(this,d)&&(y=y.concat(this.g.get(yi(this,d))));else{d=Array.from(this.g.values());for(let E=0;E<d.length;E++)y=y.concat(d[E])}return y},n.set=function(d,y){return Rn(this),this.i=null,d=yi(this,d),qo(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},n.get=function(d,y){return d?(d=this.V(d),0<d.length?String(d[0]):y):y};function Ls(d,y,E){Fo(d,y),0<E.length&&(d.i=null,d.g.set(yi(d,y),L(E)),d.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var C=y[E];const J=encodeURIComponent(String(C)),de=this.V(C);for(C=0;C<de.length;C++){var $=J;de[C]!==""&&($+="="+encodeURIComponent(String(de[C]))),d.push($)}}return this.i=d.join("&")};function yi(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function Vh(d,y){y&&!d.j&&(Rn(d),d.i=null,d.g.forEach(function(E,C){var $=C.toLowerCase();C!=$&&(Fo(this,C),Ls(this,$,E))},d)),d.j=y}function Ac(d,y){const E=new Sr;if(h.Image){const C=new Image;C.onload=x(oi,E,"TestLoadImage: loaded",!0,y,C),C.onerror=x(oi,E,"TestLoadImage: error",!1,y,C),C.onabort=x(oi,E,"TestLoadImage: abort",!1,y,C),C.ontimeout=x(oi,E,"TestLoadImage: timeout",!1,y,C),h.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=d}else y(!1)}function zh(d,y){const E=new Sr,C=new AbortController,$=setTimeout(()=>{C.abort(),oi(E,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:C.signal}).then(J=>{clearTimeout($),J.ok?oi(E,"TestPingServer: ok",!0,y):oi(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout($),oi(E,"TestPingServer: error",!1,y)})}function oi(d,y,E,C,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),C(E)}catch{}}function Yi(){this.g=new ja}function Ic(d,y,E){const C=E||"";try{Vo(d,function($,J){let de=$;m($)&&(de=zt($)),y.push(C+J+"="+encodeURIComponent(de))})}catch($){throw y.push(C+"type="+encodeURIComponent("_badmap")),$}}function gs(d){this.l=d.Ub||null,this.j=d.eb||!1}N(gs,us),gs.prototype.g=function(){return new wi(this.l,this.j)},gs.prototype.i=(function(d){return function(){return d}})({});function wi(d,y){dt.call(this),this.D=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(wi,dt),n=wi.prototype,n.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=y,this.readyState=1,kr(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(y.body=d),(this.D||h).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_s(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,kr(this)),this.g&&(this.readyState=3,kr(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ho(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ho(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?_s(this):kr(this),this.readyState==3&&Ho(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,_s(this))},n.Qa=function(d){this.g&&(this.response=d,_s(this))},n.ga=function(){this.g&&_s(this)};function _s(d){d.readyState=4,d.l=null,d.j=null,d.v=null,kr(d)}n.setRequestHeader=function(d,y){this.u.append(d,y)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,d.push(E[0]+": "+E[1]),E=y.next();return d.join(`\r
`)};function kr(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(wi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Va(d){let y="";return oe(d,function(E,C){y+=C,y+=":",y+=E,y+=`\r
`}),y}function Or(d,y,E){e:{for(C in E){var C=!1;break e}C=!0}C||(E=Va(E),typeof d=="string"?E!=null&&encodeURIComponent(String(E)):_t(d,y,E))}function Ft(d){dt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(Ft,dt);var Kn=/^https?$/i,Us=["POST","PUT"];n=Ft.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,y,E,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ds.g(),this.v=this.o?Er(this.o):Er(ds),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(J){za(this,J);return}if(d=E||"",E=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var $ in C)E.set($,C[$]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const J of C.keys())E.set(J,C.get(J));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(E.keys()).find(J=>J.toLowerCase()=="content-type"),$=h.FormData&&d instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Us,y,void 0))||C||$||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,de]of E)this.g.setRequestHeader(J,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$o(this),this.u=!0,this.g.send(d),this.u=!1}catch(J){za(this,J)}};function za(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.m=5,Dr(d),jr(d)}function Dr(d){d.A||(d.A=!0,Kt(d,"complete"),Kt(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Kt(this,"complete"),Kt(this,"abort"),jr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jr(this,!0)),Ft.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Bh(this):this.bb())},n.bb=function(){Bh(this)};function Bh(d){if(d.h&&typeof c<"u"&&(!d.v[1]||ii(d)!=4||d.Z()!=2)){if(d.u&&ii(d)==4)Oi(d.Ea,0,d);else if(Kt(d,"readystatechange"),ii(d)==4){d.h=!1;try{const de=d.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var C;if(C=de===0){var $=String(d.D).match(Sc)[1]||null;!$&&h.self&&h.self.location&&($=h.self.location.protocol.slice(0,-1)),C=!Kn.test($?$.toLowerCase():"")}E=C}if(E)Kt(d,"complete"),Kt(d,"success");else{d.m=6;try{var J=2<ii(d)?d.g.statusText:""}catch{J=""}d.l=J+" ["+d.Z()+"]",Dr(d)}}finally{jr(d)}}}}function jr(d,y){if(d.g){$o(d);const E=d.g,C=d.v[0]?()=>{}:null;d.g=null,d.v=null,y||Kt(d,"ready");try{E.onreadystatechange=C}catch{}}}function $o(d){d.I&&(h.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function ii(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<ii(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),Bt(y)}};function Ba(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Fh(d){const y={};d=(d.g&&2<=ii(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<d.length;C++){if(Y(d[C]))continue;var E=V(d[C]);const $=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const J=y[$]||[];y[$]=J,J.push(E)}I(y,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fa(d,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[d]||y}function qh(d){this.Aa=0,this.i=[],this.j=new Sr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fa("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fa("baseRetryDelayMs",5e3,d),this.cb=Fa("retryDelaySeedMs",1e4,d),this.Wa=Fa("forwardChannelMaxRetries",2,d),this.wa=Fa("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new Ec(d&&d.concurrentRequestLimit),this.Da=new Yi,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=qh.prototype,n.la=8,n.G=1,n.connect=function(d,y,E,C){hn(0),this.W=d,this.H=y||{},E&&C!==void 0&&(this.H.OSID=E,this.H.OAID=C),this.F=this.X,this.I=Qh(this,null,this.W),Go(this)};function Rc(d){if(Hh(d),d.G==3){var y=d.U++,E=Zt(d.I);if(_t(E,"SID",d.K),_t(E,"RID",y),_t(E,"TYPE","terminate"),qa(d,E),y=new fs(d,d.j,y),y.L=2,y.v=Ua(Zt(E)),E=!1,h.navigator&&h.navigator.sendBeacon)try{E=h.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&h.Image&&(new Image().src=y.v,E=!0),E||(y.g=Xh(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Wi(y)}Dc(d)}function Pr(d){d.g&&(Oc(d),d.g.cancel(),d.g=null)}function Hh(d){Pr(d),d.u&&(h.clearTimeout(d.u),d.u=null),Mr(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&h.clearTimeout(d.s),d.s=null)}function Go(d){if(!Tc(d.h)&&!d.s){d.s=!0;var y=d.Ga;G||be(),ie||(G(),ie=!0),me.add(y,d),d.B=0}}function Jm(d,y){return Mh(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=y.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Tr(T(d.Ga,d,y),Yh(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const $=new fs(this,this.j,d);let J=this.o;if(this.S&&(J?(J=A(J),U(J,this.S)):J=this.S),this.m!==null||this.O||($.H=J,J=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var C=this.i[E];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(y+=C,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=Nc(this,$,y),E=Zt(this.I),_t(E,"RID",d),_t(E,"CVER",22),this.D&&_t(E,"X-HTTP-Session-Id",this.D),qa(this,E),J&&(this.O?y="headers="+encodeURIComponent(String(Va(J)))+"&"+y:this.m&&Or(E,this.m,J)),Ir(this.h,$),this.Ua&&_t(E,"TYPE","init"),this.P?(_t(E,"$req",y),_t(E,"SID","null"),$.T=!0,Pa($,E,null)):Pa($,E,y),this.G=2}}else this.G==3&&(d?$h(this,d):this.i.length==0||Tc(this.h)||$h(this))};function $h(d,y){var E;y?E=y.l:E=d.U++;const C=Zt(d.I);_t(C,"SID",d.K),_t(C,"RID",E),_t(C,"AID",d.T),qa(d,C),d.m&&d.o&&Or(C,d.m,d.o),E=new fs(d,d.j,E,d.B+1),d.m===null&&(E.H=d.o),y&&(d.i=y.D.concat(d.i)),y=Nc(d,E,1e3),E.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Ir(d.h,E),Pa(E,C,y)}function qa(d,y){d.H&&oe(d.H,function(E,C){_t(y,C,E)}),d.l&&Vo({},function(E,C){_t(y,C,E)})}function Nc(d,y,E){E=Math.min(d.i.length,E);var C=d.l?T(d.l.Na,d.l,d):null;e:{var $=d.i;let J=-1;for(;;){const de=["count="+E];J==-1?0<E?(J=$[0].g,de.push("ofs="+J)):J=0:de.push("ofs="+J);let xt=!0;for(let dn=0;dn<E;dn++){let et=$[dn].g;const Nn=$[dn].map;if(et-=J,0>et)J=Math.max(0,$[dn].g-100),xt=!1;else try{Ic(Nn,de,"req"+et+"_")}catch{C&&C(Nn)}}if(xt){C=de.join("&");break e}}}return d=d.i.splice(0,E),y.D=d,C}function Gh(d){if(!d.g&&!d.u){d.Y=1;var y=d.Fa;G||be(),ie||(G(),ie=!0),me.add(y,d),d.v=0}}function kc(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Tr(T(d.Fa,d),Yh(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,Kh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Tr(T(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,hn(10),Pr(this),Kh(this))};function Oc(d){d.A!=null&&(h.clearTimeout(d.A),d.A=null)}function Kh(d){d.g=new fs(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var y=Zt(d.qa);_t(y,"RID","rpc"),_t(y,"SID",d.K),_t(y,"AID",d.T),_t(y,"CI",d.F?"0":"1"),!d.F&&d.ja&&_t(y,"TO",d.ja),_t(y,"TYPE","xmlhttp"),qa(d,y),d.m&&d.o&&Or(y,d.m,d.o),d.L&&(d.g.I=d.L);var E=d.g;d=d.ia,E.L=1,E.v=Ua(Zt(y)),E.m=null,E.P=!0,js(E,d)}n.Za=function(){this.C!=null&&(this.C=null,Pr(this),kc(this),hn(19))};function Mr(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function Wh(d,y){var E=null;if(d.g==y){Mr(d),Oc(d),d.g=null;var C=2}else if(Ar(d.h,y))E=y.D,Di(d.h,y),C=1;else return;if(d.G!=0){if(y.o)if(C==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var $=d.B;C=Fe(),Kt(C,new Ki(C,E)),Go(d)}else Gh(d);else if($=y.s,$==3||$==0&&0<y.X||!(C==1&&Jm(d,y)||C==2&&kc(d)))switch(E&&0<E.length&&(y=d.h,y.i=y.i.concat(E)),$){case 1:Vs(d,5);break;case 4:Vs(d,10);break;case 3:Vs(d,6);break;default:Vs(d,2)}}}function Yh(d,y){let E=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(E*=2),E*y}function Vs(d,y){if(d.j.info("Error code "+y),y==2){var E=T(d.fb,d),C=d.Xa;const $=!C;C=new Ms(C||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Rr(C,"https"),Ua(C),$?Ac(C.toString(),E):zh(C.toString(),E)}else hn(2);d.G=0,d.l&&d.l.sa(y),Dc(d),Hh(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),hn(2)):(this.j.info("Failed to ping google.com"),hn(1))};function Dc(d){if(d.G=0,d.ka=[],d.l){const y=ni(d.h);(y.length!=0||d.i.length!=0)&&(O(d.ka,y),O(d.ka,d.i),d.h.i.length=0,L(d.i),d.i.length=0),d.l.ra()}}function Qh(d,y,E){var C=E instanceof Ms?Zt(E):new Ms(E);if(C.g!="")y&&(C.g=y+"."+C.g),La(C,C.s);else{var $=h.location;C=$.protocol,y=y?y+"."+$.hostname:$.hostname,$=+$.port;var J=new Ms(null);C&&Rr(J,C),y&&(J.g=y),$&&La(J,$),E&&(J.l=E),C=J}return E=d.D,y=d.ya,E&&y&&_t(C,E,y),_t(C,"VER",d.la),qa(d,C),C}function Xh(d,y,E){if(y&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Ca&&!d.pa?new Ft(new gs({eb:E})):new Ft(d.pa),y.Ha(d.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Jh(){}n=Jh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ko(){}Ko.prototype.g=function(d,y){return new si(d,y)};function si(d,y){dt.call(this),this.g=new qh(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(d?d["X-WebChannel-Client-Profile"]=y.va:d={"X-WebChannel-Client-Profile":y.va}),this.g.S=d,(d=y&&y.Sb)&&!Y(d)&&(this.g.m=d),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!Y(y)&&(this.g.D=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new Lr(this)}N(si,dt),si.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},si.prototype.close=function(){Rc(this.g)},si.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var E={};E.__data__=d,d=E}else this.u&&(E={},E.__data__=zt(d),d=E);y.i.push(new Km(y.Ya++,d)),y.G==3&&Go(y)},si.prototype.N=function(){this.g.l=null,delete this.j,Rc(this.g),delete this.g,si.aa.N.call(this)};function Zh(d){pe.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const E in y){d=E;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}N(Zh,pe);function ed(){Ie.call(this),this.status=1}N(ed,Ie);function Lr(d){this.g=d}N(Lr,Jh),Lr.prototype.ua=function(){Kt(this.g,"a")},Lr.prototype.ta=function(d){Kt(this.g,new Zh(d))},Lr.prototype.sa=function(d){Kt(this.g,new ed)},Lr.prototype.ra=function(){Kt(this.g,"b")},Ko.prototype.createWebChannel=Ko.prototype.g,si.prototype.send=si.prototype.o,si.prototype.open=si.prototype.m,si.prototype.close=si.prototype.close,rx=function(){return new Ko},sx=function(){return Fe()},ix=Re,X_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Jt.NO_ERROR=0,Jt.TIMEOUT=8,Jt.HTTP_ERROR=6,wf=Jt,Ln.COMPLETE="complete",nx=Ln,ks.EventType=se,se.OPEN="a",se.CLOSE="b",se.ERROR="c",se.MESSAGE="d",dt.prototype.listen=dt.prototype.K,xu=ks,Ft.prototype.listenOnce=Ft.prototype.L,Ft.prototype.getLastError=Ft.prototype.Ka,Ft.prototype.getLastErrorCode=Ft.prototype.Ba,Ft.prototype.getStatus=Ft.prototype.Z,Ft.prototype.getResponseJson=Ft.prototype.Oa,Ft.prototype.getResponseText=Ft.prototype.oa,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Ha,tx=Ft}).apply(typeof af<"u"?af:typeof self<"u"?self:typeof window<"u"?window:{});const PE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qn.UNAUTHENTICATED=new Qn(null),Qn.GOOGLE_CREDENTIALS=new Qn("google-credentials-uid"),Qn.FIRST_PARTY=new Qn("first-party-uid"),Qn.MOCK_USER=new Qn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=new gm("@firebase/firestore");function _u(){return bo.logLevel}function xe(n,...e){if(bo.logLevel<=ct.DEBUG){const t=e.map(iv);bo.debug(`Firestore (${fc}): ${n}`,...t)}}function pr(n,...e){if(bo.logLevel<=ct.ERROR){const t=e.map(iv);bo.error(`Firestore (${fc}): ${n}`,...t)}}function Xl(n,...e){if(bo.logLevel<=ct.WARN){const t=e.map(iv);bo.warn(`Firestore (${fc}): ${n}`,...t)}}function iv(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(n="Unexpected state"){const e=`FIRESTORE (${fc}) INTERNAL ASSERTION FAILED: `+n;throw pr(e),new Error(e)}function Nt(n,e){n||qe()}function Ke(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends Ns{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Qn.UNAUTHENTICATED)))}shutdown(){}}class pO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class gO{constructor(e){this.t=e,this.currentUser=Qn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Nt(this.o===void 0);let i=this.i;const r=f=>this.i!==i?(i=this.i,t(f)):Promise.resolve();let o=new ya;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ya,e.enqueueRetryable((()=>r(this.currentUser)))};const c=()=>{const f=o;e.enqueueRetryable((async()=>{await f.promise,await r(this.currentUser)}))},h=f=>{xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>h(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ya)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Nt(typeof i.accessToken=="string"),new ax(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Nt(e===null||typeof e=="string"),new Qn(e)}}class _O{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Qn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class vO{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new _O(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Qn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class yO{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Nt(this.o===void 0);const i=o=>{o.error!=null&&xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.R;return this.R=o.token,xe("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const r=o=>{xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((o=>r(o))),setTimeout((()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?r(o):xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Nt(typeof t.token=="string"),this.R=t.token,new yO(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=bO(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%e.length))}return i}}function wt(n,e){return n<e?-1:n>e?1:0}function Jl(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ue(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Cn.fromMillis(Date.now())}static fromDate(e){return Cn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Cn(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?wt(this.nanoseconds,e.nanoseconds):wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ge(e)}static min(){return new Ge(new Cn(0,0))}static max(){return new Ge(new Cn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,t,i){t===void 0?t=0:t>e.length&&qe(),i===void 0?i=e.length-t:i>e.length-t&&qe(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ku.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ku?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const o=e.get(r),c=t.get(r);if(o<c)return-1;if(o>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class nn extends Ku{construct(e,t,i){return new nn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ue(ue.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new nn(t)}static emptyPath(){return new nn([])}}const EO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hn extends Ku{construct(e,t,i){return new Hn(e,t,i)}static isValidIdentifier(e){return EO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Hn(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const o=()=>{if(i.length===0)throw new Ue(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;r<e.length;){const h=e[r];if(h==="\\"){if(r+1===e.length)throw new Ue(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[r+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Ue(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,r+=2}else h==="`"?(c=!c,r++):h!=="."||c?(i+=h,r++):(o(),r++)}if(o(),c)throw new Ue(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hn(t)}static emptyPath(){return new Hn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.path=e}static fromPath(e){return new Ve(nn.fromString(e))}static fromName(e){return new Ve(nn.fromString(e).popFirst(5))}static empty(){return new Ve(nn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ve(new nn(e.slice()))}}function TO(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ge.fromTimestamp(i===1e9?new Cn(t+1,0):new Cn(t,i));return new Ta(r,Ve.empty(),e)}function SO(n){return new Ta(n.readTime,n.key,-1)}class Ta{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ta(Ge.min(),Ve.empty(),-1)}static max(){return new Ta(Ge.max(),Ve.empty(),-1)}}function xO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ve.comparator(n.documentKey,e.documentKey),t!==0?t:wt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wh(n){if(n.code!==ue.FAILED_PRECONDITION||n.message!==CO)throw n;xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&qe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce(((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.reject(t)}static resolve(e){return new ce(((t,i)=>{t(e)}))}static reject(e){return new ce(((t,i)=>{i(e)}))}static waitFor(e){return new ce(((t,i)=>{let r=0,o=0,c=!1;e.forEach((h=>{++r,h.next((()=>{++o,c&&o===r&&t()}),(f=>i(f)))})),c=!0,o===r&&t()}))}static or(e){let t=ce.resolve(!1);for(const i of e)t=t.next((r=>r?ce.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,o)=>{i.push(t.call(this,r,o))})),this.waitFor(i)}static mapArray(e,t){return new ce(((i,r)=>{const o=e.length,c=new Array(o);let h=0;for(let f=0;f<o;f++){const m=f;t(e[m]).next((v=>{c[m]=v,++h,h===o&&i(c)}),(v=>r(v)))}}))}static doWhile(e,t){return new ce(((i,r)=>{const o=()=>{e()===!0?t().next((()=>{o()}),r):i()};o()}))}}function IO(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function bh(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}sv.oe=-1;function Em(n){return n==null}function Mf(n){return n===0&&1/n==-1/0}function RO(n){return typeof n=="number"&&Number.isInteger(n)&&!Mf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Do(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wn=class J_{constructor(e,t){this.comparator=e,this.root=t||wa.EMPTY}insert(e,t){return new J_(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wa.BLACK,null,null))}remove(e){return new J_(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new of(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new of(this.root,e,this.comparator,!1)}getReverseIterator(){return new of(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new of(this.root,e,this.comparator,!0)}},of=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},wa=class nr{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??nr.RED,this.left=r??nr.EMPTY,this.right=o??nr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new nr(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return nr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return nr.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw qe();const e=this.left.check();if(e!==this.right.check())throw qe();return e+(this.isRed()?0:1)}};wa.EMPTY=null,wa.RED=!0,wa.BLACK=!1;wa.EMPTY=new class{constructor(){this.size=0}get key(){throw qe()}get value(){throw qe()}get color(){throw qe()}get left(){throw qe()}get right(){throw qe()}copy(e,t,i,r,o){return this}insert(e,t,i){return new wa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.comparator=e,this.data=new wn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new LE(this.data.getIterator())}getIteratorFrom(e){return new LE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof $n)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new $n(this.comparator);return t.data=e,t}}class LE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.fields=e,e.sort(Hn.comparator)}static empty(){return new ns([])}unionWith(e){let t=new $n(Hn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ns(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new cx("Invalid base64 string: "+o):o}})(e);return new Gn(t)}static fromUint8Array(e){const t=(function(r){let o="";for(let c=0;c<r.length;++c)o+=String.fromCharCode(r[c]);return o})(e);return new Gn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gn.EMPTY_BYTE_STRING=new Gn("");const NO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sa(n){if(Nt(!!n),typeof n=="string"){let e=0;const t=NO.exec(n);if(Nt(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:cn(n.seconds),nanos:cn(n.nanos)}}function cn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Eo(n){return typeof n=="string"?Gn.fromBase64String(n):Gn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function av(n){const e=n.mapValue.fields.__previous_value__;return rv(e)?av(e):e}function Wu(n){const e=Sa(n.mapValue.fields.__local_write_time__.timestampValue);return new Cn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kO{constructor(e,t,i,r,o,c,h,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=m}}class Yu{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Yu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Yu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf={mapValue:{}};function To(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?rv(n)?4:DO(n)?9007199254740991:OO(n)?10:11:qe()}function Is(n,e){if(n===e)return!0;const t=To(n);if(t!==To(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Wu(n).isEqual(Wu(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const c=Sa(r.timestampValue),h=Sa(o.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return Eo(r.bytesValue).isEqual(Eo(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return cn(r.geoPointValue.latitude)===cn(o.geoPointValue.latitude)&&cn(r.geoPointValue.longitude)===cn(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return cn(r.integerValue)===cn(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const c=cn(r.doubleValue),h=cn(o.doubleValue);return c===h?Mf(c)===Mf(h):isNaN(c)&&isNaN(h)}return!1})(n,e);case 9:return Jl(n.arrayValue.values||[],e.arrayValue.values||[],Is);case 10:case 11:return(function(r,o){const c=r.mapValue.fields||{},h=o.mapValue.fields||{};if(ME(c)!==ME(h))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(h[f]===void 0||!Is(c[f],h[f])))return!1;return!0})(n,e);default:return qe()}}function Qu(n,e){return(n.values||[]).find((t=>Is(t,e)))!==void 0}function Zl(n,e){if(n===e)return 0;const t=To(n),i=To(e);if(t!==i)return wt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return wt(n.booleanValue,e.booleanValue);case 2:return(function(o,c){const h=cn(o.integerValue||o.doubleValue),f=cn(c.integerValue||c.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1})(n,e);case 3:return UE(n.timestampValue,e.timestampValue);case 4:return UE(Wu(n),Wu(e));case 5:return wt(n.stringValue,e.stringValue);case 6:return(function(o,c){const h=Eo(o),f=Eo(c);return h.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){const h=o.split("/"),f=c.split("/");for(let m=0;m<h.length&&m<f.length;m++){const v=wt(h[m],f[m]);if(v!==0)return v}return wt(h.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){const h=wt(cn(o.latitude),cn(c.latitude));return h!==0?h:wt(cn(o.longitude),cn(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return VE(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var h,f,m,v;const w=o.fields||{},T=c.fields||{},x=(h=w.value)===null||h===void 0?void 0:h.arrayValue,N=(f=T.value)===null||f===void 0?void 0:f.arrayValue,L=wt(((m=x?.values)===null||m===void 0?void 0:m.length)||0,((v=N?.values)===null||v===void 0?void 0:v.length)||0);return L!==0?L:VE(x,N)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===lf.mapValue&&c===lf.mapValue)return 0;if(o===lf.mapValue)return 1;if(c===lf.mapValue)return-1;const h=o.fields||{},f=Object.keys(h),m=c.fields||{},v=Object.keys(m);f.sort(),v.sort();for(let w=0;w<f.length&&w<v.length;++w){const T=wt(f[w],v[w]);if(T!==0)return T;const x=Zl(h[f[w]],m[v[w]]);if(x!==0)return x}return wt(f.length,v.length)})(n.mapValue,e.mapValue);default:throw qe()}}function UE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return wt(n,e);const t=Sa(n),i=Sa(e),r=wt(t.seconds,i.seconds);return r!==0?r:wt(t.nanos,i.nanos)}function VE(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const o=Zl(t[r],i[r]);if(o)return o}return wt(t.length,i.length)}function ec(n){return Z_(n)}function Z_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Sa(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Eo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ve.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const o of t.values||[])r?r=!1:i+=",",i+=Z_(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",o=!0;for(const c of i)o?o=!1:r+=",",r+=`${c}:${Z_(t.fields[c])}`;return r+"}"})(n.mapValue):qe()}function e0(n){return!!n&&"integerValue"in n}function ov(n){return!!n&&"arrayValue"in n}function zE(n){return!!n&&"nullValue"in n}function BE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bf(n){return!!n&&"mapValue"in n}function OO(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Nu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Do(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Nu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function DO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e){this.value=e}static empty(){return new Ri({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!bf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nu(t)}setAll(e){let t=Hn.emptyPath(),i={},r=[];e.forEach(((c,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,i,r),i={},r=[],t=h.popLast()}c?i[h.lastSegment()]=Nu(c):r.push(h.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){const t=this.field(e.popLast());bf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];bf(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Do(t,((r,o)=>e[r]=o));for(const r of i)delete e[r]}clone(){return new Ri(Nu(this.value))}}function ux(n){const e=[];return Do(n.fields,((t,i)=>{const r=new Hn([t]);if(bf(i)){const o=ux(i.mapValue).fields;if(o.length===0)e.push(r);else for(const c of o)e.push(r.child(c))}else e.push(r)})),new ns(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e,t,i,r,o,c,h){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=c,this.documentState=h}static newInvalidDocument(e){return new Xn(e,0,Ge.min(),Ge.min(),Ge.min(),Ri.empty(),0)}static newFoundDocument(e,t,i,r){return new Xn(e,1,t,Ge.min(),i,r,0)}static newNoDocument(e,t){return new Xn(e,2,t,Ge.min(),Ge.min(),Ri.empty(),0)}static newUnknownDocument(e,t){return new Xn(e,3,t,Ge.min(),Ge.min(),Ri.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ri.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ri.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,t){this.position=e,this.inclusive=t}}function FE(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const o=e[r],c=n.position[r];if(o.field.isKeyField()?i=Ve.comparator(Ve.fromName(c.referenceValue),t.key):i=Zl(c,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function qE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Is(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t="asc"){this.field=e,this.dir=t}}function jO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{}class Sn extends hx{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new MO(e,t,i):t==="array-contains"?new VO(e,i):t==="in"?new zO(e,i):t==="not-in"?new BO(e,i):t==="array-contains-any"?new FO(e,i):new Sn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new LO(e,i):new UO(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Zl(t,this.value)):t!==null&&To(this.value)===To(t)&&this.matchesComparison(Zl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return qe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rs extends hx{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Rs(e,t)}matches(e){return dx(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function dx(n){return n.op==="and"}function fx(n){return PO(n)&&dx(n)}function PO(n){for(const e of n.filters)if(e instanceof Rs)return!1;return!0}function t0(n){if(n instanceof Sn)return n.field.canonicalString()+n.op.toString()+ec(n.value);if(fx(n))return n.filters.map((e=>t0(e))).join(",");{const e=n.filters.map((t=>t0(t))).join(",");return`${n.op}(${e})`}}function mx(n,e){return n instanceof Sn?(function(i,r){return r instanceof Sn&&i.op===r.op&&i.field.isEqual(r.field)&&Is(i.value,r.value)})(n,e):n instanceof Rs?(function(i,r){return r instanceof Rs&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((o,c,h)=>o&&mx(c,r.filters[h])),!0):!1})(n,e):void qe()}function px(n){return n instanceof Sn?(function(t){return`${t.field.canonicalString()} ${t.op} ${ec(t.value)}`})(n):n instanceof Rs?(function(t){return t.op.toString()+" {"+t.getFilters().map(px).join(" ,")+"}"})(n):"Filter"}class MO extends Sn{constructor(e,t,i){super(e,t,i),this.key=Ve.fromName(i.referenceValue)}matches(e){const t=Ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class LO extends Sn{constructor(e,t){super(e,"in",t),this.keys=gx("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class UO extends Sn{constructor(e,t){super(e,"not-in",t),this.keys=gx("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function gx(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((i=>Ve.fromName(i.referenceValue)))}class VO extends Sn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ov(t)&&Qu(t.arrayValue,this.value)}}class zO extends Sn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Qu(this.value.arrayValue,t)}}class BO extends Sn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Qu(this.value.arrayValue,t)}}class FO extends Sn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ov(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Qu(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e,t=null,i=[],r=[],o=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=c,this.endAt=h,this.ue=null}}function HE(n,e=null,t=[],i=[],r=null,o=null,c=null){return new qO(n,e,t,i,r,o,c)}function lv(n){const e=Ke(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>t0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(o){return o.field.canonicalString()+o.dir})(i))).join(","),Em(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>ec(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>ec(i))).join(",")),e.ue=t}return e.ue}function cv(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!jO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mx(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!qE(n.startAt,e.startAt)&&qE(n.endAt,e.endAt)}function n0(n){return Ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e,t=null,i=[],r=[],o=null,c="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=c,this.startAt=h,this.endAt=f,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function HO(n,e,t,i,r,o,c,h){return new Tm(n,e,t,i,r,o,c,h)}function uv(n){return new Tm(n)}function $E(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function $O(n){return n.collectionGroup!==null}function ku(n){const e=Ke(n);if(e.ce===null){e.ce=[];const t=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new $n(Hn.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((m=>{m.isInequality()&&(h=h.add(m.field))}))})),h})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Uf(o,i))})),t.has(Hn.keyField().canonicalString())||e.ce.push(new Uf(Hn.keyField(),i))}return e.ce}function Cs(n){const e=Ke(n);return e.le||(e.le=GO(e,ku(n))),e.le}function GO(n,e){if(n.limitType==="F")return HE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const o=r.dir==="desc"?"asc":"desc";return new Uf(r.field,o)}));const t=n.endAt?new Lf(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Lf(n.startAt.position,n.startAt.inclusive):null;return HE(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function i0(n,e,t){return new Tm(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Sm(n,e){return cv(Cs(n),Cs(e))&&n.limitType===e.limitType}function _x(n){return`${lv(Cs(n))}|lt:${n.limitType}`}function jl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>px(r))).join(", ")}]`),Em(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>ec(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>ec(r))).join(",")),`Target(${i})`})(Cs(n))}; limitType=${n.limitType})`}function xm(n,e){return e.isFoundDocument()&&(function(i,r){const o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Ve.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(const o of ku(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(c,h,f){const m=FE(c,h,f);return c.inclusive?m<=0:m<0})(i.startAt,ku(i),r)||i.endAt&&!(function(c,h,f){const m=FE(c,h,f);return c.inclusive?m>=0:m>0})(i.endAt,ku(i),r))})(n,e)}function KO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vx(n){return(e,t)=>{let i=!1;for(const r of ku(n)){const o=WO(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function WO(n,e,t){const i=n.field.isKeyField()?Ve.comparator(e.key,t.key):(function(o,c,h){const f=c.data.field(o),m=h.data.field(o);return f!==null&&m!==null?Zl(f,m):qe()})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return qe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Do(this.inner,((t,i)=>{for(const[r,o]of i)e(r,o)}))}isEmpty(){return lx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=new wn(Ve.comparator);function gr(){return YO}const yx=new wn(Ve.comparator);function Cu(...n){let e=yx;for(const t of n)e=e.insert(t.key,t);return e}function wx(n){let e=yx;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function mo(){return Ou()}function bx(){return Ou()}function Ou(){return new mc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const QO=new wn(Ve.comparator),XO=new $n(Ve.comparator);function ut(...n){let e=XO;for(const t of n)e=e.add(t);return e}const JO=new $n(wt);function ZO(){return JO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mf(e)?"-0":e}}function Ex(n){return{integerValue:""+n}}function e5(n,e){return RO(e)?Ex(e):hv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this._=void 0}}function t5(n,e,t){return n instanceof Vf?(function(r,o){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&rv(o)&&(o=av(o)),o&&(c.fields.__previous_value__=o),{mapValue:c}})(t,e):n instanceof Xu?Sx(n,e):n instanceof Ju?xx(n,e):(function(r,o){const c=Tx(r,o),h=GE(c)+GE(r.Pe);return e0(c)&&e0(r.Pe)?Ex(h):hv(r.serializer,h)})(n,e)}function n5(n,e,t){return n instanceof Xu?Sx(n,e):n instanceof Ju?xx(n,e):t}function Tx(n,e){return n instanceof zf?(function(i){return e0(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}class Vf extends Cm{}class Xu extends Cm{constructor(e){super(),this.elements=e}}function Sx(n,e){const t=Cx(e);for(const i of n.elements)t.some((r=>Is(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Ju extends Cm{constructor(e){super(),this.elements=e}}function xx(n,e){let t=Cx(e);for(const i of n.elements)t=t.filter((r=>!Is(r,i)));return{arrayValue:{values:t}}}class zf extends Cm{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function GE(n){return cn(n.integerValue||n.doubleValue)}function Cx(n){return ov(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function i5(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Xu&&r instanceof Xu||i instanceof Ju&&r instanceof Ju?Jl(i.elements,r.elements,Is):i instanceof zf&&r instanceof zf?Is(i.Pe,r.Pe):i instanceof Vf&&r instanceof Vf})(n.transform,e.transform)}class s5{constructor(e,t){this.version=e,this.transformResults=t}}class hr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hr}static exists(e){return new hr(void 0,e)}static updateTime(e){return new hr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ef(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Am{}function Ax(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rx(n.key,hr.none()):new Im(n.key,n.data,hr.none());{const t=n.data,i=Ri.empty();let r=new $n(Hn.comparator);for(let o of e.fields)if(!r.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?i.delete(o):i.set(o,c),r=r.add(o)}return new jo(n.key,i,new ns(r.toArray()),hr.none())}}function r5(n,e,t){n instanceof Im?(function(r,o,c){const h=r.value.clone(),f=WE(r.fieldTransforms,o,c.transformResults);h.setAll(f),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):n instanceof jo?(function(r,o,c){if(!Ef(r.precondition,o))return void o.convertToUnknownDocument(c.version);const h=WE(r.fieldTransforms,o,c.transformResults),f=o.data;f.setAll(Ix(r)),f.setAll(h),o.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(n,e,t):(function(r,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Du(n,e,t,i){return n instanceof Im?(function(o,c,h,f){if(!Ef(o.precondition,c))return h;const m=o.value.clone(),v=YE(o.fieldTransforms,f,c);return m.setAll(v),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof jo?(function(o,c,h,f){if(!Ef(o.precondition,c))return h;const m=YE(o.fieldTransforms,f,c),v=c.data;return v.setAll(Ix(o)),v.setAll(m),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((w=>w.field)))})(n,e,t,i):(function(o,c,h){return Ef(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(n,e,t)}function a5(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),o=Tx(i.transform,r||null);o!=null&&(t===null&&(t=Ri.empty()),t.set(i.field,o))}return t||null}function KE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Jl(i,r,((o,c)=>i5(o,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Im extends Am{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class jo extends Am{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Ix(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function WE(n,e,t){const i=new Map;Nt(n.length===t.length);for(let r=0;r<t.length;r++){const o=n[r],c=o.transform,h=e.data.field(o.field);i.set(o.field,n5(c,h,t[r]))}return i}function YE(n,e,t){const i=new Map;for(const r of n){const o=r.transform,c=t.data.field(r.field);i.set(r.field,t5(o,c,e))}return i}class Rx extends Am{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class o5 extends Am{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l5{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(e.key)&&r5(o,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Du(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Du(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=bx();return this.mutations.forEach((r=>{const o=e.get(r.key),c=o.overlayedDocument;let h=this.applyToLocalView(c,o.mutatedFields);h=t.has(r.key)?null:h;const f=Ax(c,h);f!==null&&i.set(r.key,f),c.isValidDocument()||c.convertToNoDocument(Ge.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ut())}isEqual(e){return this.batchId===e.batchId&&Jl(this.mutations,e.mutations,((t,i)=>KE(t,i)))&&Jl(this.baseMutations,e.baseMutations,((t,i)=>KE(t,i)))}}class dv{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Nt(e.mutations.length===i.length);let r=(function(){return QO})();const o=e.mutations;for(let c=0;c<o.length;c++)r=r.insert(o[c].key,i[c].version);return new dv(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _n,ft;function h5(n){switch(n){default:return qe();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}function Nx(n){if(n===void 0)return pr("GRPC error has no .code"),ue.UNKNOWN;switch(n){case _n.OK:return ue.OK;case _n.CANCELLED:return ue.CANCELLED;case _n.UNKNOWN:return ue.UNKNOWN;case _n.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case _n.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case _n.INTERNAL:return ue.INTERNAL;case _n.UNAVAILABLE:return ue.UNAVAILABLE;case _n.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case _n.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case _n.NOT_FOUND:return ue.NOT_FOUND;case _n.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case _n.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case _n.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case _n.ABORTED:return ue.ABORTED;case _n.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case _n.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case _n.DATA_LOSS:return ue.DATA_LOSS;default:return qe()}}(ft=_n||(_n={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5=new vo([4294967295,4294967295],0);function QE(n){const e=d5().encode(n),t=new ex;return t.update(e),new Uint8Array(t.digest())}function XE(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new vo([t,i],0),new vo([r,o],0)]}class fv{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Au(`Invalid padding: ${t}`);if(i<0)throw new Au(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Au(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Au(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=vo.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(vo.fromNumber(i)));return r.compare(f5)===1&&(r=new vo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=QE(e),[i,r]=XE(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,r,o);if(!this.de(c))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new fv(o,r,t);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.Ie===0)return;const t=QE(e),[i,r]=XE(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,r,o);this.Ae(c)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Eh.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Rm(Ge.min(),r,new wn(wt),gr(),ut())}}class Eh{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Eh(i,t,ut(),ut(),ut())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}}class kx{constructor(e,t){this.targetId=e,this.me=t}}class Ox{constructor(e,t,i=Gn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class JE{constructor(){this.fe=0,this.ge=e2(),this.pe=Gn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ut(),t=ut(),i=ut();return this.ge.forEach(((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:qe()}})),new Eh(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=e2()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Nt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class m5{constructor(e){this.Le=e,this.Be=new Map,this.ke=gr(),this.qe=ZE(),this.Qe=new wn(wt)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:qe()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((i,r)=>{this.ze(r)&&t(r)}))}He(e){const t=e.targetId,i=e.me.count,r=this.Je(t);if(r){const o=r.target;if(n0(o))if(i===0){const c=new Ve(o.path);this.Ue(t,c,Xn.newNoDocument(c,Ge.min()))}else Nt(i===1);else{const c=this.Ye(t);if(c!==i){const h=this.Ze(e),f=h?this.Xe(h,e,c):1;if(f!==0){this.je(t);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,m)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t;let c,h;try{c=Eo(i).toUint8Array()}catch(f){if(f instanceof cx)return Xl("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new fv(c,r,o)}catch(f){return Xl(f instanceof Au?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.Ie===0?null:h}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let r=0;return i.forEach((o=>{const c=this.Le.tt(),h=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.Ue(t,o,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((o,c)=>{const h=this.Je(c);if(h){if(o.current&&n0(h.target)){const f=new Ve(h.target.path);this.ke.get(f)!==null||this.it(c,f)||this.Ue(c,f,Xn.newNoDocument(f,e))}o.be&&(t.set(c,o.ve()),o.Ce())}}));let i=ut();this.qe.forEach(((o,c)=>{let h=!0;c.forEachWhile((f=>{const m=this.Je(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(o))})),this.ke.forEach(((o,c)=>c.setReadTime(e)));const r=new Rm(e,t,this.Qe,this.ke,i);return this.ke=gr(),this.qe=ZE(),this.Qe=new wn(wt),r}$e(e,t){if(!this.ze(e))return;const i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new JE,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new $n(wt),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||xe("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new JE),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function ZE(){return new wn(Ve.comparator)}function e2(){return new wn(Ve.comparator)}const p5={asc:"ASCENDING",desc:"DESCENDING"},g5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_5={and:"AND",or:"OR"};class v5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function s0(n,e){return n.useProto3Json||Em(e)?e:{value:e}}function Bf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dx(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function y5(n,e){return Bf(n,e.toTimestamp())}function As(n){return Nt(!!n),Ge.fromTimestamp((function(t){const i=Sa(t);return new Cn(i.seconds,i.nanos)})(n))}function mv(n,e){return r0(n,e).canonicalString()}function r0(n,e){const t=(function(r){return new nn(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function jx(n){const e=nn.fromString(n);return Nt(Vx(e)),e}function a0(n,e){return mv(n.databaseId,e.path)}function o_(n,e){const t=jx(e);if(t.get(1)!==n.databaseId.projectId)throw new Ue(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ue(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ve(Mx(t))}function Px(n,e){return mv(n.databaseId,e)}function w5(n){const e=jx(n);return e.length===4?nn.emptyPath():Mx(e)}function o0(n){return new nn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Mx(n){return Nt(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function t2(n,e,t){return{name:a0(n,e),fields:t.value.mapValue.fields}}function b5(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:qe()})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(m,v){return m.useProto3Json?(Nt(v===void 0||typeof v=="string"),Gn.fromBase64String(v||"")):(Nt(v===void 0||v instanceof Buffer||v instanceof Uint8Array),Gn.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(m){const v=m.code===void 0?ue.UNKNOWN:Nx(m.code);return new Ue(v,m.message||"")})(c);t=new Ox(i,r,o,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=o_(n,i.document.name),o=As(i.document.updateTime),c=i.document.createTime?As(i.document.createTime):Ge.min(),h=new Ri({mapValue:{fields:i.document.fields}}),f=Xn.newFoundDocument(r,o,c,h),m=i.targetIds||[],v=i.removedTargetIds||[];t=new Tf(m,v,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=o_(n,i.document),o=i.readTime?As(i.readTime):Ge.min(),c=Xn.newNoDocument(r,o),h=i.removedTargetIds||[];t=new Tf([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=o_(n,i.document),o=i.removedTargetIds||[];t=new Tf([],o,r,null)}else{if(!("filter"in e))return qe();{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:o}=i,c=new u5(r,o),h=i.targetId;t=new kx(h,c)}}return t}function E5(n,e){let t;if(e instanceof Im)t={update:t2(n,e.key,e.value)};else if(e instanceof Rx)t={delete:a0(n,e.key)};else if(e instanceof jo)t={update:t2(n,e.key,e.data),updateMask:k5(e.fieldMask)};else{if(!(e instanceof o5))return qe();t={verify:a0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(o,c){const h=c.transform;if(h instanceof Vf)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Xu)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Ju)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof zf)return{fieldPath:c.field.canonicalString(),increment:h.Pe};throw qe()})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:y5(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:qe()})(n,e.precondition)),t}function T5(n,e){return n&&n.length>0?(Nt(e!==void 0),n.map((t=>(function(r,o){let c=r.updateTime?As(r.updateTime):As(o);return c.isEqual(Ge.min())&&(c=As(o)),new s5(c,r.transformResults||[])})(t,e)))):[]}function S5(n,e){return{documents:[Px(n,e.path)]}}function x5(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Px(n,r);const o=(function(m){if(m.length!==0)return Ux(Rs.create(m,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(m){if(m.length!==0)return m.map((v=>(function(T){return{field:Pl(T.field),direction:I5(T.dir)}})(v)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const h=s0(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{_t:t,parent:r}}function C5(n){let e=w5(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Nt(i===1);const v=t.from[0];v.allDescendants?r=v.collectionId:e=e.child(v.collectionId)}let o=[];t.where&&(o=(function(w){const T=Lx(w);return T instanceof Rs&&fx(T)?T.getFilters():[T]})(t.where));let c=[];t.orderBy&&(c=(function(w){return w.map((T=>(function(N){return new Uf(Ml(N.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(T)))})(t.orderBy));let h=null;t.limit&&(h=(function(w){let T;return T=typeof w=="object"?w.value:w,Em(T)?null:T})(t.limit));let f=null;t.startAt&&(f=(function(w){const T=!!w.before,x=w.values||[];return new Lf(x,T)})(t.startAt));let m=null;return t.endAt&&(m=(function(w){const T=!w.before,x=w.values||[];return new Lf(x,T)})(t.endAt)),HO(e,r,c,o,h,"F",f,m)}function A5(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return qe()}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Lx(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ml(t.unaryFilter.field);return Sn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Ml(t.unaryFilter.field);return Sn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Ml(t.unaryFilter.field);return Sn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Ml(t.unaryFilter.field);return Sn.create(c,"!=",{nullValue:"NULL_VALUE"});default:return qe()}})(n):n.fieldFilter!==void 0?(function(t){return Sn.create(Ml(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return qe()}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Rs.create(t.compositeFilter.filters.map((i=>Lx(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return qe()}})(t.compositeFilter.op))})(n):qe()}function I5(n){return p5[n]}function R5(n){return g5[n]}function N5(n){return _5[n]}function Pl(n){return{fieldPath:n.canonicalString()}}function Ml(n){return Hn.fromServerFormat(n.fieldPath)}function Ux(n){return n instanceof Sn?(function(t){if(t.op==="=="){if(BE(t.value))return{unaryFilter:{field:Pl(t.field),op:"IS_NAN"}};if(zE(t.value))return{unaryFilter:{field:Pl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(BE(t.value))return{unaryFilter:{field:Pl(t.field),op:"IS_NOT_NAN"}};if(zE(t.value))return{unaryFilter:{field:Pl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pl(t.field),op:R5(t.op),value:t.value}}})(n):n instanceof Rs?(function(t){const i=t.getFilters().map((r=>Ux(r)));return i.length===1?i[0]:{compositeFilter:{op:N5(t.op),filters:i}}})(n):qe()}function k5(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Vx(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,t,i,r,o=Ge.min(),c=Ge.min(),h=Gn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new ga(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ga(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O5{constructor(e){this.ct=e}}function D5(n){const e=C5({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?i0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(){this.un=new P5}addToCollectionParentIndex(e,t){return this.un.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(Ta.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(Ta.min())}updateCollectionGroup(e,t,i){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class P5{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new $n(nn.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new $n(nn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new tc(0)}static kn(){return new tc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(){this.changes=new mc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ce.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U5{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Du(i.mutation,r,ns.empty(),Cn.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,ut()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=ut()){const r=mo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((o=>{let c=Cu();return o.forEach(((h,f)=>{c=c.insert(h,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=mo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,ut())))}populateOverlays(e,t,i){const r=[];return i.forEach((o=>{t.has(o)||r.push(o)})),this.documentOverlayCache.getOverlays(e,r).next((o=>{o.forEach(((c,h)=>{t.set(c,h)}))}))}computeViews(e,t,i,r){let o=gr();const c=Ou(),h=(function(){return Ou()})();return t.forEach(((f,m)=>{const v=i.get(m.key);r.has(m.key)&&(v===void 0||v.mutation instanceof jo)?o=o.insert(m.key,m):v!==void 0?(c.set(m.key,v.mutation.getFieldMask()),Du(v.mutation,m,v.mutation.getFieldMask(),Cn.now())):c.set(m.key,ns.empty())})),this.recalculateAndSaveOverlays(e,o).next((f=>(f.forEach(((m,v)=>c.set(m,v))),t.forEach(((m,v)=>{var w;return h.set(m,new L5(v,(w=c.get(m))!==null&&w!==void 0?w:null))})),h)))}recalculateAndSaveOverlays(e,t){const i=Ou();let r=new wn(((c,h)=>c-h)),o=ut();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const h of c)h.keys().forEach((f=>{const m=t.get(f);if(m===null)return;let v=i.get(f)||ns.empty();v=h.applyToLocalView(m,v),i.set(f,v);const w=(r.get(h.batchId)||ut()).add(f);r=r.insert(h.batchId,w)}))})).next((()=>{const c=[],h=r.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,v=f.value,w=bx();v.forEach((T=>{if(!o.has(T)){const x=Ax(t.get(T),i.get(T));x!==null&&w.set(T,x),o=o.add(T)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,w))}return ce.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(c){return Ve.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):$O(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((o=>{const c=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):ce.resolve(mo());let h=-1,f=o;return c.next((m=>ce.forEach(m,((v,w)=>(h<w.largestBatchId&&(h=w.largestBatchId),o.get(v)?ce.resolve():this.remoteDocumentCache.getEntry(e,v).next((T=>{f=f.insert(v,T)}))))).next((()=>this.populateOverlays(e,m,o))).next((()=>this.computeViews(e,f,m,ut()))).next((v=>({batchId:h,changes:wx(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ve(t)).next((i=>{let r=Cu();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const o=t.collectionGroup;let c=Cu();return this.indexManager.getCollectionParents(e,o).next((h=>ce.forEach(h,(f=>{const m=(function(w,T){return new Tm(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,i,r).next((v=>{v.forEach(((w,T)=>{c=c.insert(w,T)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r)))).next((c=>{o.forEach(((f,m)=>{const v=m.getKey();c.get(v)===null&&(c=c.insert(v,Xn.newInvalidDocument(v)))}));let h=Cu();return c.forEach(((f,m)=>{const v=o.get(f);v!==void 0&&Du(v.mutation,m,ns.empty(),Cn.now()),xm(t,m)&&(h=h.insert(f,m))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ce.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:As(r.createTime)}})(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,(function(r){return{name:r.name,query:D5(r.bundledQuery),readTime:As(r.readTime)}})(t)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(){this.overlays=new wn(Ve.comparator),this.Ir=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const i=mo();return ce.forEach(t,(r=>this.getOverlay(e,r).next((o=>{o!==null&&i.set(r,o)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,o)=>{this.ht(e,t,o)})),ce.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.Ir.get(i);return r!==void 0&&(r.forEach((o=>this.overlays=this.overlays.remove(o))),this.Ir.delete(i)),ce.resolve()}getOverlaysForCollection(e,t,i){const r=mo(),o=t.length+1,c=new Ve(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&f.largestBatchId>i&&r.set(f.getKey(),f)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new wn(((m,v)=>m-v));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let v=o.get(m.largestBatchId);v===null&&(v=mo(),o=o.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const h=mo(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((m,v)=>h.set(m,v))),!(h.size()>=r)););return ce.resolve(h)}ht(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const c=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new c5(t,i));let o=this.Ir.get(t);o===void 0&&(o=ut(),this.Ir.set(t,o)),this.Ir.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(){this.sessionToken=Gn.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(){this.Tr=new $n(Pn.Er),this.dr=new $n(Pn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const i=new Pn(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Vr(new Pn(e,t))}mr(e,t){e.forEach((i=>this.removeReference(i,t)))}gr(e){const t=new Ve(new nn([])),i=new Pn(t,e),r=new Pn(t,e+1),o=[];return this.dr.forEachInRange([i,r],(c=>{this.Vr(c),o.push(c.key)})),o}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Ve(new nn([])),i=new Pn(t,e),r=new Pn(t,e+1);let o=ut();return this.dr.forEachInRange([i,r],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new Pn(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Pn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Ve.comparator(e.key,t.key)||wt(e.wr,t.wr)}static Ar(e,t){return wt(e.wr,t.wr)||Ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new $n(Pn.Er)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new l5(o,t,i,r);this.mutationQueue.push(c);for(const h of r)this.br=this.br.add(new Pn(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return ce.resolve(c)}lookupMutationBatch(e,t){return ce.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.vr(i),o=r<0?0:r;return ce.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Pn(t,0),r=new Pn(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([i,r],(c=>{const h=this.Dr(c.wr);o.push(h)})),ce.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new $n(wt);return t.forEach((r=>{const o=new Pn(r,0),c=new Pn(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,c],(h=>{i=i.add(h.wr)}))})),ce.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let o=i;Ve.isDocumentKey(o)||(o=o.child(""));const c=new Pn(new Ve(o),0);let h=new $n(wt);return this.br.forEachWhile((f=>{const m=f.key.path;return!!i.isPrefixOf(m)&&(m.length===r&&(h=h.add(f.wr)),!0)}),c),ce.resolve(this.Cr(h))}Cr(e){const t=[];return e.forEach((i=>{const r=this.Dr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Nt(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return ce.forEach(t.mutations,(r=>{const o=new Pn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=i}))}On(e){}containsKey(e,t){const i=new Pn(t,0),r=this.br.firstAfterOrEqual(i);return ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q5{constructor(e){this.Mr=e,this.docs=(function(){return new wn(Ve.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),o=r?r.size:0,c=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ce.resolve(i?i.document.mutableCopy():Xn.newInvalidDocument(t))}getEntries(e,t){let i=gr();return t.forEach((r=>{const o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():Xn.newInvalidDocument(r))})),ce.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=gr();const c=t.path,h=new Ve(c.child("")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:m,value:{document:v}}=f.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||xO(SO(v),i)<=0||(r.has(v.key)||xm(t,v))&&(o=o.insert(v.key,v.mutableCopy()))}return ce.resolve(o)}getAllFromCollectionGroup(e,t,i,r){qe()}Or(e,t){return ce.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new H5(this)}getSize(e){return ce.resolve(this.size)}}class H5 extends M5{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)})),ce.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e){this.persistence=e,this.Nr=new mc((t=>lv(t)),cv),this.lastRemoteSnapshotVersion=Ge.min(),this.highestTargetId=0,this.Lr=0,this.Br=new pv,this.targetCount=0,this.kr=tc.Bn()}forEachTarget(e,t){return this.Nr.forEach(((i,r)=>t(r))),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),ce.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new tc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Kn(t),ce.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,i){let r=0;const o=[];return this.Nr.forEach(((c,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.Nr.delete(c),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),r++)})),ce.waitFor(o).next((()=>r))}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const i=this.Nr.get(t)||null;return ce.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),ce.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);const r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((c=>{o.push(r.markPotentiallyOrphaned(e,c))})),ce.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Br.yr(t);return ce.resolve(i)}containsKey(e,t){return ce.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(e,t){this.qr={},this.overlays={},this.Qr=new sv(0),this.Kr=!1,this.Kr=!0,this.$r=new B5,this.referenceDelegate=e(this),this.Ur=new $5(this),this.indexManager=new j5,this.remoteDocumentCache=(function(r){return new q5(r)})((i=>this.referenceDelegate.Wr(i))),this.serializer=new O5(t),this.Gr=new V5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new z5,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new F5(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){xe("MemoryPersistence","Starting transaction:",e);const r=new K5(this.Qr.next());return this.referenceDelegate.zr(),i(r).next((o=>this.referenceDelegate.jr(r).next((()=>o)))).toPromise().then((o=>(r.raiseOnCommittedEvent(),o)))}Hr(e,t){return ce.or(Object.values(this.qr).map((i=>()=>i.containsKey(e,t))))}}class K5 extends AO{constructor(e){super(),this.currentSequenceNumber=e}}class gv{constructor(e){this.persistence=e,this.Jr=new pv,this.Yr=null}static Zr(e){return new gv(e)}get Xr(){if(this.Yr)return this.Yr;throw qe()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),ce.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((r=>this.Xr.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((o=>this.Xr.add(o.toString())))})).next((()=>i.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Xr,(i=>{const r=Ve.fromPath(i);return this.ei(e,r).next((o=>{o||t.removeEntry(r,Ge.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return ce.or([()=>ce.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=r}static Wi(e,t){let i=ut(),r=ut();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new _v(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return jN()?8:IO(ei())>0?6:4})()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,r){const o={result:null};return this.Yi(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.Zi(e,t,r,i).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new W5;return this.Xi(e,t,c).next((h=>{if(o.result=h,this.zi)return this.es(e,t,c,h.size)}))})).next((()=>o.result))}es(e,t,i,r){return i.documentReadCount<this.ji?(_u()<=ct.DEBUG&&xe("QueryEngine","SDK will not create cache indexes for query:",jl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ce.resolve()):(_u()<=ct.DEBUG&&xe("QueryEngine","Query:",jl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(_u()<=ct.DEBUG&&xe("QueryEngine","The SDK decides to create cache indexes for query:",jl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cs(t))):ce.resolve())}Yi(e,t){if($E(t))return ce.resolve(null);let i=Cs(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=i0(t,null,"F"),i=Cs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((o=>{const c=ut(...o);return this.Ji.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((f=>{const m=this.ts(t,h);return this.ns(t,m,c,f.readTime)?this.Yi(e,i0(t,null,"F")):this.rs(e,m,t,f)}))))})))))}Zi(e,t,i,r){return $E(t)||r.isEqual(Ge.min())?ce.resolve(null):this.Ji.getDocuments(e,i).next((o=>{const c=this.ts(t,o);return this.ns(t,c,i,r)?ce.resolve(null):(_u()<=ct.DEBUG&&xe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),jl(t)),this.rs(e,c,t,TO(r,-1)).next((h=>h)))}))}ts(e,t){let i=new $n(vx(e));return t.forEach(((r,o)=>{xm(e,o)&&(i=i.add(o))})),i}ns(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Xi(e,t,i){return _u()<=ct.DEBUG&&xe("QueryEngine","Using full collection scan to execute query:",jl(t)),this.Ji.getDocumentsMatchingQuery(e,t,Ta.min(),i)}rs(e,t,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e,t,i,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new wn(wt),this._s=new mc((o=>lv(o)),cv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new U5(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function X5(n,e,t,i){return new Q5(n,e,t,i)}async function zx(n,e){const t=Ke(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((o=>(r=o,t.ls(e),t.mutationQueue.getAllMutationBatches(i)))).next((o=>{const c=[],h=[];let f=ut();for(const m of r){c.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}for(const m of o){h.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(i,f).next((m=>({hs:m,removedBatchIds:c,addedBatchIds:h})))}))}))}function J5(n,e){const t=Ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return(function(h,f,m,v){const w=m.batch,T=w.keys();let x=ce.resolve();return T.forEach((N=>{x=x.next((()=>v.getEntry(f,N))).next((L=>{const O=m.docVersions.get(N);Nt(O!==null),L.version.compareTo(O)<0&&(w.applyToRemoteDocument(L,m),L.isValidDocument()&&(L.setReadTime(m.commitVersion),v.addEntry(L)))}))})),x.next((()=>h.mutationQueue.removeMutationBatch(f,w)))})(t,i,e,o).next((()=>o.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let f=ut();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(f=f.add(h.batch.mutations[m].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function Bx(n){const e=Ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ur.getLastRemoteSnapshotVersion(t)))}function Z5(n,e){const t=Ke(n),i=e.snapshotVersion;let r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;const h=[];e.targetChanges.forEach(((v,w)=>{const T=r.get(w);if(!T)return;h.push(t.Ur.removeMatchingKeys(o,v.removedDocuments,w).next((()=>t.Ur.addMatchingKeys(o,v.addedDocuments,w))));let x=T.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(w)!==null?x=x.withResumeToken(Gn.EMPTY_BYTE_STRING,Ge.min()).withLastLimboFreeSnapshotVersion(Ge.min()):v.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(v.resumeToken,i)),r=r.insert(w,x),(function(L,O,Z){return L.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=3e8?!0:Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0})(T,x,v)&&h.push(t.Ur.updateTargetData(o,x))}));let f=gr(),m=ut();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,v))})),h.push(eD(o,c,e.documentUpdates).next((v=>{f=v.Ps,m=v.Is}))),!i.isEqual(Ge.min())){const v=t.Ur.getLastRemoteSnapshotVersion(o).next((w=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,i)));h.push(v)}return ce.waitFor(h).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,f,m))).next((()=>f))})).then((o=>(t.os=r,o)))}function eD(n,e,t){let i=ut(),r=ut();return t.forEach((o=>i=i.add(o))),e.getEntries(n,i).next((o=>{let c=gr();return t.forEach(((h,f)=>{const m=o.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(h)),f.isNoDocument()&&f.version.isEqual(Ge.min())?(e.removeEntry(h,f.readTime),c=c.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),c=c.insert(h,f)):xe("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)})),{Ps:c,Is:r}}))}function tD(n,e){const t=Ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function nD(n,e){const t=Ke(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Ur.getTargetData(i,e).next((o=>o?(r=o,ce.resolve(r)):t.Ur.allocateTargetId(i).next((c=>(r=new ga(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i}))}async function l0(n,e,t){const i=Ke(n),r=i.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,(c=>i.persistence.referenceDelegate.removeTarget(c,r)))}catch(c){if(!bh(c))throw c;xe("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}i.os=i.os.remove(e),i._s.delete(r.target)}function n2(n,e,t){const i=Ke(n);let r=Ge.min(),o=ut();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,m,v){const w=Ke(f),T=w._s.get(v);return T!==void 0?ce.resolve(w.os.get(T)):w.Ur.getTargetData(m,v)})(i,c,Cs(e)).next((h=>{if(h)return r=h.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(c,h.targetId).next((f=>{o=f}))})).next((()=>i.ss.getDocumentsMatchingQuery(c,e,t?r:Ge.min(),t?o:ut()))).next((h=>(iD(i,KO(e),h),{documents:h,Ts:o})))))}function iD(n,e,t){let i=n.us.get(e)||Ge.min();t.forEach(((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)})),n.us.set(e,i)}class i2{constructor(){this.activeTargetIds=ZO()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sD{constructor(){this.so=new i2,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new i2,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){xe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){xe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cf=null;function l_(){return cf===null?cf=(function(){return 268435456+Math.round(2147483648*Math.random())})():cf++,"0x"+cf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn="WebChannelConnection";class lD extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${r}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${o}`}get Fo(){return!1}Mo(t,i,r,o,c){const h=l_(),f=this.xo(t,i.toUriEncodedString());xe("RestConnection",`Sending RPC '${t}' ${h}:`,f,r);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,o,c),this.No(t,f,m,r).then((v=>(xe("RestConnection",`Received RPC '${t}' ${h}: `,v),v)),(v=>{throw Xl("RestConnection",`RPC '${t}' ${h} failed with error: `,v,"url: ",f,"request:",r),v}))}Lo(t,i,r,o,c,h){return this.Mo(t,i,r,o,c)}Oo(t,i,r){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+fc})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach(((o,c)=>t[c]=o)),r&&r.headers.forEach(((o,c)=>t[c]=o))}xo(t,i){const r=aD[t];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,r){const o=l_();return new Promise(((c,h)=>{const f=new tx;f.setWithCredentials(!0),f.listenOnce(nx.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case wf.NO_ERROR:const v=f.getResponseJson();xe(Yn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(v)),c(v);break;case wf.TIMEOUT:xe(Yn,`RPC '${e}' ${o} timed out`),h(new Ue(ue.DEADLINE_EXCEEDED,"Request time out"));break;case wf.HTTP_ERROR:const w=f.getStatus();if(xe(Yn,`RPC '${e}' ${o} failed with status:`,w,"response text:",f.getResponseText()),w>0){let T=f.getResponseJson();Array.isArray(T)&&(T=T[0]);const x=T?.error;if(x&&x.status&&x.message){const N=(function(O){const Z=O.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(Z)>=0?Z:ue.UNKNOWN})(x.status);h(new Ue(N,x.message))}else h(new Ue(ue.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new Ue(ue.UNAVAILABLE,"Connection failed."));break;default:qe()}}finally{xe(Yn,`RPC '${e}' ${o} completed.`)}}));const m=JSON.stringify(r);xe(Yn,`RPC '${e}' ${o} sending request:`,r),f.send(t,"POST",m,i,15)}))}Bo(e,t,i){const r=l_(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=rx(),h=sx(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Oo(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const v=o.join("");xe(Yn,`Creating RPC '${e}' stream ${r}: ${v}`,f);const w=c.createWebChannel(v,f);let T=!1,x=!1;const N=new oD({Io:O=>{x?xe(Yn,`Not sending because RPC '${e}' stream ${r} is closed:`,O):(T||(xe(Yn,`Opening RPC '${e}' stream ${r} transport.`),w.open(),T=!0),xe(Yn,`RPC '${e}' stream ${r} sending:`,O),w.send(O))},To:()=>w.close()}),L=(O,Z,Y)=>{O.listen(Z,(H=>{try{Y(H)}catch(le){setTimeout((()=>{throw le}),0)}}))};return L(w,xu.EventType.OPEN,(()=>{x||(xe(Yn,`RPC '${e}' stream ${r} transport opened.`),N.yo())})),L(w,xu.EventType.CLOSE,(()=>{x||(x=!0,xe(Yn,`RPC '${e}' stream ${r} transport closed`),N.So())})),L(w,xu.EventType.ERROR,(O=>{x||(x=!0,Xl(Yn,`RPC '${e}' stream ${r} transport errored:`,O),N.So(new Ue(ue.UNAVAILABLE,"The operation could not be completed")))})),L(w,xu.EventType.MESSAGE,(O=>{var Z;if(!x){const Y=O.data[0];Nt(!!Y);const H=Y,le=H.error||((Z=H[0])===null||Z===void 0?void 0:Z.error);if(le){xe(Yn,`RPC '${e}' stream ${r} received error:`,le);const ve=le.status;let oe=(function(R){const U=_n[R];if(U!==void 0)return Nx(U)})(ve),I=le.message;oe===void 0&&(oe=ue.INTERNAL,I="Unknown error status: "+ve+" with message "+le.message),x=!0,N.So(new Ue(oe,I)),w.close()}else xe(Yn,`RPC '${e}' stream ${r} received:`,Y),N.bo(Y)}})),L(h,ix.STAT_EVENT,(O=>{O.stat===X_.PROXY?xe(Yn,`RPC '${e}' stream ${r} detected buffering proxy`):O.stat===X_.NOPROXY&&xe(Yn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{N.wo()}),0),N}}function c_(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(n){return new v5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e,t,i=1e3,r=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&xe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,t,i,r,o,c,h,f){this.ui=e,this.Ho=i,this.Jo=r,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Fx(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(pr(t.toString()),pr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.Yo===t&&this.P_(i,r)}),(i=>{e((()=>{const r=new Ue(ue.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)}))}))}P_(e,t){const i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{i((()=>this.listener.Eo()))})),this.stream.Ro((()=>{i((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((r=>{i((()=>this.I_(r)))})),this.stream.onMessage((r=>{i((()=>++this.e_==1?this.E_(r):this.onNext(r)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return xe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(xe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class cD extends qx{constructor(e,t,i,r,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,c),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=b5(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Ge.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Ge.min():c.readTime?As(c.readTime):Ge.min()})(e);return this.listener.d_(t,i)}A_(e){const t={};t.database=o0(this.serializer),t.addTarget=(function(o,c){let h;const f=c.target;if(h=n0(f)?{documents:S5(o,f)}:{query:x5(o,f)._t},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=Dx(o,c.resumeToken);const m=s0(o,c.expectedCount);m!==null&&(h.expectedCount=m)}else if(c.snapshotVersion.compareTo(Ge.min())>0){h.readTime=Bf(o,c.snapshotVersion.toTimestamp());const m=s0(o,c.expectedCount);m!==null&&(h.expectedCount=m)}return h})(this.serializer,e);const i=A5(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){const t={};t.database=o0(this.serializer),t.removeTarget=e,this.a_(t)}}class uD extends qx{constructor(e,t,i,r,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,c),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Nt(!!e.streamToken),this.lastStreamToken=e.streamToken,Nt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Nt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=T5(e.writeResults,e.commitTime),i=As(e.commitTime);return this.listener.g_(i,t)}p_(){const e={};e.database=o0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>E5(this.serializer,i)))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Ue(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Mo(e,r0(t,i),r,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ue(ue.UNKNOWN,o.toString())}))}Lo(e,t,i,r,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Lo(e,r0(t,i),r,c,h,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ue(ue.UNKNOWN,c.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class dD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(pr(t),this.D_=!1):xe("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o((c=>{i.enqueueAndForget((async()=>{Po(this)&&(xe("RemoteStore","Restarting streams for network reachability change."),await(async function(f){const m=Ke(f);m.L_.add(4),await Th(m),m.q_.set("Unknown"),m.L_.delete(4),await km(m)})(this))}))})),this.q_=new dD(i,r)}}async function km(n){if(Po(n))for(const e of n.B_)await e(!0)}async function Th(n){for(const e of n.B_)await e(!1)}function Hx(n,e){const t=Ke(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),bv(t)?wv(t):pc(t).r_()&&yv(t,e))}function vv(n,e){const t=Ke(n),i=pc(t);t.N_.delete(e),i.r_()&&$x(t,e),t.N_.size===0&&(i.r_()?i.o_():Po(t)&&t.q_.set("Unknown"))}function yv(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ge.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}pc(n).A_(e)}function $x(n,e){n.Q_.xe(e),pc(n).R_(e)}function wv(n){n.Q_=new m5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),pc(n).start(),n.q_.v_()}function bv(n){return Po(n)&&!pc(n).n_()&&n.N_.size>0}function Po(n){return Ke(n).L_.size===0}function Gx(n){n.Q_=void 0}async function mD(n){n.q_.set("Online")}async function pD(n){n.N_.forEach(((e,t)=>{yv(n,e)}))}async function gD(n,e){Gx(n),bv(n)?(n.q_.M_(e),wv(n)):n.q_.set("Unknown")}async function _D(n,e,t){if(n.q_.set("Online"),e instanceof Ox&&e.state===2&&e.cause)try{await(async function(r,o){const c=o.cause;for(const h of o.targetIds)r.N_.has(h)&&(await r.remoteSyncer.rejectListen(h,c),r.N_.delete(h),r.Q_.removeTarget(h))})(n,e)}catch(i){xe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Ff(n,i)}else if(e instanceof Tf?n.Q_.Ke(e):e instanceof kx?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Ge.min()))try{const i=await Bx(n.localStore);t.compareTo(i)>=0&&await(function(o,c){const h=o.Q_.rt(c);return h.targetChanges.forEach(((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const v=o.N_.get(m);v&&o.N_.set(m,v.withResumeToken(f.resumeToken,c))}})),h.targetMismatches.forEach(((f,m)=>{const v=o.N_.get(f);if(!v)return;o.N_.set(f,v.withResumeToken(Gn.EMPTY_BYTE_STRING,v.snapshotVersion)),$x(o,f);const w=new ga(v.target,f,m,v.sequenceNumber);yv(o,w)})),o.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(i){xe("RemoteStore","Failed to raise snapshot:",i),await Ff(n,i)}}async function Ff(n,e,t){if(!bh(e))throw e;n.L_.add(1),await Th(n),n.q_.set("Offline"),t||(t=()=>Bx(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{xe("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await km(n)}))}function Kx(n,e){return e().catch((t=>Ff(n,t,e)))}async function Om(n){const e=Ke(n),t=xa(e);let i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;vD(e);)try{const r=await tD(e.localStore,i);if(r===null){e.O_.length===0&&t.o_();break}i=r.batchId,yD(e,r)}catch(r){await Ff(e,r)}Wx(e)&&Yx(e)}function vD(n){return Po(n)&&n.O_.length<10}function yD(n,e){n.O_.push(e);const t=xa(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Wx(n){return Po(n)&&!xa(n).n_()&&n.O_.length>0}function Yx(n){xa(n).start()}async function wD(n){xa(n).p_()}async function bD(n){const e=xa(n);for(const t of n.O_)e.m_(t.mutations)}async function ED(n,e,t){const i=n.O_.shift(),r=dv.from(i,e,t);await Kx(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Om(n)}async function TD(n,e){e&&xa(n).V_&&await(async function(i,r){if((function(c){return h5(c)&&c!==ue.ABORTED})(r.code)){const o=i.O_.shift();xa(i).s_(),await Kx(i,(()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r))),await Om(i)}})(n,e),Wx(n)&&Yx(n)}async function r2(n,e){const t=Ke(n);t.asyncQueue.verifyOperationInProgress(),xe("RemoteStore","RemoteStore received new credentials");const i=Po(t);t.L_.add(3),await Th(t),i&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await km(t)}async function SD(n,e){const t=Ke(n);e?(t.L_.delete(2),await km(t)):e||(t.L_.add(2),await Th(t),t.q_.set("Unknown"))}function pc(n){return n.K_||(n.K_=(function(t,i,r){const o=Ke(t);return o.w_(),new cD(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Eo:mD.bind(null,n),Ro:pD.bind(null,n),mo:gD.bind(null,n),d_:_D.bind(null,n)}),n.B_.push((async e=>{e?(n.K_.s_(),bv(n)?wv(n):n.q_.set("Unknown")):(await n.K_.stop(),Gx(n))}))),n.K_}function xa(n){return n.U_||(n.U_=(function(t,i,r){const o=Ke(t);return o.w_(),new uD(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:wD.bind(null,n),mo:TD.bind(null,n),f_:bD.bind(null,n),g_:ED.bind(null,n)}),n.B_.push((async e=>{e?(n.U_.s_(),await Om(n)):(await n.U_.stop(),n.O_.length>0&&(xe("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new ya,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){const c=Date.now()+i,h=new Ev(e,t,c,r,o);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tv(n,e){if(pr("AsyncQueue",`${e}: ${n}`),bh(n))return new Ue(ue.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ve.comparator(t.key,i.key):(t,i)=>Ve.comparator(t.key,i.key),this.keyedMap=Cu(),this.sortedSet=new wn(this.comparator)}static emptySet(e){return new $l(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $l)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new $l;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(){this.W_=new wn(Ve.comparator)}track(e){const t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):qe():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,i)=>{e.push(i)})),e}}class nc{constructor(e,t,i,r,o,c,h,f,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,r,o){const c=[];return t.forEach((h=>{c.push({type:0,doc:h})})),new nc(e,t,$l.emptySet(t),c,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class CD{constructor(){this.queries=o2(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){const r=Ke(t),o=r.queries;r.queries=o2(),o.forEach(((c,h)=>{for(const f of h.j_)f.onError(i)}))})(this,new Ue(ue.ABORTED,"Firestore shutting down"))}}function o2(){return new mc((n=>_x(n)),Sm)}async function AD(n,e){const t=Ke(n);let i=3;const r=e.query;let o=t.queries.get(r);o?!o.H_()&&e.J_()&&(i=2):(o=new xD,i=e.J_()?0:1);try{switch(i){case 0:o.z_=await t.onListen(r,!0);break;case 1:o.z_=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(c){const h=Tv(c,`Initialization of query '${jl(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Sv(t)}async function ID(n,e){const t=Ke(n),i=e.query;let r=3;const o=t.queries.get(i);if(o){const c=o.j_.indexOf(e);c>=0&&(o.j_.splice(c,1),o.j_.length===0?r=e.J_()?0:1:!o.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function RD(n,e){const t=Ke(n);let i=!1;for(const r of e){const o=r.query,c=t.queries.get(o);if(c){for(const h of c.j_)h.X_(r)&&(i=!0);c.z_=r}}i&&Sv(t)}function ND(n,e,t){const i=Ke(n),r=i.queries.get(e);if(r)for(const o of r.j_)o.onError(t);i.queries.delete(e)}function Sv(n){n.Y_.forEach((e=>{e.next()}))}var c0,l2;(l2=c0||(c0={})).ea="default",l2.Cache="cache";class kD{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new nc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==c0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(e){this.key=e}}class Xx{constructor(e){this.key=e}}class OD{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ut(),this.mutatedKeys=ut(),this.Aa=vx(e),this.Ra=new $l(this.Aa)}get Va(){return this.Ta}ma(e,t){const i=t?t.fa:new a2,r=t?t.Ra:this.Ra;let o=t?t.mutatedKeys:this.mutatedKeys,c=r,h=!1;const f=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((v,w)=>{const T=r.get(v),x=xm(this.query,w)?w:null,N=!!T&&this.mutatedKeys.has(T.key),L=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let O=!1;T&&x?T.data.isEqual(x.data)?N!==L&&(i.track({type:3,doc:x}),O=!0):this.ga(T,x)||(i.track({type:2,doc:x}),O=!0,(f&&this.Aa(x,f)>0||m&&this.Aa(x,m)<0)&&(h=!0)):!T&&x?(i.track({type:0,doc:x}),O=!0):T&&!x&&(i.track({type:1,doc:T}),O=!0,(f||m)&&(h=!0)),O&&(x?(c=c.add(x),o=L?o.add(v):o.delete(v)):(c=c.delete(v),o=o.delete(v)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const v=this.query.limitType==="F"?c.last():c.first();c=c.delete(v.key),o=o.delete(v.key),i.track({type:1,doc:v})}return{Ra:c,fa:i,ns:h,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const c=e.fa.G_();c.sort(((v,w)=>(function(x,N){const L=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qe()}};return L(x)-L(N)})(v.type,w.type)||this.Aa(v.doc,w.doc))),this.pa(i),r=r!=null&&r;const h=t&&!r?this.ya():[],f=this.da.size===0&&this.current&&!r?1:0,m=f!==this.Ea;return this.Ea=f,c.length!==0||m?{snapshot:new nc(this.query,e.Ra,o,c,e.mutatedKeys,f===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new a2,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((t=>this.Ta=this.Ta.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ta=this.Ta.delete(t))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ut(),this.Ra.forEach((i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))}));const t=[];return e.forEach((i=>{this.da.has(i)||t.push(new Xx(i))})),this.da.forEach((i=>{e.has(i)||t.push(new Qx(i))})),t}ba(e){this.Ta=e.Ts,this.da=ut();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return nc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class DD{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class jD{constructor(e){this.key=e,this.va=!1}}class PD{constructor(e,t,i,r,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Ca={},this.Fa=new mc((h=>_x(h)),Sm),this.Ma=new Map,this.xa=new Set,this.Oa=new wn(Ve.comparator),this.Na=new Map,this.La=new pv,this.Ba={},this.ka=new Map,this.qa=tc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function MD(n,e,t=!0){const i=iC(n);let r;const o=i.Fa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.Da()):r=await Jx(i,e,t,!0),r}async function LD(n,e){const t=iC(n);await Jx(t,e,!0,!1)}async function Jx(n,e,t,i){const r=await nD(n.localStore,Cs(e)),o=r.targetId,c=n.sharedClientState.addLocalQueryTarget(o,t);let h;return i&&(h=await UD(n,e,o,c==="current",r.resumeToken)),n.isPrimaryClient&&t&&Hx(n.remoteStore,r),h}async function UD(n,e,t,i,r){n.Ka=(w,T,x)=>(async function(L,O,Z,Y){let H=O.view.ma(Z);H.ns&&(H=await n2(L.localStore,O.query,!1).then((({documents:I})=>O.view.ma(I,H))));const le=Y&&Y.targetChanges.get(O.targetId),ve=Y&&Y.targetMismatches.get(O.targetId)!=null,oe=O.view.applyChanges(H,L.isPrimaryClient,le,ve);return u2(L,O.targetId,oe.wa),oe.snapshot})(n,w,T,x);const o=await n2(n.localStore,e,!0),c=new OD(e,o.Ts),h=c.ma(o.documents),f=Eh.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),m=c.applyChanges(h,n.isPrimaryClient,f);u2(n,t,m.wa);const v=new DD(e,t,c);return n.Fa.set(e,v),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),m.snapshot}async function VD(n,e,t){const i=Ke(n),r=i.Fa.get(e),o=i.Ma.get(r.targetId);if(o.length>1)return i.Ma.set(r.targetId,o.filter((c=>!Sm(c,e)))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await l0(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&vv(i.remoteStore,r.targetId),u0(i,r.targetId)})).catch(wh)):(u0(i,r.targetId),await l0(i.localStore,r.targetId,!0))}async function zD(n,e){const t=Ke(n),i=t.Fa.get(e),r=t.Ma.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),vv(t.remoteStore,i.targetId))}async function BD(n,e,t){const i=WD(n);try{const r=await(function(c,h){const f=Ke(c),m=Cn.now(),v=h.reduce(((x,N)=>x.add(N.key)),ut());let w,T;return f.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let N=gr(),L=ut();return f.cs.getEntries(x,v).next((O=>{N=O,N.forEach(((Z,Y)=>{Y.isValidDocument()||(L=L.add(Z))}))})).next((()=>f.localDocuments.getOverlayedDocuments(x,N))).next((O=>{w=O;const Z=[];for(const Y of h){const H=a5(Y,w.get(Y.key).overlayedDocument);H!=null&&Z.push(new jo(Y.key,H,ux(H.value.mapValue),hr.exists(!0)))}return f.mutationQueue.addMutationBatch(x,m,Z,h)})).next((O=>{T=O;const Z=O.applyToLocalDocumentSet(w,L);return f.documentOverlayCache.saveOverlays(x,O.batchId,Z)}))})).then((()=>({batchId:T.batchId,changes:wx(w)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(c,h,f){let m=c.Ba[c.currentUser.toKey()];m||(m=new wn(wt)),m=m.insert(h,f),c.Ba[c.currentUser.toKey()]=m})(i,r.batchId,t),await Sh(i,r.changes),await Om(i.remoteStore)}catch(r){const o=Tv(r,"Failed to persist write");t.reject(o)}}async function Zx(n,e){const t=Ke(n);try{const i=await Z5(t.localStore,e);e.targetChanges.forEach(((r,o)=>{const c=t.Na.get(o);c&&(Nt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?c.va=!0:r.modifiedDocuments.size>0?Nt(c.va):r.removedDocuments.size>0&&(Nt(c.va),c.va=!1))})),await Sh(t,i,e)}catch(i){await wh(i)}}function c2(n,e,t){const i=Ke(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Fa.forEach(((o,c)=>{const h=c.view.Z_(e);h.snapshot&&r.push(h.snapshot)})),(function(c,h){const f=Ke(c);f.onlineState=h;let m=!1;f.queries.forEach(((v,w)=>{for(const T of w.j_)T.Z_(h)&&(m=!0)})),m&&Sv(f)})(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function FD(n,e,t){const i=Ke(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Na.get(e),o=r&&r.key;if(o){let c=new wn(Ve.comparator);c=c.insert(o,Xn.newNoDocument(o,Ge.min()));const h=ut().add(o),f=new Rm(Ge.min(),new Map,new wn(wt),c,h);await Zx(i,f),i.Oa=i.Oa.remove(o),i.Na.delete(e),xv(i)}else await l0(i.localStore,e,!1).then((()=>u0(i,e,t))).catch(wh)}async function qD(n,e){const t=Ke(n),i=e.batch.batchId;try{const r=await J5(t.localStore,e);tC(t,i,null),eC(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Sh(t,r)}catch(r){await wh(r)}}async function HD(n,e,t){const i=Ke(n);try{const r=await(function(c,h){const f=Ke(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let v;return f.mutationQueue.lookupMutationBatch(m,h).next((w=>(Nt(w!==null),v=w.keys(),f.mutationQueue.removeMutationBatch(m,w)))).next((()=>f.mutationQueue.performConsistencyCheck(m))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(m,v,h))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v))).next((()=>f.localDocuments.getDocuments(m,v)))}))})(i.localStore,e);tC(i,e,t),eC(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Sh(i,r)}catch(r){await wh(r)}}function eC(n,e){(n.ka.get(e)||[]).forEach((t=>{t.resolve()})),n.ka.delete(e)}function tC(n,e,t){const i=Ke(n);let r=i.Ba[i.currentUser.toKey()];if(r){const o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function u0(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach((i=>{n.La.containsKey(i)||nC(n,i)}))}function nC(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(vv(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),xv(n))}function u2(n,e,t){for(const i of t)i instanceof Qx?(n.La.addReference(i.key,e),$D(n,i)):i instanceof Xx?(xe("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||nC(n,i.key)):qe()}function $D(n,e){const t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(xe("SyncEngine","New document in limbo: "+t),n.xa.add(i),xv(n))}function xv(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Ve(nn.fromString(e)),i=n.qa.next();n.Na.set(i,new jD(t)),n.Oa=n.Oa.insert(t,i),Hx(n.remoteStore,new ga(Cs(uv(t.path)),i,"TargetPurposeLimboResolution",sv.oe))}}async function Sh(n,e,t){const i=Ke(n),r=[],o=[],c=[];i.Fa.isEmpty()||(i.Fa.forEach(((h,f)=>{c.push(i.Ka(f,e,t).then((m=>{var v;if((m||t)&&i.isPrimaryClient){const w=m?!m.fromCache:(v=t?.targetChanges.get(f.targetId))===null||v===void 0?void 0:v.current;i.sharedClientState.updateQueryState(f.targetId,w?"current":"not-current")}if(m){r.push(m);const w=_v.Wi(f.targetId,m);o.push(w)}})))})),await Promise.all(c),i.Ca.d_(r),await(async function(f,m){const v=Ke(f);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>ce.forEach(m,(T=>ce.forEach(T.$i,(x=>v.persistence.referenceDelegate.addReference(w,T.targetId,x))).next((()=>ce.forEach(T.Ui,(x=>v.persistence.referenceDelegate.removeReference(w,T.targetId,x)))))))))}catch(w){if(!bh(w))throw w;xe("LocalStore","Failed to update sequence numbers: "+w)}for(const w of m){const T=w.targetId;if(!w.fromCache){const x=v.os.get(T),N=x.snapshotVersion,L=x.withLastLimboFreeSnapshotVersion(N);v.os=v.os.insert(T,L)}}})(i.localStore,o))}async function GD(n,e){const t=Ke(n);if(!t.currentUser.isEqual(e)){xe("SyncEngine","User change. New user:",e.toKey());const i=await zx(t.localStore,e);t.currentUser=e,(function(o,c){o.ka.forEach((h=>{h.forEach((f=>{f.reject(new Ue(ue.CANCELLED,c))}))})),o.ka.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Sh(t,i.hs)}}function KD(n,e){const t=Ke(n),i=t.Na.get(e);if(i&&i.va)return ut().add(i.key);{let r=ut();const o=t.Ma.get(e);if(!o)return r;for(const c of o){const h=t.Fa.get(c);r=r.unionWith(h.view.Va)}return r}}function iC(n){const e=Ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Zx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FD.bind(null,e),e.Ca.d_=RD.bind(null,e.eventManager),e.Ca.$a=ND.bind(null,e.eventManager),e}function WD(n){const e=Ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=HD.bind(null,e),e}class qf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Nm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return X5(this.persistence,new Y5,e.initialUser,this.serializer)}Ga(e){return new G5(gv.Zr,this.serializer)}Wa(e){return new sD}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qf.provider={build:()=>new qf};class h0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>c2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=GD.bind(null,this.syncEngine),await SD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new CD})()}createDatastore(e){const t=Nm(e.databaseInfo.databaseId),i=(function(o){return new lD(o)})(e.databaseInfo);return(function(o,c,h,f){return new hD(o,c,h,f)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,o,c,h){return new fD(i,r,o,c,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>c2(this.syncEngine,t,0)),(function(){return s2.D()?new s2:new rD})())}createSyncEngine(e,t){return(function(r,o,c,h,f,m,v){const w=new PD(r,o,c,h,f,m);return v&&(w.Qa=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const o=Ke(r);xe("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await Th(o),o.k_.shutdown(),o.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}h0.provider={build:()=>new h0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):pr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Qn.UNAUTHENTICATED,this.clientId=ox.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,(async c=>{xe("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(xe("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ya;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Tv(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function u_(n,e){n.asyncQueue.verifyOperationInProgress(),xe("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await zx(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function h2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await XD(n);xe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>r2(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>r2(e.remoteStore,r))),n._onlineComponents=e}async function XD(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){xe("FirestoreClient","Using user provided OfflineComponentProvider");try{await u_(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ue.FAILED_PRECONDITION||r.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Xl("Error using user provided cache. Falling back to memory cache: "+t),await u_(n,new qf)}}else xe("FirestoreClient","Using default OfflineComponentProvider"),await u_(n,new qf);return n._offlineComponents}async function sC(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(xe("FirestoreClient","Using user provided OnlineComponentProvider"),await h2(n,n._uninitializedComponentsProvider._online)):(xe("FirestoreClient","Using default OnlineComponentProvider"),await h2(n,new h0))),n._onlineComponents}function JD(n){return sC(n).then((e=>e.syncEngine))}async function ZD(n){const e=await sC(n),t=e.eventManager;return t.onListen=MD.bind(null,e.syncEngine),t.onUnlisten=VD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=LD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=zD.bind(null,e.syncEngine),t}function ej(n,e,t={}){const i=new ya;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,f,m){const v=new YD({next:T=>{v.Za(),c.enqueueAndForget((()=>ID(o,w)));const x=T.docs.has(h);!x&&T.fromCache?m.reject(new Ue(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&T.fromCache&&f&&f.source==="server"?m.reject(new Ue(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(T)},error:T=>m.reject(T)}),w=new kD(uv(h.path),v,{includeMetadataChanges:!0,_a:!0});return AD(o,w)})(await ZD(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tj(n,e,t){if(!t)throw new Ue(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nj(n,e,t,i){if(e===!0&&i===!0)throw new Ue(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function f2(n){if(!Ve.isDocumentKey(n))throw new Ue(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Cv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":qe()}function Zu(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ue(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Cv(n);throw new Ue(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ue(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rC((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Ue(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Ue(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Ue(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Av{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new m2({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new m2(e),e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new mO;switch(i.type){case"firstParty":return new vO(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ue(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=d2.get(t);i&&(xe("ComponentProvider","Removing Datastore"),d2.delete(t),i.terminate())})(this),Promise.resolve()}}function ij(n,e,t,i={}){var r;const o=(n=Zu(n,Av))._getSettings(),c=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==c&&Xl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),i.mockUserToken){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=Qn.MOCK_USER;else{h=uS(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Ue(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Qn(m)}n._authCredentials=new pO(new ax(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Iv(this.firestore,e,this._query)}}class qi{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new eh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qi(this.firestore,e,this._key)}}class eh extends Iv{constructor(e,t,i){super(e,t,uv(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qi(this.firestore,null,new Ve(e))}withConverter(e){return new eh(this.firestore,e,this._path)}}function sj(n,e,...t){if(n=Yt(n),arguments.length===1&&(e=ox.newId()),tj("doc","path",e),n instanceof Av){const i=nn.fromString(e,...t);return f2(i),new qi(n,null,new Ve(i))}{if(!(n instanceof qi||n instanceof eh))throw new Ue(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nn.fromString(e,...t));return f2(i),new qi(n.firestore,n instanceof eh?n.converter:null,new Ve(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Fx(this,"async_queue_retry"),this.Vu=()=>{const i=c_();i&&xe("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;const t=c_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=c_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new ya;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!bh(e))throw e;xe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((i=>{this.Eu=i,this.du=!1;const r=(function(c){let h=c.message||"";return c.stack&&(h=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),h})(i);throw pr("INTERNAL UNHANDLED ERROR: ",r),i})).then((i=>(this.du=!1,i))))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Ev.createAndSchedule(this,e,t,i,(o=>this.yu(o)));return this.Tu.push(r),r}fu(){this.Eu&&qe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Rv extends Av{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new p2,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new p2(e),this._firestoreClient=void 0,await e}}}function rj(n,e){const t=typeof n=="object"?n:vm(),i=typeof n=="string"?n:"(default)",r=No(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const o=oS("firestore");o&&ij(r,...o)}return r}function aC(n){if(n._terminated)throw new Ue(ue.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||aj(n),n._firestoreClient}function aj(n){var e,t,i;const r=n._freezeSettings(),o=(function(h,f,m,v){return new kO(h,f,m,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,rC(v.experimentalLongPollingOptions),v.useFetchStreams)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new QD(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(h){const f=h?._online.build();return{_offline:h?._offline.build(f),_online:f}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ic(Gn.fromBase64String(e))}catch(t){throw new Ue(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ic(Gn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return wt(this._lat,e._lat)||wt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oj=/^__.*__$/;class oC{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new jo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function lC(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qe()}}class Dv{constructor(e,t,i,r,o,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Dv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Hf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(lC(this.Cu)&&oj.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class lj{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Nm(e)}Qu(e,t,i,r=!1){return new Dv({Cu:e,methodName:t,qu:i,path:Hn.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cj(n){const e=n._freezeSettings(),t=Nm(n._databaseId);return new lj(n._databaseId,!!e.ignoreUndefinedProperties,t)}class jm extends Nv{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jm}}function uj(n,e,t,i){const r=n.Qu(1,e,t);uC("Data must be an object, but it was:",r,i);const o=[],c=Ri.empty();Do(i,((f,m)=>{const v=jv(e,f,t);m=Yt(m);const w=r.Nu(v);if(m instanceof jm)o.push(v);else{const T=Pm(m,w);T!=null&&(o.push(v),c.set(v,T))}}));const h=new ns(o);return new oC(c,h,r.fieldTransforms)}function hj(n,e,t,i,r,o){const c=n.Qu(1,e,t),h=[g2(e,i,t)],f=[r];if(o.length%2!=0)throw new Ue(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)h.push(g2(e,o[T])),f.push(o[T+1]);const m=[],v=Ri.empty();for(let T=h.length-1;T>=0;--T)if(!mj(m,h[T])){const x=h[T];let N=f[T];N=Yt(N);const L=c.Nu(x);if(N instanceof jm)m.push(x);else{const O=Pm(N,L);O!=null&&(m.push(x),v.set(x,O))}}const w=new ns(m);return new oC(v,w,c.fieldTransforms)}function Pm(n,e){if(cC(n=Yt(n)))return uC("Unsupported field value:",e,n),dj(n,e);if(n instanceof Nv)return(function(i,r){if(!lC(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(i,r){const o=[];let c=0;for(const h of i){let f=Pm(h,r.Lu(c));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),c++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Yt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return e5(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Cn.fromDate(i);return{timestampValue:Bf(r.serializer,o)}}if(i instanceof Cn){const o=new Cn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Bf(r.serializer,o)}}if(i instanceof kv)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ic)return{bytesValue:Dx(r.serializer,i._byteString)};if(i instanceof qi){const o=r.databaseId,c=i.firestore._databaseId;if(!c.isEqual(o))throw r.Bu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:mv(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ov)return(function(c,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map((f=>{if(typeof f!="number")throw h.Bu("VectorValues must only contain numeric values.");return hv(h.serializer,f)}))}}}}}})(i,r);throw r.Bu(`Unsupported field value: ${Cv(i)}`)})(n,e)}function dj(n,e){const t={};return lx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Do(n,((i,r)=>{const o=Pm(r,e.Mu(i));o!=null&&(t[i]=o)})),{mapValue:{fields:t}}}function cC(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Cn||n instanceof kv||n instanceof ic||n instanceof qi||n instanceof Nv||n instanceof Ov)}function uC(n,e,t){if(!cC(t)||!(function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)})(t)){const i=Cv(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function g2(n,e,t){if((e=Yt(e))instanceof Dm)return e._internalPath;if(typeof e=="string")return jv(n,e);throw Hf("Field path arguments must be of type string or ",n,!1,void 0,t)}const fj=new RegExp("[~\\*/\\[\\]]");function jv(n,e,t){if(e.search(fj)>=0)throw Hf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Dm(...e.split("."))._internalPath}catch{throw Hf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Hf(n,e,t,i,r){const o=i&&!i.isEmpty(),c=r!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||c)&&(f+=" (found",o&&(f+=` in field ${i}`),c&&(f+=` in document ${r}`),f+=")"),new Ue(ue.INVALID_ARGUMENT,h+n+f)}function mj(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new qi(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(dC("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class pj extends hC{data(){return super.data()}}function dC(n,e){return typeof e=="string"?jv(n,e):e instanceof Dm?e._internalPath:e._delegate._internalPath}class gj{convertValue(e,t="none"){switch(To(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Eo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw qe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Do(e,((r,o)=>{i[r]=this.convertValue(o,t)})),i}convertVectorValue(e){var t,i,r;const o=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map((c=>cn(c.doubleValue)));return new Ov(o)}convertGeoPoint(e){return new kv(cn(e.latitude),cn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=av(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Wu(e));default:return null}}convertTimestamp(e){const t=Sa(e);return new Cn(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=nn.fromString(e);Nt(Vx(i));const r=new Yu(i.get(1),i.get(3)),o=new Ve(i.popFirst(5));return r.isEqual(t)||pr(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fC extends hC{constructor(e,t,i,r,o,c){super(e,t,i,r,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vj(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(dC("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class vj extends fC{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yj(n){n=Zu(n,qi);const e=Zu(n.firestore,Rv);return ej(aC(e),n._key).then((t=>Tj(e,n,t)))}class wj extends gj{constructor(e){super(),this.firestore=e}convertBytes(e){return new ic(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new qi(this.firestore,null,t)}}function bj(n,e,t,...i){n=Zu(n,qi);const r=Zu(n.firestore,Rv),o=cj(r);let c;return c=typeof(e=Yt(e))=="string"||e instanceof Dm?hj(o,"updateDoc",n._key,e,t,i):uj(o,"updateDoc",n._key,e),Ej(r,[c.toMutation(n._key,hr.exists(!0))])}function Ej(n,e){return(function(i,r){const o=new ya;return i.asyncQueue.enqueueAndForget((async()=>BD(await JD(i),r,o))),o.promise})(aC(n),e)}function Tj(n,e,t){const i=t.docs.get(e._key),r=new wj(n);return new fC(n,r,e._key,i,new _j(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){fc=r})(ko),os(new Hi("firestore",((i,{instanceIdentifier:r,options:o})=>{const c=i.getProvider("app").getImmediate(),h=new Rv(new gO(i.getProvider("auth-internal")),new wO(i.getProvider("app-check-internal")),(function(m,v){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ue(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yu(m.options.projectId,v)})(c,r),c);return o=Object.assign({useFetchStreams:t},o),h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),_i(PE,"4.7.3",e),_i(PE,"4.7.3","esm2017")})();var _2={};const v2="@firebase/database",y2="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mC="";function Sj(n){mC=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Tn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Hu(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return yr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new xj(e)}}catch{}return new Cj},po=pC("localStorage"),Aj=pC("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl=new gm("@firebase/database"),Ij=(function(){let n=1;return function(){return n++}})(),gC=function(n){const e=$N(n),t=new BN;t.update(e);const i=t.digest();return q0.encodeByteArray(i)},xh=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=xh.apply(null,i):typeof i=="object"?e+=Tn(i):e+=i,e+=" "}return e};let ju=null,w2=!0;const Rj=function(n,e){fe(!0,"Can't turn on custom loggers persistently."),Gl.logLevel=ct.VERBOSE,ju=Gl.log.bind(Gl)},Jn=function(...n){if(w2===!0&&(w2=!1,ju===null&&Aj.get("logging_enabled")===!0&&Rj()),ju){const e=xh.apply(null,n);ju(e)}},Ch=function(n){return function(...e){Jn(n,...e)}},d0=function(...n){const e="FIREBASE INTERNAL ERROR: "+xh(...n);Gl.error(e)},_r=function(...n){const e=`FIREBASE FATAL ERROR: ${xh(...n)}`;throw Gl.error(e),new Error(e)},Ni=function(...n){const e="FIREBASE WARNING: "+xh(...n);Gl.warn(e)},Nj=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ni("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},_C=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},kj=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},sc="[MIN_NAME]",So="[MAX_NAME]",gc=function(n,e){if(n===e)return 0;if(n===sc||e===So)return-1;if(e===sc||n===So)return 1;{const t=b2(n),i=b2(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},Oj=function(n,e){return n===e?0:n<e?-1:1},vu=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Tn(e))},Pv=function(n){if(typeof n!="object"||n===null)return Tn(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=Tn(e[i]),t+=":",t+=Pv(n[e[i]]);return t+="}",t},vC=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function vi(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const yC=function(n){fe(!_C(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let r,o,c,h,f;n===0?(o=0,c=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=h+i,c=Math.round(n*Math.pow(2,t-h)-Math.pow(2,t))):(o=0,c=Math.round(n/Math.pow(2,1-i-t))));const m=[];for(f=t;f;f-=1)m.push(c%2?1:0),c=Math.floor(c/2);for(f=e;f;f-=1)m.push(o%2?1:0),o=Math.floor(o/2);m.push(r?1:0),m.reverse();const v=m.join("");let w="";for(f=0;f<64;f+=8){let T=parseInt(v.substr(f,8),2).toString(16);T.length===1&&(T="0"+T),w=w+T}return w.toLowerCase()},Dj=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},jj=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Pj(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const Mj=new RegExp("^-?(0*)\\d{1,10}$"),Lj=-2147483648,Uj=2147483647,b2=function(n){if(Mj.test(n)){const e=Number(n);if(e>=Lj&&e<=Uj)return e}return null},Ah=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Ni("Exception was thrown by user callback.",t),e},Math.floor(0))}},Vj=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Pu=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Ni(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Jn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ni(e)}}class Sf{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Sf.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv="5",wC="v",bC="s",EC="r",TC="f",SC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,xC="ls",CC="p",f0="ac",AC="websocket",IC="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,t,i,r,o=!1,c="",h=!1,f=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=o,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=f,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=po.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&po.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Fj(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function NC(n,e,t){fe(typeof e=="string","typeof type must == string"),fe(typeof t=="object","typeof params must == object");let i;if(e===AC)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===IC)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Fj(n)&&(t.ns=n.namespace);const r=[];return vi(t,(o,c)=>{r.push(o+"="+c)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(){this.counters_={}}incrementCounter(e,t=1){yr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return TN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_={},d_={};function Lv(n){const e=n.toString();return h_[e]||(h_[e]=new qj),h_[e]}function Hj(n,e){const t=n.toString();return d_[t]||(d_[t]=e()),d_[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Ah(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2="start",Gj="close",Kj="pLPCommand",Wj="pRTLPCB",kC="id",OC="pw",DC="ser",Yj="cb",Qj="seg",Xj="ts",Jj="d",Zj="dframe",jC=1870,PC=30,eP=jC-PC,tP=25e3,nP=3e4;class zl{constructor(e,t,i,r,o,c,h){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=o,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ch(e),this.stats_=Lv(t),this.urlFn=f=>(this.appCheckToken&&(f[f0]=this.appCheckToken),NC(t,IC,f))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new $j(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(nP)),kj(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Uv((...o)=>{const[c,h,f,m,v]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===E2)this.id=h,this.password=f;else if(c===Gj)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...o)=>{const[c,h]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const i={};i[E2]="t",i[DC]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Yj]=this.scriptTagHolder.uniqueCallbackIdentifier),i[wC]=Mv,this.transportSessionId&&(i[bC]=this.transportSessionId),this.lastSessionId&&(i[xC]=this.lastSessionId),this.applicationId&&(i[CC]=this.applicationId),this.appCheckToken&&(i[f0]=this.appCheckToken),typeof location<"u"&&location.hostname&&SC.test(location.hostname)&&(i[EC]=TC);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){zl.forceAllow_=!0}static forceDisallow(){zl.forceDisallow_=!0}static isAvailable(){return zl.forceAllow_?!0:!zl.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Dj()&&!jj()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Tn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=sS(t),r=vC(i,eP);for(let o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[Zj]="t",i[kC]=e,i[OC]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Tn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Uv{constructor(e,t,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Ij(),window[Kj+this.uniqueCallbackIdentifier]=e,window[Wj+this.uniqueCallbackIdentifier]=t,this.myIFrame=Uv.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){Jn("frame writing exception"),h.stack&&Jn(h.stack),Jn(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Jn("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[kC]=this.myID,e[OC]=this.myPW,e[DC]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+PC+i.length<=jC;){const c=this.pendingSegs.shift();i=i+"&"+Qj+r+"="+c.seg+"&"+Xj+r+"="+c.ts+"&"+Jj+r+"="+c.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(tP)),o=()=>{clearTimeout(r),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Jn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=16384,sP=45e3;let $f=null;typeof MozWebSocket<"u"?$f=MozWebSocket:typeof WebSocket<"u"&&($f=WebSocket);class ts{constructor(e,t,i,r,o,c,h){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ch(this.connId),this.stats_=Lv(t),this.connURL=ts.connectionURL_(t,c,h,r,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,r,o){const c={};return c[wC]=Mv,typeof location<"u"&&location.hostname&&SC.test(location.hostname)&&(c[EC]=TC),t&&(c[bC]=t),i&&(c[xC]=i),r&&(c[f0]=r),o&&(c[CC]=o),NC(e,AC,c)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,po.set("previous_websocket_failure",!0);try{let i;DN(),this.mySock=new $f(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){ts.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&$f!==null&&!ts.forceDisallow_}static previouslyFailed(){return po.isInMemoryStorage||po.get("previous_websocket_failure")===!0}markConnectionHealthy(){po.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=Hu(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(fe(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=Tn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=vC(t,iP);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(sP))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ts.responsesRequiredToBeHealthy=2;ts.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[zl,ts]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=ts&&ts.isAvailable();let i=t&&!ts.previouslyFailed();if(e.webSocketOnly&&(t||Ni("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ts];else{const r=this.transports_=[];for(const o of th.ALL_TRANSPORTS)o&&o.isAvailable()&&r.push(o);th.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}th.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP=6e4,aP=5e3,oP=10*1024,lP=100*1024,f_="t",T2="d",cP="s",S2="r",uP="e",x2="o",C2="a",A2="n",I2="p",hP="h";class dP{constructor(e,t,i,r,o,c,h,f,m,v){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=o,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=f,this.onKill_=m,this.lastSessionId=v,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ch("c:"+this.id+":"),this.transportManager_=new th(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Pu(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>lP?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>oP?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(f_ in e){const t=e[f_];t===C2?this.upgradeIfSecondaryHealthy_():t===S2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===x2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=vu("t",e),i=vu("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:I2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:C2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:A2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=vu("t",e),i=vu("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=vu(f_,e);if(T2 in e){const i=e[T2];if(t===hP){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===A2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===cP?this.onConnectionShutdown_(i):t===S2?this.onReset_(i):t===uP?d0("Server Error: "+i):t===x2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):d0("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Mv!==i&&Ni("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Pu(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(rP))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Pu(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(aP))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:I2,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(po.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e){this.allowedEvents_=e,this.listeners_={},fe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let o=0;o<r.length;o++)if(r[o].callback===t&&(!i||i===r[o].context)){r.splice(o,1);return}}validateEventType_(e){fe(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf extends LC{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!$0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Gf}getInitialEvent(e){return fe(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2=32,N2=768;class Mt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function bt(){return new Mt("")}function rt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Ca(n){return n.pieces_.length-n.pieceNum_}function Vt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Mt(n.pieces_,e)}function UC(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function fP(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function VC(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function zC(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Mt(e,0)}function xn(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Mt)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new Mt(t,0)}function at(n){return n.pieceNum_>=n.pieces_.length}function ai(n,e){const t=rt(n),i=rt(e);if(t===null)return e;if(t===i)return ai(Vt(n),Vt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Vv(n,e){if(Ca(n)!==Ca(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function is(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Ca(n)>Ca(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class mP{constructor(e,t){this.errorPrefix_=t,this.parts_=VC(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=pm(this.parts_[i]);BC(this)}}function pP(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=pm(e),BC(n)}function gP(n){const e=n.parts_.pop();n.byteLength_-=pm(e),n.parts_.length>0&&(n.byteLength_-=1)}function BC(n){if(n.byteLength_>N2)throw new Error(n.errorPrefix_+"has a key path longer than "+N2+" bytes ("+n.byteLength_+").");if(n.parts_.length>R2)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+R2+") or object contains a cycle "+co(n))}function co(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv extends LC{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new zv}getInitialEvent(e){return fe(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yu=1e3,_P=300*1e3,k2=30*1e3,vP=1.3,yP=3e4,wP="server_kill",O2=3;class dr extends MC{constructor(e,t,i,r,o,c,h,f){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=h,this.authOverride_=f,this.id=dr.nextPersistentConnectionId_++,this.log_=Ch("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=yu,this.maxReconnectDelay_=_P,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,f)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");zv.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Gf.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const r=++this.requestNumber_,o={r,a:e,b:t};this.log_(Tn(o)),fe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[r]=i)}get(e){this.initConnection_();const t=new H0,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const h=c.d;c.s==="ok"?t.resolve(h):t.reject(h)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,r){this.initConnection_();const o=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),fe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),fe(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");const h={onComplete:r,hashFn:t,query:e,tag:i};this.listens.get(c).set(o,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+i+" for "+r);const o={p:i},c="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(c,o,h=>{const f=h.d,m=h.s;dr.warnOnListenWarnings_(f,t),(this.listens.get(i)&&this.listens.get(i).get(r))===e&&(this.log_("listen response",h),m!=="ok"&&this.removeListen_(i,r),e.onComplete&&e.onComplete(m,f))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&yr(e,"w")){const i=Yl(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Ni(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||zN(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=k2)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=VN(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,r=>{const o=r.s,c=r.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),fe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,e._queryObject,t)}sendUnlisten_(e,t,i,r){this.log_("Unlisten on "+e+" for "+t);const o={p:e},c="n";r&&(o.q=i,o.t=r),this.sendRequest(c,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,r){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,c=>{r&&setTimeout(()=>{r(c.s,c.d)},Math.floor(0))})}put(e,t,i,r){this.putInternal("p",e,t,i,r)}merge(e,t,i,r){this.putInternal("m",e,t,i,r)}putInternal(e,t,i,r,o){this.initConnection_();const c={p:t,d:i};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:e,request:c,onComplete:r}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Tn(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):d0("Unrecognized action received from server: "+Tn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){fe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yu,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=yu,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>yP&&(this.reconnectDelay_=yu),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*vP)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+dr.nextConnectionId_++,o=this.lastSessionId;let c=!1,h=null;const f=function(){h?h.close():(c=!0,i())},m=function(w){fe(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(w)};this.realtime_={close:f,sendRequest:m};const v=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[w,T]=await Promise.all([this.authTokenProvider_.getToken(v),this.appCheckTokenProvider_.getToken(v)]);c?Jn("getToken() completed but was canceled"):(Jn("getToken() completed. Creating connection."),this.authToken_=w&&w.accessToken,this.appCheckToken_=T&&T.token,h=new dP(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,x=>{Ni(x+" ("+this.repoInfo_.toString()+")"),this.interrupt(wP)},o))}catch(w){this.log_("Failed to get token: "+w),c||(this.repoInfo_.nodeAdmin&&Ni(w),f())}}}interrupt(e){Jn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Jn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],B_(this.interruptReasons_)&&(this.reconnectDelay_=yu,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>Pv(o)).join("$"):i="default";const r=this.removeListen_(e,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const i=new Mt(e).toString();let r;if(this.listens.has(i)){const o=this.listens.get(i);r=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(e,t){Jn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=O2&&(this.reconnectDelay_=k2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Jn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=O2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+mC.replace(/\./g,"-")]=1,$0()?e["framework.cordova"]=1:hS()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Gf.getInstance().currentlyOnline();return B_(this.interruptReasons_)&&e}}dr.nextPersistentConnectionId_=0;dr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new tt(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new tt(sc,e),r=new tt(sc,t);return this.compare(i,r)!==0}minPost(){return tt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uf;class FC extends Mm{static get __EMPTY_NODE(){return uf}static set __EMPTY_NODE(e){uf=e}compare(e,t){return gc(e.name,t.name)}isDefinedOn(e){throw uc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return tt.MIN}maxPost(){return new tt(So,uf)}makePost(e,t){return fe(typeof e=="string","KeyIndex indexValue must always be a string."),new tt(e,uf)}toString(){return".key"}}const Kl=new FC;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,t,i,r,o=null){this.isReverse_=r,this.resultGenerator_=o,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?i(e.key,t):1,r&&(c*=-1),c<0)this.isReverse_?e=e.left:e=e.right;else if(c===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Mn{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??Mn.RED,this.left=r??gi.EMPTY_NODE,this.right=o??gi.EMPTY_NODE}copy(e,t,i,r,o){return new Mn(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const o=i(e,r.key);return o<0?r=r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r=r.copy(null,t,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return gi.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,r;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return gi.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Mn.RED=!0;Mn.BLACK=!1;class bP{copy(e,t,i,r,o){return this}insert(e,t,i){return new Mn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class gi{constructor(e,t=gi.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new gi(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Mn.BLACK,null,null))}remove(e){return new gi(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Mn.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new hf(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new hf(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new hf(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new hf(this.root_,null,this.comparator_,!0,e)}}gi.EMPTY_NODE=new bP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(n,e){return gc(n.name,e.name)}function Bv(n,e){return gc(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m0;function TP(n){m0=n}const qC=function(n){return typeof n=="number"?"number:"+yC(n):"string:"+n},HC=function(n){if(n.isLeafNode()){const e=n.val();fe(typeof e=="string"||typeof e=="number"||typeof e=="object"&&yr(e,".sv"),"Priority must be a string or number.")}else fe(n===m0||n.isEmpty(),"priority of unexpected type.");fe(n===m0||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D2;class jn{constructor(e,t=jn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,fe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),HC(this.priorityNode_)}static set __childrenNodeConstructor(e){D2=e}static get __childrenNodeConstructor(){return D2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new jn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:jn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return at(e)?this:rt(e)===".priority"?this.priorityNode_:jn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:jn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=rt(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(fe(i!==".priority"||Ca(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,jn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Vt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+qC(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=yC(this.value_):e+=this.value_,this.lazyHash_=gC(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===jn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof jn.__childrenNodeConstructor?-1:(fe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,r=jn.VALUE_TYPE_ORDER.indexOf(t),o=jn.VALUE_TYPE_ORDER.indexOf(i);return fe(r>=0,"Unknown leaf type: "+t),fe(o>=0,"Unknown leaf type: "+i),r===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}jn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $C,GC;function SP(n){$C=n}function xP(n){GC=n}class CP extends Mm{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),o=i.compareTo(r);return o===0?gc(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return tt.MIN}maxPost(){return new tt(So,new jn("[PRIORITY-POST]",GC))}makePost(e,t){const i=$C(e);return new tt(t,new jn("[PRIORITY-POST]",i))}toString(){return".priority"}}const sn=new CP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP=Math.log(2);class IP{constructor(e){const t=o=>parseInt(Math.log(o)/AP,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Kf=function(n,e,t,i){n.sort(e);const r=function(f,m){const v=m-f;let w,T;if(v===0)return null;if(v===1)return w=n[f],T=t?t(w):w,new Mn(T,w.node,Mn.BLACK,null,null);{const x=parseInt(v/2,10)+f,N=r(f,x),L=r(x+1,m);return w=n[x],T=t?t(w):w,new Mn(T,w.node,Mn.BLACK,N,L)}},o=function(f){let m=null,v=null,w=n.length;const T=function(N,L){const O=w-N,Z=w;w-=N;const Y=r(O+1,Z),H=n[O],le=t?t(H):H;x(new Mn(le,H.node,L,null,Y))},x=function(N){m?(m.left=N,m=N):(v=N,m=N)};for(let N=0;N<f.count;++N){const L=f.nextBitIsOne(),O=Math.pow(2,f.count-(N+1));L?T(O,Mn.BLACK):(T(O,Mn.BLACK),T(O,Mn.RED))}return v},c=new IP(n.length),h=o(c);return new gi(i||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m_;const El={};class lr{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return fe(El&&sn,"ChildrenNode.ts has not been loaded"),m_=m_||new lr({".priority":El},{".priority":sn}),m_}get(e){const t=Yl(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof gi?t:null}hasIndex(e){return yr(this.indexSet_,e.toString())}addIndex(e,t){fe(e!==Kl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const o=t.getIterator(tt.Wrap);let c=o.getNext();for(;c;)r=r||e.isDefinedOn(c.node),i.push(c),c=o.getNext();let h;r?h=Kf(i,e.getCompare()):h=El;const f=e.toString(),m=Object.assign({},this.indexSet_);m[f]=e;const v=Object.assign({},this.indexes_);return v[f]=h,new lr(v,m)}addToIndexes(e,t){const i=If(this.indexes_,(r,o)=>{const c=Yl(this.indexSet_,o);if(fe(c,"Missing index implementation for "+o),r===El)if(c.isDefinedOn(e.node)){const h=[],f=t.getIterator(tt.Wrap);let m=f.getNext();for(;m;)m.name!==e.name&&h.push(m),m=f.getNext();return h.push(e),Kf(h,c.getCompare())}else return El;else{const h=t.get(e.name);let f=r;return h&&(f=f.remove(new tt(e.name,h))),f.insert(e,e.node)}});return new lr(i,this.indexSet_)}removeFromIndexes(e,t){const i=If(this.indexes_,r=>{if(r===El)return r;{const o=t.get(e.name);return o?r.remove(new tt(e.name,o)):r}});return new lr(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wu;class ze{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&HC(this.priorityNode_),this.children_.isEmpty()&&fe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return wu||(wu=new ze(new gi(Bv),null,lr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||wu}updatePriority(e){return this.children_.isEmpty()?this:new ze(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?wu:t}}getChild(e){const t=rt(e);return t===null?this:this.getImmediateChild(t).getChild(Vt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(fe(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new tt(e,t);let r,o;t.isEmpty()?(r=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const c=r.isEmpty()?wu:this.priorityNode_;return new ze(r,c,o)}}updateChild(e,t){const i=rt(e);if(i===null)return t;{fe(rt(e)!==".priority"||Ca(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(Vt(e),t);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,r=0,o=!0;if(this.forEachChild(sn,(c,h)=>{t[c]=h.val(e),i++,o&&ze.INTEGER_REGEXP_.test(c)?r=Math.max(r,Number(c)):o=!1}),!e&&o&&r<2*i){const c=[];for(const h in t)c[h]=t[h];return c}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+qC(this.getPriority().val())+":"),this.forEachChild(sn,(t,i)=>{const r=i.hash();r!==""&&(e+=":"+t+":"+r)}),this.lazyHash_=e===""?"":gC(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const r=this.resolveIndex_(i);if(r){const o=r.getPredecessorKey(new tt(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new tt(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new tt(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(r=>t(r.name,r.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,tt.Wrap);let o=r.peek();for(;o!=null&&t.compare(o,e)<0;)r.getNext(),o=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,tt.Wrap);let o=r.peek();for(;o!=null&&t.compare(o,e)>0;)r.getNext(),o=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ih?-1:0}withIndex(e){if(e===Kl||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ze(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Kl||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(sn),r=t.getIterator(sn);let o=i.getNext(),c=r.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=i.getNext(),c=r.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(e){return e===Kl?null:this.indexMap_.get(e.toString())}}ze.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class RP extends ze{constructor(){super(new gi(Bv),ze.EMPTY_NODE,lr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ze.EMPTY_NODE}isEmpty(){return!1}}const Ih=new RP;Object.defineProperties(tt,{MIN:{value:new tt(sc,ze.EMPTY_NODE)},MAX:{value:new tt(So,Ih)}});FC.__EMPTY_NODE=ze.EMPTY_NODE;jn.__childrenNodeConstructor=ze;TP(Ih);xP(Ih);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP=!0;function qn(n,e=null){if(n===null)return ze.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),fe(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new jn(t,qn(e))}if(!(n instanceof Array)&&NP){const t=[];let i=!1;if(vi(n,(c,h)=>{if(c.substring(0,1)!=="."){const f=qn(h);f.isEmpty()||(i=i||!f.getPriority().isEmpty(),t.push(new tt(c,f)))}}),t.length===0)return ze.EMPTY_NODE;const o=Kf(t,EP,c=>c.name,Bv);if(i){const c=Kf(t,sn.getCompare());return new ze(o,qn(e),new lr({".priority":c},{".priority":sn}))}else return new ze(o,qn(e),lr.Default)}else{let t=ze.EMPTY_NODE;return vi(n,(i,r)=>{if(yr(n,i)&&i.substring(0,1)!=="."){const o=qn(r);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(qn(e))}}SP(qn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP extends Mm{constructor(e){super(),this.indexPath_=e,fe(!at(e)&&rt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),o=i.compareTo(r);return o===0?gc(e.name,t.name):o}makePost(e,t){const i=qn(e),r=ze.EMPTY_NODE.updateChild(this.indexPath_,i);return new tt(t,r)}maxPost(){const e=ze.EMPTY_NODE.updateChild(this.indexPath_,Ih);return new tt(So,e)}toString(){return VC(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP extends Mm{compare(e,t){const i=e.node.compareTo(t.node);return i===0?gc(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return tt.MIN}maxPost(){return tt.MAX}makePost(e,t){const i=qn(e);return new tt(t,i)}toString(){return".value"}}const DP=new OP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(n){return{type:"value",snapshotNode:n}}function rc(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function nh(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function ih(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function jP(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e){this.index_=e}updateChild(e,t,i,r,o,c){fe(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(r).equals(i.getChild(r))&&h.isEmpty()===i.isEmpty()||(c!=null&&(i.isEmpty()?e.hasChild(t)?c.trackChildChange(nh(t,h)):fe(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(rc(t,i)):c.trackChildChange(ih(t,i,h))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(sn,(r,o)=>{t.hasChild(r)||i.trackChildChange(nh(r,o))}),t.isLeafNode()||t.forEachChild(sn,(r,o)=>{if(e.hasChild(r)){const c=e.getImmediateChild(r);c.equals(o)||i.trackChildChange(ih(r,o,c))}else i.trackChildChange(rc(r,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ze.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e){this.indexedFilter_=new Fv(e.getIndex()),this.index_=e.getIndex(),this.startPost_=sh.getStartPost_(e),this.endPost_=sh.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,o,c){return this.matches(new tt(t,i))||(i=ze.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,o,c)}updateFullNode(e,t,i){t.isLeafNode()&&(t=ze.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(ze.EMPTY_NODE);const o=this;return t.forEachChild(sn,(c,h)=>{o.matches(new tt(c,h))||(r=r.updateImmediateChild(c,ze.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new sh(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,o,c){return this.rangedFilter_.matches(new tt(t,i))||(i=ze.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,o,c):this.fullLimitUpdateChild_(e,t,i,o,c)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=ze.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=ze.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;o.hasNext()&&c<this.limit_;){const h=o.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))r=r.updateImmediateChild(h.name,h.node),c++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(ze.EMPTY_NODE);let o;this.reverse_?o=r.getReverseIterator(this.index_):o=r.getIterator(this.index_);let c=0;for(;o.hasNext();){const h=o.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:r=r.updateImmediateChild(h.name,ze.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,o){let c;if(this.reverse_){const w=this.index_.getCompare();c=(T,x)=>w(x,T)}else c=this.index_.getCompare();const h=e;fe(h.numChildren()===this.limit_,"");const f=new tt(t,i),m=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),v=this.rangedFilter_.matches(f);if(h.hasChild(t)){const w=h.getImmediateChild(t);let T=r.getChildAfterChild(this.index_,m,this.reverse_);for(;T!=null&&(T.name===t||h.hasChild(T.name));)T=r.getChildAfterChild(this.index_,T,this.reverse_);const x=T==null?1:c(T,f);if(v&&!i.isEmpty()&&x>=0)return o?.trackChildChange(ih(t,i,w)),h.updateImmediateChild(t,i);{o?.trackChildChange(nh(t,w));const L=h.updateImmediateChild(t,ze.EMPTY_NODE);return T!=null&&this.rangedFilter_.matches(T)?(o?.trackChildChange(rc(T.name,T.node)),L.updateImmediateChild(T.name,T.node)):L}}else return i.isEmpty()?e:v&&c(m,f)>=0?(o!=null&&(o.trackChildChange(nh(m.name,m.node)),o.trackChildChange(rc(t,i))),h.updateImmediateChild(t,i).updateImmediateChild(m.name,ze.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=sn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return fe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return fe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:sc}hasEnd(){return this.endSet_}getIndexEndValue(){return fe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return fe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:So}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return fe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===sn}copy(){const e=new qv;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function MP(n){return n.loadsAllData()?new Fv(n.getIndex()):n.hasLimit()?new PP(n):new sh(n)}function j2(n){const e={};if(n.isDefault())return e;let t;if(n.index_===sn?t="$priority":n.index_===DP?t="$value":n.index_===Kl?t="$key":(fe(n.index_ instanceof kP,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Tn(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=Tn(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+Tn(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=Tn(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+Tn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function P2(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==sn&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf extends MC{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Ch("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(fe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const c=Wf.getListenId_(e,i),h={};this.listens_[c]=h;const f=j2(e._queryParams);this.restRequest_(o+".json",f,(m,v)=>{let w=v;if(m===404&&(w=null,m=null),m===null&&this.onDataUpdate_(o,w,!1,i),Yl(this.listens_,c)===h){let T;m?m===401?T="permission_denied":T="rest_error:"+m:T="ok",r(T,null)}})}unlisten(e,t){const i=Wf.getListenId_(e,t);delete this.listens_[i]}get(e){const t=j2(e._queryParams),i=e._path.toString(),r=new H0;return this.restRequest_(i+".json",t,(o,c)=>{let h=c;o===404&&(h=null,o=null),o===null?(this.onDataUpdate_(i,h,!1,null),r.resolve(h)):r.reject(new Error(h))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,o])=>{r&&r.accessToken&&(t.auth=r.accessToken),o&&o.token&&(t.ac=o.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+hc(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(i&&h.readyState===4){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let f=null;if(h.status>=200&&h.status<300){try{f=Hu(h.responseText)}catch{Ni("Failed to parse JSON response for "+c+": "+h.responseText)}i(null,f)}else h.status!==401&&h.status!==404&&Ni("Got unsuccessful REST response for "+c+" Status: "+h.status),i(h.status);i=null}},h.open("GET",c,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.rootNode_=ze.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(){return{value:null,children:new Map}}function WC(n,e,t){if(at(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=rt(e);n.children.has(i)||n.children.set(i,Yf());const r=n.children.get(i);e=Vt(e),WC(r,e,t)}}function p0(n,e,t){n.value!==null?t(e,n.value):UP(n,(i,r)=>{const o=new Mt(e.toString()+"/"+i);p0(r,o,t)})}function UP(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&vi(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2=10*1e3,zP=30*1e3,BP=300*1e3;class FP{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new VP(e);const i=M2+(zP-M2)*Math.random();Pu(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;vi(e,(r,o)=>{o>0&&yr(this.statsToReport_,r)&&(t[r]=o,i=!0)}),i&&this.server_.reportStats(t),Pu(this.reportStats_.bind(this),Math.floor(Math.random()*2*BP))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ss;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ss||(ss={}));function YC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Hv(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function $v(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=ss.ACK_USER_WRITE,this.source=YC()}operationForChild(e){if(at(this.path)){if(this.affectedTree.value!=null)return fe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Mt(e));return new Qf(bt(),t,this.revert)}}else return fe(rt(this.path)===e,"operationForChild called for unrelated child."),new Qf(Vt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t){this.source=e,this.path=t,this.type=ss.LISTEN_COMPLETE}operationForChild(e){return at(this.path)?new rh(this.source,bt()):new rh(this.source,Vt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=ss.OVERWRITE}operationForChild(e){return at(this.path)?new xo(this.source,bt(),this.snap.getImmediateChild(e)):new xo(this.source,Vt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=ss.MERGE}operationForChild(e){if(at(this.path)){const t=this.children.subtree(new Mt(e));return t.isEmpty()?null:t.value?new xo(this.source,bt(),t.value):new ah(this.source,bt(),t)}else return fe(rt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ah(this.source,Vt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(at(e))return this.isFullyInitialized()&&!this.filtered_;const t=rt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function HP(n,e,t,i){const r=[],o=[];return e.forEach(c=>{c.type==="child_changed"&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&o.push(jP(c.childName,c.snapshotNode))}),bu(n,r,"child_removed",e,i,t),bu(n,r,"child_added",e,i,t),bu(n,r,"child_moved",o,i,t),bu(n,r,"child_changed",e,i,t),bu(n,r,"value",e,i,t),r}function bu(n,e,t,i,r,o){const c=i.filter(h=>h.type===t);c.sort((h,f)=>GP(n,h,f)),c.forEach(h=>{const f=$P(n,h,o);r.forEach(m=>{m.respondsTo(h.type)&&e.push(m.createEvent(f,n.query_))})})}function $P(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function GP(n,e,t){if(e.childName==null||t.childName==null)throw uc("Should only compare child_ events.");const i=new tt(e.childName,e.snapshotNode),r=new tt(t.childName,t.snapshotNode);return n.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(n,e){return{eventCache:n,serverCache:e}}function Mu(n,e,t,i){return Lm(new Aa(e,t,i),n.serverCache)}function QC(n,e,t,i){return Lm(n.eventCache,new Aa(e,t,i))}function Xf(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Co(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let p_;const KP=()=>(p_||(p_=new gi(Oj)),p_);class $t{constructor(e,t=KP()){this.value=e,this.children=t}static fromObject(e){let t=new $t(null);return vi(e,(i,r)=>{t=t.set(new Mt(i),r)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:bt(),value:this.value};if(at(e))return null;{const i=rt(e),r=this.children.get(i);if(r!==null){const o=r.findRootMostMatchingPathAndValue(Vt(e),t);return o!=null?{path:xn(new Mt(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(at(e))return this;{const t=rt(e),i=this.children.get(t);return i!==null?i.subtree(Vt(e)):new $t(null)}}set(e,t){if(at(e))return new $t(t,this.children);{const i=rt(e),o=(this.children.get(i)||new $t(null)).set(Vt(e),t),c=this.children.insert(i,o);return new $t(this.value,c)}}remove(e){if(at(e))return this.children.isEmpty()?new $t(null):new $t(null,this.children);{const t=rt(e),i=this.children.get(t);if(i){const r=i.remove(Vt(e));let o;return r.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,r),this.value===null&&o.isEmpty()?new $t(null):new $t(this.value,o)}else return this}}get(e){if(at(e))return this.value;{const t=rt(e),i=this.children.get(t);return i?i.get(Vt(e)):null}}setTree(e,t){if(at(e))return t;{const i=rt(e),o=(this.children.get(i)||new $t(null)).setTree(Vt(e),t);let c;return o.isEmpty()?c=this.children.remove(i):c=this.children.insert(i,o),new $t(this.value,c)}}fold(e){return this.fold_(bt(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,o)=>{i[r]=o.fold_(xn(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,bt(),t)}findOnPath_(e,t,i){const r=this.value?i(t,this.value):!1;if(r)return r;if(at(e))return null;{const o=rt(e),c=this.children.get(o);return c?c.findOnPath_(Vt(e),xn(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,bt(),t)}foreachOnPath_(e,t,i){if(at(e))return this;{this.value&&i(t,this.value);const r=rt(e),o=this.children.get(r);return o?o.foreachOnPath_(Vt(e),xn(t,r),i):new $t(null)}}foreach(e){this.foreach_(bt(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(xn(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.writeTree_=e}static empty(){return new as(new $t(null))}}function Lu(n,e,t){if(at(e))return new as(new $t(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const r=i.path;let o=i.value;const c=ai(r,e);return o=o.updateChild(c,t),new as(n.writeTree_.set(r,o))}else{const r=new $t(t),o=n.writeTree_.setTree(e,r);return new as(o)}}}function L2(n,e,t){let i=n;return vi(t,(r,o)=>{i=Lu(i,xn(e,r),o)}),i}function U2(n,e){if(at(e))return as.empty();{const t=n.writeTree_.setTree(e,new $t(null));return new as(t)}}function g0(n,e){return Mo(n,e)!=null}function Mo(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ai(t.path,e)):null}function V2(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(sn,(i,r)=>{e.push(new tt(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new tt(i,r.value))}),e}function ba(n,e){if(at(e))return n;{const t=Mo(n,e);return t!=null?new as(new $t(t)):new as(n.writeTree_.subtree(e))}}function _0(n){return n.writeTree_.isEmpty()}function ac(n,e){return XC(bt(),n.writeTree_,e)}function XC(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,o)=>{r===".priority"?(fe(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=XC(xn(n,r),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(xn(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(n,e){return tA(e,n)}function WP(n,e,t,i,r){fe(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=Lu(n.visibleWrites,e,t)),n.lastWriteId=i}function YP(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function QP(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);fe(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,o=!1,c=n.allWrites.length-1;for(;r&&c>=0;){const h=n.allWrites[c];h.visible&&(c>=t&&XP(h,i.path)?r=!1:is(i.path,h.path)&&(o=!0)),c--}if(r){if(o)return JP(n),!0;if(i.snap)n.visibleWrites=U2(n.visibleWrites,i.path);else{const h=i.children;vi(h,f=>{n.visibleWrites=U2(n.visibleWrites,xn(i.path,f))})}return!0}else return!1}function XP(n,e){if(n.snap)return is(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&is(xn(n.path,t),e))return!0;return!1}function JP(n){n.visibleWrites=JC(n.allWrites,ZP,bt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function ZP(n){return n.visible}function JC(n,e,t){let i=as.empty();for(let r=0;r<n.length;++r){const o=n[r];if(e(o)){const c=o.path;let h;if(o.snap)is(t,c)?(h=ai(t,c),i=Lu(i,h,o.snap)):is(c,t)&&(h=ai(c,t),i=Lu(i,bt(),o.snap.getChild(h)));else if(o.children){if(is(t,c))h=ai(t,c),i=L2(i,h,o.children);else if(is(c,t))if(h=ai(c,t),at(h))i=L2(i,bt(),o.children);else{const f=Yl(o.children,rt(h));if(f){const m=f.getChild(Vt(h));i=Lu(i,bt(),m)}}}else throw uc("WriteRecord should have .snap or .children")}}return i}function ZC(n,e,t,i,r){if(!i&&!r){const o=Mo(n.visibleWrites,e);if(o!=null)return o;{const c=ba(n.visibleWrites,e);if(_0(c))return t;if(t==null&&!g0(c,bt()))return null;{const h=t||ze.EMPTY_NODE;return ac(c,h)}}}else{const o=ba(n.visibleWrites,e);if(!r&&_0(o))return t;if(!r&&t==null&&!g0(o,bt()))return null;{const c=function(m){return(m.visible||r)&&(!i||!~i.indexOf(m.writeId))&&(is(m.path,e)||is(e,m.path))},h=JC(n.allWrites,c,e),f=t||ze.EMPTY_NODE;return ac(h,f)}}}function e8(n,e,t){let i=ze.EMPTY_NODE;const r=Mo(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(sn,(o,c)=>{i=i.updateImmediateChild(o,c)}),i;if(t){const o=ba(n.visibleWrites,e);return t.forEachChild(sn,(c,h)=>{const f=ac(ba(o,new Mt(c)),h);i=i.updateImmediateChild(c,f)}),V2(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}else{const o=ba(n.visibleWrites,e);return V2(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}}function t8(n,e,t,i,r){fe(i||r,"Either existingEventSnap or existingServerSnap must exist");const o=xn(e,t);if(g0(n.visibleWrites,o))return null;{const c=ba(n.visibleWrites,o);return _0(c)?r.getChild(t):ac(c,r.getChild(t))}}function n8(n,e,t,i){const r=xn(e,t),o=Mo(n.visibleWrites,r);if(o!=null)return o;if(i.isCompleteForChild(t)){const c=ba(n.visibleWrites,r);return ac(c,i.getNode().getImmediateChild(t))}else return null}function i8(n,e){return Mo(n.visibleWrites,e)}function s8(n,e,t,i,r,o,c){let h;const f=ba(n.visibleWrites,e),m=Mo(f,bt());if(m!=null)h=m;else if(t!=null)h=ac(f,t);else return[];if(h=h.withIndex(c),!h.isEmpty()&&!h.isLeafNode()){const v=[],w=c.getCompare(),T=o?h.getReverseIteratorFrom(i,c):h.getIteratorFrom(i,c);let x=T.getNext();for(;x&&v.length<r;)w(x,i)!==0&&v.push(x),x=T.getNext();return v}else return[]}function r8(){return{visibleWrites:as.empty(),allWrites:[],lastWriteId:-1}}function Jf(n,e,t,i){return ZC(n.writeTree,n.treePath,e,t,i)}function Gv(n,e){return e8(n.writeTree,n.treePath,e)}function z2(n,e,t,i){return t8(n.writeTree,n.treePath,e,t,i)}function Zf(n,e){return i8(n.writeTree,xn(n.treePath,e))}function a8(n,e,t,i,r,o){return s8(n.writeTree,n.treePath,e,t,i,r,o)}function Kv(n,e,t){return n8(n.writeTree,n.treePath,e,t)}function eA(n,e){return tA(xn(n.treePath,e),n.writeTree)}function tA(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;fe(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),fe(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const o=r.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,ih(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,nh(i,r.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,rc(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,ih(i,e.snapshotNode,r.oldSnap));else throw uc("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const nA=new l8;class Wv{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new Aa(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Kv(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Co(this.viewCache_),o=a8(this.writes_,r,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(n){return{filter:n}}function u8(n,e){fe(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),fe(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function h8(n,e,t,i,r){const o=new o8;let c,h;if(t.type===ss.OVERWRITE){const m=t;m.source.fromUser?c=v0(n,e,m.path,m.snap,i,r,o):(fe(m.source.fromServer,"Unknown source."),h=m.source.tagged||e.serverCache.isFiltered()&&!at(m.path),c=em(n,e,m.path,m.snap,i,r,h,o))}else if(t.type===ss.MERGE){const m=t;m.source.fromUser?c=f8(n,e,m.path,m.children,i,r,o):(fe(m.source.fromServer,"Unknown source."),h=m.source.tagged||e.serverCache.isFiltered(),c=y0(n,e,m.path,m.children,i,r,h,o))}else if(t.type===ss.ACK_USER_WRITE){const m=t;m.revert?c=g8(n,e,m.path,i,r,o):c=m8(n,e,m.path,m.affectedTree,i,r,o)}else if(t.type===ss.LISTEN_COMPLETE)c=p8(n,e,t.path,i,o);else throw uc("Unknown operation type: "+t.type);const f=o.getChanges();return d8(e,c,f),{viewCache:c,changes:f}}function d8(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Xf(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(KC(Xf(e)))}}function iA(n,e,t,i,r,o){const c=e.eventCache;if(Zf(i,t)!=null)return e;{let h,f;if(at(t))if(fe(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const m=Co(e),v=m instanceof ze?m:ze.EMPTY_NODE,w=Gv(i,v);h=n.filter.updateFullNode(e.eventCache.getNode(),w,o)}else{const m=Jf(i,Co(e));h=n.filter.updateFullNode(e.eventCache.getNode(),m,o)}else{const m=rt(t);if(m===".priority"){fe(Ca(t)===1,"Can't have a priority with additional path components");const v=c.getNode();f=e.serverCache.getNode();const w=z2(i,t,v,f);w!=null?h=n.filter.updatePriority(v,w):h=c.getNode()}else{const v=Vt(t);let w;if(c.isCompleteForChild(m)){f=e.serverCache.getNode();const T=z2(i,t,c.getNode(),f);T!=null?w=c.getNode().getImmediateChild(m).updateChild(v,T):w=c.getNode().getImmediateChild(m)}else w=Kv(i,m,e.serverCache);w!=null?h=n.filter.updateChild(c.getNode(),m,w,v,r,o):h=c.getNode()}}return Mu(e,h,c.isFullyInitialized()||at(t),n.filter.filtersNodes())}}function em(n,e,t,i,r,o,c,h){const f=e.serverCache;let m;const v=c?n.filter:n.filter.getIndexedFilter();if(at(t))m=v.updateFullNode(f.getNode(),i,null);else if(v.filtersNodes()&&!f.isFiltered()){const x=f.getNode().updateChild(t,i);m=v.updateFullNode(f.getNode(),x,null)}else{const x=rt(t);if(!f.isCompleteForPath(t)&&Ca(t)>1)return e;const N=Vt(t),O=f.getNode().getImmediateChild(x).updateChild(N,i);x===".priority"?m=v.updatePriority(f.getNode(),O):m=v.updateChild(f.getNode(),x,O,N,nA,null)}const w=QC(e,m,f.isFullyInitialized()||at(t),v.filtersNodes()),T=new Wv(r,w,o);return iA(n,w,t,r,T,h)}function v0(n,e,t,i,r,o,c){const h=e.eventCache;let f,m;const v=new Wv(r,e,o);if(at(t))m=n.filter.updateFullNode(e.eventCache.getNode(),i,c),f=Mu(e,m,!0,n.filter.filtersNodes());else{const w=rt(t);if(w===".priority")m=n.filter.updatePriority(e.eventCache.getNode(),i),f=Mu(e,m,h.isFullyInitialized(),h.isFiltered());else{const T=Vt(t),x=h.getNode().getImmediateChild(w);let N;if(at(T))N=i;else{const L=v.getCompleteChild(w);L!=null?UC(T)===".priority"&&L.getChild(zC(T)).isEmpty()?N=L:N=L.updateChild(T,i):N=ze.EMPTY_NODE}if(x.equals(N))f=e;else{const L=n.filter.updateChild(h.getNode(),w,N,T,v,c);f=Mu(e,L,h.isFullyInitialized(),n.filter.filtersNodes())}}}return f}function B2(n,e){return n.eventCache.isCompleteForChild(e)}function f8(n,e,t,i,r,o,c){let h=e;return i.foreach((f,m)=>{const v=xn(t,f);B2(e,rt(v))&&(h=v0(n,h,v,m,r,o,c))}),i.foreach((f,m)=>{const v=xn(t,f);B2(e,rt(v))||(h=v0(n,h,v,m,r,o,c))}),h}function F2(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function y0(n,e,t,i,r,o,c,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let f=e,m;at(t)?m=i:m=new $t(null).setTree(t,i);const v=e.serverCache.getNode();return m.children.inorderTraversal((w,T)=>{if(v.hasChild(w)){const x=e.serverCache.getNode().getImmediateChild(w),N=F2(n,x,T);f=em(n,f,new Mt(w),N,r,o,c,h)}}),m.children.inorderTraversal((w,T)=>{const x=!e.serverCache.isCompleteForChild(w)&&T.value===null;if(!v.hasChild(w)&&!x){const N=e.serverCache.getNode().getImmediateChild(w),L=F2(n,N,T);f=em(n,f,new Mt(w),L,r,o,c,h)}}),f}function m8(n,e,t,i,r,o,c){if(Zf(r,t)!=null)return e;const h=e.serverCache.isFiltered(),f=e.serverCache;if(i.value!=null){if(at(t)&&f.isFullyInitialized()||f.isCompleteForPath(t))return em(n,e,t,f.getNode().getChild(t),r,o,h,c);if(at(t)){let m=new $t(null);return f.getNode().forEachChild(Kl,(v,w)=>{m=m.set(new Mt(v),w)}),y0(n,e,t,m,r,o,h,c)}else return e}else{let m=new $t(null);return i.foreach((v,w)=>{const T=xn(t,v);f.isCompleteForPath(T)&&(m=m.set(v,f.getNode().getChild(T)))}),y0(n,e,t,m,r,o,h,c)}}function p8(n,e,t,i,r){const o=e.serverCache,c=QC(e,o.getNode(),o.isFullyInitialized()||at(t),o.isFiltered());return iA(n,c,t,i,nA,r)}function g8(n,e,t,i,r,o){let c;if(Zf(i,t)!=null)return e;{const h=new Wv(i,e,r),f=e.eventCache.getNode();let m;if(at(t)||rt(t)===".priority"){let v;if(e.serverCache.isFullyInitialized())v=Jf(i,Co(e));else{const w=e.serverCache.getNode();fe(w instanceof ze,"serverChildren would be complete if leaf node"),v=Gv(i,w)}v=v,m=n.filter.updateFullNode(f,v,o)}else{const v=rt(t);let w=Kv(i,v,e.serverCache);w==null&&e.serverCache.isCompleteForChild(v)&&(w=f.getImmediateChild(v)),w!=null?m=n.filter.updateChild(f,v,w,Vt(t),h,o):e.eventCache.getNode().hasChild(v)?m=n.filter.updateChild(f,v,ze.EMPTY_NODE,Vt(t),h,o):m=f,m.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=Jf(i,Co(e)),c.isLeafNode()&&(m=n.filter.updateFullNode(m,c,o)))}return c=e.serverCache.isFullyInitialized()||Zf(i,bt())!=null,Mu(e,m,c,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new Fv(i.getIndex()),o=MP(i);this.processor_=c8(o);const c=t.serverCache,h=t.eventCache,f=r.updateFullNode(ze.EMPTY_NODE,c.getNode(),null),m=o.updateFullNode(ze.EMPTY_NODE,h.getNode(),null),v=new Aa(f,c.isFullyInitialized(),r.filtersNodes()),w=new Aa(m,h.isFullyInitialized(),o.filtersNodes());this.viewCache_=Lm(w,v),this.eventGenerator_=new qP(this.query_)}get query(){return this.query_}}function v8(n){return n.viewCache_.serverCache.getNode()}function y8(n){return Xf(n.viewCache_)}function w8(n,e){const t=Co(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!at(e)&&!t.getImmediateChild(rt(e)).isEmpty())?t.getChild(e):null}function q2(n){return n.eventRegistrations_.length===0}function b8(n,e){n.eventRegistrations_.push(e)}function H2(n,e,t){const i=[];if(t){fe(e==null,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(o=>{const c=o.createCancelEvent(t,r);c&&i.push(c)})}if(e){let r=[];for(let o=0;o<n.eventRegistrations_.length;++o){const c=n.eventRegistrations_[o];if(!c.matches(e))r.push(c);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function $2(n,e,t,i){e.type===ss.MERGE&&e.source.queryId!==null&&(fe(Co(n.viewCache_),"We should always have a full cache before handling merges"),fe(Xf(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,o=h8(n.processor_,r,e,t,i);return u8(n.processor_,o.viewCache),fe(o.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,sA(n,o.changes,o.viewCache.eventCache.getNode(),null)}function E8(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(sn,(o,c)=>{i.push(rc(o,c))}),t.isFullyInitialized()&&i.push(KC(t.getNode())),sA(n,i,t.getNode(),e)}function sA(n,e,t,i){const r=i?[i]:n.eventRegistrations_;return HP(n.eventGenerator_,e,t,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tm;class rA{constructor(){this.views=new Map}}function T8(n){fe(!tm,"__referenceConstructor has already been defined"),tm=n}function S8(){return fe(tm,"Reference.ts has not been loaded"),tm}function x8(n){return n.views.size===0}function Yv(n,e,t,i){const r=e.source.queryId;if(r!==null){const o=n.views.get(r);return fe(o!=null,"SyncTree gave us an op for an invalid query."),$2(o,e,t,i)}else{let o=[];for(const c of n.views.values())o=o.concat($2(c,e,t,i));return o}}function aA(n,e,t,i,r){const o=e._queryIdentifier,c=n.views.get(o);if(!c){let h=Jf(t,r?i:null),f=!1;h?f=!0:i instanceof ze?(h=Gv(t,i),f=!1):(h=ze.EMPTY_NODE,f=!1);const m=Lm(new Aa(h,f,!1),new Aa(i,r,!1));return new _8(e,m)}return c}function C8(n,e,t,i,r,o){const c=aA(n,e,i,r,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),b8(c,t),E8(c,t)}function A8(n,e,t,i){const r=e._queryIdentifier,o=[];let c=[];const h=Ia(n);if(r==="default")for(const[f,m]of n.views.entries())c=c.concat(H2(m,t,i)),q2(m)&&(n.views.delete(f),m.query._queryParams.loadsAllData()||o.push(m.query));else{const f=n.views.get(r);f&&(c=c.concat(H2(f,t,i)),q2(f)&&(n.views.delete(r),f.query._queryParams.loadsAllData()||o.push(f.query)))}return h&&!Ia(n)&&o.push(new(S8())(e._repo,e._path)),{removed:o,events:c}}function oA(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ea(n,e){let t=null;for(const i of n.views.values())t=t||w8(i,e);return t}function lA(n,e){if(e._queryParams.loadsAllData())return Vm(n);{const i=e._queryIdentifier;return n.views.get(i)}}function cA(n,e){return lA(n,e)!=null}function Ia(n){return Vm(n)!=null}function Vm(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nm;function I8(n){fe(!nm,"__referenceConstructor has already been defined"),nm=n}function R8(){return fe(nm,"Reference.ts has not been loaded"),nm}let N8=1;class G2{constructor(e){this.listenProvider_=e,this.syncPointTree_=new $t(null),this.pendingWriteTree_=r8(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function k8(n,e,t,i,r){return WP(n.pendingWriteTree_,e,t,i,r),r?Nh(n,new xo(YC(),e,t)):[]}function Bl(n,e,t=!1){const i=YP(n.pendingWriteTree_,e);if(QP(n.pendingWriteTree_,e)){let o=new $t(null);return i.snap!=null?o=o.set(bt(),!0):vi(i.children,c=>{o=o.set(new Mt(c),!0)}),Nh(n,new Qf(i.path,o,t))}else return[]}function Rh(n,e,t){return Nh(n,new xo(Hv(),e,t))}function O8(n,e,t){const i=$t.fromObject(t);return Nh(n,new ah(Hv(),e,i))}function D8(n,e){return Nh(n,new rh(Hv(),e))}function j8(n,e,t){const i=Qv(n,t);if(i){const r=Xv(i),o=r.path,c=r.queryId,h=ai(o,e),f=new rh($v(c),h);return Jv(n,o,f)}else return[]}function im(n,e,t,i,r=!1){const o=e._path,c=n.syncPointTree_.get(o);let h=[];if(c&&(e._queryIdentifier==="default"||cA(c,e))){const f=A8(c,e,t,i);x8(c)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const m=f.removed;if(h=f.events,!r){const v=m.findIndex(T=>T._queryParams.loadsAllData())!==-1,w=n.syncPointTree_.findOnPath(o,(T,x)=>Ia(x));if(v&&!w){const T=n.syncPointTree_.subtree(o);if(!T.isEmpty()){const x=L8(T);for(let N=0;N<x.length;++N){const L=x[N],O=L.query,Z=mA(n,L);n.listenProvider_.startListening(Uu(O),oh(n,O),Z.hashFn,Z.onComplete)}}}!w&&m.length>0&&!i&&(v?n.listenProvider_.stopListening(Uu(e),null):m.forEach(T=>{const x=n.queryToTagMap.get(zm(T));n.listenProvider_.stopListening(Uu(T),x)}))}U8(n,m)}return h}function uA(n,e,t,i){const r=Qv(n,i);if(r!=null){const o=Xv(r),c=o.path,h=o.queryId,f=ai(c,e),m=new xo($v(h),f,t);return Jv(n,c,m)}else return[]}function P8(n,e,t,i){const r=Qv(n,i);if(r){const o=Xv(r),c=o.path,h=o.queryId,f=ai(c,e),m=$t.fromObject(t),v=new ah($v(h),f,m);return Jv(n,c,v)}else return[]}function w0(n,e,t,i=!1){const r=e._path;let o=null,c=!1;n.syncPointTree_.foreachOnPath(r,(T,x)=>{const N=ai(T,r);o=o||Ea(x,N),c=c||Ia(x)});let h=n.syncPointTree_.get(r);h?(c=c||Ia(h),o=o||Ea(h,bt())):(h=new rA,n.syncPointTree_=n.syncPointTree_.set(r,h));let f;o!=null?f=!0:(f=!1,o=ze.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((x,N)=>{const L=Ea(N,bt());L&&(o=o.updateImmediateChild(x,L))}));const m=cA(h,e);if(!m&&!e._queryParams.loadsAllData()){const T=zm(e);fe(!n.queryToTagMap.has(T),"View does not exist, but we have a tag");const x=V8();n.queryToTagMap.set(T,x),n.tagToQueryMap.set(x,T)}const v=Um(n.pendingWriteTree_,r);let w=C8(h,e,t,v,o,f);if(!m&&!c&&!i){const T=lA(h,e);w=w.concat(z8(n,e,T))}return w}function hA(n,e,t){const r=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(c,h)=>{const f=ai(c,e),m=Ea(h,f);if(m)return m});return ZC(r,e,o,t,!0)}function M8(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(m,v)=>{const w=ai(m,t);i=i||Ea(v,w)});let r=n.syncPointTree_.get(t);r?i=i||Ea(r,bt()):(r=new rA,n.syncPointTree_=n.syncPointTree_.set(t,r));const o=i!=null,c=o?new Aa(i,!0,!1):null,h=Um(n.pendingWriteTree_,e._path),f=aA(r,e,h,o?c.getNode():ze.EMPTY_NODE,o);return y8(f)}function Nh(n,e){return dA(e,n.syncPointTree_,null,Um(n.pendingWriteTree_,bt()))}function dA(n,e,t,i){if(at(n.path))return fA(n,e,t,i);{const r=e.get(bt());t==null&&r!=null&&(t=Ea(r,bt()));let o=[];const c=rt(n.path),h=n.operationForChild(c),f=e.children.get(c);if(f&&h){const m=t?t.getImmediateChild(c):null,v=eA(i,c);o=o.concat(dA(h,f,m,v))}return r&&(o=o.concat(Yv(r,n,i,t))),o}}function fA(n,e,t,i){const r=e.get(bt());t==null&&r!=null&&(t=Ea(r,bt()));let o=[];return e.children.inorderTraversal((c,h)=>{const f=t?t.getImmediateChild(c):null,m=eA(i,c),v=n.operationForChild(c);v&&(o=o.concat(fA(v,h,f,m)))}),r&&(o=o.concat(Yv(r,n,i,t))),o}function mA(n,e){const t=e.query,i=oh(n,t);return{hashFn:()=>(v8(e)||ze.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?j8(n,t._path,i):D8(n,t._path);{const o=Pj(r,t);return im(n,t,null,o)}}}}function oh(n,e){const t=zm(e);return n.queryToTagMap.get(t)}function zm(n){return n._path.toString()+"$"+n._queryIdentifier}function Qv(n,e){return n.tagToQueryMap.get(e)}function Xv(n){const e=n.indexOf("$");return fe(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Mt(n.substr(0,e))}}function Jv(n,e,t){const i=n.syncPointTree_.get(e);fe(i,"Missing sync point for query tag that we're tracking");const r=Um(n.pendingWriteTree_,e);return Yv(i,t,r,null)}function L8(n){return n.fold((e,t,i)=>{if(t&&Ia(t))return[Vm(t)];{let r=[];return t&&(r=oA(t)),vi(i,(o,c)=>{r=r.concat(c)}),r}})}function Uu(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(R8())(n._repo,n._path):n}function U8(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const r=zm(i),o=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(o)}}}function V8(){return N8++}function z8(n,e,t){const i=e._path,r=oh(n,e),o=mA(n,t),c=n.listenProvider_.startListening(Uu(e),r,o.hashFn,o.onComplete),h=n.syncPointTree_.subtree(i);if(r)fe(!Ia(h.value),"If we're adding a query, it shouldn't be shadowed");else{const f=h.fold((m,v,w)=>{if(!at(m)&&v&&Ia(v))return[Vm(v).query];{let T=[];return v&&(T=T.concat(oA(v).map(x=>x.query))),vi(w,(x,N)=>{T=T.concat(N)}),T}});for(let m=0;m<f.length;++m){const v=f[m];n.listenProvider_.stopListening(Uu(v),oh(n,v))}}return c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Zv(t)}node(){return this.node_}}class ey{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=xn(this.path_,e);return new ey(this.syncTree_,t)}node(){return hA(this.syncTree_,this.path_)}}const B8=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},K2=function(n,e,t){if(!n||typeof n!="object")return n;if(fe(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return F8(n[".sv"],e,t);if(typeof n[".sv"]=="object")return q8(n[".sv"],e);fe(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},F8=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:fe(!1,"Unexpected server value: "+n)}},q8=function(n,e,t){n.hasOwnProperty("increment")||fe(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&fe(!1,"Unexpected increment value: "+i);const r=e.node();if(fe(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const c=r.getValue();return typeof c!="number"?i:c+i},H8=function(n,e,t,i){return ty(e,new ey(t,n),i)},$8=function(n,e,t){return ty(n,new Zv(e),t)};function ty(n,e,t){const i=n.getPriority().val(),r=K2(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const c=n,h=K2(c.getValue(),e,t);return h!==c.getValue()||r!==c.getPriority().val()?new jn(h,qn(r)):n}else{const c=n;return o=c,r!==c.getPriority().val()&&(o=o.updatePriority(new jn(r))),c.forEachChild(sn,(h,f)=>{const m=ty(f,e.getImmediateChild(h),t);m!==f&&(o=o.updateImmediateChild(h,m))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function iy(n,e){let t=e instanceof Mt?e:new Mt(e),i=n,r=rt(t);for(;r!==null;){const o=Yl(i.node.children,r)||{children:{},childCount:0};i=new ny(r,i,o),t=Vt(t),r=rt(t)}return i}function _c(n){return n.node.value}function pA(n,e){n.node.value=e,b0(n)}function gA(n){return n.node.childCount>0}function G8(n){return _c(n)===void 0&&!gA(n)}function Bm(n,e){vi(n.node.children,(t,i)=>{e(new ny(t,n,i))})}function _A(n,e,t,i){t&&e(n),Bm(n,r=>{_A(r,e,!0)})}function K8(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function kh(n){return new Mt(n.parent===null?n.name:kh(n.parent)+"/"+n.name)}function b0(n){n.parent!==null&&W8(n.parent,n.name,n)}function W8(n,e,t){const i=G8(t),r=yr(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,b0(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,b0(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y8=/[\[\].#$\/\u0000-\u001F\u007F]/,Q8=/[\[\].#$\u0000-\u001F\u007F]/,g_=10*1024*1024,vA=function(n){return typeof n=="string"&&n.length!==0&&!Y8.test(n)},yA=function(n){return typeof n=="string"&&n.length!==0&&!Q8.test(n)},X8=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),yA(n)},wA=function(n,e,t){const i=t instanceof Mt?new mP(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+co(i));if(typeof e=="function")throw new Error(n+"contains a function "+co(i)+" with contents = "+e.toString());if(_C(e))throw new Error(n+"contains "+e.toString()+" "+co(i));if(typeof e=="string"&&e.length>g_/3&&pm(e)>g_)throw new Error(n+"contains a string greater than "+g_+" utf8 bytes "+co(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,o=!1;if(vi(e,(c,h)=>{if(c===".value")r=!0;else if(c!==".priority"&&c!==".sv"&&(o=!0,!vA(c)))throw new Error(n+" contains an invalid key ("+c+") "+co(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);pP(i,c),wA(n,h,i),gP(i)}),r&&o)throw new Error(n+' contains ".value" child '+co(i)+" in addition to actual children.")}},bA=function(n,e,t,i){if(!yA(t))throw new Error(pS(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},J8=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),bA(n,e,t)},Z8=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!vA(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!X8(t))throw new Error(pS(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function EA(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],o=r.getPath();t!==null&&!Vv(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(r)}t&&n.eventLists_.push(t)}function TA(n,e,t){EA(n,t),SA(n,i=>Vv(i,e))}function Oa(n,e,t){EA(n,t),SA(n,i=>is(i,e)||is(e,i))}function SA(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];if(r){const o=r.path;e(o)?(tM(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function tM(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();ju&&Jn("event: "+t.toString()),Ah(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nM="repo_interrupt",iM=25;class sM{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new eM,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Yf(),this.transactionQueueTree_=new ny,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function rM(n,e,t){if(n.stats_=Lv(n.repoInfo_),n.forceRestClient_||Vj())n.server_=new Wf(n.repoInfo_,(i,r,o,c)=>{W2(n,i,r,o,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Y2(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Tn(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new dr(n.repoInfo_,e,(i,r,o,c)=>{W2(n,i,r,o,c)},i=>{Y2(n,i)},i=>{oM(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Hj(n.repoInfo_,()=>new FP(n.stats_,n.server_)),n.infoData_=new LP,n.infoSyncTree_=new G2({startListening:(i,r,o,c)=>{let h=[];const f=n.infoData_.getNode(i._path);return f.isEmpty()||(h=Rh(n.infoSyncTree_,i._path,f),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),sy(n,"connected",!1),n.serverSyncTree_=new G2({startListening:(i,r,o,c)=>(n.server_.listen(i,o,r,(h,f)=>{const m=c(h,f);Oa(n.eventQueue_,i._path,m)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function aM(n){const t=n.infoData_.getNode(new Mt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function xA(n){return B8({timestamp:aM(n)})}function W2(n,e,t,i,r){n.dataUpdateCount++;const o=new Mt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(r)if(i){const f=If(t,m=>qn(m));c=P8(n.serverSyncTree_,o,f,r)}else{const f=qn(t);c=uA(n.serverSyncTree_,o,f,r)}else if(i){const f=If(t,m=>qn(m));c=O8(n.serverSyncTree_,o,f)}else{const f=qn(t);c=Rh(n.serverSyncTree_,o,f)}let h=o;c.length>0&&(h=oy(n,o)),Oa(n.eventQueue_,h,c)}function Y2(n,e){sy(n,"connected",e),e===!1&&uM(n)}function oM(n,e){vi(e,(t,i)=>{sy(n,t,i)})}function sy(n,e,t){const i=new Mt("/.info/"+e),r=qn(t);n.infoData_.updateSnapshot(i,r);const o=Rh(n.infoSyncTree_,i,r);Oa(n.eventQueue_,i,o)}function lM(n){return n.nextWriteId_++}function cM(n,e,t){const i=M8(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(r=>{const o=qn(r).withIndex(e._queryParams.getIndex());w0(n.serverSyncTree_,e,t,!0);let c;if(e._queryParams.loadsAllData())c=Rh(n.serverSyncTree_,e._path,o);else{const h=oh(n.serverSyncTree_,e);c=uA(n.serverSyncTree_,e._path,o,h)}return Oa(n.eventQueue_,e._path,c),im(n.serverSyncTree_,e,t,null,!0),o},r=>(ry(n,"get for query "+Tn(e)+" failed: "+r),Promise.reject(new Error(r))))}function uM(n){ry(n,"onDisconnectEvents");const e=xA(n),t=Yf();p0(n.onDisconnect_,bt(),(r,o)=>{const c=H8(r,o,n.serverSyncTree_,e);WC(t,r,c)});let i=[];p0(t,bt(),(r,o)=>{i=i.concat(Rh(n.serverSyncTree_,r,o));const c=gM(n,r);oy(n,c)}),n.onDisconnect_=Yf(),Oa(n.eventQueue_,bt(),i)}function hM(n,e,t){let i;rt(e._path)===".info"?i=w0(n.infoSyncTree_,e,t):i=w0(n.serverSyncTree_,e,t),TA(n.eventQueue_,e._path,i)}function dM(n,e,t){let i;rt(e._path)===".info"?i=im(n.infoSyncTree_,e,t):i=im(n.serverSyncTree_,e,t),TA(n.eventQueue_,e._path,i)}function fM(n){n.persistentConnection_&&n.persistentConnection_.interrupt(nM)}function ry(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Jn(t,...e)}function CA(n,e,t){return hA(n.serverSyncTree_,e,t)||ze.EMPTY_NODE}function ay(n,e=n.transactionQueueTree_){if(e||Fm(n,e),_c(e)){const t=IA(n,e);fe(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&mM(n,kh(e),t)}else gA(e)&&Bm(e,t=>{ay(n,t)})}function mM(n,e,t){const i=t.map(m=>m.currentWriteId),r=CA(n,e,i);let o=r;const c=r.hash();for(let m=0;m<t.length;m++){const v=t[m];fe(v.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),v.status=1,v.retryCount++;const w=ai(e,v.path);o=o.updateChild(w,v.currentOutputSnapshotRaw)}const h=o.val(!0),f=e;n.server_.put(f.toString(),h,m=>{ry(n,"transaction put response",{path:f.toString(),status:m});let v=[];if(m==="ok"){const w=[];for(let T=0;T<t.length;T++)t[T].status=2,v=v.concat(Bl(n.serverSyncTree_,t[T].currentWriteId)),t[T].onComplete&&w.push(()=>t[T].onComplete(null,!0,t[T].currentOutputSnapshotResolved)),t[T].unwatcher();Fm(n,iy(n.transactionQueueTree_,e)),ay(n,n.transactionQueueTree_),Oa(n.eventQueue_,e,v);for(let T=0;T<w.length;T++)Ah(w[T])}else{if(m==="datastale")for(let w=0;w<t.length;w++)t[w].status===3?t[w].status=4:t[w].status=0;else{Ni("transaction at "+f.toString()+" failed: "+m);for(let w=0;w<t.length;w++)t[w].status=4,t[w].abortReason=m}oy(n,e)}},c)}function oy(n,e){const t=AA(n,e),i=kh(t),r=IA(n,t);return pM(n,r,i),i}function pM(n,e,t){if(e.length===0)return;const i=[];let r=[];const c=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const f=e[h],m=ai(t,f.path);let v=!1,w;if(fe(m!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),f.status===4)v=!0,w=f.abortReason,r=r.concat(Bl(n.serverSyncTree_,f.currentWriteId,!0));else if(f.status===0)if(f.retryCount>=iM)v=!0,w="maxretry",r=r.concat(Bl(n.serverSyncTree_,f.currentWriteId,!0));else{const T=CA(n,f.path,c);f.currentInputSnapshot=T;const x=e[h].update(T.val());if(x!==void 0){wA("transaction failed: Data returned ",x,f.path);let N=qn(x);typeof x=="object"&&x!=null&&yr(x,".priority")||(N=N.updatePriority(T.getPriority()));const O=f.currentWriteId,Z=xA(n),Y=$8(N,T,Z);f.currentOutputSnapshotRaw=N,f.currentOutputSnapshotResolved=Y,f.currentWriteId=lM(n),c.splice(c.indexOf(O),1),r=r.concat(k8(n.serverSyncTree_,f.path,Y,f.currentWriteId,f.applyLocally)),r=r.concat(Bl(n.serverSyncTree_,O,!0))}else v=!0,w="nodata",r=r.concat(Bl(n.serverSyncTree_,f.currentWriteId,!0))}Oa(n.eventQueue_,t,r),r=[],v&&(e[h].status=2,(function(T){setTimeout(T,Math.floor(0))})(e[h].unwatcher),e[h].onComplete&&(w==="nodata"?i.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):i.push(()=>e[h].onComplete(new Error(w),!1,null))))}Fm(n,n.transactionQueueTree_);for(let h=0;h<i.length;h++)Ah(i[h]);ay(n,n.transactionQueueTree_)}function AA(n,e){let t,i=n.transactionQueueTree_;for(t=rt(e);t!==null&&_c(i)===void 0;)i=iy(i,t),e=Vt(e),t=rt(e);return i}function IA(n,e){const t=[];return RA(n,e,t),t.sort((i,r)=>i.order-r.order),t}function RA(n,e,t){const i=_c(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);Bm(e,r=>{RA(n,r,t)})}function Fm(n,e){const t=_c(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,pA(e,t.length>0?t:void 0)}Bm(e,i=>{Fm(n,i)})}function gM(n,e){const t=kh(AA(n,e)),i=iy(n.transactionQueueTree_,e);return K8(i,r=>{__(n,r)}),__(n,i),_A(i,r=>{__(n,r)}),t}function __(n,e){const t=_c(e);if(t){const i=[];let r=[],o=-1;for(let c=0;c<t.length;c++)t[c].status===3||(t[c].status===1?(fe(o===c-1,"All SENT items should be at beginning of queue."),o=c,t[c].status=3,t[c].abortReason="set"):(fe(t[c].status===0,"Unexpected transaction status in abort"),t[c].unwatcher(),r=r.concat(Bl(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&i.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));o===-1?pA(e,void 0):t.length=o+1,Oa(n.eventQueue_,kh(e),r);for(let c=0;c<i.length;c++)Ah(i[c])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _M(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function vM(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Ni(`Invalid query segment '${t}' in query '${n}'`)}return e}const Q2=function(n,e){const t=yM(n),i=t.namespace;t.domain==="firebase.com"&&_r(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&_r("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Nj();const r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new RC(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new Mt(t.pathString)}},yM=function(n){let e="",t="",i="",r="",o="",c=!0,h="https",f=443;if(typeof n=="string"){let m=n.indexOf("//");m>=0&&(h=n.substring(0,m-1),n=n.substring(m+2));let v=n.indexOf("/");v===-1&&(v=n.length);let w=n.indexOf("?");w===-1&&(w=n.length),e=n.substring(0,Math.min(v,w)),v<w&&(r=_M(n.substring(v,w)));const T=vM(n.substring(Math.min(n.length,w)));m=e.indexOf(":"),m>=0?(c=h==="https"||h==="wss",f=parseInt(e.substring(m+1),10)):m=e.length;const x=e.slice(0,m);if(x.toLowerCase()==="localhost")t="localhost";else if(x.split(".").length<=2)t=x;else{const N=e.indexOf(".");i=e.substring(0,N).toLowerCase(),t=e.substring(N+1),o=i}"ns"in T&&(o=T.ns)}return{host:e,port:f,domain:t,subdomain:i,secure:c,scheme:h,pathString:r,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Tn(this.snapshot.exportVal())}}class bM{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return fe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return at(this._path)?null:UC(this._path)}get ref(){return new br(this._repo,this._path)}get _queryIdentifier(){const e=P2(this._queryParams),t=Pv(e);return t==="{}"?"default":t}get _queryObject(){return P2(this._queryParams)}isEqual(e){if(e=Yt(e),!(e instanceof ly))return!1;const t=this._repo===e._repo,i=Vv(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+fP(this._path)}}class br extends ly{constructor(e,t){super(e,t,new qv,!1)}get parent(){const e=zC(this._path);return e===null?null:new br(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class lh{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Mt(e),i=T0(this.ref,e);return new lh(this._node.getChild(t),i,sn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new lh(r,T0(this.ref,i),sn)))}hasChild(e){const t=new Mt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function E0(n,e){return n=Yt(n),n._checkNotDeleted("ref"),e!==void 0?T0(n._root,e):n._root}function T0(n,e){return n=Yt(n),rt(n._path)===null?J8("child","path",e):bA("child","path",e),new br(n._repo,xn(n._path,e))}function EM(n){n=Yt(n);const e=new NA(()=>{}),t=new qm(e);return cM(n._repo,n,t).then(i=>new lh(i,new br(n._repo,n._path),n._queryParams.getIndex()))}class qm{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new wM("value",this,new lh(e.snapshotNode,new br(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new bM(this,e,t):null}matches(e){return e instanceof qm?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function TM(n,e,t,i,r){const o=new NA(t,void 0),c=new qm(o);return hM(n._repo,n,c),()=>dM(n._repo,n,c)}function SM(n,e,t,i){return TM(n,"value",e)}T8(br);I8(br);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM="FIREBASE_DATABASE_EMULATOR_HOST",S0={};let CM=!1;function AM(n,e,t,i){n.repoInfo_=new RC(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function IM(n,e,t,i,r){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||_r("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Jn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c=Q2(o,r),h=c.repoInfo,f;typeof process<"u"&&_2&&(f=_2[xM]),f?(o=`http://${f}?ns=${h.namespace}`,c=Q2(o,r),h=c.repoInfo):c.repoInfo.secure;const m=new Bj(n.name,n.options,e);Z8("Invalid Firebase Database URL",c),at(c.path)||_r("Database URL must point to the root of a Firebase Database (not including a child path).");const v=NM(h,n,m,new zj(n.name,t));return new kM(v,n)}function RM(n,e){const t=S0[e];(!t||t[n.key]!==n)&&_r(`Database ${e}(${n.repoInfo_}) has already been deleted.`),fM(n),delete t[n.key]}function NM(n,e,t,i){let r=S0[e.name];r||(r={},S0[e.name]=r);let o=r[n.toURLString()];return o&&_r("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new sM(n,CM,t,i),r[n.toURLString()]=o,o}class kM{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(rM(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new br(this._repo,bt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(RM(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&_r("Cannot call "+e+" on a deleted database.")}}function sm(n=vm(),e){const t=No(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=oS("database");i&&OM(t,...i)}return t}function OM(n,e,t,i={}){n=Yt(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&_r("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let o;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&_r('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Sf(Sf.OWNER);else if(i.mockUserToken){const c=typeof i.mockUserToken=="string"?i.mockUserToken:uS(i.mockUserToken,n.app.options.projectId);o=new Sf(c)}AM(r,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(n){Sj(ko),os(new Hi("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return IM(i,r,o,t)},"PUBLIC").setMultipleInstances(!0)),_i(v2,y2,n),_i(v2,y2,"esm2017")}dr.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};dr.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};DM();const jM={apiKey:"AIzaSyAO05nIto1UkqE4Yp61imFTrizspcXN1GA",authDomain:"hiddo-3887f.firebaseapp.com",projectId:"hiddo-3887f",storageBucket:"hiddo-3887f.appspot.com",messagingSenderId:"775242278433",appId:"1:775242278433:web:b76d914244d5d8fd37a560"},cy=vS(jM),Ye=uO(cy);X6(Ye,ev);const PM=rj(cy);sm(cy);const MM="modulepreload",LM=function(n){return"/"+n},X2={},Oh=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let m=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var c=m;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),f=h?.nonce||h?.getAttribute("nonce");r=m(t.map(v=>{if(v=LM(v),v in X2)return;X2[v]=!0;const w=v.endsWith(".css"),T=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${T}`))return;const x=document.createElement("link");if(x.rel=w?"stylesheet":MM,w||(x.as="script"),x.crossOrigin="",x.href=v,f&&x.setAttribute("nonce",f),document.head.appendChild(x),w)return new Promise((N,L)=>{x.addEventListener("load",N),x.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${v}`)))})}))}function o(h){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=h,window.dispatchEvent(f),!f.defaultPrevented)throw h}return r.then(h=>{for(const f of h||[])f.status==="rejected"&&o(f.reason);return e().catch(o)})},UM=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oh(async()=>{const{default:i}=await Promise.resolve().then(()=>vc);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)};class uy extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class J2 extends uy{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Z2 extends uy{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class eT extends uy{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var x0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(x0||(x0={}));var VM=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};class zM{constructor(e,{headers:t={},customFetch:i,region:r=x0.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=UM(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return VM(this,arguments,void 0,function*(t,i={}){var r;try{const{headers:o,method:c,body:h,signal:f}=i;let m={},{region:v}=i;v||(v=this.region);const w=new URL(`${this.url}/${t}`);v&&v!=="any"&&(m["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let T;h&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",T=h):typeof h=="string"?(m["Content-Type"]="text/plain",T=h):typeof FormData<"u"&&h instanceof FormData?T=h:(m["Content-Type"]="application/json",T=JSON.stringify(h)));const x=yield this.fetch(w.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),o),body:T,signal:f}).catch(Z=>{throw Z.name==="AbortError"?Z:new J2(Z)}),N=x.headers.get("x-relay-error");if(N&&N==="true")throw new Z2(x);if(!x.ok)throw new eT(x);let L=((r=x.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),O;return L==="application/json"?O=yield x.json():L==="application/octet-stream"?O=yield x.blob():L==="text/event-stream"?O=x:L==="multipart/form-data"?O=yield x.formData():O=yield x.text(),{data:O,error:null,response:x}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new J2(o)}:{data:null,error:o,response:o instanceof eT||o instanceof Z2?o.context:void 0}}})}}var Dn={},Tl={},Sl={},xl={},Cl={},Al={},BM=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},oc=BM();const FM=oc.fetch,kA=oc.fetch.bind(oc),OA=oc.Headers,qM=oc.Request,HM=oc.Response,vc=Object.freeze(Object.defineProperty({__proto__:null,Headers:OA,Request:qM,Response:HM,default:kA,fetch:FM},Symbol.toStringTag,{value:"Module"})),$M=cR(vc);var df={},tT;function DA(){if(tT)return df;tT=1,Object.defineProperty(df,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return df.default=n,df}var nT;function jA(){if(nT)return Al;nT=1;var n=Al&&Al.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Al,"__esModule",{value:!0});const e=n($M),t=n(DA());class i{constructor(o){var c,h;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(c=o.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=o.signal,this.isMaybeSingle=(h=o.isMaybeSingle)!==null&&h!==void 0?h:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,c){return this.headers=new Headers(this.headers),this.headers.set(o,c),this}then(o,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let f=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var v,w,T,x;let N=null,L=null,O=null,Z=m.status,Y=m.statusText;if(m.ok){if(this.method!=="HEAD"){const oe=await m.text();oe===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((v=this.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?L=oe:L=JSON.parse(oe))}const le=(w=this.headers.get("Prefer"))===null||w===void 0?void 0:w.match(/count=(exact|planned|estimated)/),ve=(T=m.headers.get("content-range"))===null||T===void 0?void 0:T.split("/");le&&ve&&ve.length>1&&(O=parseInt(ve[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(L)&&(L.length>1?(N={code:"PGRST116",details:`Results contain ${L.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},L=null,O=null,Z=406,Y="Not Acceptable"):L.length===1?L=L[0]:L=null)}else{const le=await m.text();try{N=JSON.parse(le),Array.isArray(N)&&m.status===404&&(L=[],N=null,Z=200,Y="OK")}catch{m.status===404&&le===""?(Z=204,Y="No Content"):N={message:le}}if(N&&this.isMaybeSingle&&(!((x=N?.details)===null||x===void 0)&&x.includes("0 rows"))&&(N=null,Z=200,Y="OK"),N&&this.shouldThrowOnError)throw new t.default(N)}return{error:N,data:L,count:O,status:Z,statusText:Y}});return this.shouldThrowOnError||(f=f.catch(m=>{var v,w,T;return{error:{message:`${(v=m?.name)!==null&&v!==void 0?v:"FetchError"}: ${m?.message}`,details:`${(w=m?.stack)!==null&&w!==void 0?w:""}`,hint:"",code:`${(T=m?.code)!==null&&T!==void 0?T:""}`},data:null,count:null,status:0,statusText:""}})),f.then(o,c)}returns(){return this}overrideTypes(){return this}}return Al.default=i,Al}var iT;function PA(){if(iT)return Cl;iT=1;var n=Cl&&Cl.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Cl,"__esModule",{value:!0});const e=n(jA());class t extends e.default{select(r){let o=!1;const c=(r??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:o=!0,nullsFirst:c,foreignTable:h,referencedTable:f=h}={}){const m=f?`${f}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${r}.${o?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:o,referencedTable:c=o}={}){const h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(h,`${r}`),this}range(r,o,{foreignTable:c,referencedTable:h=c}={}){const f=typeof h>"u"?"offset":`${h}.offset`,m=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(f,`${r}`),this.url.searchParams.set(m,`${o-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:o=!1,settings:c=!1,buffers:h=!1,wal:f=!1,format:m="text"}={}){var v;const w=[r?"analyze":null,o?"verbose":null,c?"settings":null,h?"buffers":null,f?"wal":null].filter(Boolean).join("|"),T=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${T}"; options=${w};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return Cl.default=t,Cl}var sT;function hy(){if(sT)return xl;sT=1;var n=xl&&xl.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(xl,"__esModule",{value:!0});const e=n(PA());class t extends e.default{eq(r,o){return this.url.searchParams.append(r,`eq.${o}`),this}neq(r,o){return this.url.searchParams.append(r,`neq.${o}`),this}gt(r,o){return this.url.searchParams.append(r,`gt.${o}`),this}gte(r,o){return this.url.searchParams.append(r,`gte.${o}`),this}lt(r,o){return this.url.searchParams.append(r,`lt.${o}`),this}lte(r,o){return this.url.searchParams.append(r,`lte.${o}`),this}like(r,o){return this.url.searchParams.append(r,`like.${o}`),this}likeAllOf(r,o){return this.url.searchParams.append(r,`like(all).{${o.join(",")}}`),this}likeAnyOf(r,o){return this.url.searchParams.append(r,`like(any).{${o.join(",")}}`),this}ilike(r,o){return this.url.searchParams.append(r,`ilike.${o}`),this}ilikeAllOf(r,o){return this.url.searchParams.append(r,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(r,o){return this.url.searchParams.append(r,`ilike(any).{${o.join(",")}}`),this}is(r,o){return this.url.searchParams.append(r,`is.${o}`),this}in(r,o){const c=Array.from(new Set(o)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(r,`in.(${c})`),this}contains(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cs.{${o.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(o)}`),this}containedBy(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cd.{${o.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(o)}`),this}rangeGt(r,o){return this.url.searchParams.append(r,`sr.${o}`),this}rangeGte(r,o){return this.url.searchParams.append(r,`nxl.${o}`),this}rangeLt(r,o){return this.url.searchParams.append(r,`sl.${o}`),this}rangeLte(r,o){return this.url.searchParams.append(r,`nxr.${o}`),this}rangeAdjacent(r,o){return this.url.searchParams.append(r,`adj.${o}`),this}overlaps(r,o){return typeof o=="string"?this.url.searchParams.append(r,`ov.${o}`):this.url.searchParams.append(r,`ov.{${o.join(",")}}`),this}textSearch(r,o,{config:c,type:h}={}){let f="";h==="plain"?f="pl":h==="phrase"?f="ph":h==="websearch"&&(f="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(r,`${f}fts${m}.${o}`),this}match(r){return Object.entries(r).forEach(([o,c])=>{this.url.searchParams.append(o,`eq.${c}`)}),this}not(r,o,c){return this.url.searchParams.append(r,`not.${o}.${c}`),this}or(r,{foreignTable:o,referencedTable:c=o}={}){const h=c?`${c}.or`:"or";return this.url.searchParams.append(h,`(${r})`),this}filter(r,o,c){return this.url.searchParams.append(r,`${o}.${c}`),this}}return xl.default=t,xl}var rT;function MA(){if(rT)return Sl;rT=1;var n=Sl&&Sl.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Sl,"__esModule",{value:!0});const e=n(hy());class t{constructor(r,{headers:o={},schema:c,fetch:h}){this.url=r,this.headers=new Headers(o),this.schema=c,this.fetch=h}select(r,o){const{head:c=!1,count:h}=o??{},f=c?"HEAD":"GET";let m=!1;const v=(r??"*").split("").map(w=>/\s/.test(w)&&!m?"":(w==='"'&&(m=!m),w)).join("");return this.url.searchParams.set("select",v),h&&this.headers.append("Prefer",`count=${h}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:o,defaultToNull:c=!0}={}){var h;const f="POST";if(o&&this.headers.append("Prefer",`count=${o}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((v,w)=>v.concat(Object.keys(w)),[]);if(m.length>0){const v=[...new Set(m)].map(w=>`"${w}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(r,{onConflict:o,ignoreDuplicates:c=!1,count:h,defaultToNull:f=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),h&&this.headers.append("Prefer",`count=${h}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const w=r.reduce((T,x)=>T.concat(Object.keys(x)),[]);if(w.length>0){const T=[...new Set(w)].map(x=>`"${x}"`);this.url.searchParams.set("columns",T.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:o}={}){var c;const h="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:r}={}){var o;const c="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Sl.default=t,Sl}var aT;function GM(){if(aT)return Tl;aT=1;var n=Tl&&Tl.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Tl,"__esModule",{value:!0});const e=n(MA()),t=n(hy());class i{constructor(o,{headers:c={},schema:h,fetch:f}={}){this.url=o,this.headers=new Headers(c),this.schemaName=h,this.fetch=f}from(o){const c=new URL(`${this.url}/${o}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new i(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,c={},{head:h=!1,get:f=!1,count:m}={}){var v;let w;const T=new URL(`${this.url}/rpc/${o}`);let x;h||f?(w=h?"HEAD":"GET",Object.entries(c).filter(([L,O])=>O!==void 0).map(([L,O])=>[L,Array.isArray(O)?`{${O.join(",")}}`:`${O}`]).forEach(([L,O])=>{T.searchParams.append(L,O)})):(w="POST",x=c);const N=new Headers(this.headers);return m&&N.set("Prefer",`count=${m}`),new t.default({method:w,url:T,headers:N,schema:this.schemaName,body:x,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return Tl.default=i,Tl}var oT;function KM(){if(oT)return Dn;oT=1;var n=Dn&&Dn.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.PostgrestError=Dn.PostgrestBuilder=Dn.PostgrestTransformBuilder=Dn.PostgrestFilterBuilder=Dn.PostgrestQueryBuilder=Dn.PostgrestClient=void 0;const e=n(GM());Dn.PostgrestClient=e.default;const t=n(MA());Dn.PostgrestQueryBuilder=t.default;const i=n(hy());Dn.PostgrestFilterBuilder=i.default;const r=n(PA());Dn.PostgrestTransformBuilder=r.default;const o=n(jA());Dn.PostgrestBuilder=o.default;const c=n(DA());return Dn.PostgrestError=c.default,Dn.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:o.default,PostgrestError:c.default},Dn}var WM=KM();const YM=L0(WM),{PostgrestClient:QM,PostgrestQueryBuilder:FV,PostgrestFilterBuilder:qV,PostgrestTransformBuilder:HV,PostgrestBuilder:$V,PostgrestError:GV}=YM;class XM{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const i=t.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const JM="2.75.1",ZM=`realtime-js/${JM}`,e9="1.0.0",C0=1e4,t9=1e3,n9=100;var Vu;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Vu||(Vu={}));var En;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(En||(En={}));var es;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(es||(es={}));var A0;(function(n){n.websocket="websocket"})(A0||(A0={}));var ho;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ho||(ho={}));class i9{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){const r=t.getUint8(1),o=t.getUint8(2);let c=this.HEADER_LENGTH+2;const h=i.decode(e.slice(c,c+r));c=c+r;const f=i.decode(e.slice(c,c+o));c=c+o;const m=JSON.parse(i.decode(e.slice(c,e.byteLength)));return{ref:null,topic:h,event:f,payload:m}}}class LA{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ut;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ut||(Ut={}));const lT=(n,e,t={})=>{var i;const r=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((o,c)=>(o[c]=s9(c,n,e,r),o),{}):{}},s9=(n,e,t,i)=>{const r=e.find(h=>h.name===n),o=r?.type,c=t[n];return o&&!i.includes(o)?UA(o,c):I0(c)},UA=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return l9(e,t)}switch(n){case Ut.bool:return r9(e);case Ut.float4:case Ut.float8:case Ut.int2:case Ut.int4:case Ut.int8:case Ut.numeric:case Ut.oid:return a9(e);case Ut.json:case Ut.jsonb:return o9(e);case Ut.timestamp:return c9(e);case Ut.abstime:case Ut.date:case Ut.daterange:case Ut.int4range:case Ut.int8range:case Ut.money:case Ut.reltime:case Ut.text:case Ut.time:case Ut.timestamptz:case Ut.timetz:case Ut.tsrange:case Ut.tstzrange:return I0(e);default:return I0(e)}},I0=n=>n,r9=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},a9=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},o9=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},l9=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let o;const c=n.slice(1,t);try{o=JSON.parse("["+c+"]")}catch{o=c?c.split(","):[]}return o.map(h=>UA(e,h))}return n},c9=n=>typeof n=="string"?n.replace(" ","T"):n,VA=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class v_{constructor(e,t,i={},r=C0){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var cT;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(cT||(cT={}));class zu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:o,onLeave:c,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zu.syncState(this.state,r,o,c),this.pendingDiffs.forEach(f=>{this.state=zu.syncDiff(this.state,f,o,c)}),this.pendingDiffs=[],h()}),this.channel._on(i.diff,{},r=>{const{onJoin:o,onLeave:c,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=zu.syncDiff(this.state,r,o,c),h())}),this.onJoin((r,o,c)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:o,newPresences:c})}),this.onLeave((r,o,c)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:o,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){const o=this.cloneDeep(e),c=this.transformState(t),h={},f={};return this.map(o,(m,v)=>{c[m]||(f[m]=v)}),this.map(c,(m,v)=>{const w=o[m];if(w){const T=v.map(O=>O.presence_ref),x=w.map(O=>O.presence_ref),N=v.filter(O=>x.indexOf(O.presence_ref)<0),L=w.filter(O=>T.indexOf(O.presence_ref)<0);N.length>0&&(h[m]=N),L.length>0&&(f[m]=L)}else h[m]=v}),this.syncDiff(o,{joins:h,leaves:f},i,r)}static syncDiff(e,t,i,r){const{joins:o,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(o,(h,f)=>{var m;const v=(m=e[h])!==null&&m!==void 0?m:[];if(e[h]=this.cloneDeep(f),v.length>0){const w=e[h].map(x=>x.presence_ref),T=v.filter(x=>w.indexOf(x.presence_ref)<0);e[h].unshift(...T)}i(h,v,f)}),this.map(c,(h,f)=>{let m=e[h];if(!m)return;const v=f.map(w=>w.presence_ref);m=m.filter(w=>v.indexOf(w.presence_ref)<0),e[h]=m,r(h,m,f),m.length===0&&delete e[h]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const r=e[i];return"metas"in r?t[i]=r.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var uT;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(uT||(uT={}));var Bu;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Bu||(Bu={}));var ir;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(ir||(ir={}));class dy{constructor(e,t={config:{}},i){var r,o;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=En.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new v_(this,es.join,this.params,this.timeout),this.rejoinTimer=new LA(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=En.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=En.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=En.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=En.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=En.errored,this.rejoinTimer.scheduleTimeout())}),this._on(es.reply,{},(c,h)=>{this._trigger(this._replyEventName(h),c)}),this.presence=new zu(this),this.broadcastEndpointURL=VA(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==En.closed){const{config:{broadcast:c,presence:h,private:f}}=this.params,m=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(x=>x.filter))!==null&&r!==void 0?r:[],v=!!this.bindings[Bu.PRESENCE]&&this.bindings[Bu.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,w={},T={broadcast:c,presence:Object.assign(Object.assign({},h),{enabled:v}),postgres_changes:m,private:f};this.socket.accessTokenValue&&(w.access_token=this.socket.accessTokenValue),this._onError(x=>e?.(ir.CHANNEL_ERROR,x)),this._onClose(()=>e?.(ir.CLOSED)),this.updateJoinPayload(Object.assign({config:T},w)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:x})=>{var N;if(this.socket.setAuth(),x===void 0){e?.(ir.SUBSCRIBED);return}else{const L=this.bindings.postgres_changes,O=(N=L?.length)!==null&&N!==void 0?N:0,Z=[];for(let Y=0;Y<O;Y++){const H=L[Y],{filter:{event:le,schema:ve,table:oe,filter:I}}=H,A=x&&x[Y];if(A&&A.event===le&&A.schema===ve&&A.table===oe&&A.filter===I)Z.push(Object.assign(Object.assign({},H),{id:A.id}));else{this.unsubscribe(),this.state=En.errored,e?.(ir.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=Z,e&&e(ir.SUBSCRIBED);return}}).receive("error",x=>{this.state=En.errored,e?.(ir.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e?.(ir.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===En.joined&&e===Bu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,i)}async send(e,t={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:c}=e,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var c,h,f;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(h=(c=this.params)===null||c===void 0?void 0:c.config)===null||h===void 0?void 0:h.broadcast)===null||f===void 0)&&f.ack)&&o("ok"),m.receive("ok",()=>o("ok")),m.receive("error",()=>o("error")),m.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=En.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(es.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new v_(this,es.leave,{},e),i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=En.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const r=new AbortController,o=setTimeout(()=>r.abort(),i),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(o),c}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new v_(this,e,t,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>n9){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,o;const c=e.toLocaleLowerCase(),{close:h,error:f,leave:m,join:v}=es;if(i&&[h,f,m,v].indexOf(c)>=0&&i!==this._joinRef())return;let T=this._onMessage(c,t,i);if(t&&!T)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(x=>{var N,L,O;return((N=x.filter)===null||N===void 0?void 0:N.event)==="*"||((O=(L=x.filter)===null||L===void 0?void 0:L.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===c}).map(x=>x.callback(T,i)):(o=this.bindings[c])===null||o===void 0||o.filter(x=>{var N,L,O,Z,Y,H;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in x){const le=x.id,ve=(N=x.filter)===null||N===void 0?void 0:N.event;return le&&((L=t.ids)===null||L===void 0?void 0:L.includes(le))&&(ve==="*"||ve?.toLocaleLowerCase()===((O=t.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const le=(Y=(Z=x?.filter)===null||Z===void 0?void 0:Z.event)===null||Y===void 0?void 0:Y.toLocaleLowerCase();return le==="*"||le===((H=t?.event)===null||H===void 0?void 0:H.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===c}).map(x=>{if(typeof T=="object"&&"ids"in T){const N=T.data,{schema:L,table:O,commit_timestamp:Z,type:Y,errors:H}=N;T=Object.assign(Object.assign({},{schema:L,table:O,commit_timestamp:Z,eventType:Y,new:{},old:{},errors:H}),this._getPayloadRecords(N))}x.callback(T,i)})}_isClosed(){return this.state===En.closed}_isJoined(){return this.state===En.joined}_isJoining(){return this.state===En.joining}_isLeaving(){return this.state===En.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const r=e.toLocaleLowerCase(),o={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var o;return!(((o=r.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&dy.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(es.close,{},e)}_onError(e){this._on(es.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=En.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=lT(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=lT(e.columns,e.old_record)),t}}const y_=()=>{},ff={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},u9=[1e3,2e3,5e3,1e4],h9=1e4,d9=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class f9{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=C0,this.transport=null,this.heartbeatIntervalMs=ff.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=y_,this.ref=0,this.reconnectTimer=null,this.logger=y_,this.conn=null,this.sendBuffer=[],this.serializer=new i9,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...c)=>Oh(async()=>{const{default:h}=await Promise.resolve().then(()=>vc);return{default:h}},void 0).then(({default:h})=>h(...c)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...c)=>o(...c)},!(!((i=t?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${A0.websocket}`,this.httpEndpoint=VA(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=XM.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:e9}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Vu.connecting:return ho.Connecting;case Vu.open:return ho.Open;case Vu.closing:return ho.Closing;default:return ho.Closed}}isConnected(){return this.connectionState()===ho.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,r=this.getChannels().find(o=>o.topic===i);if(r)return r;{const o=new dy(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:i,payload:r,ref:o}=e,c=()=>{this.encode(e,h=>{var f;(f=this.conn)===null||f===void 0||f.send(h)})};this.log("push",`${t} ${i} (${o})`,r),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(t9,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},ff.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:o,ref:c}=t,h=c?`(${c})`:"",f=o.status||"";this.log("receive",`${f} ${i} ${r} ${h}`.trim(),o),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(r,o,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(es.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([d9],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const r={access_token:t,version:ZM};t&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(es.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new LA(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ff.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,r,o,c,h,f,m,v;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:C0,this.heartbeatIntervalMs=(r=e?.heartbeatIntervalMs)!==null&&r!==void 0?r:ff.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(h=e?.heartbeatCallback)!==null&&h!==void 0?h:y_,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(w=>u9[w-1]||h9),this.encode=(m=e?.encode)!==null&&m!==void 0?m:((w,T)=>T(JSON.stringify(w))),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class fy extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function yn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class m9 extends fy{constructor(e,t,i){super(e),this.name="StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class R0 extends fy{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var p9=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};const zA=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oh(async()=>{const{default:i}=await Promise.resolve().then(()=>vc);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},g9=()=>p9(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Oh(()=>Promise.resolve().then(()=>vc),void 0)).Response:Response}),N0=n=>{if(Array.isArray(n))return n.map(t=>N0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const r=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[r]=N0(i)}),e},_9=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Lo=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};const w_=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),v9=(n,e,t)=>Lo(void 0,void 0,void 0,function*(){const i=yield g9();n instanceof i&&!t?.noResolveJson?n.json().then(r=>{const o=n.status||500,c=r?.statusCode||o+"";e(new m9(w_(r),o,c))}).catch(r=>{e(new R0(w_(r),r))}):e(new R0(w_(n),n))}),y9=(n,e,t,i)=>{const r={method:n,headers:e?.headers||{}};return n==="GET"||!i?r:(_9(i)?(r.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(i)):r.body=i,e?.duplex&&(r.duplex=e.duplex),Object.assign(Object.assign({},r),t))};function Dh(n,e,t,i,r,o){return Lo(this,void 0,void 0,function*(){return new Promise((c,h)=>{n(t,y9(e,i,r,o)).then(f=>{if(!f.ok)throw f;return i?.noResolveJson?f:f.json()}).then(f=>c(f)).catch(f=>v9(f,h,i))})})}function rm(n,e,t,i){return Lo(this,void 0,void 0,function*(){return Dh(n,"GET",e,t,i)})}function Es(n,e,t,i,r){return Lo(this,void 0,void 0,function*(){return Dh(n,"POST",e,i,r,t)})}function k0(n,e,t,i,r){return Lo(this,void 0,void 0,function*(){return Dh(n,"PUT",e,i,r,t)})}function w9(n,e,t,i){return Lo(this,void 0,void 0,function*(){return Dh(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),i)})}function BA(n,e,t,i,r){return Lo(this,void 0,void 0,function*(){return Dh(n,"DELETE",e,i,r,t)})}var b9=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};class E9{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return b9(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(yn(e))return{data:null,error:e};throw e}})}}var T9=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})},FA;class S9{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[FA]="BlobDownloadBuilder",this.promise=null}asStream(){return new E9(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return T9(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(yn(e))return{data:null,error:e};throw e}})}}FA=Symbol.toStringTag;var mi=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};const x9={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hT={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class C9{constructor(e,t={},i,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=i,this.fetch=zA(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,i,r){return mi(this,void 0,void 0,function*(){try{let o;const c=Object.assign(Object.assign({},hT),r);let h=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const f=c.metadata;typeof Blob<"u"&&i instanceof Blob?(o=new FormData,o.append("cacheControl",c.cacheControl),f&&o.append("metadata",this.encodeMetadata(f)),o.append("",i)):typeof FormData<"u"&&i instanceof FormData?(o=i,o.append("cacheControl",c.cacheControl),f&&o.append("metadata",this.encodeMetadata(f))):(o=i,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType,f&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(f)))),r?.headers&&(h=Object.assign(Object.assign({},h),r.headers));const m=this._removeEmptyFolders(t),v=this._getFinalPath(m),w=yield(e=="PUT"?k0:Es)(this.fetch,`${this.url}/object/${v}`,o,Object.assign({headers:h},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:w.Id,fullPath:w.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(yn(o))return{data:null,error:o};throw o}})}upload(e,t,i){return mi(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,r){return mi(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),c=this._getFinalPath(o),h=new URL(this.url+`/object/upload/sign/${c}`);h.searchParams.set("token",t);try{let f;const m=Object.assign({upsert:hT.upsert},r),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&i instanceof Blob?(f=new FormData,f.append("cacheControl",m.cacheControl),f.append("",i)):typeof FormData<"u"&&i instanceof FormData?(f=i,f.append("cacheControl",m.cacheControl)):(f=i,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const w=yield k0(this.fetch,h.toString(),f,{headers:v});return{data:{path:o,fullPath:w.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(yn(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e,t){return mi(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const r=Object.assign({},this.headers);t?.upsert&&(r["x-upsert"]="true");const o=yield Es(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),c=new URL(this.url+o.url),h=c.searchParams.get("token");if(!h)throw new fy("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:h},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(yn(i))return{data:null,error:i};throw i}})}update(e,t,i){return mi(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return mi(this,void 0,void 0,function*(){try{return{data:yield Es(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yn(r))return{data:null,error:r};throw r}})}copy(e,t,i){return mi(this,void 0,void 0,function*(){try{return{data:{path:(yield Es(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yn(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,i){return mi(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),o=yield Es(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},i?.transform?{transform:i.transform}:{}),{headers:this.headers});const c=i?.download?`&download=${i.download===!0?"":i.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${c}`)},{data:o,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yn(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,i){return mi(this,void 0,void 0,function*(){try{const r=yield Es(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${o}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yn(r))return{data:null,error:r};throw r}})}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(t?.transform||{}),c=o?`?${o}`:"",h=this._getFinalPath(e),f=()=>rm(this.fetch,`${this.url}/${r}/${h}${c}`,{headers:this.headers,noResolveJson:!0});return new S9(f,this.shouldThrowOnError)}info(e){return mi(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const i=yield rm(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:N0(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(yn(i))return{data:null,error:i};throw i}})}exists(e){return mi(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield w9(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(yn(i)&&i instanceof R0){const r=i.originalError;if([400,404].includes(r?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,t){const i=this._getFinalPath(e),r=[],o=t?.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&r.push(o);const h=typeof t?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(t?.transform||{});f!==""&&r.push(f);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${i}${m}`)}}}remove(e){return mi(this,void 0,void 0,function*(){try{return{data:yield BA(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(yn(t))return{data:null,error:t};throw t}})}list(e,t,i){return mi(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},x9),t),{prefix:e||""});return{data:yield Es(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yn(r))return{data:null,error:r};throw r}})}listV2(e,t){return mi(this,void 0,void 0,function*(){try{const i=Object.assign({},e);return{data:yield Es(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},t),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(yn(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const A9="2.75.1",I9={"X-Client-Info":`storage-js/${A9}`};var Il=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};class R9{constructor(e,t={},i,r){this.shouldThrowOnError=!1;const o=new URL(e);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},I9),t),this.fetch=zA(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Il(this,void 0,void 0,function*(){try{return{data:yield rm(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(yn(e))return{data:null,error:e};throw e}})}getBucket(e){return Il(this,void 0,void 0,function*(){try{return{data:yield rm(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(yn(t))return{data:null,error:t};throw t}})}createBucket(e){return Il(this,arguments,void 0,function*(t,i={public:!1}){try{return{data:yield Es(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yn(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Il(this,void 0,void 0,function*(){try{return{data:yield k0(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(yn(i))return{data:null,error:i};throw i}})}emptyBucket(e){return Il(this,void 0,void 0,function*(){try{return{data:yield Es(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(yn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Il(this,void 0,void 0,function*(){try{return{data:yield BA(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(yn(t))return{data:null,error:t};throw t}})}}class N9 extends R9{constructor(e,t={},i,r){super(e,t,i,r)}from(e){return new C9(this.url,this.headers,e,this.fetch)}}const k9="2.75.1";let Iu="";typeof Deno<"u"?Iu="deno":typeof document<"u"?Iu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Iu="react-native":Iu="node";const O9={"X-Client-Info":`supabase-js-${Iu}/${k9}`},D9={headers:O9},j9={schema:"public"},P9={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},M9={};var L9=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};const U9=n=>{let e;return n?e=n:typeof fetch>"u"?e=kA:e=fetch,(...t)=>e(...t)},V9=()=>typeof Headers>"u"?OA:Headers,z9=(n,e,t)=>{const i=U9(t),r=V9();return(o,c)=>L9(void 0,void 0,void 0,function*(){var h;const f=(h=yield e())!==null&&h!==void 0?h:n;let m=new r(c?.headers);return m.has("apikey")||m.set("apikey",n),m.has("Authorization")||m.set("Authorization",`Bearer ${f}`),i(o,Object.assign(Object.assign({},c),{headers:m}))})};var B9=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};function F9(n){return n.endsWith("/")?n:n+"/"}function q9(n,e){var t,i;const{db:r,auth:o,realtime:c,global:h}=n,{db:f,auth:m,realtime:v,global:w}=e,T={db:Object.assign(Object.assign({},f),r),auth:Object.assign(Object.assign({},m),o),realtime:Object.assign(Object.assign({},v),c),storage:{},global:Object.assign(Object.assign(Object.assign({},w),h),{headers:Object.assign(Object.assign({},(t=w?.headers)!==null&&t!==void 0?t:{}),(i=h?.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>B9(this,void 0,void 0,function*(){return""})};return n.accessToken?T.accessToken=n.accessToken:delete T.accessToken,T}function H9(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(F9(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const qA="2.75.1",Ll=30*1e3,O0=3,b_=O0*Ll,$9="http://localhost:9999",G9="supabase.auth.token",K9={"X-Client-Info":`gotrue-js/${qA}`},D0="X-Supabase-Api-Version",HA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},W9=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Y9=600*1e3;class ch extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function De(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Q9 extends ch{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function X9(n){return De(n)&&n.name==="AuthApiError"}class fo extends ch{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Da extends ch{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class ca extends Da{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function J9(n){return De(n)&&n.name==="AuthSessionMissingError"}class Rl extends Da{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class mf extends Da{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class pf extends Da{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Z9(n){return De(n)&&n.name==="AuthImplicitGrantRedirectError"}class dT extends Da{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class j0 extends Da{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function E_(n){return De(n)&&n.name==="AuthRetryableFetchError"}class fT extends Da{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class P0 extends Da{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const am="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),mT=` 	
\r=`.split(""),eL=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<mT.length;e+=1)n[mT[e].charCodeAt(0)]=-2;for(let e=0;e<am.length;e+=1)n[am[e].charCodeAt(0)]=e;return n})();function pT(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(am[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(am[i]),e.queuedBits-=6}}function $A(n,e,t){const i=eL[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function gT(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},o=c=>{iL(c,i,t)};for(let c=0;c<n.length;c+=1)$A(n.charCodeAt(c),r,o);return e.join("")}function tL(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function nL(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}tL(i,e)}}function iL(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Wl(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)$A(n.charCodeAt(r),t,i);return new Uint8Array(e)}function sL(n){const e=[];return nL(n,t=>e.push(t)),new Uint8Array(e)}function go(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};return n.forEach(r=>pT(r,t,i)),pT(null,t,i),e.join("")}function rL(n){return Math.round(Date.now()/1e3)+n}function aL(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Ii=()=>typeof window<"u"&&typeof document<"u",ao={tested:!1,writable:!1},GA=()=>{if(!Ii())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ao.tested)return ao.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ao.tested=!0,ao.writable=!0}catch{ao.tested=!0,ao.writable=!1}return ao.writable};function oL(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,o)=>{e[o]=r})}catch{}return t.searchParams.forEach((i,r)=>{e[r]=i}),e}const KA=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oh(async()=>{const{default:i}=await Promise.resolve().then(()=>vc);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},lL=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ul=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},oo=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},la=async(n,e)=>{await n.removeItem(e)};class Hm{constructor(){this.promise=new Hm.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Hm.promiseConstructor=Promise;function T_(n){const e=n.split(".");if(e.length!==3)throw new P0("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!W9.test(e[i]))throw new P0("JWT not in base64url format");return{header:JSON.parse(gT(e[0])),payload:JSON.parse(gT(e[1])),signature:Wl(e[2]),raw:{header:e[0],payload:e[1]}}}async function cL(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function uL(n,e){return new Promise((i,r)=>{(async()=>{for(let o=0;o<1/0;o++)try{const c=await n(o);if(!e(o,null,c)){i(c);return}}catch(c){if(!e(o,c)){r(c);return}}})()})}function hL(n){return("0"+n.toString(16)).substr(-2)}function dL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let r="";for(let o=0;o<56;o++)r+=t.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,hL).join("")}async function fL(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(i);return Array.from(r).map(o=>String.fromCharCode(o)).join("")}async function mL(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await fL(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Nl(n,e,t=!1){const i=dL();let r=i;t&&(r+="/PASSWORD_RECOVERY"),await Ul(n,`${e}-code-verifier`,r);const o=await mL(i);return[o,i===o?"plain":"s256"]}const pL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gL(n){const e=n.headers.get(D0);if(!e||!e.match(pL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function _L(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function vL(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const yL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function kl(n){if(!yL.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function S_(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function _T(n){return JSON.parse(JSON.stringify(n))}var wL=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const uo=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),bL=[502,503,504];async function vT(n){var e;if(!lL(n))throw new j0(uo(n),0);if(bL.includes(n.status))throw new j0(uo(n),n.status);let t;try{t=await n.json()}catch(o){throw new fo(uo(o),o)}let i;const r=gL(n);if(r&&r.getTime()>=HA["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new fT(uo(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new ca}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,c)=>o&&typeof c=="string",!0))throw new fT(uo(t),n.status,t.weak_password.reasons);throw new Q9(uo(t),n.status||500,i)}const EL=(n,e,t,i)=>{const r={method:n,headers:e?.headers||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),t))};async function $e(n,e,t,i){var r;const o=Object.assign({},i?.headers);o[D0]||(o[D0]=HA["2024-01-01"].name),i?.jwt&&(o.Authorization=`Bearer ${i.jwt}`);const c=(r=i?.query)!==null&&r!==void 0?r:{};i?.redirectTo&&(c.redirect_to=i.redirectTo);const h=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",f=await TL(n,e,t+h,{headers:o,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(f):{data:Object.assign({},f),error:null}}async function TL(n,e,t,i,r,o){const c=EL(e,i,r,o);let h;try{h=await n(t,Object.assign({},c))}catch(f){throw console.error(f),new j0(uo(f),0)}if(h.ok||await vT(h),i?.noResolveJson)return h;try{return await h.json()}catch(f){await vT(f)}}function Zi(n){var e;let t=null;CL(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=rL(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function yT(n){const e=Zi(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ma(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function SL(n){return{data:n,error:null}}function xL(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:o}=n,c=wL(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:o},f=Object.assign({},c);return{data:{properties:h,user:f},error:null}}function wT(n){return n}function CL(n){return n.access_token&&n.refresh_token&&n.expires_in}const x_=["global","local","others"];var AL=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};class IL{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=KA(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=x_[0]){if(x_.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${x_.join(", ")}`);try{return await $e(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(De(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await $e(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ma})}catch(i){if(De(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=AL(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i?.newEmail,delete r.newEmail),await $e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:xL,redirectTo:t?.redirectTo})}catch(t){if(De(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await $e(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ma})}catch(t){if(De(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,r,o,c,h,f;try{const m={nextPage:null,lastPage:0,total:0},v=await $e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:wT});if(v.error)throw v.error;const w=await v.json(),T=(c=v.headers.get("x-total-count"))!==null&&c!==void 0?c:0,x=(f=(h=v.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&f!==void 0?f:[];return x.length>0&&(x.forEach(N=>{const L=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(N.split(";")[1].split("=")[1]);m[`${O}Page`]=L}),m.total=parseInt(T)),{data:Object.assign(Object.assign({},w),m),error:null}}catch(m){if(De(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){kl(e);try{return await $e(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ma})}catch(t){if(De(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){kl(e);try{return await $e(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ma})}catch(i){if(De(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){kl(e);try{return await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ma})}catch(i){if(De(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){kl(e.userId);try{const{data:t,error:i}=await $e(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(De(t))return{data:null,error:t};throw t}}async _deleteFactor(e){kl(e.userId),kl(e.id);try{return{data:await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(De(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,r,o,c,h,f;try{const m={nextPage:null,lastPage:0,total:0},v=await $e(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:wT});if(v.error)throw v.error;const w=await v.json(),T=(c=v.headers.get("x-total-count"))!==null&&c!==void 0?c:0,x=(f=(h=v.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&f!==void 0?f:[];return x.length>0&&(x.forEach(N=>{const L=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(N.split(";")[1].split("=")[1]);m[`${O}Page`]=L}),m.total=parseInt(T)),{data:Object.assign(Object.assign({},w),m),error:null}}catch(m){if(De(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(e){try{return await $e(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(De(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await $e(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(De(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(e){try{return await $e(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(De(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await $e(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(De(t))return{data:null,error:t};throw t}}}function bT(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Ol={debug:!!(globalThis&&GA()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class WA extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class RL extends WA{}async function NL(n,e,t){Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new RL(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Ol.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function kL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function YA(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function OL(n){return parseInt(n,16)}function DL(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function jL(n){var e;const{chainId:t,domain:i,expirationTime:r,issuedAt:o=new Date,nonce:c,notBefore:h,requestId:f,resources:m,scheme:v,uri:w,version:T}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!w)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(T!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${T}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const x=YA(n.address),N=v?`${v}://${i}`:i,L=n.statement?`${n.statement}
`:"",O=`${N} wants you to sign in with your Ethereum account:
${x}

${L}`;let Z=`URI: ${w}
Version: ${T}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${o.toISOString()}`;if(r&&(Z+=`
Expiration Time: ${r.toISOString()}`),h&&(Z+=`
Not Before: ${h.toISOString()}`),f&&(Z+=`
Request ID: ${f}`),m){let Y=`
Resources:`;for(const H of m){if(!H||typeof H!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${H}`);Y+=`
- ${H}`}Z+=Y}return`${O}
${Z}`}class vn extends Error{constructor({message:e,code:t,cause:i,name:r}){var o;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(o=r??(i instanceof Error?i.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=t}}class om extends vn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function PL({error:n,options:e}){var t,i,r;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new vn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=o.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new vn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=o.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new vn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new vn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new vn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new vn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return o.pubKeyCredParams.filter(h=>h.type==="public-key").length===0?new vn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new vn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const c=window.location.hostname;if(XA(c)){if(o.rp.id!==c)return new vn({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new vn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new vn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new vn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new vn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function ML({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new vn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new vn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(XA(i)){if(t.rpId!==i)return new vn({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new vn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new vn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new vn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}var QA=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};class LL{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const UL=new LL;function VL(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,r=QA(n,["challenge","user","excludeCredentials"]),o=Wl(e).buffer,c=Object.assign(Object.assign({},t),{id:Wl(t.id).buffer}),h=Object.assign(Object.assign({},r),{challenge:o,user:c});if(i&&i.length>0){h.excludeCredentials=new Array(i.length);for(let f=0;f<i.length;f++){const m=i[f];h.excludeCredentials[f]=Object.assign(Object.assign({},m),{id:Wl(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return h}function zL(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=QA(n,["challenge","allowCredentials"]),r=Wl(e).buffer,o=Object.assign(Object.assign({},i),{challenge:r});if(t&&t.length>0){o.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const h=t[c];o.allowCredentials[c]=Object.assign(Object.assign({},h),{id:Wl(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return o}function BL(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:go(new Uint8Array(n.response.attestationObject)),clientDataJSON:go(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function FL(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),r=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:go(new Uint8Array(r.authenticatorData)),clientDataJSON:go(new Uint8Array(r.clientDataJSON)),signature:go(new Uint8Array(r.signature)),userHandle:r.userHandle?go(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function XA(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function ET(){var n,e;return!!(Ii()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function qL(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new om("Browser returned unexpected credential type",e)}:{data:null,error:new om("Empty credential response",e)}}catch(e){return{data:null,error:PL({error:e,options:n})}}}async function HL(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new om("Browser returned unexpected credential type",e)}:{data:null,error:new om("Empty credential response",e)}}catch(e){return{data:null,error:ML({error:e,options:n})}}}const $L={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},GL={userVerification:"preferred",hints:["security-key"]};function lm(...n){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),t=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),i={};for(const r of n)if(r)for(const o in r){const c=r[o];if(c!==void 0)if(Array.isArray(c))i[o]=c;else if(t(c))i[o]=c;else if(e(c)){const h=i[o];e(h)?i[o]=lm(h,c):i[o]=lm(c)}else i[o]=c}return i}function KL(n,e){return lm($L,n,e||{})}function WL(n,e){return lm(GL,n,e||{})}class YL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:r},o){try{const{data:c,error:h}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:h};const f=r??UL.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=KL(c.webauthn.credential_options.publicKey,o?.create),{data:v,error:w}=await qL({publicKey:m,signal:f});return v?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:v}},error:null}:{data:null,error:w}}case"request":{const m=WL(c.webauthn.credential_options.publicKey,o?.request),{data:v,error:w}=await HL(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:f}));return v?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:v}},error:null}:{data:null,error:w}}}}catch(c){return De(c)?{data:null,error:c}:{data:null,error:new fo("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}},o){if(!t)return{data:null,error:new ch("rpId is required for WebAuthn authentication")};try{if(!ET())return{data:null,error:new fo("Browser does not support WebAuthn",null)};const{data:c,error:h}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:r},{request:o});if(!c)return{data:null,error:h};const{webauthn:f}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:f.type,rpId:t,rpOrigins:i,credential_response:f.credential_response}})}catch(c){return De(c)?{data:null,error:c}:{data:null,error:new fo("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r},o){if(!t)return{data:null,error:new ch("rpId is required for WebAuthn registration")};try{if(!ET())return{data:null,error:new fo("Browser does not support WebAuthn",null)};const{data:c,error:h}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(v=>{var w;return(w=v.data)===null||w===void 0?void 0:w.all.find(T=>T.factor_type==="webauthn"&&T.friendly_name===e&&T.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:h};const{data:f,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:r},{create:o});return f?this._verify({factorId:c.id,challengeId:f.challengeId,webauthn:{rpId:t,rpOrigins:i,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:m}}catch(c){return De(c)?{data:null,error:c}:{data:null,error:new fo("Unexpected error in register",c)}}}}kL();const QL={url:$9,storageKey:G9,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:K9,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function TT(n,e,t){return await t()}const Dl={};class uh{get jwks(){var e,t;return(t=(e=Dl[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Dl[this.storageKey]=Object.assign(Object.assign({},Dl[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Dl[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Dl[this.storageKey]=Object.assign(Object.assign({},Dl[this.storageKey]),{cachedAt:e})}constructor(e){var t,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=uh.nextInstanceID,uh.nextInstanceID+=1,this.instanceID>0&&Ii()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},QL),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new IL({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=KA(r.fetch),this.lock=r.lock||TT,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ii()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=NL:this.lock=TT,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new YL(this)},this.persistSession?(r.storage?this.storage=r.storage:GA()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=bT(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=bT(this.memoryStorage)),Ii()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${qA}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=oL(window.location.href);let i="none";if(this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce"),Ii()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:o}=await this._getSessionFromURL(t,i);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Z9(o)){const f=(e=o.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:c,redirectType:h}=r;return this._debug("#_initialize()","detected session in URL",c,"redirect type",h),await this._saveSession(c),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return De(t)?{error:t}:{error:new fo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{const o=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=e?.options)===null||r===void 0?void 0:r.captchaToken}},xform:Zi}),{data:c,error:h}=o;if(h||!c)return{data:{user:null,session:null},error:h};const f=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(o){if(De(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var t,i,r;try{let o;if("email"in e){const{email:v,password:w,options:T}=e;let x=null,N=null;this.flowType==="pkce"&&([x,N]=await Nl(this.storage,this.storageKey)),o=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:T?.emailRedirectTo,body:{email:v,password:w,data:(t=T?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:T?.captchaToken},code_challenge:x,code_challenge_method:N},xform:Zi})}else if("phone"in e){const{phone:v,password:w,options:T}=e;o=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:w,data:(i=T?.data)!==null&&i!==void 0?i:{},channel:(r=T?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:T?.captchaToken}},xform:Zi})}else throw new mf("You must provide either an email or phone number and a password");const{data:c,error:h}=o;if(h||!c)return{data:{user:null,session:null},error:h};const f=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(o){if(De(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:c,options:h}=e;t=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:c,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:yT})}else if("phone"in e){const{phone:o,password:c,options:h}=e;t=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:c,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:yT})}else throw new mf("You must provide either an email or phone number and a password");const{data:i,error:r}=t;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Rl}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(t){if(De(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,i,r,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,r,o,c,h,f,m,v,w,T;let x,N;if("message"in e)x=e.message,N=e.signature;else{const{chain:L,wallet:O,statement:Z,options:Y}=e;let H;if(Ii())if(typeof O=="object")H=O;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")H=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!Y?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");H=O}const le=new URL((t=Y?.url)!==null&&t!==void 0?t:window.location.href),ve=await H.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ve||ve.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const oe=YA(ve[0]);let I=(i=Y?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!I){const R=await H.request({method:"eth_chainId"});I=OL(R)}const A={domain:le.host,address:oe,statement:Z,uri:le.href,version:"1",chainId:I,nonce:(r=Y?.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(c=(o=Y?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(h=Y?.signInWithEthereum)===null||h===void 0?void 0:h.expirationTime,notBefore:(f=Y?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(m=Y?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=Y?.signInWithEthereum)===null||v===void 0?void 0:v.resources};x=jL(A),N=await H.request({method:"personal_sign",params:[DL(x),oe]})}try{const{data:L,error:O}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:N},!((w=e.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(T=e.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:Zi});if(O)throw O;return!L||!L.session||!L.user?{data:{user:null,session:null},error:new Rl}:(L.session&&(await this._saveSession(L.session),await this._notifyAllSubscribers("SIGNED_IN",L.session)),{data:Object.assign({},L),error:O})}catch(L){if(De(L))return{data:{user:null,session:null},error:L};throw L}}async signInWithSolana(e){var t,i,r,o,c,h,f,m,v,w,T,x;let N,L;if("message"in e)N=e.message,L=e.signature;else{const{chain:O,wallet:Z,statement:Y,options:H}=e;let le;if(Ii())if(typeof Z=="object")le=Z;else{const oe=window;if("solana"in oe&&typeof oe.solana=="object"&&("signIn"in oe.solana&&typeof oe.solana.signIn=="function"||"signMessage"in oe.solana&&typeof oe.solana.signMessage=="function"))le=oe.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof Z!="object"||!H?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");le=Z}const ve=new URL((t=H?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in le&&le.signIn){const oe=await le.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},H?.signInWithSolana),{version:"1",domain:ve.host,uri:ve.href}),Y?{statement:Y}:null));let I;if(Array.isArray(oe)&&oe[0]&&typeof oe[0]=="object")I=oe[0];else if(oe&&typeof oe=="object"&&"signedMessage"in oe&&"signature"in oe)I=oe;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)N=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),L=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in le)||typeof le.signMessage!="function"||!("publicKey"in le)||typeof le!="object"||!le.publicKey||!("toBase58"in le.publicKey)||typeof le.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${ve.host} wants you to sign in with your Solana account:`,le.publicKey.toBase58(),...Y?["",Y,""]:[""],"Version: 1",`URI: ${ve.href}`,`Issued At: ${(r=(i=H?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((o=H?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${H.signInWithSolana.notBefore}`]:[],...!((c=H?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${H.signInWithSolana.expirationTime}`]:[],...!((h=H?.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${H.signInWithSolana.chainId}`]:[],...!((f=H?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${H.signInWithSolana.nonce}`]:[],...!((m=H?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${H.signInWithSolana.requestId}`]:[],...!((w=(v=H?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||w===void 0)&&w.length?["Resources",...H.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const oe=await le.signMessage(new TextEncoder().encode(N),"utf8");if(!oe||!(oe instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");L=oe}}try{const{data:O,error:Z}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:go(L)},!((T=e.options)===null||T===void 0)&&T.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Zi});if(Z)throw Z;return!O||!O.session||!O.user?{data:{user:null,session:null},error:new Rl}:(O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),{data:Object.assign({},O),error:Z})}catch(O){if(De(O))return{data:{user:null,session:null},error:O};throw O}}async _exchangeCodeForSession(e){const t=await oo(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(t??"").split("/");try{const{data:o,error:c}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:Zi});if(await la(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Rl}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:r??null}),error:c})}catch(o){if(De(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:t,provider:i,token:r,access_token:o,nonce:c}=e,h=await $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:o,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Zi}),{data:f,error:m}=h;return m?{data:{user:null,session:null},error:m}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new Rl}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:m})}catch(t){if(De(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,i,r,o,c;try{if("email"in e){const{email:h,options:f}=e;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Nl(this.storage,this.storageKey));const{error:w}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(t=f?.data)!==null&&t!==void 0?t:{},create_user:(i=f?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:f?.emailRedirectTo});return{data:{user:null,session:null},error:w}}if("phone"in e){const{phone:h,options:f}=e,{data:m,error:v}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(r=f?.data)!==null&&r!==void 0?r:{},create_user:(o=f?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(c=f?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m?.message_id},error:v}}throw new mf("You must provide either an email or phone number.")}catch(h){if(De(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(e){var t,i;try{let r,o;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:c,error:h}=await $e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:Zi});if(h)throw h;if(!c)throw new Error("An error occurred on token verification.");const f=c.session,m=c.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(r){if(De(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,i,r;try{let o=null,c=null;return this.flowType==="pkce"&&([o,c]=await Nl(this.storage,this.storageKey)),await $e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:c}),headers:this.headers,xform:SL})}catch(o){if(De(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new ca;const{error:r}=await $e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(De(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:o}=e,{error:c}=await $e(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:i,type:r,options:o}=e,{data:c,error:h}=await $e(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:h}}throw new mf("You must provide either an email or phone number and a type")}catch(t){if(De(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await oo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<b_:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const c=await oo(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=S_()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(f,m,v)=>(!c&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,m,v))})}return{data:{session:e},error:null}}const{data:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ma}):await this._useSession(async t=>{var i,r,o;const{data:c,error:h}=t;if(h)throw h;return!(!((i=c.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ca}:await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(r=c.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0,xform:ma})})}catch(t){if(De(t))return J9(t)&&(await this._removeSession(),await la(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:r,error:o}=i;if(o)throw o;if(!r.session)throw new ca;const c=r.session;let h=null,f=null;this.flowType==="pkce"&&e.email!=null&&([h,f]=await Nl(this.storage,this.storageKey));const{data:m,error:v}=await $e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:f}),jwt:c.access_token,xform:ma});if(v)throw v;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(i){if(De(i))return{data:{user:null},error:i};throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ca;const t=Date.now()/1e3;let i=t,r=!0,o=null;const{payload:c}=T_(e.access_token);if(c.exp&&(i=c.exp,r=i<=t),r){const{data:h,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!h)return{data:{user:null,session:null},error:null};o=h}else{const{data:h,error:f}=await this._getUser(e.access_token);if(f)throw f;o={access_token:e.access_token,refresh_token:e.refresh_token,user:h.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(De(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:c,error:h}=t;if(h)throw h;e=(i=c.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new ca;const{data:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(De(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ii())throw new pf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new pf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new dT("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new pf("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new dT("No code detected.");const{data:Y,error:H}=await this._exchangeCodeForSession(e.code);if(H)throw H;const le=new URL(window.location.href);return le.searchParams.delete("code"),window.history.replaceState(window.history.state,"",le.toString()),{data:{session:Y.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:o,refresh_token:c,expires_in:h,expires_at:f,token_type:m}=e;if(!o||!h||!c||!m)throw new pf("No session defined in URL");const v=Math.round(Date.now()/1e3),w=parseInt(h);let T=v+w;f&&(T=parseInt(f));const x=T-v;x*1e3<=Ll&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${w}s`);const N=T-w;v-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,T,v):v-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,T,v);const{data:L,error:O}=await this._getUser(o);if(O)throw O;const Z={provider_token:i,provider_refresh_token:r,access_token:o,expires_in:w,expires_at:T,refresh_token:c,token_type:m,user:L.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:Z,redirectType:e.type},error:null}}catch(i){if(De(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await oo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:r,error:o}=t;if(o)return{error:o};const c=(i=r.session)===null||i===void 0?void 0:i.access_token;if(c){const{error:h}=await this.admin.signOut(c,e);if(h&&!(X9(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return e!=="others"&&(await this._removeSession(),await la(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=aL(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{const{data:{session:o},error:c}=t;if(c)throw c;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await Nl(this.storage,this.storageKey,!0));try{return await $e(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(De(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(De(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:r}=await this._useSession(async o=>{var c,h,f,m,v;const{data:w,error:T}=o;if(T)throw T;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(h=e.options)===null||h===void 0?void 0:h.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await $e(this.fetch,"GET",x,{headers:this.headers,jwt:(v=(m=w.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(r)throw r;return Ii()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),{data:{provider:e.provider,url:i?.url},error:null}}catch(i){if(De(i))return{data:{provider:e.provider,url:null},error:i};throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:r,data:{session:o}}=t;if(r)throw r;const{options:c,provider:h,token:f,access_token:m,nonce:v}=e,w=await $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=o?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:h,id_token:f,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Zi}),{data:T,error:x}=w;return x?{data:{user:null,session:null},error:x}:!T||!T.session||!T.user?{data:{user:null,session:null},error:new Rl}:(T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("USER_UPDATED",T.session)),{data:T,error:x})}catch(r){if(De(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;const{data:o,error:c}=t;if(c)throw c;return await $e(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(De(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await uL(async r=>(r>0&&await cL(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await $e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Zi})),(r,o)=>{const c=200*Math.pow(2,r);return o&&E_(o)&&Date.now()+c-i<Ll})}catch(i){if(this._debug(t,"error",i),De(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),Ii()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await oo(this.storage,this.storageKey);if(r&&this.userStorage){let c=await oo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:r.user},await Ul(this.userStorage,this.storageKey+"-user",c)),r.user=(e=c?.user)!==null&&e!==void 0?e:S_()}else if(r&&!r.user&&!r.user){const c=await oo(this.storage,this.storageKey+"-user");c&&c?.user?(r.user=c.user,await la(this.storage,this.storageKey+"-user"),await Ul(this.storage,this.storageKey,r)):r.user=S_()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const o=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<b_;if(this._debug(i,`session has${o?"":" not"} expired with margin of ${b_}s`),o){if(this.autoRefreshToken&&r.refresh_token){const{error:c}=await this._callRefreshToken(r.refresh_token);c&&(console.error(c),E_(c)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:h}=await this._getUser(r.access_token);!h&&c?.user?(r.user=c.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(i,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new ca;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Hm;const{data:o,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!o.session)throw new ca;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const h={data:o.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(o){if(this._debug(r,"error",o),De(o)){const c={data:null,error:o};return E_(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],c=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(e,t)}catch(f){o.push(f)}});if(await Promise.all(c),o.length>0){for(let h=0;h<o.length;h+=1)console.error(o[h]);throw o[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Ul(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const o=_T(r);await Ul(this.storage,this.storageKey,o)}else{const r=_T(t);await Ul(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await la(this.storage,this.storageKey),await la(this.storage,this.storageKey+"-code-verifier"),await la(this.storage,this.storageKey+"-user"),this.userStorage&&await la(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ii()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ll);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/Ll);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Ll}ms, refresh threshold is ${O0} ticks`),r<=O0&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof WA)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ii()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const r=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[o,c]=await Nl(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(c)}`});r.push(h.toString())}if(i?.queryParams){const o=new URLSearchParams(i.queryParams);r.push(o.toString())}return i?.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:r,error:o}=t;return o?{data:null,error:o}:await $e(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(De(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;const{data:o,error:c}=t;if(c)return{data:null,error:c};const h=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:f,error:m}=await $e(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});return m?{data:null,error:m}:(e.factorType==="totp"&&f.type==="totp"&&(!((r=f?.totp)===null||r===void 0)&&r.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})})}catch(t){if(De(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:o}=t;if(o)return{data:null,error:o};const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?BL(e.webauthn.credential_response):FL(e.webauthn.credential_response)})}:{code:e.code}),{data:h,error:f}=await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:f})})}catch(t){if(De(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:o}=t;if(o)return{data:null,error:o};const c=await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token});if(c.error)return c;const{data:h}=c;if(h.type!=="webauthn")return{data:h,error:null};switch(h.webauthn.type){case"create":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:VL(h.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:zL(h.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(De(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const r={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=t?.factors)!==null&&e!==void 0?e:[])r.all.push(o),o.status==="verified"&&r[o.factor_type].push(o);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,i;const{data:{session:r},error:o}=e;if(o)return{data:null,error:o};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=T_(r.access_token);let h=null;c.aal&&(h=c.aal);let f=h;((i=(t=r.user.factors)===null||t===void 0?void 0:t.filter(w=>w.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(f="aal2");const v=c.amr||[];return{data:{currentLevel:h,nextLevel:f,currentAuthenticationMethods:v},error:null}}))}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(h=>h.kid===e);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(h=>h.kid===e),i&&this.jwks_cached_at+Y9>r)return i;const{data:o,error:c}=await $e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=r,i=o.keys.find(h=>h.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:x,error:N}=await this.getSession();if(N||!x.session)return{data:null,error:N};i=x.session.access_token}const{header:r,payload:o,signature:c,raw:{header:h,payload:f}}=T_(i);t?.allowExpired||_L(o.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!m){const{error:x}=await this.getUser(i);if(x)throw x;return{data:{claims:o,header:r,signature:c},error:null}}const v=vL(r.alg),w=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,w,c,sL(`${h}.${f}`)))throw new P0("Invalid JWT signature");return{data:{claims:o,header:r,signature:c},error:null}}catch(i){if(De(i))return{data:null,error:i};throw i}}}uh.nextInstanceID=0;const XL=uh;class JL extends XL{constructor(e){super(e)}}var ZL=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(v){try{m(i.next(v))}catch(w){c(w)}}function f(v){try{m(i.throw(v))}catch(w){c(w)}}function m(v){v.done?o(v.value):r(v.value).then(h,f)}m((i=i.apply(n,e||[])).next())})};class eU{constructor(e,t,i){var r,o,c;this.supabaseUrl=e,this.supabaseKey=t;const h=H9(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const f=`sb-${h.hostname.split(".")[0]}-auth-token`,m={db:j9,realtime:M9,auth:Object.assign(Object.assign({},P9),{storageKey:f}),global:D9},v=q9(i??{},m);this.storageKey=(r=v.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=v.global.headers)!==null&&o!==void 0?o:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(w,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=v.auth)!==null&&c!==void 0?c:{},this.headers,v.global.fetch),this.fetch=z9(t,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new QM(new URL("rest/v1",h).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new N9(this.storageUrl.href,this.headers,this.fetch,i?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new zM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return ZL(this,void 0,void 0,function*(){var e,t;if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(t=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,userStorage:o,storageKey:c,flowType:h,lock:f,debug:m},v,w){const T={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new JL({url:this.authUrl.href,headers:Object.assign(Object.assign({},T),v),storageKey:c,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,userStorage:o,flowType:h,lock:f,debug:m,fetch:w,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new f9(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,i)=>{this._handleTokenChanged(t,"CLIENT",i?.access_token)})}_handleTokenChanged(e,t,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const tU=(n,e,t)=>new eU(n,e,t);function nU(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}nU()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const iU="https://raoohjclgxiuushhdwvv.supabase.co",sU="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJhb29oamNsZ3hpdXVzaGhkd3Z2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzkzMTEsImV4cCI6MjA3MzAxNTMxMX0.LgK_EzTdLWn9ELp-riXnyWV0MVI3pLMCtTPss-s2aKc",Te=tU(iU,sU);var JA={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ST=rs.createContext&&rs.createContext(JA),rU=["attr","size","title"];function aU(n,e){if(n==null)return{};var t=oU(n,e),i,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function oU(n,e){if(n==null)return{};var t={};for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}function cm(){return cm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},cm.apply(this,arguments)}function xT(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function um(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xT(Object(t),!0).forEach(function(i){lU(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xT(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function lU(n,e,t){return e=cU(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cU(n){var e=uU(n,"string");return typeof e=="symbol"?e:e+""}function uU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ZA(n){return n&&n.map((e,t)=>rs.createElement(e.tag,um({key:t},e.attr),ZA(e.child)))}function Oe(n){return e=>rs.createElement(hU,cm({attr:um({},n.attr)},e),ZA(n.child))}function hU(n){var e=t=>{var{attr:i,size:r,title:o}=n,c=aU(n,rU),h=r||t.size||"1em",f;return t.className&&(f=t.className),n.className&&(f=(f?f+" ":"")+n.className),rs.createElement("svg",cm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,c,{className:f,style:um(um({color:n.color||t.color},t.style),n.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),o&&rs.createElement("title",null,o),n.children)};return ST!==void 0?rs.createElement(ST.Consumer,null,t=>e(t)):e(JA)}function C_(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M244 400 100 256l144-144M120 256h292"},child:[]}]})(n)}function CT(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"m268 112 144 144-144 144m124-144H100"},child:[]}]})(n)}function dU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"m112 244 144-144 144 144M256 120v292"},child:[]}]})(n)}function fU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M480 128a64 64 0 0 0-64-64h-16V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 368 48v16H144V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 112 48v16H96a64 64 0 0 0-64 64v12a4 4 0 0 0 4 4h440a4 4 0 0 0 4-4zM32 416a64 64 0 0 0 64 64h320a64 64 0 0 0 64-64V179a3 3 0 0 0-3-3H35a3 3 0 0 0-3 3zm344-208a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24 24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24 24 24 0 0 1 24-24z"},child:[]}]})(n)}function my(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M391 480c-19.52 0-46.94-7.06-88-30-49.93-28-88.55-53.85-138.21-103.38C116.91 298.77 93.61 267.79 61 208.45c-36.84-67-30.56-102.12-23.54-117.13C45.82 73.38 58.16 62.65 74.11 52a176.3 176.3 0 0 1 28.64-15.2c1-.43 1.93-.84 2.76-1.21 4.95-2.23 12.45-5.6 21.95-2 6.34 2.38 12 7.25 20.86 16 18.17 17.92 43 57.83 52.16 77.43 6.15 13.21 10.22 21.93 10.23 31.71 0 11.45-5.76 20.28-12.75 29.81-1.31 1.79-2.61 3.5-3.87 5.16-7.61 10-9.28 12.89-8.18 18.05 2.23 10.37 18.86 41.24 46.19 68.51s57.31 42.85 67.72 45.07c5.38 1.15 8.33-.59 18.65-8.47 1.48-1.13 3-2.3 4.59-3.47 10.66-7.93 19.08-13.54 30.26-13.54h.06c9.73 0 18.06 4.22 31.86 11.18 18 9.08 59.11 33.59 77.14 51.78 8.77 8.84 13.66 14.48 16.05 20.81 3.6 9.53.21 17-2 22-.37.83-.78 1.74-1.21 2.75a176.49 176.49 0 0 1-15.29 28.58c-10.63 15.9-21.4 28.21-39.38 36.58A67.42 67.42 0 0 1 391 480z"},child:[]}]})(n)}function e4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432 144h-59c-3 0-6.72-1.94-9.62-5l-25.94-40.94a15.52 15.52 0 0 0-1.37-1.85C327.11 85.76 315 80 302 80h-92c-13 0-25.11 5.76-34.07 16.21a15.52 15.52 0 0 0-1.37 1.85l-25.94 41c-2.22 2.42-5.34 5-8.62 5v-8a16 16 0 0 0-16-16h-24a16 16 0 0 0-16 16v8h-4a48.05 48.05 0 0 0-48 48V384a48.05 48.05 0 0 0 48 48h352a48.05 48.05 0 0 0 48-48V192a48.05 48.05 0 0 0-48-48zM316.84 346.3a96.06 96.06 0 0 1-155.66-59.18 16 16 0 0 1-16.49-26.43l20-20a16 16 0 0 1 22.62 0l20 20A16 16 0 0 1 196 288a17.31 17.31 0 0 1-2-.14 64.07 64.07 0 0 0 102.66 33.63 16 16 0 1 1 20.21 24.81zm50.47-63-20 20a16 16 0 0 1-22.62 0l-20-20a16 16 0 0 1 13.09-27.2A64 64 0 0 0 215 222.64 16 16 0 1 1 194.61 198a96 96 0 0 1 156 59 16 16 0 0 1 16.72 26.35z"},child:[]}]})(n)}function AT(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"272",r:"64"},child:[]},{tag:"path",attr:{d:"M432 144h-59c-3 0-6.72-1.94-9.62-5l-25.94-40.94a15.52 15.52 0 0 0-1.37-1.85C327.11 85.76 315 80 302 80h-92c-13 0-25.11 5.76-34.07 16.21a15.52 15.52 0 0 0-1.37 1.85l-25.94 41c-2.22 2.42-5.34 5-8.62 5v-8a16 16 0 0 0-16-16h-24a16 16 0 0 0-16 16v8h-4a48.05 48.05 0 0 0-48 48V384a48.05 48.05 0 0 0 48 48h352a48.05 48.05 0 0 0 48-48V192a48.05 48.05 0 0 0-48-48zM256 368a96 96 0 1 1 96-96 96.11 96.11 0 0 1-96 96z"},child:[]}]})(n)}function mU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M398 81.84A227.4 227.4 0 0 0 255.82 32C194.9 32 138 55.47 95.46 98.09 54.35 139.33 31.82 193.78 32 251.37a215.66 215.66 0 0 0 35.65 118.76l.19.27c.28.41.57.82.86 1.22s.65.92.73 1.05l.22.4c1.13 2 2 4.44 1.23 6.9l-18.42 66.66a29.13 29.13 0 0 0-1.2 7.63A25.69 25.69 0 0 0 76.83 480a29.44 29.44 0 0 0 10.45-2.29l67.49-24.36.85-.33a14.75 14.75 0 0 1 5.8-1.15 15.12 15.12 0 0 1 5.37 1c1.62.63 16.33 6.26 31.85 10.6 12.9 3.6 39.74 9 60.77 9 59.65 0 115.35-23.1 156.83-65.06C457.36 365.77 480 310.42 480 251.49a213.5 213.5 0 0 0-4.78-45c-10.34-48.62-37.76-92.9-77.22-124.65zM87.48 380zM160 288a32 32 0 1 1 32-32 32 32 0 0 1-32 32zm96 0a32 32 0 1 1 32-32 32 32 0 0 1-32 32zm96 0a32 32 0 1 1 32-32 32 32 0 0 1-32 32z"},child:[]}]})(n)}function IT(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M416 128 192 384l-96-96"},child:[]}]})(n)}function hh(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(n)}function pU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"256",r:"48"},child:[]},{tag:"circle",attr:{cx:"416",cy:"256",r:"48"},child:[]},{tag:"circle",attr:{cx:"96",cy:"256",r:"48"},child:[]}]})(n)}function t4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448zM248 315.85l-51.79-51.79a2 2 0 0 0-3.39 1.69 64.11 64.11 0 0 0 53.49 53.49 2 2 0 0 0 1.69-3.39zm16-119.7L315.87 248a2 2 0 0 0 3.4-1.69 64.13 64.13 0 0 0-53.55-53.55 2 2 0 0 0-1.72 3.39z"},child:[]},{tag:"path",attr:{d:"M491 273.36a32.2 32.2 0 0 0-.1-34.76c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.68 96a226.54 226.54 0 0 0-71.82 11.79 4 4 0 0 0-1.56 6.63l47.24 47.24a4 4 0 0 0 3.82 1.05 96 96 0 0 1 116 116 4 4 0 0 0 1.05 3.81l67.95 68a4 4 0 0 0 5.4.24 343.81 343.81 0 0 0 67.24-77.4zM256 352a96 96 0 0 1-93.3-118.63 4 4 0 0 0-1.05-3.81l-66.84-66.87a4 4 0 0 0-5.41-.23c-24.39 20.81-47 46.13-67.67 75.72a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.39 76.14 98.28 100.65C162.06 402 207.92 416 255.68 416a238.22 238.22 0 0 0 72.64-11.55 4 4 0 0 0 1.61-6.64l-47.47-47.46a4 4 0 0 0-3.81-1.05A96 96 0 0 1 256 352z"},child:[]}]})(n)}function n4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"256",r:"64"},child:[]},{tag:"path",attr:{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96c-42.52 0-84.33 12.15-124.27 36.11-40.73 24.43-77.63 60.12-109.68 106.07a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416c46.71 0 93.81-14.43 136.2-41.72 38.46-24.77 72.72-59.66 99.08-100.92a32.2 32.2 0 0 0-.1-34.76zM256 352a96 96 0 1 1 96-96 96.11 96.11 0 0 1-96 96z"},child:[]}]})(n)}function gU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M472 168H40a24 24 0 0 1 0-48h432a24 24 0 0 1 0 48zm-80 112H120a24 24 0 0 1 0-48h272a24 24 0 0 1 0 48zm-96 112h-80a24 24 0 0 1 0-48h80a24 24 0 0 1 0 48z"},child:[]}]})(n)}function i4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M340.75 344.49c5.91-20.7 9.82-44.75 11.31-67.84a4.41 4.41 0 0 0-4.46-4.65h-71.06a4.43 4.43 0 0 0-4.47 4.39v55.3a4.44 4.44 0 0 0 4.14 4.38 273.51 273.51 0 0 1 59 11.39 4.45 4.45 0 0 0 5.54-2.97zm-17.17 32.82a260.05 260.05 0 0 0-46.6-9.09 4.42 4.42 0 0 0-4.91 4.29v65.24a4.47 4.47 0 0 0 6.76 3.7c15.9-9.27 29-24.84 40.84-45.43 1.94-3.36 4.89-9.15 6.67-12.69a4.29 4.29 0 0 0-2.76-6.02zm-88.29-8.91a256.85 256.85 0 0 0-46.56 8.82c-2.64.76-3.75 4.4-2.55 6.79 1.79 3.56 4 8.11 5.89 11.51 13 23 26.84 37.5 41.24 45.93a4.47 4.47 0 0 0 6.76-3.7v-65.27a4.16 4.16 0 0 0-4.78-4.08zm.31-96.4h-71.06a4.41 4.41 0 0 0-4.46 4.64c1.48 23.06 5.37 47.16 11.26 67.84a4.46 4.46 0 0 0 5.59 3 272.2 272.2 0 0 1 59-11.36 4.44 4.44 0 0 0 4.15-4.38V276.4a4.43 4.43 0 0 0-4.48-4.4zM277 143.78a235.8 235.8 0 0 0 46.5-9.14 4.3 4.3 0 0 0 2.76-6c-1.79-3.57-4.27-8.68-6.17-12.09-12.29-22-26.14-37.35-41.24-46a4.48 4.48 0 0 0-6.76 3.7v65.23a4.43 4.43 0 0 0 4.91 4.3zm-.46 96.22h71.06a4.39 4.39 0 0 0 4.46-4.58c-1.48-22.77-5.27-47.8-11.16-68.22a4.46 4.46 0 0 0-5.59-2.95c-19 5.74-38.79 10.43-59.09 12a4.4 4.4 0 0 0-4.15 4.32v55.11a4.4 4.4 0 0 0 4.47 4.32zM233.31 70.56c-15.42 8.57-29.17 24.43-41.47 46.37-1.91 3.41-4.19 8.11-6 11.67a4.31 4.31 0 0 0 2.76 6 225.42 225.42 0 0 0 46.54 9.17 4.43 4.43 0 0 0 4.91-4.29V74.26a4.49 4.49 0 0 0-6.74-3.7zm2.61 105.7c-20.3-1.55-40.11-6.24-59.09-12a4.46 4.46 0 0 0-5.59 2.95c-5.89 20.42-9.68 45.45-11.16 68.22a4.39 4.39 0 0 0 4.46 4.58h71.06a4.4 4.4 0 0 0 4.47-4.34v-55.09a4.4 4.4 0 0 0-4.15-4.32z"},child:[]},{tag:"path",attr:{d:"M414.39 97.61A224 224 0 1 0 97.61 414.39 224 224 0 1 0 414.39 97.61zM176.6 430.85a219.08 219.08 0 0 1-12.48-19.66c-2-3.69-4.84-9.26-6.73-13.13a7.29 7.29 0 0 0-10.31-3.16c-4.3 2.41-10 5.72-14.13 8.43a147.29 147.29 0 0 1-23.57-22.43 248.83 248.83 0 0 1 30.41-18.36c1.86-1 2.77-2.14 2.18-4.18a374.8 374.8 0 0 1-14.09-82.17 4.36 4.36 0 0 0-4.3-4.17H66.84a2 2 0 0 1-2-1.7A98.28 98.28 0 0 1 64 256a96.27 96.27 0 0 1 .86-14.29 2 2 0 0 1 2-1.7h56.74c2.29 0 4.17-1.32 4.29-3.63a372.71 372.71 0 0 1 14-81.83 4.36 4.36 0 0 0-2.19-5.11 260.63 260.63 0 0 1-29.84-17.9 169.82 169.82 0 0 1 23.14-22.8c4.08 2.68 9.4 5.71 13.66 8.11a7.89 7.89 0 0 0 11-3.42c1.88-3.87 4-8.18 6.06-11.88a221.93 221.93 0 0 1 12.54-19.91A185 185 0 0 1 256 64c28.94 0 55.9 7 80.53 18.46a202.23 202.23 0 0 1 12 19c2.59 4.66 5.34 10.37 7.66 15.32a4.29 4.29 0 0 0 5.92 1.94c5.38-2.91 11.21-6.26 16.34-9.63a171.36 171.36 0 0 1 23.2 23 244.89 244.89 0 0 1-29.06 17.31 4.35 4.35 0 0 0-2.18 5.12 348.68 348.68 0 0 1 13.85 81.4 4.33 4.33 0 0 0 4.3 4.12l56.62-.07a2 2 0 0 1 2 1.7 117.46 117.46 0 0 1 0 28.62 2 2 0 0 1-2 1.72h-56.67a4.35 4.35 0 0 0-4.3 4.17 367.4 367.4 0 0 1-13.87 81.3 4.45 4.45 0 0 0 2.19 5.19c5 2.59 10.57 5.48 15.37 8.42s9.55 6.08 14.13 9.34a172.73 172.73 0 0 1-23 22.93c-2.44-1.61-5.34-3.44-7.84-4.94-1.72-1-4.89-2.77-6.65-3.76-3.82-2.14-7.88-.54-9.79 3.4s-4.83 9.59-6.87 13.25a212.42 212.42 0 0 1-12.35 19.53C310.91 442.37 284.94 448 256 448s-54.77-5.63-79.4-17.15z"},child:[]}]})(n)}function _U(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 448a32 32 0 0 1-18-5.57c-78.59-53.35-112.62-89.93-131.39-112.8-40-48.75-59.15-98.8-58.61-153C48.63 114.52 98.46 64 159.08 64c44.08 0 74.61 24.83 92.39 45.51a6 6 0 0 0 9.06 0C278.31 88.81 308.84 64 352.92 64c60.62 0 110.45 50.52 111.08 112.64.54 54.21-18.63 104.26-58.61 153-18.77 22.87-52.8 59.45-131.39 112.8a32 32 0 0 1-18 5.56z"},child:[]}]})(n)}function vU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m478.33 433.6-90-218a22 22 0 0 0-40.67 0l-90 218a22 22 0 1 0 40.67 16.79L316.66 406h102.67l18.33 44.39A22 22 0 0 0 458 464a22 22 0 0 0 20.32-30.4zM334.83 362 368 281.65 401.17 362zm-66.99-19.08a22 22 0 0 0-4.89-30.7c-.2-.15-15-11.13-36.49-34.73 39.65-53.68 62.11-114.75 71.27-143.49H330a22 22 0 0 0 0-44H214V70a22 22 0 0 0-44 0v20H54a22 22 0 0 0 0 44h197.25c-9.52 26.95-27.05 69.5-53.79 108.36-31.41-41.68-43.08-68.65-43.17-68.87a22 22 0 0 0-40.58 17c.58 1.38 14.55 34.23 52.86 83.93.92 1.19 1.83 2.35 2.74 3.51-39.24 44.35-77.74 71.86-93.85 80.74a22 22 0 1 0 21.07 38.63c2.16-1.18 48.6-26.89 101.63-85.59 22.52 24.08 38 35.44 38.93 36.1a22 22 0 0 0 30.75-4.9z"},child:[]}]})(n)}function s4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M368 192h-16v-80a96 96 0 1 0-192 0v80h-16a64.07 64.07 0 0 0-64 64v176a64.07 64.07 0 0 0 64 64h224a64.07 64.07 0 0 0 64-64V256a64.07 64.07 0 0 0-64-64zm-48 0H192v-80a64 64 0 1 1 128 0z"},child:[]}]})(n)}function yU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m93.19 329.38 47.45-304.07c1.64-10.37 15.55-12.82 20.46-3.55l51 95.45zM432 400l-46.74-276.79a11 11 0 0 0-18.54-6L80 400l159.36 91.91a33.18 33.18 0 0 0 31.91 0zM302.36 158.93l-36.54-69.54a10.86 10.86 0 0 0-19.36 0L85.83 375.74z"},child:[]}]})(n)}function r4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M424 80H88a56.06 56.06 0 0 0-56 56v240a56.06 56.06 0 0 0 56 56h336a56.06 56.06 0 0 0 56-56V136a56.06 56.06 0 0 0-56-56zm-14.18 92.63-144 112a16 16 0 0 1-19.64 0l-144-112a16 16 0 1 1 19.64-25.26L256 251.73l134.18-104.36a16 16 0 0 1 19.64 25.26z"},child:[]}]})(n)}function wU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M426 16h-74a22 22 0 0 0 0 44h20.89l-37.1 37.09A157.68 157.68 0 0 0 216 42c-87.12 0-158 70.88-158 158 0 79.66 59.26 145.72 136 156.46V394h-28a22 22 0 0 0 0 44h28v36a22 22 0 0 0 44 0v-36h28a22 22 0 0 0 0-44h-28v-37.54c76.74-10.74 136-76.8 136-156.46a157.15 157.15 0 0 0-14-64.92l44-44V112a22 22 0 0 0 44 0V38a22 22 0 0 0-22-22zM216 314a114 114 0 1 1 114-114 114.13 114.13 0 0 1-114 114z"},child:[]}]})(n)}function a4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M432 400 96 64"},child:[]},{tag:"path",attr:{d:"M400 240v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 368 208v32a111.68 111.68 0 0 1-2.68 24.38 2 2 0 0 0 .53 1.84l22.59 22.59a2 2 0 0 0 3.29-.72A143.27 143.27 0 0 0 400 240zM256 352a112.36 112.36 0 0 1-112-112v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 112 208v32c0 74 56.1 135.12 128 143.11V432h-47.55c-8.61 0-16 6.62-16.43 15.23A16 16 0 0 0 192 464h127.55c8.61 0 16-6.62 16.43-15.23A16 16 0 0 0 320 432h-48v-48.89a143.08 143.08 0 0 0 52-16.22 4 4 0 0 0 .91-6.35l-18.4-18.39a3 3 0 0 0-3.41-.58A111 111 0 0 1 256 352zm1.14-304a79.66 79.66 0 0 0-68.47 36.57 4 4 0 0 0 .54 5L332.59 233a2 2 0 0 0 3.41-1.42V128.91C336 85 301 48.6 257.14 48z"},child:[]},{tag:"path",attr:{d:"M179.41 215a2 2 0 0 0-3.41 1.42V239a80.89 80.89 0 0 0 23.45 56.9 78.55 78.55 0 0 0 77.8 21.19 2 2 0 0 0 .86-3.35z"},child:[]}]})(n)}function o4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M192 448h128m64-240v32c0 70.4-57.6 128-128 128h0c-70.4 0-128-57.6-128-128v-32m128 160v80"},child:[]},{tag:"path",attr:{d:"M256 320a78.83 78.83 0 0 1-56.55-24.1A80.89 80.89 0 0 1 176 239V128a79.69 79.69 0 0 1 80-80c44.86 0 80 35.14 80 80v111c0 44.66-35.89 81-80 81z"},child:[]}]})(n)}function dh(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.64 64.58C313.18 43.57 286 32 256 32c-30.16 0-57.43 11.5-76.8 32.38-19.58 21.11-29.12 49.8-26.88 80.78C156.76 206.28 203.27 256 256 256s99.16-49.71 103.67-110.82c2.27-30.7-7.33-59.33-27.03-80.6zM432 480H80a31 31 0 0 1-24.2-11.13c-6.5-7.77-9.12-18.38-7.18-29.11C57.06 392.94 83.4 353.61 124.8 326c36.78-24.51 83.37-38 131.2-38s94.42 13.5 131.2 38c41.4 27.6 67.74 66.93 76.18 113.75 1.94 10.73-.68 21.34-7.18 29.11A31 31 0 0 1 432 480z"},child:[]}]})(n)}function bU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"m400 148-21.12-24.57A191.43 191.43 0 0 0 240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 0 0 181.07-128"},child:[]},{tag:"path",attr:{d:"M464 97.42V208a16 16 0 0 1-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"},child:[]}]})(n)}function RT(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M456.69 421.39 362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8 124.95 124.95 0 0 1-124.8-124.8z"},child:[]}]})(n)}function EU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M479.07 111.36a16 16 0 0 0-13.15-14.74c-86.5-15.52-122.61-26.74-203.33-63.2a16 16 0 0 0-13.18 0C168.69 69.88 132.58 81.1 46.08 96.62a16 16 0 0 0-13.15 14.74c-3.85 61.11 4.36 118.05 24.43 169.24A349.47 349.47 0 0 0 129 393.11c53.47 56.73 110.24 81.37 121.07 85.73a16 16 0 0 0 12 0c10.83-4.36 67.6-29 121.07-85.73a349.47 349.47 0 0 0 71.5-112.51c20.07-51.19 28.28-108.13 24.43-169.24zm-131 75.11-110.8 128a16 16 0 0 1-11.41 5.53h-.66a16 16 0 0 1-11.2-4.57l-49.2-48.2a16 16 0 1 1 22.4-22.86l37 36.29 99.7-115.13a16 16 0 0 1 24.2 20.94z"},child:[]}]})(n)}function l4(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M208 512a24.84 24.84 0 0 1-23.34-16l-39.84-103.6a16.06 16.06 0 0 0-9.19-9.19L32 343.34a25 25 0 0 1 0-46.68l103.6-39.84a16.06 16.06 0 0 0 9.19-9.19L184.66 144a25 25 0 0 1 46.68 0l39.84 103.6a16.06 16.06 0 0 0 9.19 9.19l103 39.63a25.49 25.49 0 0 1 16.63 24.1 24.82 24.82 0 0 1-16 22.82l-103.6 39.84a16.06 16.06 0 0 0-9.19 9.19L231.34 496A24.84 24.84 0 0 1 208 512zm66.85-254.84zM88 176a14.67 14.67 0 0 1-13.69-9.4l-16.86-43.84a7.28 7.28 0 0 0-4.21-4.21L9.4 101.69a14.67 14.67 0 0 1 0-27.38l43.84-16.86a7.31 7.31 0 0 0 4.21-4.21L74.16 9.79A15 15 0 0 1 86.23.11a14.67 14.67 0 0 1 15.46 9.29l16.86 43.84a7.31 7.31 0 0 0 4.21 4.21l43.84 16.86a14.67 14.67 0 0 1 0 27.38l-43.84 16.86a7.28 7.28 0 0 0-4.21 4.21l-16.86 43.84A14.67 14.67 0 0 1 88 176zm312 80a16 16 0 0 1-14.93-10.26l-22.84-59.37a8 8 0 0 0-4.6-4.6l-59.37-22.84a16 16 0 0 1 0-29.86l59.37-22.84a8 8 0 0 0 4.6-4.6l22.67-58.95a16.45 16.45 0 0 1 13.17-10.57 16 16 0 0 1 16.86 10.15l22.84 59.37a8 8 0 0 0 4.6 4.6l59.37 22.84a16 16 0 0 1 0 29.86l-59.37 22.84a8 8 0 0 0-4.6 4.6l-22.84 59.37A16 16 0 0 1 400 256z"},child:[]}]})(n)}function hm(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M336 179.52A67.52 67.52 0 0 0 268.48 112h-79.2a4 4 0 0 0-2.82 6.83l142.71 142.71a4 4 0 0 0 6.83-2.82zM16 180v152a68 68 0 0 0 68 68h184a67.66 67.66 0 0 0 42.84-15.24 4 4 0 0 0 .33-6L54.41 122a4 4 0 0 0-4.87-.62A68 68 0 0 0 16 180zm448 204.39a32 32 0 0 1-13-2.77 15.77 15.77 0 0 1-2.71-1.54l-82.71-58.22A32 32 0 0 1 352 295.7v-79.4a32 32 0 0 1 13.58-26.16l82.71-58.22a15.77 15.77 0 0 1 2.71-1.54 32 32 0 0 1 45 29.24v192.76a32 32 0 0 1-32 32z"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M416 416 80 80"},child:[]}]})(n)}function fh(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 384.39a32 32 0 0 1-13-2.77 15.77 15.77 0 0 1-2.71-1.54l-82.71-58.22A32 32 0 0 1 352 295.7v-79.4a32 32 0 0 1 13.58-26.16l82.71-58.22a15.77 15.77 0 0 1 2.71-1.54 32 32 0 0 1 45 29.24v192.76a32 32 0 0 1-32 32zM268 400H84a68.07 68.07 0 0 1-68-68V180a68.07 68.07 0 0 1 68-68h184.48A67.6 67.6 0 0 1 336 179.52V332a68.07 68.07 0 0 1-68 68z"},child:[]}]})(n)}function TU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M449.07 399.08 278.64 82.58c-12.08-22.44-44.26-22.44-56.35 0L51.87 399.08A32 32 0 0 0 80 446.25h340.89a32 32 0 0 0 28.18-47.17zm-198.6-1.83a20 20 0 1 1 20-20 20 20 0 0 1-20 20zm21.72-201.15-5.74 122a16 16 0 0 1-32 0l-5.74-121.95a21.73 21.73 0 0 1 21.5-22.69h.21a21.74 21.74 0 0 1 21.73 22.7z"},child:[]}]})(n)}function SU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M346.65 304.3a136 136 0 0 0-180.71 0 21 21 0 1 0 27.91 31.38 94 94 0 0 1 124.89 0 21 21 0 0 0 27.91-31.4z"},child:[]},{tag:"path",attr:{d:"M256.28 183.7a221.47 221.47 0 0 0-151.8 59.92 21 21 0 1 0 28.68 30.67 180.28 180.28 0 0 1 246.24 0 21 21 0 1 0 28.68-30.67 221.47 221.47 0 0 0-151.8-59.92z"},child:[]},{tag:"path",attr:{d:"M462 175.86a309 309 0 0 0-411.44 0 21 21 0 1 0 28 31.29 267 267 0 0 1 355.43 0 21 21 0 0 0 28-31.31z"},child:[]},{tag:"circle",attr:{cx:"256.28",cy:"393.41",r:"32"},child:[]}]})(n)}function xU(){const n=cs(),[e,t]=P.useState(""),[i,r]=P.useState(""),[o,c]=P.useState(""),[h,f]=P.useState(""),[m,v]=P.useState(""),[w,T]=P.useState(""),[x,N]=P.useState(""),[L,O]=P.useState(null),[Z,Y]=P.useState(""),[H,le]=P.useState(!1),[ve,oe]=P.useState(!1),[I,A]=P.useState(1),R=[{label:"Male",value:"male",icon:""},{label:"Female",value:"female",icon:""},{label:"Other",value:"other",icon:""}],U=[{label:"Single",value:"single",icon:""},{label:"Married",value:"married",icon:""},{label:"Divorced",value:"divorced",icon:""},{label:"In a Relationship",value:"relationship",icon:""}],V=["India","United States","Canada","United Kingdom","Australia","Germany","France","Japan","Brazil","South Africa"],F=async B=>{const ee=B.target.files[0];if(ee){if(!ee.type.startsWith("image/")){alert("Please select an image file");return}if(ee.size>5*1024*1024){alert("Image size should be less than 5MB");return}O(URL.createObjectURL(ee));try{const he=`${Date.now()}_${ee.name}`,{error:ye}=await Te.storage.from("signUp_Images").upload(he,ee,{upsert:!0});if(ye)throw ye;const{data:ke}=Te.storage.from("signUp_Images").getPublicUrl(he);Y(ke.publicUrl)}catch(he){console.error(he),alert("Image upload failed")}}},k=B=>{const ee=new Date,he=new Date(B);let ye=ee.getFullYear()-he.getFullYear();const ke=ee.getMonth()-he.getMonth();return(ke<0||ke===0&&ee.getDate()<he.getDate())&&ye--,ye},ge=()=>i&&e&&o&&L,Se=()=>h&&m&&w&&x,j=()=>{I===1&&ge()&&A(2)},G=()=>{A(1)},ie=async()=>{if(!ge()||!Se()){alert("Please fill all required fields");return}if(k(h)<18){alert("You must be at least 18 years old to register.");return}if(o.length<6){alert("Password must be at least 6 characters long");return}oe(!0);try{const B=await K6(Ye,e,o);await Q6(B.user,{displayName:i,photoURL:Z});const{error:ee}=await Te.from("users").upsert([{id:B.user.uid,email:B.user.email,password:o,avatar:Z,name:i,country:x,gender:m,maritalstatus:w,dateofbirth:h,age:k(h),about:"Hey there! I'm new here! ",isverifiedprofile:!0,isactivestatus:!0,totalgold:100,totaldiamond:10,created_at:new Date().toISOString()}]);if(ee)throw ee;alert(" Welcome aboard! Your account has been created successfully!"),n("/login")}catch(B){console.error("Signup error:",B),B.code==="auth/email-already-in-use"?alert("This email is already registered. Please try logging in."):B.code==="auth/weak-password"?alert("Password is too weak. Please choose a stronger password."):B.code==="auth/invalid-email"?alert("Please enter a valid email address."):alert("Signup failed: "+B.message)}finally{oe(!1)}},me=()=>_.jsxs("div",{className:"mb-8",children:[_.jsx("div",{className:"w-full h-2 bg-white/20 rounded-full overflow-hidden mb-3",children:_.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-500",style:{width:I===1?"50%":"100%"}})}),_.jsx("div",{className:"flex justify-between px-4",children:[1,2].map(B=>_.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${I>=B?"bg-white text-orange-500 shadow-lg":"bg-white/20 text-white/70"}`,children:B},B))})]}),be=()=>_.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white mb-2",children:"Create Your Profile"}),_.jsx("p",{className:"text-white/80 text-sm sm:text-base",children:"Let's start with the basics"})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("label",{htmlFor:"profile-upload",className:"cursor-pointer inline-block",children:_.jsxs("div",{className:"relative w-24 h-24 sm:w-32 sm:h-32 mx-auto mb-3 group",children:[L?_.jsx("img",{src:L,alt:"profile",className:"w-full h-full rounded-full object-cover border-4 border-white/30 transition-all duration-300 group-hover:border-white/50"}):_.jsxs("div",{className:"w-full h-full rounded-full bg-white/20 border-3 border-dashed border-white/40 flex flex-col items-center justify-center text-white/80 transition-all duration-300 group-hover:bg-white/30 group-hover:border-white/60",children:[_.jsx(AT,{className:"text-2xl sm:text-3xl mb-1"}),_.jsx("span",{className:"text-xs",children:"Add Photo"})]}),_.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:_.jsx(AT,{className:"text-white text-xl"})})]})}),_.jsx("input",{id:"profile-upload",type:"file",accept:"image/*",onChange:F,className:"hidden"}),_.jsx("p",{className:"text-white/70 text-sm",children:"Click to upload your profile picture"})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"relative",children:[_.jsx(dh,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white/70 text-lg"}),_.jsx("input",{type:"text",placeholder:"Full Name",value:i,onChange:B=>r(B.target.value),className:"w-full bg-white/15 border-2 border-transparent rounded-2xl pl-12 pr-4 py-4 text-white placeholder-white/60 focus:outline-none focus:border-white/50 focus:bg-white/20 transition-all duration-300 backdrop-blur-sm"})]}),_.jsxs("div",{className:"relative",children:[_.jsx(r4,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white/70 text-lg"}),_.jsx("input",{type:"email",placeholder:"Email Address",value:e,onChange:B=>t(B.target.value),className:"w-full bg-white/15 border-2 border-transparent rounded-2xl pl-12 pr-4 py-4 text-white placeholder-white/60 focus:outline-none focus:border-white/50 focus:bg-white/20 transition-all duration-300 backdrop-blur-sm"})]}),_.jsxs("div",{className:"relative",children:[_.jsx(s4,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white/70 text-lg"}),_.jsx("input",{type:H?"text":"password",placeholder:"Password",value:o,onChange:B=>c(B.target.value),className:"w-full bg-white/15 border-2 border-transparent rounded-2xl pl-12 pr-12 py-4 text-white placeholder-white/60 focus:outline-none focus:border-white/50 focus:bg-white/20 transition-all duration-300 backdrop-blur-sm"}),_.jsx("button",{type:"button",className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-white/70 hover:text-white transition-colors duration-300 p-1 rounded-lg hover:bg-white/10",onClick:()=>le(!H),children:H?_.jsx(t4,{className:"text-lg"}):_.jsx(n4,{className:"text-lg"})})]})]}),_.jsxs("button",{className:"w-full bg-white/90 hover:bg-white text-gray-800 rounded-2xl py-4 font-bold text-lg flex items-center justify-center gap-2 transition-all duration-300 hover:shadow-2xl hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",onClick:j,disabled:!ge(),children:["Continue",_.jsx(C_,{className:"transform rotate-180 text-lg"})]})]}),D=()=>_.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white mb-2",children:"Personal Details"}),_.jsx("p",{className:"text-white/80 text-sm sm:text-base",children:"Tell us more about yourself"})]}),_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{className:"relative",children:[_.jsx(fU,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white/70 text-lg"}),_.jsx("input",{type:"date",value:h,onChange:B=>f(B.target.value),className:"w-full bg-white/15 border-2 border-transparent rounded-2xl pl-12 pr-24 py-4 text-white placeholder-white/60 focus:outline-none focus:border-white/50 focus:bg-white/20 transition-all duration-300 backdrop-blur-sm",max:new Date().toISOString().split("T")[0]}),h&&_.jsxs("span",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/20 text-white px-3 py-1 rounded-full text-sm font-bold",children:[k(h)," years"]})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"flex items-center gap-2 text-white font-semibold mb-3",children:[_.jsx(wU,{className:"text-lg"}),"Gender"]}),_.jsx("div",{className:"grid grid-cols-3 gap-2",children:R.map(B=>_.jsxs("button",{className:`flex flex-col items-center gap-2 p-3 rounded-xl transition-all duration-300 ${m===B.value?"bg-white text-orange-500 shadow-lg scale-105":"bg-white/10 text-white hover:bg-white/15 hover:scale-105"}`,onClick:()=>v(B.value),type:"button",children:[_.jsx("span",{className:"text-xl",children:B.icon}),_.jsx("span",{className:"text-xs font-semibold",children:B.label})]},B.value))})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"flex items-center gap-2 text-white font-semibold mb-3",children:[_.jsx(_U,{className:"text-lg"}),"Relationship Status"]}),_.jsx("div",{className:"grid grid-cols-2 gap-2",children:U.map(B=>_.jsxs("button",{className:`flex flex-col items-center gap-2 p-3 rounded-xl transition-all duration-300 ${w===B.value?"bg-white text-orange-500 shadow-lg scale-105":"bg-white/10 text-white hover:bg-white/15 hover:scale-105"}`,onClick:()=>T(B.value),type:"button",children:[_.jsx("span",{className:"text-xl",children:B.icon}),_.jsx("span",{className:"text-xs font-semibold text-center leading-tight",children:B.label})]},B.value))})]}),_.jsxs("div",{className:"relative",children:[_.jsx(i4,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white/70 text-lg"}),_.jsxs("select",{value:x,onChange:B=>N(B.target.value),className:"w-full bg-white/15 border-2 border-transparent rounded-2xl pl-12 pr-4 py-4 text-white focus:outline-none focus:border-white/50 focus:bg-white/20 transition-all duration-300 backdrop-blur-sm appearance-none",children:[_.jsx("option",{value:"",className:"text-gray-800",children:"Select Country"}),V.map(B=>_.jsx("option",{value:B,className:"text-gray-800",children:B},B))]})]})]}),_.jsxs("div",{className:"flex gap-3",children:[_.jsxs("button",{className:"flex-1 bg-white/10 hover:bg-white/20 border-2 border-white/30 text-white rounded-2xl py-4 font-semibold flex items-center justify-center gap-2 transition-all duration-300 hover:scale-105 active:scale-95",onClick:G,type:"button",children:[_.jsx(C_,{className:"text-lg"}),"Back"]}),_.jsx("button",{className:"flex-2 bg-white/90 hover:bg-white text-gray-800 rounded-2xl py-4 font-bold text-lg flex items-center justify-center gap-2 transition-all duration-300 hover:shadow-2xl hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",onClick:ie,disabled:!Se()||ve,children:ve?_.jsx("div",{className:"w-6 h-6 border-2 border-transparent border-t-orange-500 rounded-full animate-spin"}):_.jsxs(_.Fragment,{children:["Complete Sign Up",_.jsx(l4,{className:"text-lg"})]})})]})]});return _.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 sm:p-6 lg:p-8 relative overflow-hidden",style:{background:"linear-gradient(135deg, #FF512F 0%, #DD2476 50%, #FF512F 100%)"},children:[_.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[_.jsx("div",{className:"absolute -top-20 -left-20 w-40 h-40 bg-white/10 rounded-full animate-pulse"}),_.jsx("div",{className:"absolute top-1/4 -right-16 w-32 h-32 bg-white/10 rounded-full animate-bounce",style:{animationDelay:"2s"}}),_.jsx("div",{className:"absolute -bottom-16 left-1/4 w-36 h-36 bg-white/10 rounded-full animate-pulse",style:{animationDelay:"1s"}})]}),_.jsx("div",{className:"w-full max-w-md relative z-10",children:_.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-6 sm:p-8 transition-all duration-700",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("button",{className:"absolute left-6 top-6 bg-white/20 hover:bg-white/30 text-white w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110",onClick:()=>n("/login"),children:_.jsx(C_,{className:"text-lg"})}),_.jsxs("div",{className:"px-12",children:[_.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Join Our Community"}),_.jsx("p",{className:"text-white/80 text-sm",children:"Start your journey with amazing people"})]})]}),_.jsx(me,{}),_.jsx("div",{className:"mb-6",children:I===1?_.jsx(be,{}):_.jsx(D,{})}),_.jsxs("div",{className:"text-center border-t border-white/20 pt-6",children:[_.jsxs("p",{className:"text-white/80 text-sm mb-2",children:["Already have an account?",_.jsx(z_,{to:"/login",className:"text-white font-semibold hover:underline ml-1",children:"Sign In"})]}),_.jsx("p",{className:"text-white/60 text-xs",children:"By signing up, you agree to our Terms & Conditions"})]})]})})]})}function CU(){const[n,e]=P.useState([]),[t,i]=P.useState(!0),[r,o]=P.useState([]),[c,h]=P.useState({}),[f,m]=P.useState(""),[v,w]=P.useState("all"),T=cs(),N=vr().pathname==="/chats",[L,O]=P.useState(!1),Z={en:{messages:"Messages",noConversations:"No Conversations",startChatting:"Start chatting by messaging your friends",deleteChat:"Delete Chat",deleteSelectedChats:"Delete Selected Chats",deleteConfirmation:"Messages will be removed from this device.",cancel:"Cancel",search:"Search conversations...",all:"All",unread:"Unread",groups:"Groups"}},Y=P.useCallback(j=>{const G=Ye?.currentUser;if(j.groupName)return j.groupName;const ie=j.users?.find(me=>me.email!==G?.email);return ie?.name||ie?.email||"Unknown"},[]),H=P.useCallback(j=>{const G=j.last_message;return G?G.text?G.text.length>25?`${G.text.substring(0,25)}...`:G.text:G.image?" Image":G.audio?" Audio":"Sent a message":"No messages yet"},[]),le=P.useCallback(j=>{const G=j.last_updated;if(!G)return"";const ie=new Date,me=new Date(G),be=Math.abs(ie-me),D=Math.floor(be/(1e3*60*60*24));return D===0?me.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):D===1?"Yesterday":D<7?me.toLocaleDateString([],{weekday:"short"}):me.toLocaleDateString([],{month:"short",day:"numeric"})},[]),ve=n.filter(j=>{const G=Y(j).toLowerCase().includes(f.toLowerCase())||H(j).toLowerCase().includes(f.toLowerCase()),ie=v==="all"?!0:v==="unread"?c[j.id]>0:v==="groups"?j.groupName!==null:!0;return G&&ie}),oe=P.useCallback(async()=>{i(!0);try{const j=localStorage.getItem("newMessages"),G=j?JSON.parse(j):{};h(G);const{data:ie,error:me}=await Te.from("chats").select("*").contains("participants",[Ye?.currentUser?.email]).order("last_updated",{ascending:!1});if(me){console.log(" Error fetching chats:",me.message),i(!1);return}const be=await Promise.all(ie.map(async D=>{const B=await Promise.all(D.users.map(async ee=>{try{const{data:he}=await Te.from("users").select("avatar, about, isactivestatus").eq("email",ee.email).single();return{...ee,avatar:he?.avatar??null,about:he?.about??null,isactivestatus:he?.isactivestatus??null}}catch{return{...ee,avatar:null}}}));return{...D,users:B}}));e(be||[])}catch(j){console.log(" Error loading chats:",j)}finally{i(!1)}},[]),I=P.useCallback(async()=>{O(!0),await oe(),setTimeout(()=>O(!1),1e3)},[oe]);P.useEffect(()=>{N&&oe()},[N,oe]);const A=j=>{const G=j.id;if(r.length){U(j);return}const ie={...c};delete ie[G],localStorage.setItem("newMessages",JSON.stringify(ie)),localStorage.setItem(`lastSeen_${G}`,Date.now().toString()),h(ie);const me=j.users?.find(be=>be.email!==Ye.currentUser?.email);T("/chat",{state:{id:G,chatName:Y(j),email:me?.email||"",avatar:me?.avatar||"",name:me?.name||"",about:me?.about||"",isactivestatus:me?.isactivestatus||""}})},R=j=>U(j),U=j=>o(G=>G.includes(j.id)?G.filter(ie=>ie!==j.id):[...G,j.id]),V=P.useCallback(()=>o([]),[]),F=P.useCallback(()=>{!r.length||!window.confirm(r.length>1?"Delete selected chats? Messages will be removed from this device.":"Delete this chat? Messages will be removed from this device.")||k()},[r]),k=async()=>{try{const j=Ye?.currentUser?.email,G=r.map(async ie=>{await Te.from("deletedchats").upsert({user_email:j,chat_id:ie},{onConflict:"user_email,chat_id"});const{data:me}=await Te.from("chats").select("participants").eq("id",ie).single(),{data:be}=await Te.from("deletedchats").select("user_email").eq("chat_id",ie);me.participants.every(D=>be?.some(B=>B.user_email===D))&&await Te.from("chats").delete().eq("id",ie)});await Promise.all(G),V(),oe()}catch(j){console.log("Error deleting chat:",j.message)}},ge=({chat:j,isSelected:G})=>{const ie=j.users?.find(B=>B.email!==Ye.currentUser?.email),me=ie?.avatar,be=c[j.id]||0,D=j.groupName;return _.jsxs("div",{className:`modern-chat-card ${G?"modern-selected-chat-card":""}`,onClick:()=>A(j),onContextMenu:B=>{B.preventDefault(),R(j)},children:[_.jsxs("div",{className:"modern-avatar-container",children:[me?_.jsx("img",{src:me,alt:Y(j),className:"modern-avatar-image"}):_.jsx("div",{className:"modern-avatar-gradient",children:_.jsx("span",{className:"modern-avatar-text",children:Y(j).charAt(0).toUpperCase()})}),ie?.isactivestatus&&!D&&_.jsx("div",{className:"modern-online-indicator"}),D&&_.jsx("div",{className:"group-indicator",children:""})]}),_.jsxs("div",{className:"modern-chat-content",children:[_.jsxs("div",{className:"modern-chat-header",children:[_.jsx("span",{className:"modern-chat-name",children:Y(j)}),_.jsx("span",{className:"modern-time-text",children:le(j)})]}),_.jsxs("div",{className:"modern-chat-footer",children:[_.jsx("span",{className:"modern-last-message",children:H(j)}),be>0&&_.jsx("div",{className:"modern-badge",children:_.jsx("span",{className:"modern-badge-text",children:be>99?"99+":be})})]})]}),G&&_.jsx("div",{className:"modern-selection-overlay",children:_.jsx("div",{className:"modern-checkbox",children:""})})]})},Se=j=>{const G=[];return j.forEach((ie,me)=>{G.push({type:"chat",data:ie}),(me+1)%3===0&&G.push({type:"ad",id:`ad-${me}`})}),G};return _.jsxs("div",{className:"modern-chats-container",children:[_.jsxs("div",{className:"modern-background-gradient",children:[_.jsx("div",{className:"modern-floating-shape shape1"}),_.jsx("div",{className:"modern-floating-shape shape2"}),_.jsx("div",{className:"modern-floating-shape shape3"}),_.jsx("div",{className:"modern-floating-shape shape4"})]}),_.jsxs("div",{className:"modern-header",children:[_.jsxs("div",{className:"modern-header-content",children:[_.jsxs("div",{className:"modern-header-text",children:[_.jsx("h1",{className:"modern-app-name",children:"Hiddo"}),_.jsx("p",{className:"modern-app-subtitle",children:Z.en.messages})]}),_.jsx("div",{className:"modern-header-actions",children:_.jsxs("button",{className:`modern-refresh-button ${L?"refreshing":""}`,onClick:I,children:[_.jsx("span",{className:"refresh-icon",children:""}),"Refresh"]})})]}),_.jsx("div",{className:"modern-search-container",children:_.jsxs("div",{className:"modern-search-input",children:[_.jsx("span",{className:"search-icon",children:""}),_.jsx("input",{type:"text",placeholder:Z.en.search,value:f,onChange:j=>m(j.target.value),className:"search-field"}),f&&_.jsx("button",{className:"clear-search",onClick:()=>m(""),children:""})]})}),_.jsx("div",{className:"modern-filter-tabs",children:["all","unread","groups"].map(j=>_.jsxs("button",{className:`modern-filter-tab ${v===j?"active":""}`,onClick:()=>w(j),children:[Z.en[j],j==="unread"&&Object.keys(c).length>0&&_.jsx("span",{className:"filter-badge",children:Object.keys(c).length})]},j))})]}),_.jsx("div",{className:"modern-content-container",onClick:V,children:t?_.jsx("div",{className:"modern-skeleton-container",children:[1,2,3,4,5].map(j=>_.jsxs("div",{className:"modern-skeleton-item",children:[_.jsx("div",{className:"modern-skeleton-avatar"}),_.jsxs("div",{className:"modern-skeleton-content",children:[_.jsx("div",{className:"modern-skeleton-line"}),_.jsx("div",{className:"modern-skeleton-line modern-skeleton-short"})]})]},j))}):ve.length===0?_.jsxs("div",{className:"modern-empty-container",children:[_.jsx("div",{className:"modern-empty-icon",children:_.jsx("div",{className:"empty-gradient",children:""})}),_.jsx("h3",{className:"modern-empty-title",children:f?"No matches found":Z.en.noConversations}),_.jsx("p",{className:"modern-empty-subtitle",children:f?"Try adjusting your search terms":Z.en.startChatting}),f&&_.jsx("button",{className:"modern-clear-search-button",onClick:()=>m(""),children:"Clear Search"})]}):_.jsx("div",{className:"modern-chats-list",children:Se(ve).map(j=>j.type==="chat"?_.jsx(ge,{chat:j.data,isSelected:r.includes(j.data.id)},j.data.id):j.type==="ad"?_.jsx("div",{className:"modern-ad-container",children:_.jsx("div",{className:"modern-ad-placeholder",children:_.jsx("div",{className:"ad-gradient",children:" Advertisement"})})},j.id):null)})}),_.jsx("div",{className:"modern-fab",onClick:()=>T("/users"),children:_.jsxs("div",{className:"modern-fab-gradient",children:[_.jsx("span",{className:"fab-icon",children:"+"}),_.jsx("div",{className:"fab-pulse"})]})}),r.length>0&&_.jsx("div",{className:"modern-selection-toolbar",children:_.jsxs("div",{className:"modern-toolbar-content",children:[_.jsxs("span",{className:"modern-item-count",children:[_.jsx("span",{className:"count-bubble",children:r.length}),r.length===1?" chat selected":" chats selected"]}),_.jsxs("div",{className:"modern-toolbar-actions",children:[_.jsx("button",{className:"modern-cancel-button",onClick:V,children:"Cancel"}),_.jsx("button",{className:"modern-delete-button",onClick:F,children:"Delete"})]})]})})]})}const AU={en:{discoverPeople:"Discover People",noUsersFound:"No users found",tryAdjustingFilters:"Try adjusting your filters or check back later for new users",discoverFilters:"Discover Filters",status:"Status",interestedIn:"Interested in",selectCountry:"Select Country",age:"Age",maritalStatus:"Marital Status",reset:"Reset",applyFilters:"Apply Filters",filtersApplied:"Filters Applied",filtersReset:"Filters Reset",foundUsers:"users matching your criteria",allFiltersReset:"All filters have been reset to default",startChatting:"Start Chatting",onlineNow:"Online Now",newUsers:"New Users"}},NT=[{code:"IN",name:"India"},{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"GB",name:"United Kingdom"},{code:"AU",name:"Australia"}],IU=["Male","Female","Other"],RU=["online","offline"],NU=["single","married","other","in a Relationship","divorced","widowed","separated","single Mom","single Dad"];function kT(){const[n,e]=P.useState([]),[t,i]=P.useState([]),[r,o]=P.useState([]),[c,h]=P.useState(!1),[f,m]=P.useState(null),[v,w]=P.useState(null),[T,x]=P.useState(null),[N,L]=P.useState("IN"),[O,Z]=P.useState(28),[Y,H]=P.useState(null),[le,ve]=P.useState(!1),[oe,I]=P.useState(!1),[A,R]=P.useState(null),[U,V]=P.useState(!0),[F,k]=P.useState(null),[ge,Se]=P.useState(""),j=cs(),G=te=>AU.en[te]||te;P.useEffect(()=>{const te=Ye.currentUser?.email;if(!te){V(!1);return}let we,Je;return(async()=>{try{V(!0),k(null);const{data:Qt,error:Lt}=await Te.from("users").select("id, email, name, age, avatar, isverifiedprofile, country, isactivestatus, about, gender, maritalstatus").neq("email",te).order("name",{ascending:!0});if(Lt)throw Lt;const An=(Qt||[]).map((Ze,gt)=>({...Ze,isNew:gt<3}));e(An),i(An);const{data:rn,error:ki}=await Te.from("chats").select("id, users, participants, group_name").contains("participants",[te]).eq("group_name","");if(ki)throw ki;o((rn||[]).map(Ze=>({chatId:Ze.id,userEmails:Ze.users}))),we=Te.channel("users-changes").on("postgres_changes",{event:"*",schema:"public",table:"users"},Ze=>{Ze.eventType==="INSERT"?(e(gt=>[...gt,Ze.new]),i(gt=>[...gt,Ze.new])):Ze.eventType==="UPDATE"?(e(gt=>gt.map(Ct=>Ct.id===Ze.new.id?Ze.new:Ct)),i(gt=>gt.map(Ct=>Ct.id===Ze.new.id?Ze.new:Ct))):Ze.eventType==="DELETE"&&(e(gt=>gt.filter(Ct=>Ct.id!==Ze.old.id)),i(gt=>gt.filter(Ct=>Ct.id!==Ze.old.id)))}).subscribe(),Je=Te.channel("chats-changes").on("postgres_changes",{event:"*",schema:"public",table:"chats"},Ze=>{Ze.eventType==="INSERT"&&Ze.new.participants.includes(te)?o(gt=>[...gt,{chatId:Ze.new.id,userEmails:Ze.new.users}]):Ze.eventType==="UPDATE"?o(gt=>gt.map(Ct=>Ct.chatId===Ze.new.id?{chatId:Ze.new.id,userEmails:Ze.new.users}:Ct)):Ze.eventType==="DELETE"&&o(gt=>gt.filter(Ct=>Ct.chatId!==Ze.old.id))}).subscribe()}catch(Qt){console.error("Error fetching chats/users:",Qt.message),k(Qt.message)}finally{V(!1)}})(),()=>{we&&Te.removeChannel(we),Je&&Te.removeChannel(Je)}},[]);const ie=P.useCallback(()=>{let te=[...t];f&&(te=te.filter(we=>we.gender?.toLowerCase()===f.toLowerCase())),O&&(te=te.filter(we=>we.age>=18&&we.age<=O)),T?.name&&(te=te.filter(we=>we.country?.toLowerCase()===T.name.toLowerCase())),Y&&(te=te.filter(we=>we.maritalstatus?.toLowerCase()===Y.toLowerCase())),v&&(v.toLowerCase()==="online"?te=te.filter(we=>we.isactivestatus===!0):v.toLowerCase()==="offline"&&(te=te.filter(we=>we.isactivestatus===!1))),ge&&(te=te.filter(we=>we.name?.toLowerCase().includes(ge.toLowerCase())||we.country?.toLowerCase().includes(ge.toLowerCase())||we.about?.toLowerCase().includes(ge.toLowerCase()))),e(te),h(!1),alert(`${G("filtersApplied")}: Found ${te.length} ${G("foundUsers")}`)},[t,f,O,T,Y,v,ge,G]),me=P.useCallback(()=>{m(null),Z(28),x(null),L("IN"),H(null),w(null),Se(""),e(t),alert(G("allFiltersReset"))},[t,G]),be=P.useCallback(async te=>{if(!Ye.currentUser?.email){alert("Please log in to start chatting");return}try{const we=te.email,Je=Ye.currentUser.email,{data:Gt,error:Qt}=await Te.from("chats").select("*").contains("participants",[Je,we]).maybeSingle();if(Qt){console.log("Error fetching chat:",Qt),alert("Error checking existing chat");return}let Lt;if(Gt)Lt=Gt.id;else{const{data:An,error:rn}=await Te.from("chats").insert([{participants:[Je,we],users:[{email:Je,name:Ye.currentUser.displayName||Je,deletedFromChat:!1},{email:we,name:te.name||we,deletedFromChat:!1}],last_updated:new Date().toISOString(),last_access:[{email:Je,date:new Date().toISOString()},{email:we,date:""}]}]).select().single();if(rn){console.log("Error creating chat:",rn),alert("Error creating new chat");return}Lt=An.id}j("/Chat",{state:{id:Lt,chatName:D(te),email:we,isactivestatus:te.isactivestatus,avatar:te.avatar,about:te.about,name:te.name,image:te.avatar,country:te.country,age:te.age,gender:te.gender,maritalstatus:te.maritalstatus}})}catch(we){console.error("Error in handleNavigate:",we),alert("Error starting chat")}},[j]),D=P.useCallback(te=>{const{name:we,email:Je}=te,Gt=Ye.currentUser?.email;return we&&we.trim()?Je===Gt?`${we}*(You)`:we:Je||"~ No Name or Email ~"},[]),B=n.filter(te=>te.isactivestatus).length,ee=n.filter(te=>te.isNew).length,he=rs.memo(({user:te,index:we})=>_.jsxs("div",{className:"bg-white rounded-3xl shadow-xl border border-orange-100 overflow-hidden cursor-pointer transition-all duration-500 hover:scale-105 hover:shadow-2xl hover:border-orange-300 animate-fade-in",style:{animationDelay:`${we*100}ms`},onClick:()=>be(te),children:[_.jsxs("div",{className:"relative h-72 overflow-hidden",children:[_.jsx("img",{src:te.avatar||"/default-avatar.png",alt:te.name,className:"w-full h-full object-cover transition-transform duration-300 hover:scale-110",onError:Je=>{Je.target.src="/default-avatar.png"}}),_.jsxs("div",{className:"absolute top-3 right-3 flex flex-col gap-2 z-10",children:[te.isNew&&_.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-pink-600 rounded-xl px-3 py-1 shadow-lg",children:_.jsx("span",{className:"text-white text-xs font-bold tracking-wider",children:"NEW"})}),te.isactivestatus&&_.jsx("div",{className:"bg-green-500 rounded-xl px-3 py-1 shadow-lg",children:_.jsx("span",{className:"text-white text-xs font-bold tracking-wider",children:"LIVE"})}),te.isverifiedprofile&&_.jsx("div",{className:"bg-white/90 rounded-full w-6 h-6 flex items-center justify-center shadow-lg",children:_.jsx(IT,{className:"text-orange-500 text-sm font-bold"})})]}),_.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent p-6 text-white",children:_.jsxs("div",{className:"space-y-2",children:[_.jsx("div",{children:_.jsxs("h3",{className:"text-xl font-bold",children:[te.name,", ",te.age]})}),_.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[_.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-lg backdrop-blur-sm ${te.isactivestatus?"bg-green-500/20 text-green-300":"bg-gray-500/20 text-gray-300"}`,children:te.isactivestatus?" Online":" Offline"}),_.jsx("span",{className:"text-sm opacity-90 font-medium",children:te.country})]}),te.about&&_.jsx("div",{className:"text-sm opacity-90 leading-relaxed",children:te.about.length>60?`${te.about.substring(0,60)}...`:te.about}),_.jsxs("div",{className:"flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-xl transition-all duration-300 hover:bg-white/30 hover:translate-x-1 w-fit",children:[_.jsx("span",{className:"text-sm font-semibold",children:G("startChatting")}),_.jsx("span",{className:"text-lg",children:""})]})]})})]}),_.jsx("div",{className:"p-4 border-t border-orange-100",children:_.jsxs("div",{className:"flex flex-wrap gap-2",children:[te.gender&&_.jsx("span",{className:"bg-gradient-to-r from-orange-100 to-pink-100 text-orange-600 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide",children:te.gender}),te.maritalstatus&&_.jsx("span",{className:"bg-gradient-to-r from-orange-100 to-pink-100 text-orange-600 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide",children:te.maritalstatus})]})})]})),ye=()=>_.jsxs("div",{className:"flex flex-col items-center justify-center py-32 text-center",children:[_.jsx("div",{className:"w-12 h-12 border-3 border-orange-200 border-t-orange-500 rounded-full animate-spin mb-4"}),_.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Discovering amazing people..."})]}),ke=()=>_.jsxs("div",{className:"flex flex-col items-center justify-center py-32 text-center",children:[_.jsx(TU,{className:"text-6xl text-orange-500 mb-4 opacity-70"}),_.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Connection Error"}),_.jsx("p",{className:"text-gray-600 mb-6 max-w-md",children:F}),_.jsx("button",{className:"bg-gradient-to-r from-orange-500 to-pink-600 text-white px-6 py-3 rounded-2xl font-semibold transition-all duration-300 hover:scale-105 hover:shadow-lg",onClick:()=>window.location.reload(),children:"Try Again"})]}),je=()=>_.jsxs("div",{className:"flex flex-col items-center justify-center py-32 text-center",children:[_.jsx("div",{className:"mb-6 animate-bounce",children:_.jsx("div",{className:"text-8xl bg-gradient-to-r from-orange-500 to-pink-600 bg-clip-text text-transparent",children:""})}),_.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:G("noUsersFound")}),_.jsx("p",{className:"text-gray-600 mb-6 max-w-md",children:G("tryAdjustingFilters")}),_.jsx("button",{className:"bg-gradient-to-r from-orange-500 to-pink-600 text-white px-6 py-3 rounded-2xl font-bold transition-all duration-300 hover:scale-105 hover:shadow-lg",onClick:me,children:"Reset All Filters"})]}),mt=()=>c?_.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end justify-center z-50",onClick:()=>h(!1),children:_.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-t-3xl max-h-[85vh] overflow-hidden",onClick:te=>te.stopPropagation(),children:[_.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-pink-600 text-white p-6",children:_.jsxs("div",{className:"flex justify-between items-start",children:[_.jsxs("div",{className:"flex-1",children:[_.jsx("h3",{className:"text-2xl font-bold mb-1",children:G("discoverFilters")}),_.jsx("p",{className:"text-white/90 text-sm",children:"Refine your search"})]}),_.jsx("button",{className:"bg-white/20 hover:bg-white/30 text-white w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 hover:rotate-90",onClick:()=>h(!1),children:_.jsx(hh,{className:"text-xl"})})]})}),_.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[_.jsxs("div",{className:"mb-7",children:[_.jsx("label",{className:"block text-gray-800 font-bold mb-4",children:"Search"}),_.jsxs("div",{className:"relative flex items-center bg-gray-100 rounded-2xl px-4 transition-all duration-300 focus-within:bg-gray-200",children:[_.jsx(RT,{className:"text-gray-500 text-lg mr-3"}),_.jsx("input",{type:"text",placeholder:"Search by name, location, or bio...",value:ge,onChange:te=>Se(te.target.value),className:"w-full bg-transparent py-4 text-gray-800 outline-none"})]})]}),_.jsxs("div",{className:"mb-7",children:[_.jsx("label",{className:"block text-gray-800 font-bold mb-4",children:G("status")}),_.jsx("div",{className:"flex flex-wrap gap-2",children:RU.map(te=>_.jsx("button",{className:`px-4 py-3 rounded-2xl font-semibold transition-all duration-300 hover:scale-105 ${v===te?"bg-gradient-to-r from-orange-500 to-pink-600 text-white shadow-lg":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,onClick:()=>w(v===te?null:te),children:te.charAt(0).toUpperCase()+te.slice(1)},te))})]}),_.jsxs("div",{className:"mb-7",children:[_.jsx("label",{className:"block text-gray-800 font-bold mb-4",children:G("interestedIn")}),_.jsx("div",{className:"flex flex-wrap gap-2",children:IU.map(te=>_.jsx("button",{className:`px-4 py-3 rounded-2xl font-semibold transition-all duration-300 hover:scale-105 ${f===te?"bg-gradient-to-r from-orange-500 to-pink-600 text-white shadow-lg":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,onClick:()=>m(f===te?null:te),children:te},te))})]}),_.jsxs("div",{className:"mb-7",children:[_.jsx("label",{className:"block text-gray-800 font-bold mb-4",children:G("selectCountry")}),_.jsxs("div",{className:"relative",children:[_.jsxs("select",{value:T?.code||"",onChange:te=>{const we=NT.find(Je=>Je.code===te.target.value);x(we),L(we?.code||"IN")},className:"w-full p-4 bg-gray-100 border-2 border-transparent rounded-2xl text-gray-800 font-medium transition-all duration-300 focus:border-orange-500 focus:bg-white appearance-none",children:[_.jsx("option",{value:"",className:"text-gray-500",children:"All Countries"}),NT.map(te=>_.jsx("option",{value:te.code,children:te.name},te.code))]}),_.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none",children:_.jsx(pU,{className:"text-gray-500 text-xl rotate-90"})})]})]}),_.jsxs("div",{className:"mb-7",children:[_.jsxs("label",{className:"block text-gray-800 font-bold mb-4",children:[G("age"),": ",_.jsx("span",{className:"text-orange-500 font-black",children:O})]}),_.jsx("input",{type:"range",min:"18",max:"120",value:O,onChange:te=>Z(parseInt(te.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-6 [&::-webkit-slider-thumb]:h-6 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-gradient-to-r [&::-webkit-slider-thumb]:from-orange-500 [&::-webkit-slider-thumb]:to-pink-600 [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-white [&::-webkit-slider-thumb]:shadow-lg"}),_.jsxs("div",{className:"flex justify-between text-sm text-gray-600 font-semibold mt-2",children:[_.jsx("span",{children:"18"}),_.jsx("span",{children:"120"})]})]}),_.jsxs("div",{className:"mb-7",children:[_.jsx("label",{className:"block text-gray-800 font-bold mb-4",children:G("maritalStatus")}),_.jsx("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto",children:NU.map(te=>_.jsx("button",{className:`px-4 py-3 rounded-2xl font-semibold transition-all duration-300 hover:scale-105 ${Y===te?"bg-gradient-to-r from-orange-500 to-pink-600 text-white shadow-lg":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,onClick:()=>H(Y===te?null:te),children:te},te))})]}),_.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200",children:[_.jsxs("button",{className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-2xl py-4 font-bold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-2",onClick:me,children:[_.jsx(bU,{className:"text-lg"}),G("reset")]}),_.jsxs("button",{className:"flex-2 bg-gradient-to-r from-orange-500 to-pink-600 hover:from-orange-600 hover:to-pink-700 text-white rounded-2xl py-4 font-bold transition-all duration-300 hover:scale-105 hover:shadow-lg flex items-center justify-center gap-2",onClick:ie,children:[_.jsx(IT,{className:"text-lg"}),G("applyFilters")]})]})]})]})}):null;return _.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-500 via-pink-600 to-orange-500 bg-[length:400%_400%] animate-gradient-shift",style:{background:"linear-gradient(135deg, #FF512F 0%, #DD2476 50%, #FF512F 100%)"},children:[_.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[_.jsx("div",{className:"absolute -top-20 -left-20 w-40 h-40 bg-white/10 rounded-full animate-pulse"}),_.jsx("div",{className:"absolute top-1/4 -right-16 w-32 h-32 bg-white/10 rounded-full animate-bounce",style:{animationDelay:"2s"}}),_.jsx("div",{className:"absolute -bottom-16 left-1/4 w-36 h-36 bg-white/10 rounded-full animate-pulse",style:{animationDelay:"1s"}})]}),_.jsxs("div",{className:"relative z-10 pt-20 px-4 sm:px-6 lg:px-8",children:[_.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-6",children:[_.jsxs("div",{className:"flex-1",children:[_.jsx("h1",{className:"text-4xl font-black text-white mb-2 tracking-tight",children:G("discoverPeople")}),_.jsx("p",{className:"text-white/90 text-lg",children:"Connect with amazing people around you"})]}),_.jsxs("div",{className:"bg-white/15 backdrop-blur-xl border border-white/20 rounded-2xl p-6 flex gap-8",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("span",{className:"block text-2xl font-black text-white mb-1",children:n.length}),_.jsx("span",{className:"text-white/80 text-sm font-semibold uppercase tracking-wide",children:"Total"})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("span",{className:"block text-2xl font-black text-white mb-1",children:B}),_.jsx("span",{className:"text-white/80 text-sm font-semibold uppercase tracking-wide",children:G("onlineNow")})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("span",{className:"block text-2xl font-black text-white mb-1",children:ee}),_.jsx("span",{className:"text-white/80 text-sm font-semibold uppercase tracking-wide",children:G("newUsers")})]})]})]}),_.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[_.jsx("div",{className:"flex-1 relative",children:_.jsxs("div",{className:"relative flex items-center bg-white/15 backdrop-blur-xl border border-white/20 rounded-2xl px-4 transition-all duration-300 focus-within:bg-white/25 focus-within:border-white/30",children:[_.jsx(RT,{className:"text-white/70 text-xl mr-3"}),_.jsx("input",{type:"text",placeholder:"Search people...",value:ge,onChange:te=>Se(te.target.value),className:"w-full bg-transparent py-4 text-white placeholder-white/70 outline-none"}),ge&&_.jsx("button",{className:"text-white/70 hover:text-white p-1 rounded-lg transition-colors duration-300",onClick:()=>Se(""),children:_.jsx(hh,{className:"text-lg"})})]})}),_.jsxs("button",{className:"bg-white/15 backdrop-blur-xl hover:bg-white/25 border border-white/20 text-white px-6 py-4 rounded-2xl font-semibold transition-all duration-300 hover:scale-105 flex items-center gap-2 whitespace-nowrap",onClick:()=>h(!0),children:[_.jsx(gU,{className:"text-lg"}),_.jsx("span",{children:"Filters"})]})]})]}),_.jsx("div",{className:"bg-white rounded-t-3xl mt-8 min-h-[calc(100vh-200px)] relative z-10 shadow-2xl pb-32",children:_.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[U?_.jsx(ye,{}):F?_.jsx(ke,{}):n.length===0?_.jsx(je,{}):_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:n.map((te,we)=>_.jsx(he,{user:te,index:we},te.id))}),n.length>0&&n.length%4===0&&_.jsx("div",{className:"flex justify-center mt-12",children:_.jsx("div",{className:"bg-gradient-to-r from-gray-100 to-gray-200 p-8 rounded-3xl text-center border-2 border-dashed border-orange-200 w-full max-w-md",children:_.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-pink-600 bg-clip-text text-transparent font-bold text-lg",children:" Premium Features Available"})})})]})}),_.jsx(mt,{}),_.jsx("style",{jsx:!0,children:`
        @keyframes gradient-shift {
          0%, 100% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
        }
        .animate-gradient-shift {
          animation: gradient-shift 8s ease infinite;
        }
        @keyframes fade-in {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
          animation: fade-in 0.6s ease forwards;
        }
      `})]})}const Fn=[];for(let n=0;n<256;++n)Fn.push((n+256).toString(16).slice(1));function kU(n,e=0){return(Fn[n[e+0]]+Fn[n[e+1]]+Fn[n[e+2]]+Fn[n[e+3]]+"-"+Fn[n[e+4]]+Fn[n[e+5]]+"-"+Fn[n[e+6]]+Fn[n[e+7]]+"-"+Fn[n[e+8]]+Fn[n[e+9]]+"-"+Fn[n[e+10]]+Fn[n[e+11]]+Fn[n[e+12]]+Fn[n[e+13]]+Fn[n[e+14]]+Fn[n[e+15]]).toLowerCase()}let A_;const OU=new Uint8Array(16);function DU(){if(!A_){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");A_=crypto.getRandomValues.bind(crypto)}return A_(OU)}const jU=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),OT={randomUUID:jU};function PU(n,e,t){n=n||{};const i=n.random??n.rng?.()??DU();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,kU(i)}function Eu(n,e,t){return OT.randomUUID&&!n?OT.randomUUID():PU(n)}function MU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z"},child:[]}]})(n)}function LU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M436.9 364.8c-14.7-14.7-50-36.8-67.4-45.1-20.2-9.7-27.6-9.5-41.9.8-11.9 8.6-19.6 16.6-33.3 13.6-13.7-2.9-40.7-23.4-66.9-49.5-26.2-26.2-46.6-53.2-49.5-66.9-2.9-13.8 5.1-21.4 13.6-33.3 10.3-14.3 10.6-21.7.8-41.9C184 125 162 89.8 147.2 75.1c-14.7-14.7-18-11.5-26.1-8.6 0 0-12 4.8-23.9 12.7-14.7 9.8-22.9 18-28.7 30.3-5.7 12.3-12.3 35.2 21.3 95 27.1 48.3 53.7 84.9 93.2 124.3l.1.1.1.1c39.5 39.5 76 66.1 124.3 93.2 59.8 33.6 82.7 27 95 21.3 12.3-5.7 20.5-13.9 30.3-28.7 7.9-11.9 12.7-23.9 12.7-23.9 2.9-8.1 6.2-11.4-8.6-26.1z"},child:[]}]})(n)}function UU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M278.6 256l68.2-68.2c6.2-6.2 6.2-16.4 0-22.6-6.2-6.2-16.4-6.2-22.6 0L256 233.4l-68.2-68.2c-6.2-6.2-16.4-6.2-22.6 0-3.1 3.1-4.7 7.2-4.7 11.3 0 4.1 1.6 8.2 4.7 11.3l68.2 68.2-68.2 68.2c-3.1 3.1-4.7 7.2-4.7 11.3 0 4.1 1.6 8.2 4.7 11.3 6.2 6.2 16.4 6.2 22.6 0l68.2-68.2 68.2 68.2c6.2 6.2 16.4 6.2 22.6 0 6.2-6.2 6.2-16.4 0-22.6L278.6 256z"},child:[]}]})(n)}function I_(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432 136h-84.3c12.4-11 20.3-26.6 20.3-44 0-33.1-28.3-60-63.1-60-20.6 0-37.9 9.7-48.9 27.4C245 41.7 227.7 32 207.1 32 172.3 32 144 58.9 144 92c0 17.4 7.8 33 20.3 44H80c-17.7 0-32 14.3-32 32v20c0 2.2 1.8 4 4 4h408c2.2 0 4-1.8 4-4v-20c0-17.7-14.3-32-32-32zM304.9 60c18.6 0 33.7 14.3 33.7 32s-15.1 32-33.7 32h-33.7c0-48 15.1-64 33.7-64zm-97.8 0c18.6 0 33.7 16 33.7 64h-33.7c-18.6 0-33.7-14.3-33.7-32s15.1-32 33.7-32zM64 226v222c0 17.6 14.4 32 32 32h146V218H72c-4.4 0-8 3.6-8 8zM440 218H270v262h146c17.6 0 32-14.4 32-32V226c0-4.4-3.6-8-8-8z"},child:[]}]})(n)}function VU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M262.3 199.2c-1.6-2.8-5.6-3.2-7.7-.7l-91.9 122.2c-2.5 2.9-.6 7.4 3.2 7.7l161.1 14c3.8.3 6.4-3.8 4.5-7.1l-69.2-136.1zM367.2 264.1c-1.6-2.8-5.6-3.2-7.7-.7l-24.8 25.1a4.68 4.68 0 0 0-.5 5.4l25.4 49.5c.8 1.3 2.1 2.2 3.7 2.3l44.9 3.9c3.8.3 6.4-3.8 4.5-7.1l-45.5-78.4zM378.1 224.4c11.2-.1 20.9-8.3 23-19.2 2.8-14.8-8.6-28.3-23.7-28.1-11.2.1-20.9 8.3-23 19.2-2.8 14.8 8.6 28.3 23.7 28.1z"},child:[]},{tag:"path",attr:{d:"M455.2 129.3l-65.8-5.7-6.1-67c-1.3-14.9-14.5-25.9-29.5-24.5L56.7 58.9c-14.9 1.3-25.9 14.5-24.6 29.4l26.8 296.5c1.3 14.9 14.5 25.9 29.5 24.5l15.7-1.4-1.5 16.7c-1.3 14.9 9.7 28 24.7 29.3l297.3 25.9c14.9 1.3 28.1-9.7 29.4-24.6l26-296.6c1.2-14.8-9.8-28-24.8-29.3zM87.6 300.7c-3.7.3-7-2.4-7.4-6.1l-18-200c-.3-3.7 2.4-7 6.1-7.3l279.2-25.1c3.7-.3 7 2.4 7.4 6.1l4.8 52.8L158 103.4c-14.9-1.3-28.1 9.7-29.4 24.6l-14.9 170.3-26.1 2.4zm362.2-135.6l-17.5 200c-.3 3.7-3.6 6.5-7.3 6.2l-18.6-1.6L145.7 347c-3.7-.3-6.5-3.6-6.2-7.3l3.8-43.9L157 139.7c.3-3.7 3.6-6.5 7.3-6.2l198 17.3 29.7 2.6 51.6 4.5c3.8.2 6.6 3.5 6.2 7.2z"},child:[]}]})(n)}function zU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48zm19 304h-38.2V207.9H275V352zm-19.1-159.8c-11.3 0-20.5-8.6-20.5-20s9.3-19.9 20.5-19.9c11.4 0 20.7 8.5 20.7 19.9s-9.3 20-20.7 20z"},child:[]}]})(n)}function BU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M255.8 218c-21 0-38 17-38 38s17 38 38 38 38-17 38-38-17-38-38-38zM102 218c-21 0-38 17-38 38s17 38 38 38 38-17 38-38-17-38-38-38zM410 218c-21 0-38 17-38 38s17 38 38 38 38-17 38-38-17-38-38-38z"},child:[]}]})(n)}function FU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.8 438.3c-7.2-31.8-48.3-47.3-62.5-52.3-15.6-5.5-37.8-6.8-52.1-10-8.2-1.8-20.1-6.3-24.1-11.1s-1.6-49.3-1.6-49.3 7.4-11.5 11.4-21.7c4-10.1 8.4-37.9 8.4-37.9s8.2 0 11.1-14.4c3.1-15.7 8-21.8 7.4-33.5-.6-11.5-6.9-11.2-6.9-11.2s6.1-16.7 6.8-51.3c.9-41.1-31.3-81.6-89.6-81.6-59.1 0-90.6 40.5-89.7 81.6.8 34.6 6.7 51.3 6.7 51.3s-6.3-.3-6.9 11.2c-.6 11.7 4.3 17.8 7.4 33.5 2.8 14.4 11.1 14.4 11.1 14.4s4.4 27.8 8.4 37.9c4 10.2 11.4 21.7 11.4 21.7s2.4 44.5-1.6 49.3c-4 4.8-15.9 9.3-24.1 11.1-14.3 3.2-36.5 4.5-52.1 10-14.2 5-55.3 20.5-62.5 52.3-1.1 5 2.7 9.7 7.9 9.7H440c5.1 0 8.9-4.7 7.8-9.7z"},child:[]}]})(n)}function qU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M435.9 64.9l-367.1 160c-6.5 3.1-6.3 12.4.3 15.3l99.3 56.1c5.9 3.3 13.2 2.6 18.3-1.8l195.8-168.8c1.3-1.1 4.4-3.2 5.6-2 1.3 1.3-.7 4.3-1.8 5.6L216.9 320.1c-4.7 5.3-5.4 13.1-1.6 19.1l64.9 104.1c3.2 6.3 12.3 6.2 15.2-.2L447.2 76c3.3-7.2-4.2-14.5-11.3-11.1z"},child:[]}]})(n)}function HU(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M450.6 153.6c-3.3 0-6.5.9-9.3 2.7l-86.5 54.6c-2.5 1.6-4 4.3-4 7.2v76c0 2.9 1.5 5.6 4 7.2l86.5 54.6c2.8 1.7 6 2.7 9.3 2.7h20.8c4.8 0 8.6-3.8 8.6-8.5v-188c0-4.7-3.9-8.5-8.6-8.5h-20.8zM273.5 384h-190C55.2 384 32 360.8 32 332.6V179.4c0-28.3 23.2-51.4 51.4-51.4h190c28.3 0 51.4 23.2 51.4 51.4v153.1c.1 28.3-23 51.5-51.3 51.5z"},child:[]}]})(n)}function $U(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"},child:[]}]})(n)}function c4(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 4H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 11H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm7-1c0 .55-.45 1-1 1h-.75v1.5h-1.5V15H14c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v4zm-3.5-.5h2v-3h-2v3z"},child:[]}]})(n)}function py(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08a.956.956 0 0 1-.29-.7c0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28a11.27 11.27 0 0 0-2.67-1.85.996.996 0 0 1-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"},child:[]}]})(n)}function GU(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9A7.902 7.902 0 0 1 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1A7.902 7.902 0 0 1 20 12c0 4.42-3.58 8-8 8z"},child:[]}]})(n)}function KU(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zm1-4.3h-2V7h2v6z"},child:[]}]})(n)}function DT(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12.16 3h-.32L9.21 8.25h5.58zM16.46 8.25h5.16L19 3h-5.16zM21.38 9.75h-8.63V20.1zM11.25 20.1V9.75H2.62zM7.54 8.25 10.16 3H5L2.38 8.25z"},child:[]}]})(n)}function WU(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"},child:[]}]})(n)}function jT(n){return Oe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 405.3V448c0 35.3 86 64 192 64s192-28.7 192-64v-42.7C342.7 434.4 267.2 448 192 448S41.3 434.4 0 405.3zM320 128c106 0 192-28.7 192-64S426 0 320 0 128 28.7 128 64s86 64 192 64zM0 300.4V352c0 35.3 86 64 192 64s192-28.7 192-64v-51.6c-41.3 34-116.9 51.6-192 51.6S41.3 334.4 0 300.4zm416 11c57.3-11.1 96-31.7 96-55.4v-42.7c-23.2 16.4-57.3 27.6-96 34.5v63.6zM192 160C86 160 0 195.8 0 240s86 80 192 80 192-35.8 192-80-86-80-192-80zm219.3 56.3c60-10.8 100.7-32 100.7-56.3v-42.7c-35.5 25.1-96.5 38.6-160.7 41.8 29.5 14.3 51.2 33.5 60 57.2z"},child:[]}]})(n)}function u4(n){return Oe({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"},child:[]}]})(n)}const R_=async(n,e,t)=>{try{if(!n||!e){console.warn("Skipping typing update  missing chatId or email");return}const i=e.replace(/[.@]/g,"_"),{error:r}=await supabase.from("chats").update({typing:{[i]:t}}).eq("id",n);r?console.error(" Error updating typing status:",r):console.log(` Typing status updated for ${e}: ${t}`)}catch(i){console.error(" setTypingStatus error:",i)}};function YU(){const[n,e]=P.useState([]),[t,i]=P.useState(!0),r=o=>{const c=/\/file\/d\/(.+?)\/view/,h=o.match(c);return h&&h[1]?`https://drive.google.com/uc?export=view&id=${h[1]}`:o};return P.useEffect(()=>{const o=sm(),c=E0(o,"GiftImage"),h=SM(c,f=>{if(f.exists()){const m=f.val();let v=[];v=Object.values(m).map(w=>({...w,imageUrl:r(w.imageUrl)})),e(v)}else e([]);i(!1)});return()=>h()},[]),{giftImages:n,loading:t}}function QU(){const n=cs(),t=vr().state||{},i=t.id,r=t.email,o=Ye?.currentUser?.email,[c,h]=P.useState([]),[f,m]=P.useState(""),[v,w]=P.useState(!1),[T,x]=P.useState(!1),[N,L]=P.useState(!1),[O,Z]=P.useState(!1),[Y,H]=P.useState(!1),[le,ve]=P.useState(!1),[oe,I]=P.useState(null),[A,R]=P.useState(1),[U,V]=P.useState("gold"),[F,k]=P.useState(0),[ge,Se]=P.useState(0),[j,G]=P.useState(3600),[ie,me]=P.useState(!1),[be,D]=P.useState(null),[B,ee]=P.useState(!1),[he,ye]=P.useState(!0),[ke,je]=P.useState(!1),mt=P.useRef(null),te=P.useRef(null),we=P.useRef(null),Je=P.useRef(null),Gt=P.useRef(null),{giftImages:Qt,loading:Lt}=YU(),An=P.useCallback(()=>(Qt||[]).filter(se=>U==="diamond"?se.isTypeDiamond:!se.isTypeDiamond),[Qt,U]);P.useEffect(()=>{const se=pe=>{Gt.current&&!Gt.current.contains(pe.target)&&je(!1)};return document.addEventListener("mousedown",se),()=>{document.removeEventListener("mousedown",se)}},[]),P.useEffect(()=>{console.log(" Chat Debug Info:",{chatId:i,currentEmail:o,partnerEmail:r,messagesCount:c.length,isChatDisabled:Y})},[i,o,r,c.length,Y]);const rn=()=>{if(f.trim()){if(!i||!o){console.error(" Cannot send message - missing data:",{chatId:i,currentEmail:o,inputText:f.trim()}),alert("Cannot send message. Chat information missing.");return}ki(i,f.trim())}},ki=async(se,pe)=>{if(!se||!o||!pe.trim()){console.error(" sendMessage validation failed:",{chatIdParam:se,currentEmail:o,text:pe}),alert("Cannot send message: Missing required information");return}const Ie=new Date().toISOString(),Re={_id:Eu(),createdAt:Ie,text:pe.trim(),status:"sending",user:{_id:o,name:Ye.currentUser?.displayName||o,avatar:Ye.currentUser?.photoURL||null}};h(Me=>[...Me,Re]),m(""),R_(se,o,!1),L(!1);try{const{error:Me}=await Te.from("chat_messages").insert([{chat_id:se,user_email:o,message:Re}]);if(Me)throw Me;await Te.from("chats").update({last_message:pe.trim(),last_updated:new Date().toISOString()}).eq("id",se)}catch(Me){console.error("sendMessage error:",Me),h(Fe=>Fe.map(At=>At._id===Re._id?{...At,status:"failed"}:At)),alert("Failed to send message")}},Ze=async(se,pe)=>{if(!se||!o){console.error(" Missing chatId or user for image message");return}const Ie=new Date().toISOString(),Re={_id:Eu(),createdAt:Ie,text:"",image:pe,status:"sending",user:{_id:o,name:Ye.currentUser?.displayName||o,avatar:Ye.currentUser?.photoURL||null}};h(Me=>[...Me,Re]);try{const{error:Me}=await Te.from("chat_messages").insert([{chat_id:se,user_email:o,message:Re}]);if(Me)throw Me;await Te.from("chats").update({last_message:"[gift ]",last_updated:new Date().toISOString()}).eq("id",se)}catch(Me){console.error("sendMessageWithImage error:",Me),h(Fe=>Fe.map(At=>At._id===Re._id?{...At,status:"failed"}:At)),alert("Failed to send sticker")}},gt=async()=>{const se=Ye?.currentUser?.email;if(!se||!r){alert("Error","User information missing");return}try{const{data:pe,error:Ie}=await Te.from("blockusers").select("TotalBlockUser").eq("email",se).single();if(Ie&&Ie.code!=="PGRST116"){console.error(" handleBlockToggle fetch error:",Ie),alert("Error","Failed to fetch block status");return}let Re=Array.isArray(pe?.TotalBlockUser)?pe.TotalBlockUser:[],Me;le?Me=Re.filter(At=>At.email!==r):Me=[...Re,{isblock:!0,email:r}];const{error:Fe}=await Te.from("blockusers").upsert({email:se,TotalBlockUser:Me});if(Fe)console.error(" handleBlockToggle update error:",Fe),alert("Error","Failed to update block status");else{const At=!le;ve(At),H(At),je(!1),console.log(` ${At?"Blocked":"Unblocked"} user: ${r}`)}}catch(pe){console.error(" handleBlockToggle error:",pe),alert("Error","Something went wrong")}},Ct=async()=>{try{me(!1);const se=Ye?.currentUser?.email,pe=Ye?.currentUser?.email;n("JoinScreen",{roomId:se,peerEmail:pe,isVideoCall:!0,isCaller:!1,isTypeJoin:!0})}catch(se){console.log("Error accepting call:",se),alert("Error","Failed to accept call")}},_e=async se=>{try{const pe=Ye?.currentUser?.email;console.log("print the peerEmail",pe);const Ie=Ye?.currentUser?.email;if(!Ie||!pe){alert("Error","User information missing");return}console.log("Initiating call:",{currentUserEmail:Ie,peerEmail:pe,isVideo:se});const{data:Re,error:Me}=await Te.from("users").select("isoncallstatus, iscallingfrom, lastcallroom, updatedat").eq("email",Ie).single(),{data:Fe,error:At}=await Te.from("users").select("isoncallstatus, iscallingfrom, lastcallroom, updatedat").eq("email",pe).single();Me&&console.log("Error fetching current user status:",Me),At&&console.log("Error fetching peer user status:",At);const kt=await We(Re),Gi=await We(Fe);if(kt||Gi){alert("User is Busy","One of the users is already on another call"),kt&&await Et(Re)&&await pt(Ie),Gi&&await Et(Fe)&&await pt(pe);return}try{const{error:Ki}=await Te.from("users").update({iscallingfrom:pe,isoncallstatus:!0,isvideocall:se,updatedat:new Date().toISOString()}).eq("email",Ie);if(Ki)throw console.log("Error updating user status:",Ki),Ki;console.log("User status updated successfully")}catch(Ki){console.log("Failed to update user status:",Ki)}const hn={roomId:Ie,peerEmail:pe,isVideoCall:se,isCaller:!0,isTypeJoin:!1};console.log("Navigating to call screen with data:",hn),n("/callscreen",{state:hn})}catch(pe){console.error("Call initiation error:",pe);try{await Te.from("users").update({iscallingfrom:"",isoncallstatus:!1,isvideocall:!1}).eq("email",Ye?.currentUser?.email)}catch(Ie){console.log("Cleanup error:",Ie)}alert("Call Error",pe?.message||"Failed to start call. Please try again.")}},We=async se=>se?.isoncallstatus?await Et(se)?(console.log("Detected stale call, considering user as available"),!1):!0:!1,Et=async se=>{if(!se?.updatedat)return!0;const pe=new Date(se.updatedat);return(new Date-pe)/(1e3*60)>2},pt=async se=>{try{console.log("Cleaning up stale call for:",se);const{error:pe}=await Te.from("users").update({iscallingfrom:"",isoncallstatus:!1,iscallerhangup:!1,lastcallroom:null,isvideocall:!1,isvideoon:!1,updatedat:new Date().toISOString()}).eq("email",se);pe?console.error("Error cleaning up stale call:",pe):console.log(" Stale call cleaned up for:",se)}catch(pe){console.error("Exception during stale call cleanup:",pe)}};P.useEffect(()=>{const se=Ye?.currentUser?.email;if(!se||!r)return;const pe=async()=>{try{const{data:Re}=await Te.from("blockusers").select("TotalBlockUser").eq("email",se).single(),Me=Array.isArray(Re?.TotalBlockUser)?Re.TotalBlockUser.some(kt=>kt.email===r):!1,{data:Fe}=await Te.from("blockusers").select("TotalBlockUser").eq("email",r).single(),At=Array.isArray(Fe?.TotalBlockUser)?Fe.TotalBlockUser.some(kt=>kt.email===se):!1;H(Me||At),ve(Me)}catch(Re){console.error(" checkBlockStatus error:",Re)}};pe();const Ie=Te.channel(`blockusers-changes-${se}-${r}`).on("postgres_changes",{event:"*",schema:"public",table:"blockusers",filter:`email=in.(${se},${r})`},()=>{pe()}).subscribe();return()=>{Te.removeChannel(Ie)}},[r]),P.useEffect(()=>{if(!i){console.error(" No chatId provided"),ye(!1);return}let se=!0;return ye(!0),(async()=>{try{const{data:Ie,error:Re}=await Te.from("chat_messages").select("id, chat_id, user_email, message").eq("chat_id",i).order("id",{ascending:!0});if(Re){console.error("Error loading messages:",Re),se&&ye(!1);return}if(!se)return;const Me=(Ie||[]).map(Fe=>({_id:Fe.id||Fe.message?._id||Eu(),createdAt:Fe.message?.createdAt||new Date().toISOString(),text:Fe.message?.text??Fe.message?.text??null,image:Fe.message?.image??null,video:Fe.message?.video??null,status:Fe.message?.status??"sent",user:Fe.message?.user??{_id:Fe.user_email,name:Fe.user_email}}));h(Me)}catch(Ie){console.error("loadMessages error:",Ie)}finally{se&&ye(!1)}})(),()=>{se=!1}},[i]),P.useEffect(()=>{if(!i)return;we.current&&(Te.removeChannel(we.current),we.current=null);const se=Te.channel(`chat_messages_listener_${i}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`chat_id=eq.${i}`},pe=>{try{const Ie=pe.new,Re=Ie.message||{},Me={_id:Ie.id||Re._id||Eu(),createdAt:Re.createdAt||new Date().toISOString(),text:Re.text??null,image:Re.image??null,video:Re.video??null,status:Re.status??"sent",user:Re.user??{_id:Ie.user_email,name:Ie.user_email}};h(Fe=>Fe.some(kt=>kt._id===Me._id||kt.createdAt===Me.createdAt&&kt.user?._id===Me.user?._id&&kt.text===Me.text)?Fe:[...Fe,Me])}catch(Ie){console.error("Realtime message processing error:",Ie)}}).subscribe();return we.current=se,()=>{we.current&&(Te.removeChannel(we.current),we.current=null)}},[i]),P.useEffect(()=>{te.current?.scrollIntoView({behavior:"smooth"})},[c]);const Xt=P.useCallback(se=>{m(se),!(!i||!o)&&(R_(i,o,!0),L(!0),mt.current&&clearTimeout(mt.current),mt.current=setTimeout(()=>{R_(i,o,!1),L(!1)},1500))},[i,o]),dt=P.useCallback(()=>{if(!i){alert("Error","Chat not available");return}const se=document.createElement("input");se.type="file",se.accept="image/*,video/*",se.onchange=async pe=>{const Ie=pe.target.files[0];if(!Ie)return;const Re=Ie.type.startsWith("image")?"image":"video";await Kt(i,Ie,Re)},se.click()},[i]),Kt=async(se,pe,Ie)=>{try{w(!0);const Re=pe.name.split(".").pop()||(Ie==="image"?"jpg":"mp4"),Me=`${o}/${Ie==="image"?"images":"videos"}/${Date.now()}.${Re}`,{error:Fe}=await Te.storage.from("chat_messages").upload(Me,pe,{contentType:pe.type});if(Fe)throw Fe;const{data:At}=Te.storage.from("chat_messages").getPublicUrl(Me),kt=At?.publicUrl;if(!kt)throw new Error("No public URL returned");await In(se,kt,Ie)}catch(Re){console.error("handleMediaUpload failed:",Re),alert("Upload failed")}finally{w(!1)}},In=async(se,pe,Ie)=>{if(!se||!o){console.error(" Missing chatId or user for media message");return}const Re=new Date().toISOString(),Me={_id:Eu(),createdAt:Re,text:null,[Ie]:pe,type:Ie,status:"sending",user:{_id:o,name:Ye.currentUser?.displayName||o,avatar:Ye.currentUser?.photoURL||null}};h(Fe=>[...Fe,Me]);try{const{error:Fe}=await Te.from("chat_messages").insert([{chat_id:se,user_email:o,message:Me}]);if(Fe)throw Fe}catch(Fe){console.error("sendMessageWithMedia error:",Fe),h(At=>At.map(kt=>kt._id===Me._id?{...kt,status:"failed"}:kt)),alert("Failed to send media")}},Oi=async()=>{if(oe){if(!i||!o){alert("Error","Chat information missing");return}try{const se=o,{data:pe}=await Te.from("users").select("totalgold, totaldiamond").eq("email",se).single(),Ie=(oe.coins||0)*A,Re=U==="gold",Me=Re?pe?.totalgold||0:pe?.totaldiamond||0;if(Ie>Me){alert(`Insufficient ${Re?"Gold":"Diamond"} Coins`);return}const Fe=Re?{totalgold:Me-Ie}:{totaldiamond:Me-Ie};await Te.from("users").update(Fe).eq("email",se),await Ze(i,oe.imageUrl),$i()}catch(se){console.error("handleSendSticker error:",se),alert("Failed to send gift")}}},$i=()=>{x(!1),I(null)};P.useEffect(()=>{const se=setInterval(()=>{G(pe=>pe<=1?3600:pe-1)},1e3);return()=>clearInterval(se)},[]),P.useEffect(()=>{(async()=>{try{if(!o)return;const{data:pe}=await Te.from("users").select("totalgold, totaldiamond").eq("email",o).single();pe&&(k(pe.totalgold||0),Se(pe.totaldiamond||0))}catch(pe){console.error("fetch balances err",pe)}})()},[o]);const Ce=async()=>{try{const se=await navigator.mediaDevices.getUserMedia({audio:!0});Je.current=new MediaRecorder(se),ee(!0),Je.current.start()}catch(se){console.error("Error starting recording:",se),alert("Error","Microphone access denied")}},Pe=()=>{Je.current&&B&&(Je.current.stop(),ee(!1))},St=()=>{alert("View Profile feature coming soon!"),je(!1)},nt=()=>{alert("Report User feature coming soon!"),je(!1)},zt=()=>{window.confirm("Are you sure you want to clear this chat?")&&(h([]),je(!1))},Bt=()=>_.jsxs("div",{className:"modern-loading-container",children:[_.jsx("div",{className:"modern-loading-spinner"}),_.jsx("p",{children:"Loading messages..."})]}),ja=()=>_.jsxs("div",{className:"modern-empty-chat",children:[_.jsx("div",{className:"modern-empty-icon",children:""}),_.jsx("h3",{children:"No messages yet"}),_.jsx("p",{children:"Start a conversation by sending a message!"})]}),us=()=>_.jsx("div",{className:"modern-header",children:_.jsxs("div",{className:"modern-header-content",children:[_.jsxs("div",{className:"modern-header-left",children:[_.jsx("button",{onClick:()=>n(-1),className:"modern-back-button",children:_.jsx(MU,{size:24})}),_.jsxs("div",{className:"modern-user-info",children:[_.jsxs("div",{className:"modern-avatar-container",children:[_.jsx("img",{src:t.avatar||t.image||"https://i.pravatar.cc/300",className:"modern-avatar",alt:t.name||t.email||"User",onError:se=>{se.target.src="https://i.pravatar.cc/300"}}),_.jsx("div",{className:`modern-status-indicator ${O?"online":"offline"}`})]}),_.jsxs("div",{className:"modern-user-details",children:[_.jsx("h2",{className:"modern-user-name",children:t.name||t.email||"Unknown User"}),_.jsx("p",{className:"modern-user-status",children:N?_.jsxs("span",{className:"modern-typing-indicator",children:[_.jsx("span",{className:"modern-typing-dot"}),_.jsx("span",{className:"modern-typing-dot"}),_.jsx("span",{className:"modern-typing-dot"}),"typing..."]}):O?"Online":"Offline"})]})]})]}),_.jsxs("div",{className:"modern-header-actions",children:[_.jsx("button",{className:"modern-header-icon-button",onClick:()=>{Y?alert("Blocked","You can't call this user."):_e(!1)},disabled:Y,title:"Voice Call",children:_.jsx(LU,{size:20})}),_.jsx("button",{className:"modern-header-icon-button",onClick:()=>{Y?alert("Blocked","You can't video call this user."):_e(!0)},disabled:Y,title:"Video Call",children:_.jsx(HU,{size:20})}),_.jsx("button",{className:"modern-header-icon-button",onClick:()=>x(!0),disabled:Y||!i,title:"Send Gift",children:_.jsx(I_,{size:20})}),_.jsxs("div",{className:"modern-menu-container",ref:Gt,children:[_.jsx("button",{className:"modern-header-icon-button",onClick:()=>je(!ke),title:"More Options",children:_.jsx(BU,{size:20})}),ke&&_.jsxs("div",{className:"modern-dropdown-menu",children:[_.jsxs("button",{className:"modern-menu-item",onClick:St,children:[_.jsx(FU,{className:"modern-menu-icon"}),_.jsx("span",{children:"View Profile"})]}),_.jsxs("button",{className:"modern-menu-item",onClick:gt,children:[_.jsx(GU,{className:"modern-menu-icon"}),_.jsx("span",{children:le?"Unblock User":"Block User"})]}),_.jsxs("button",{className:"modern-menu-item",onClick:nt,children:[_.jsx(KU,{className:"modern-menu-icon"}),_.jsx("span",{children:"Report User"})]}),_.jsxs("button",{className:"modern-menu-item",onClick:zt,children:[_.jsx(zU,{className:"modern-menu-icon"}),_.jsx("span",{children:"Clear Chat"})]})]})]})]})]})}),Er=rs.memo(({message:se})=>{const pe=se.user?._id===o;return _.jsxs("div",{className:`modern-message-container ${pe?"self":"other"}`,children:[!pe&&_.jsx("img",{src:t.avatar||"https://i.pravatar.cc/300",className:"modern-sender-avatar",alt:"Sender",onError:Ie=>{Ie.target.src="https://i.pravatar.cc/300"}}),_.jsxs("div",{className:`modern-message-bubble ${pe?"self":"other"}`,children:[se.image&&_.jsxs("div",{className:"modern-media-container",children:[_.jsx("img",{src:se.image,className:"modern-message-image",alt:"Shared content",loading:"lazy"}),_.jsx("div",{className:"modern-media-overlay",children:" Gift"})]}),se.video&&_.jsxs("div",{className:"modern-media-container",children:[_.jsx("video",{src:se.video,className:"modern-message-video",controls:!0,preload:"metadata"}),_.jsx("div",{className:"modern-media-overlay",children:" Video"})]}),se.text&&_.jsx("div",{className:"modern-message-text",children:se.text}),_.jsxs("div",{className:"modern-message-meta",children:[_.jsx("span",{className:"modern-message-time",children:new Date(se.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),pe&&_.jsx("span",{className:`modern-message-status ${se.status}`,children:se.status==="failed"?"":se.status==="sending"?"":""})]})]})]})}),ks=()=>_.jsx("div",{className:"modern-modal-overlay",onClick:$i,children:_.jsxs("div",{className:"modern-sticker-modal",onClick:se=>se.stopPropagation(),children:[_.jsxs("div",{className:"modern-banner",children:[_.jsxs("div",{className:"modern-banner-content",children:[_.jsx(WU,{className:"modern-banner-icon"}),_.jsx("span",{children:"Get newbie bonus, recharge for free lottery"})]}),_.jsx("div",{className:"modern-timer-box",children:_.jsxs("span",{className:"modern-timer",children:[Math.floor(j/60).toString().padStart(2,"0"),":",(j%60).toString().padStart(2,"0")]})})]}),_.jsxs("div",{className:"modern-sticker-header",children:[_.jsx("h3",{className:"modern-sticker-title",children:"Send a Special Gift"}),_.jsxs("div",{className:"modern-header-right",children:[_.jsxs("div",{className:"modern-coins-display",children:[_.jsxs("div",{className:"modern-coin-item diamond",children:[_.jsx(DT,{size:18}),_.jsx("span",{children:ge})]}),_.jsxs("div",{className:"modern-coin-item gold",children:[_.jsx(jT,{size:18}),_.jsx("span",{children:F})]})]}),_.jsx("button",{className:"modern-close-modal",onClick:$i,children:_.jsx(UU,{size:24})})]})]}),_.jsxs("div",{className:"modern-tab-row",children:[_.jsxs("button",{className:`modern-tab-button ${U==="gold"?"active":""}`,onClick:()=>V("gold"),children:[_.jsx(jT,{className:"modern-tab-icon"}),_.jsx("span",{children:"Gold Gifts"})]}),_.jsxs("button",{className:`modern-tab-button ${U==="diamond"?"active":""}`,onClick:()=>V("diamond"),children:[_.jsx(DT,{className:"modern-tab-icon"}),_.jsx("span",{children:"Premium Gifts"})]})]}),Lt?_.jsxs("div",{className:"modern-loading-stickers",children:[_.jsx("div",{className:"modern-loading-spinner"}),_.jsx("p",{children:"Loading amazing gifts..."})]}):_.jsx("div",{className:"modern-stickers-grid",children:An().map((se,pe)=>_.jsx("button",{className:`modern-sticker-item ${oe===se?"selected":""}`,onClick:()=>I(se),children:_.jsxs("div",{className:"modern-sticker-image-container",children:[_.jsx("img",{src:se.imageUrl,alt:se.name,className:"modern-sticker-image",loading:"lazy"}),se.isNew&&_.jsx("span",{className:"modern-new-badge",children:"NEW"}),_.jsxs("div",{className:"modern-sticker-cost",children:[se.coins," ",U==="gold"?"":""]})]})},pe))}),_.jsxs("div",{className:"modern-sticker-footer",children:[_.jsxs("div",{className:"modern-recipient-info",children:[_.jsx("div",{className:"modern-recipient-avatar",children:t.name?.charAt(0)||"U"}),_.jsxs("span",{className:"modern-recipient-name",children:["To: ",t.name||"User"]})]}),_.jsxs("div",{className:"modern-quantity-control",children:[_.jsx("label",{children:"Quantity:"}),_.jsx("select",{value:A,onChange:se=>R(Number(se.target.value)),className:"modern-quantity-dropdown",children:Array.from({length:10},(se,pe)=>_.jsx("option",{value:pe+1,children:pe+1},pe+1))})]}),_.jsxs("button",{className:"modern-send-sticker-button",onClick:Oi,disabled:!oe,children:[_.jsx(I_,{className:"modern-send-icon"}),"Send Gift",oe&&_.jsxs("span",{className:"modern-total-cost",children:["(",oe.coins*A," ",U==="gold"?"":"",")"]})]})]})]})});return _.jsxs("div",{className:"modern-chat-container",children:[v&&_.jsxs("div",{className:"modern-upload-overlay",children:[_.jsx("div",{className:"modern-upload-spinner"}),_.jsx("div",{className:"modern-upload-text",children:"Uploading your media..."})]}),_.jsx(us,{}),_.jsx("div",{className:"modern-messages-container",children:_.jsx("div",{className:"modern-messages-list",children:he?_.jsx(Bt,{}):c.length===0?_.jsx(ja,{}):_.jsxs(_.Fragment,{children:[c.map((se,pe)=>_.jsx(Er,{message:se},se._id||pe)),_.jsx("div",{ref:te,className:"modern-messages-end"})]})})}),T&&_.jsx(ks,{}),_.jsxs("div",{className:"modern-input-container",children:[_.jsx("button",{className:"modern-input-button modern-gift-button",onClick:()=>x(!0),disabled:Y||!i,title:"Send Gift",children:_.jsx(I_,{size:24})}),_.jsxs("div",{className:"modern-input-wrapper",children:[_.jsx("input",{className:"modern-message-input",placeholder:i?Y?"You can't send messages to this user":"Type a message...":"Chat not available",value:f,onChange:se=>Xt(se.target.value),disabled:Y||!i,onKeyDown:se=>{se.key==="Enter"&&!se.shiftKey&&(se.preventDefault(),rn())}}),_.jsx("button",{className:`modern-voice-button ${B?"recording":""}`,onMouseDown:Ce,onMouseUp:Pe,onTouchStart:Ce,onTouchEnd:Pe,disabled:Y||!i,title:"Hold to record voice message",children:""})]}),_.jsx("button",{className:"modern-input-button modern-media-button",onClick:dt,disabled:Y||v||!i,title:"Attach Media",children:_.jsx(VU,{size:24})}),_.jsx("button",{className:`modern-send-button ${f.trim()?"":"disabled"}`,onClick:rn,disabled:!f.trim()||Y||v||!i,title:"Send Message",children:_.jsx(qU,{size:20})})]}),ie&&be&&_.jsx("div",{className:"modern-incoming-call-overlay",children:_.jsxs("div",{className:"modern-incoming-call-modal",children:[_.jsx("h3",{children:"Incoming Call"}),_.jsxs("p",{children:["From: ",be.name]}),_.jsxs("div",{className:"modern-call-actions",children:[_.jsx("button",{onClick:Ct,children:"Accept"}),_.jsx("button",{onClick:()=>me(!1),children:"Reject"})]})]})})]})}function XU(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M10 4H8v4H4v2h6zM8 20h2v-6H4v2h4zm12-6h-6v6h2v-4h4zm0-6h-4V4h-2v6h6z"},child:[]}]})(n)}function JU(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 5h5V3H3v7h2zm5 14H5v-5H3v7h7zm11-5h-2v5h-5v2h7zm-2-4h2V3h-7v2h5z"},child:[]}]})(n)}function PT(n){return Oe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19 3c-1.654 0-3 1.346-3 3 0 .502.136.968.354 1.385l-1.116 1.302A3.976 3.976 0 0 0 13 8c-.739 0-1.425.216-2.02.566L9.566 7.152A3.449 3.449 0 0 0 10 5.5C10 3.57 8.43 2 6.5 2S3 3.57 3 5.5 4.57 9 6.5 9c.601 0 1.158-.166 1.652-.434L9.566 9.98A3.972 3.972 0 0 0 9 12c0 .997.38 1.899.985 2.601l-1.692 1.692.025.025A2.962 2.962 0 0 0 7 16c-1.654 0-3 1.346-3 3s1.346 3 3 3 3-1.346 3-3c0-.476-.121-.919-.318-1.318l.025.025 1.954-1.954c.421.15.867.247 1.339.247 2.206 0 4-1.794 4-4a3.96 3.96 0 0 0-.439-1.785l1.253-1.462c.364.158.764.247 1.186.247 1.654 0 3-1.346 3-3s-1.346-3-3-3zM7 20a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM5 5.5C5 4.673 5.673 4 6.5 4S8 4.673 8 5.5 7.327 7 6.5 7 5 6.327 5 5.5zm8 8.5c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2zm6-7a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"},child:[]}]})(n)}function ZU(){const n=cs(),t=vr().state||{},{roomId:i,isVideoCall:r,peerEmail:o,fcmToken:c,accessToken:h,selfFcmToken:f,selfAccessToken:m,avatar:v,avatars:w}=t,[T,x]=P.useState(null),[N,L]=P.useState(null),[O,Z]=P.useState(!0),[Y,H]=P.useState(!1),[le,ve]=P.useState(!1),[oe,I]=P.useState(!1),[A,R]=P.useState("Connecting..."),[U,V]=P.useState(0),[F,k]=P.useState(!0),[ge,Se]=P.useState(!1),[j,G]=P.useState(null),[ie,me]=P.useState(null),[be,D]=P.useState("full-hd"),[B,ee]=P.useState(!1),[he,ye]=P.useState("good"),[ke,je]=P.useState(!1),mt=P.useRef(null),te=P.useRef(!1);P.useRef([]),P.useRef(null);const we=P.useRef(null);P.useRef(null);const Je=P.useRef(null),Gt=P.useRef(null),Qt=P.useRef(null),Lt=P.useRef(null),An={iceServers:[{urls:"stun:stun.relay.metered.ca:80"},{urls:"turn:159.223.175.154:3478",username:"user",credential:"password"},{urls:"turn:95.217.13.89:3478",username:"user",credential:"password"}],iceCandidatePoolSize:10},rn={"4k":{width:3840,height:2160,frameRate:30,bitrate:8e6},"full-hd":{width:1920,height:1080,frameRate:30,bitrate:4e6},hd:{width:1280,height:720,frameRate:30,bitrate:25e5}},ki=Ce=>{const Pe=Math.floor(Ce/60),St=Ce%60;return`${Pe.toString().padStart(2,"0")}:${St.toString().padStart(2,"0")}`},Ze=async()=>{try{const Ce=await navigator.mediaDevices.getUserMedia({audio:!0,video:r});return ve(!0),!0}catch(Ce){return console.log("Permission error:",Ce),ve(!1),!1}},gt=async()=>{try{const Ce=rn[be],Pe={audio:{channelCount:1,echoCancellation:!0,noiseSuppression:!0,sampleRate:48e3,sampleSize:16,autoGainControl:!0},video:r?{width:{ideal:Ce.width},height:{ideal:Ce.height},frameRate:{ideal:Ce.frameRate},facingMode:O?"user":"environment"}:!1},St=await navigator.mediaDevices.getUserMedia(Pe);x(St),Je.current&&(Je.current.srcObject=St),r||(k(!1),St.getVideoTracks().forEach(nt=>{nt.enabled=!1}))}catch(Ce){console.log("Error starting local stream:",Ce)}},Ct=async(Ce,Pe,St,nt,zt={})=>{const Bt="https://fcm.googleapis.com/v1/projects/hiddo-3887f/messages:send",ja={message:{token:Ce,data:{title:Pe,body:St,...zt}}};try{const Er=await(await fetch(Bt,{method:"POST",headers:{"Content-Type":"application/json",Authorization:nt},body:JSON.stringify(ja)})).json();console.log("FCM Response:",Er)}catch(us){console.error("FCM Error:",us)}},_e=async Ce=>{try{if(!T)return;te.current=!0,I(!0),R("Calling...");const Pe=new RTCPeerConnection(An);mt.current=Pe,T.getTracks().forEach(nt=>{Pe.addTrack(nt,T)}),Pe.ontrack=nt=>{const zt=nt.streams[0];L(zt),Gt.current&&(Gt.current.srcObject=zt),R("Connected"),$i()},Pe.onicecandidate=nt=>{nt.candidate&&console.log("ICE candidate:",nt.candidate)},Pe.onconnectionstatechange=()=>{console.log("PC state:",Pe.connectionState),["failed","disconnected","closed"].includes(Pe.connectionState)&&We()};const St=await Pe.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:r});await Pe.setLocalDescription(St);try{const{error:nt}=await Te.from("users").update({iscallingfrom:Ye?.currentUser?.email||null,isoncallstatus:!0,lastcallroom:Ce,isvideocall:r}).eq("email",o);if(nt)throw nt;const{error:zt}=await Te.from("users").update({isvideoon:r,isoncallstatus:!0}).eq("email",Ye?.currentUser?.email);if(zt)throw zt;Se(!0),Ct(c,"Start Call",Ye?.currentUser?.email,h,{Peeremail:Ye?.currentUser?.email,type:"Incoming_Call",remoteAccessToken:m,remoteFCMToken:f,screenName:"JoinScreen",avatar:w}),console.log(" Call started successfully")}catch(nt){console.error(" Error updating user status:",nt)}}catch(Pe){console.log("startCall error:",Pe),I(!1),te.current=!1,R("Connection Failed"),In()}},We=async()=>{R("Disconnected"),me(!0),setTimeout(()=>{window.confirm("Call ended. Return to chat?")&&Oi()},1e3)},Et=async()=>{if(!(!r||!T))try{const Ce=T.getVideoTracks()[0],Pe={video:{width:{ideal:1280},height:{ideal:720},facingMode:O?"environment":"user"}},St=await navigator.mediaDevices.getUserMedia(Pe),nt=St.getVideoTracks()[0],zt=mt.current.getSenders().find(Bt=>Bt.track&&Bt.track.kind==="video");zt&&await zt.replaceTrack(nt),Ce.stop(),T.removeTrack(Ce),T.addTrack(nt),Je.current&&(Je.current.srcObject=T),Z(!O),St.getTracks().forEach(Bt=>{Bt.kind==="audio"&&Bt.stop()})}catch(Ce){console.log("Error switching camera:",Ce)}},pt=()=>{T&&(T.getAudioTracks().forEach(Ce=>{Ce.enabled=!Ce.enabled}),H(!Y))},Xt=async()=>{if(!r||!T)return;const Ce=T.getVideoTracks()[0];if(Ce){Ce.enabled=!Ce.enabled,k(Ce.enabled);try{const{error:Pe}=await Te.from("users").update({isvideoon:Ce.enabled}).eq("email",Ye?.currentUser?.email);Pe&&console.error(" Error updating video status:",Pe)}catch(Pe){console.error(" toggleVideo error:",Pe)}}},dt=async Ce=>{try{if(!T)return;D(Ce);const Pe=rn[Ce],St=T.getVideoTracks()[0];St&&(await St.applyConstraints({width:{ideal:Pe.width},height:{ideal:Pe.height},frameRate:{ideal:Pe.frameRate}}),console.log(`Switched to ${Ce} quality`))}catch(Pe){console.log(`Error switching to ${Ce}:`,Pe)}},Kt=()=>{document.fullscreenElement?(document.exitFullscreen?.(),ee(!1)):(Lt.current?.requestFullscreen?.(),ee(!0))},In=async()=>{try{console.log("Cleaning up connections..."),we.current&&(clearInterval(we.current),we.current=null),T&&T.getTracks().forEach(Ce=>Ce.stop()),mt.current&&(mt.current.close(),mt.current=null),L(null),I(!1),V(0),R("Call Ended"),console.log("Connections cleaned up successfully")}catch(Ce){console.error("Error during cleanup:",Ce)}},Oi=async()=>{try{console.log("Ending call for:",o);const{error:Ce}=await Te.from("users").update({iscallingfrom:"",isoncallstatus:!1}).eq("email",o),{error:Pe}=await Te.from("users").update({isoncallstatus:!1,iscallingfrom:""}).eq("email",Ye?.currentUser?.email),{error:St}=await Te.from("users").update({iscallerhangup:!1}).eq("email",o);Ct(c,"Call Ended",Ye?.currentUser?.email,h,{Peeremail:Ye?.currentUser?.email,type:"Reject_Call",remoteAccessToken:m,remoteFCMToken:f}),await In(),n(-1),console.log(" Call ended successfully")}catch(Ce){console.error(" Error ending call:",Ce)}},$i=()=>{Qt.current&&(Qt.current.pause(),Qt.current=null)};return P.useEffect(()=>((async()=>{await Ze()&&await gt()})(),()=>{In()}),[]),P.useEffect(()=>(oe&&N?we.current=setInterval(()=>{V(Ce=>Ce+1)},1e3):we.current&&clearInterval(we.current),()=>{we.current&&clearInterval(we.current)}),[oe,N]),P.useEffect(()=>{if(!o)return;const Ce=Te.channel(`video-status-${o}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`email=eq.${o}`},Pe=>{const St=Pe.new.isvideoon;console.log("Peer video status:",St),G(!!St)}).subscribe();return()=>{Te.removeChannel(Ce)}},[o]),_.jsxs("div",{ref:Lt,className:"min-h-screen bg-gradient-to-br from-purple-900 via-pink-800 to-red-700 flex flex-col relative overflow-hidden",children:[_.jsxs("div",{className:"absolute inset-0",children:[_.jsx("div",{className:"absolute top-0 left-0 w-72 h-72 bg-white/5 rounded-full blur-3xl animate-pulse"}),_.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-pink-500/10 rounded-full blur-3xl animate-bounce delay-1000"}),_.jsx("div",{className:"absolute top-1/2 left-1/2 w-64 h-64 bg-purple-500/10 rounded-full blur-3xl animate-ping"})]}),_.jsx("div",{className:"relative z-10 bg-black/30 backdrop-blur-lg border-b border-white/20 px-6 py-4",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center space-x-4",children:[_.jsx("button",{onClick:Oi,className:"p-2 hover:bg-white/10 rounded-full transition-all duration-300",children:_.jsx(hh,{className:"w-6 h-6 text-white"})}),_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:`w-3 h-3 rounded-full absolute -top-1 -right-1 z-10 ${oe?"bg-green-500 animate-pulse":"bg-yellow-500"}`}),_.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:_.jsx(u4,{className:"w-6 h-6 text-white"})})]}),_.jsxs("div",{children:[_.jsx("h2",{className:"text-white font-semibold text-lg",children:o||"Unknown User"}),_.jsxs("div",{className:"flex items-center space-x-2 text-white/80 text-sm",children:[_.jsx("span",{className:`w-2 h-2 rounded-full ${A==="Connected"?"bg-green-500":A==="Calling..."?"bg-yellow-500":"bg-red-500"}`}),_.jsx("span",{children:A}),oe&&N&&_.jsxs(_.Fragment,{children:[_.jsx("span",{children:""}),_.jsx("span",{className:"font-mono",children:ki(U)})]})]})]})]})]}),_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsxs("div",{className:"flex items-center space-x-1 bg-black/30 px-3 py-1 rounded-full",children:[_.jsx(PT,{className:"w-4 h-4 text-green-400"}),_.jsx("span",{className:"text-white text-sm",children:"Good"})]}),_.jsx("button",{onClick:Kt,className:"p-2 hover:bg-white/10 rounded-full transition-all duration-300",children:B?_.jsx(XU,{className:"w-5 h-5 text-white"}):_.jsx(JU,{className:"w-5 h-5 text-white"})})]})]})}),_.jsx("div",{className:"flex-1 relative",children:r?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"w-full h-full bg-black relative",children:[N&&j?_.jsx("video",{ref:Gt,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0}):_.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-gray-900 to-black",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mb-4",children:_.jsx(dh,{className:"w-16 h-16 text-white"})}),_.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:_.jsx(hm,{className:"w-4 h-4 text-white"})})]}),_.jsx("p",{className:"text-white/70 text-lg",children:"Camera is off"})]}),oe&&_.jsx("div",{className:"absolute top-4 left-4 bg-black/50 backdrop-blur-sm px-3 py-1 rounded-full",children:_.jsxs("span",{className:"text-white text-sm font-medium capitalize",children:[be,"  ",he]})})]}),T&&F&&_.jsxs("div",{className:"absolute top-4 right-4 w-48 h-36 bg-black rounded-2xl overflow-hidden border-2 border-white/30 shadow-2xl transition-all duration-300 hover:scale-105",children:[_.jsx("video",{ref:Je,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0,style:{transform:O?"scaleX(1)":"scaleX(-1)"}}),_.jsxs("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1",children:[_.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),_.jsx("div",{className:"text-white text-xs font-medium",children:"You"})]})]})]}):_.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-purple-900 via-pink-800 to-red-700",children:[_.jsxs("div",{className:"relative mb-8",children:[_.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full animate-ping"}),_.jsx("div",{className:"relative w-48 h-48 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center border-4 border-white/30 shadow-2xl",children:_.jsx(dh,{className:"w-24 h-24 text-white"})}),_.jsx("div",{className:"absolute -bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-1",children:[1,2,3,2,1].map((Ce,Pe)=>_.jsx("div",{className:"w-1 bg-green-400 rounded-full animate-pulse",style:{height:`${Ce*8}px`,animationDelay:`${Pe*.2}s`}},Pe))})]}),_.jsx("h3",{className:"text-white text-2xl font-semibold mb-2",children:o||"Unknown User"}),_.jsx("p",{className:"text-white/70 text-lg",children:"Audio Call in Progress"}),_.jsx("div",{className:"mt-6 flex space-x-1",children:[...Array(8)].map((Ce,Pe)=>_.jsx("div",{className:"w-2 bg-green-400 rounded-full animate-pulse",style:{height:`${Math.random()*20+8}px`,animationDelay:`${Pe*.1}s`}},Pe))})]})}),_.jsxs("div",{className:"relative z-10 bg-black/30 backdrop-blur-lg border-t border-white/20 px-6 py-6",children:[!T&&_.jsx("div",{className:"flex justify-center",children:_.jsxs("button",{className:"flex items-center space-x-3 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-8 py-4 rounded-2xl font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-2xl",onClick:Ze,children:[_.jsx(fh,{className:"w-6 h-6"}),_.jsx("span",{children:"Grant Permissions"})]})}),T&&!oe&&_.jsx("div",{className:"flex justify-center",children:_.jsxs("button",{className:"flex items-center space-x-3 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white px-8 py-4 rounded-2xl font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-2xl animate-pulse",onClick:()=>_e(i),children:[_.jsx(my,{className:"w-6 h-6"}),_.jsx("span",{children:"Start Call"})]})}),oe&&_.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[_.jsxs("button",{className:`flex flex-col items-center justify-center w-16 h-16 rounded-2xl transition-all duration-300 transform hover:scale-110 ${Y?"bg-red-500 hover:bg-red-600 text-white":"bg-white/20 hover:bg-white/30 text-white backdrop-blur-sm"}`,onClick:pt,children:[Y?_.jsx(a4,{className:"w-7 h-7"}):_.jsx(o4,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:Y?"Unmute":"Mute"})]}),r&&_.jsxs("button",{className:`flex flex-col items-center justify-center w-16 h-16 rounded-2xl transition-all duration-300 transform hover:scale-110 ${F?"bg-white/20 hover:bg-white/30 text-white backdrop-blur-sm":"bg-red-500 hover:bg-red-600 text-white"}`,onClick:Xt,children:[F?_.jsx(fh,{className:"w-7 h-7"}):_.jsx(hm,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:"Video"})]}),_.jsxs("button",{className:"flex flex-col items-center justify-center w-20 h-20 bg-red-500 hover:bg-red-600 text-white rounded-full transition-all duration-300 transform hover:scale-110 hover:shadow-2xl",onClick:Oi,children:[_.jsx(py,{className:"w-8 h-8"}),_.jsx("span",{className:"text-xs mt-1",children:"End"})]}),r&&_.jsxs("button",{className:"flex flex-col items-center justify-center w-16 h-16 bg-white/20 hover:bg-white/30 text-white rounded-2xl backdrop-blur-sm transition-all duration-300 transform hover:scale-110",onClick:Et,children:[_.jsx(e4,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:"Flip"})]}),r&&oe&&_.jsxs("button",{className:"flex flex-col items-center justify-center w-16 h-16 bg-white/20 hover:bg-white/30 text-white rounded-2xl backdrop-blur-sm transition-all duration-300 transform hover:scale-110",onClick:()=>{dt(be==="hd"?"full-hd":be==="full-hd"?"4k":"hd")},children:[_.jsx(c4,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:"Quality"})]}),_.jsxs("button",{className:"flex flex-col items-center justify-center w-16 h-16 bg-white/20 hover:bg-white/30 text-white rounded-2xl backdrop-blur-sm transition-all duration-300 transform hover:scale-110",onClick:()=>je(!ke),children:[_.jsx($U,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:"Settings"})]})]}),ke&&_.jsx("div",{className:"absolute bottom-24 left-1/2 transform -translate-x-1/2 bg-black/80 backdrop-blur-lg rounded-2xl p-4 border border-white/20 min-w-48",children:_.jsxs("div",{className:"space-y-3",children:[_.jsx("div",{className:"text-white font-semibold text-center mb-2",children:"Settings"}),_.jsxs("div",{className:"space-y-2",children:[_.jsx("div",{className:"text-white/70 text-sm",children:"Video Quality"}),_.jsx("div",{className:"flex space-x-2",children:["hd","full-hd","4k"].map(Ce=>_.jsx("button",{className:`flex-1 py-2 rounded-lg text-xs font-medium transition-all duration-200 ${be===Ce?"bg-purple-500 text-white":"bg-white/10 text-white/70 hover:bg-white/20"}`,onClick:()=>dt(Ce),children:Ce.toUpperCase()},Ce))})]}),_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("span",{className:"text-white/70 text-sm",children:"Network"}),_.jsxs("div",{className:"flex items-center space-x-1",children:[_.jsx(PT,{className:"w-4 h-4 text-green-400"}),_.jsx("span",{className:"text-white text-sm",children:"Good"})]})]})]})})]})]})}const{RTCPeerConnection:e7}=window,t7={HD:{width:1280,height:720,frameRate:30,bitrate:25e5},FULL_HD:{width:1920,height:1080,frameRate:30,bitrate:4e6},UHD_4K:{width:3840,height:2160,frameRate:30,bitrate:8e6}},n7={iceServers:[{urls:"stun:stun.relay.metered.ca:80"},{urls:"turn:159.223.175.154:3478",username:"user",credential:"password"},{urls:"turn:95.217.13.89:3478",username:"user",credential:"password"}],iceCandidatePoolSize:10};function i7(){const n=cs(),t=vr().state||{},{roomId:i,peerEmail:r,remoteAccessToken:o,remoteFCMToken:c,avatar:h,isVideoCall:f=!0}=t,[m,v]=P.useState(null),[w,T]=P.useState(null),[x,N]=P.useState(null),[L,O]=P.useState(!0),[Z,Y]=P.useState(!1),[H,le]=P.useState(!1),[ve,oe]=P.useState(!1),[I,A]=P.useState("Joining..."),[R,U]=P.useState(0),[V,F]=P.useState(!0),[k,ge]=P.useState(null),[Se,j]=P.useState(f),[G,ie]=P.useState("FULL_HD"),[me,be]=P.useState("good"),D=P.useRef(null),B=P.useRef([]),ee=P.useRef(null),he=P.useRef(null),ye=P.useRef(null),ke=async(_e,We,Et,pt,Xt={})=>{const dt="https://fcm.googleapis.com/v1/projects/hiddo-3887f/messages:send",Kt={message:{token:_e,data:{title:We,body:Et,...Xt}}};try{const Oi=await(await fetch(dt,{method:"POST",headers:{"Content-Type":"application/json",Authorization:pt},body:JSON.stringify(Kt)})).json();console.log("FCM Response:",Oi)}catch(In){console.error("FCM Error:",In)}},je=async()=>{try{console.log("Cleaning up connections..."),mt(),ye.current&&(ye.current.pause(),ye.current=null),D.current&&clearInterval(D.current),B.current&&B.current.length>0&&(B.current.forEach(_e=>{typeof _e=="function"&&_e()}),B.current=[]),m&&m.getTracks().forEach(_e=>{_e.stop(),_e.enabled=!1}),x&&(x.close(),N(null)),T(null),le(!1),U(0),A("Call Ended"),console.log("Connections cleaned up successfully")}catch(_e){console.error("Error during cleanup:",_e)}},mt=()=>{ye.current&&(ye.current.pause(),ye.current.currentTime=0,console.log("Ringtone stopped"))};P.useEffect(()=>{if(!r)return;console.log(" Subscribing to Supabase Realtime...");const _e=Te.channel("peer-video-status").on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`email=eq.${r}`},pt=>{const Xt=pt.new?.isvideoon;console.log(" Peer video status updated:",Xt),ge(!!Xt)}).subscribe(),We=Te.channel("current-user-videoCall").on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`email=eq.${Ye?.currentUser?.email}`},pt=>{const Xt=pt.new?.isvideocall;console.log(" Video call type updated:",Xt),j(!!Xt)}).subscribe(),Et=Te.channel("peer-hangup").on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`email=eq.${r}`},pt=>{const Xt=pt.new?.iscallerhangup;console.log(" Peer hangup status:",Xt),Xt===!0&&te()}).subscribe();return()=>{console.log(" Unsubscribing Supabase Realtime..."),Te.removeChannel(_e),Te.removeChannel(We),Te.removeChannel(Et)}},[r]);const te=()=>{if(window.confirm("Call Ended - Call hangup by User"))try{je(),n(-1),Te.from("users").update({iscallerhangup:!1}).eq("email",r)}catch(_e){console.error(" Exception in hangup update:",_e)}};P.useEffect(()=>(H&&w?D.current=setInterval(()=>{U(_e=>_e+1)},1e3):D.current&&clearInterval(D.current),()=>{D.current&&clearInterval(D.current)}),[H,w]),P.useEffect(()=>{m&&!H&&Lt()},[m]),P.useEffect(()=>(Je(),()=>{je()}),[]);const we=_e=>{const We=Math.floor(_e/60),Et=_e%60;return`${We.toString().padStart(2,"0")}:${Et.toString().padStart(2,"0")}`},Je=async()=>{try{const _e=await navigator.mediaDevices.getUserMedia({audio:!0,video:Se});return oe(!0),v(_e),!0}catch(_e){return console.log("Permission error:",_e),oe(!1),!1}},Gt=async()=>{try{const _e=t7[G],We={audio:{channelCount:1,echoCancellation:!0,noiseSuppression:!0,sampleRate:48e3,sampleSize:16,autoGainControl:!0},video:Se?{width:{ideal:_e.width},height:{ideal:_e.height},frameRate:{ideal:_e.frameRate},facingMode:L?"user":"environment"}:!1},Et=await navigator.mediaDevices.getUserMedia(We);v(Et),ee.current&&(ee.current.srcObject=Et)}catch(_e){console.log("Error starting local stream:",_e),(G==="UHD_4K"||G==="FULL_HD")&&(console.log("Trying HD quality as fallback..."),ie("HD"),setTimeout(()=>Gt(),500))}},Qt=async _e=>{G!==_e&&(ie(_e),m&&(m.getTracks().forEach(We=>We.stop()),v(null)),await Gt())},Lt=async()=>{if(!m){console.log("Local stream not ready yet!");return}le(!0),A("Connecting...");try{const _e=new e7(n7);m.getTracks().forEach(We=>{_e.addTrack(We,m)}),_e.ontrack=We=>{if(We.streams&&We.streams[0]){const Et=We.streams[0];T(Et),he.current&&(he.current.srcObject=Et),A("Connected"),mt()}},_e.onicecandidate=We=>{We.candidate&&console.log("ICE candidate generated")},_e.onconnectionstatechange=()=>{console.log("PC state:",_e.connectionState),["failed","disconnected","closed"].includes(_e.connectionState)&&(A("Disconnected"),An())},N(_e);try{const{error:We}=await Te.from("users").update({isoncallstatus:!0}).eq("email",r);if(We)throw We;const{error:Et}=await Te.from("users").update({isvideoon:!0,isoncallstatus:!0}).eq("email",Ye?.currentUser?.email);if(Et)throw Et;console.log(" Call status updated successfully")}catch(We){console.log(" User flag update error:",We)}}catch(_e){console.log("joinCall error:",_e),A("Connection Failed"),mt(),je()}},An=()=>{window.confirm("Call Disconnected - The call has ended")&&rn()},rn=async()=>{console.log("Ending call for:",r);try{const{error:_e}=await Te.from("users").update({iscallingfrom:"",isoncallstatus:!1}).eq("email",Ye.currentUser?.email);if(_e)throw _e;const{error:We}=await Te.from("users").update({isoncallstatus:!1}).eq("email",r);if(We)throw We;ke(c,"Call Ended",Ye?.currentUser?.email,o,{Peeremail:Ye?.currentUser?.email,type:"Reject_Call"}),await je(),n(-1),console.log(" Call ended successfully")}catch(_e){console.log(" Error ending call:",_e)}},ki=async()=>{if(!(!Se||!m))try{const _e=m.getVideoTracks()[0],We={video:{width:{ideal:1280},height:{ideal:720},facingMode:L?"environment":"user"}},Et=await navigator.mediaDevices.getUserMedia(We),pt=Et.getVideoTracks()[0],Xt=x?.getSenders().find(dt=>dt.track&&dt.track.kind==="video");Xt&&await Xt.replaceTrack(pt),_e.stop(),m.removeTrack(_e),m.addTrack(pt),ee.current&&(ee.current.srcObject=m),O(!L),Et.getTracks().forEach(dt=>{dt.kind==="audio"&&dt.stop()})}catch(_e){console.log("Error switching camera:",_e)}},Ze=()=>{m&&(m.getAudioTracks().forEach(_e=>{_e.enabled=!_e.enabled}),Y(!Z))},gt=async()=>{if(!(!Se||!m))try{m.getVideoTracks().forEach(async _e=>{_e.enabled=!_e.enabled,F(_e.enabled);const{error:We}=await Te.from("users").update({isvideoon:_e.enabled}).eq("email",Ye?.currentUser?.email);We&&console.error("Error updating video status:",We)})}catch(_e){console.error("toggleVideo error:",_e)}},Ct=()=>Se?_.jsxs("div",{className:"relative w-full h-full bg-gray-900",children:[_.jsx("div",{className:"absolute inset-0",children:w&&k?_.jsx("video",{ref:he,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0}):_.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gray-900 text-gray-400",children:[_.jsx(hm,{className:"w-16 h-16 mb-4 opacity-50"}),_.jsx("p",{className:"text-lg",children:"Camera Off"})]})}),m&&V&&_.jsxs("div",{className:"absolute top-4 right-4 w-48 h-64 bg-black rounded-2xl overflow-hidden border-2 border-white/30 shadow-2xl z-10",children:[_.jsx("video",{ref:ee,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0,style:{transform:L?"scaleX(1)":"scaleX(-1)"}}),_.jsxs("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex items-center space-x-1 bg-black/50 px-2 py-1 rounded-full",children:[_.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),_.jsx("span",{className:"text-white text-xs font-medium",children:"You"})]})]}),H&&_.jsx("div",{className:"absolute top-4 left-4 bg-black/50 backdrop-blur-sm px-3 py-1 rounded-full",children:_.jsxs("span",{className:"text-white text-sm font-medium capitalize",children:[G,"  ",me]})})]}):_.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-purple-900 via-blue-900 to-gray-900",children:_.jsxs("div",{className:"text-center",children:[_.jsxs("div",{className:"relative mb-8",children:[_.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full animate-ping"}),_.jsx("div",{className:"relative w-48 h-48 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center border-4 border-white/20 shadow-2xl overflow-hidden",children:h?_.jsx("img",{src:h,alt:"Caller",className:"w-full h-full object-cover"}):_.jsx(dh,{className:"w-20 h-20 text-white"})}),_.jsx("div",{className:"absolute -bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-1",children:[1,2,3,2,1].map((_e,We)=>_.jsx("div",{className:"w-1 bg-green-400 rounded-full animate-pulse",style:{height:`${_e*8}px`,animationDelay:`${We*.2}s`}},We))})]}),_.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-white mb-2",children:r||"Unknown User"}),_.jsx("p",{className:"text-gray-300 text-lg mb-2",children:I}),H&&w&&_.jsx("p",{className:"text-white text-xl font-semibold",children:we(R)})]})});return _.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex flex-col relative overflow-hidden",children:[_.jsx("div",{className:"relative z-20 bg-black/30 backdrop-blur-lg border-b border-white/20 px-6 py-4",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center space-x-4",children:[_.jsx("button",{onClick:rn,className:"p-2 hover:bg-white/10 rounded-full transition-all duration-300",children:_.jsx(hh,{className:"w-6 h-6 text-white"})}),_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:`w-3 h-3 rounded-full absolute -top-1 -right-1 z-10 ${H?"bg-green-500 animate-pulse":"bg-yellow-500"}`}),_.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:_.jsx(u4,{className:"w-6 h-6 text-white"})})]}),_.jsxs("div",{children:[_.jsx("h2",{className:"text-white font-semibold text-lg",children:r||"Unknown User"}),_.jsxs("div",{className:"flex items-center space-x-2 text-white/80 text-sm",children:[_.jsx("span",{className:`w-2 h-2 rounded-full ${I==="Connected"?"bg-green-500":I==="Connecting..."?"bg-yellow-500":"bg-red-500"}`}),_.jsx("span",{children:I}),H&&w&&_.jsxs(_.Fragment,{children:[_.jsx("span",{children:""}),_.jsx("span",{className:"font-mono",children:we(R)})]})]})]})]})]}),_.jsx("div",{className:"flex items-center space-x-3",children:_.jsxs("div",{className:"flex items-center space-x-1 bg-black/30 px-3 py-1 rounded-full",children:[_.jsx(SU,{className:"w-4 h-4 text-green-400"}),_.jsx("span",{className:"text-white text-sm",children:"Good"})]})})]})}),_.jsx("div",{className:"flex-1 relative",children:Ct()}),_.jsx("div",{className:"relative z-20 bg-black/30 backdrop-blur-lg border-t border-white/20 px-6 py-6",children:H?_.jsxs("div",{className:"flex justify-center items-center space-x-4 lg:space-x-6",children:[_.jsxs("button",{className:`flex flex-col items-center justify-center w-16 h-16 rounded-2xl transition-all duration-300 transform hover:scale-110 ${Z?"bg-red-500 hover:bg-red-600 text-white":"bg-white/20 hover:bg-white/30 text-white backdrop-blur-sm"}`,onClick:Ze,children:[Z?_.jsx(a4,{className:"w-7 h-7"}):_.jsx(o4,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:Z?"Unmute":"Mute"})]}),Se&&_.jsxs("button",{className:`flex flex-col items-center justify-center w-16 h-16 rounded-2xl transition-all duration-300 transform hover:scale-110 ${V?"bg-white/20 hover:bg-white/30 text-white backdrop-blur-sm":"bg-red-500 hover:bg-red-600 text-white"}`,onClick:gt,children:[V?_.jsx(fh,{className:"w-7 h-7"}):_.jsx(hm,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:"Video"})]}),_.jsxs("button",{className:"flex flex-col items-center justify-center w-20 h-20 bg-red-500 hover:bg-red-600 text-white rounded-full transition-all duration-300 transform hover:scale-110 hover:shadow-2xl",onClick:rn,children:[_.jsx(py,{className:"w-8 h-8"}),_.jsx("span",{className:"text-xs mt-1",children:"End"})]}),Se&&_.jsxs("button",{className:"flex flex-col items-center justify-center w-16 h-16 bg-white/20 hover:bg-white/30 text-white rounded-2xl backdrop-blur-sm transition-all duration-300 transform hover:scale-110",onClick:ki,children:[_.jsx(e4,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:"Flip"})]}),Se&&_.jsxs("button",{className:"flex flex-col items-center justify-center w-16 h-16 bg-white/20 hover:bg-white/30 text-white rounded-2xl backdrop-blur-sm transition-all duration-300 transform hover:scale-110",onClick:()=>{const _e=["HD","FULL_HD","UHD_4K"],Et=(_e.indexOf(G)+1)%_e.length;Qt(_e[Et])},children:[_.jsx(c4,{className:"w-7 h-7"}),_.jsx("span",{className:"text-xs mt-1",children:G})]})]}):_.jsx("div",{className:"flex justify-center",children:m?_.jsxs("button",{className:"flex items-center space-x-3 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white px-8 py-4 rounded-2xl font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-2xl animate-pulse",onClick:Lt,children:[_.jsx(my,{className:"w-6 h-6"}),_.jsx("span",{children:"Join Call"})]}):_.jsxs("button",{className:"flex items-center space-x-3 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-2xl",onClick:Je,children:[_.jsx(fh,{className:"w-6 h-6"}),_.jsx("span",{children:"Grant Permissions"})]})})}),_.jsx("style",{jsx:!0,children:`
        @keyframes ping {
          0% {
            transform: scale(1);
            opacity: 1;
          }
          75%, 100% {
            transform: scale(2);
            opacity: 0;
          }
        }
        
        .animate-ping {
          animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        
        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
          .animate-ping,
          .transition-all,
          .transform {
            animation: none;
            transition: none;
          }
        }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
          .w-48.h-64 {
            width: 8rem;
            height: 10rem;
          }
          
          .space-x-4 {
            gap: 1rem;
          }
          
          .w-16.h-16 {
            width: 4rem;
            height: 4rem;
          }
          
          .w-20.h-20 {
            width: 5rem;
            height: 5rem;
          }
        }
        
        @media (max-width: 480px) {
          .w-48.h-64 {
            width: 6rem;
            height: 8rem;
          }
          
          .space-x-4 {
            gap: 0.5rem;
          }
          
          .w-16.h-16 {
            width: 3.5rem;
            height: 3.5rem;
          }
          
          .w-20.h-20 {
            width: 4rem;
            height: 4rem;
          }
        }
      `})]})}const s7=({callerName:n,callerImage:e,onAccept:t,onReject:i,isVideoCall:r=!1,ringtone:o,stopRingtone:c})=>{const[h,f]=P.useState(1),[m,v]=P.useState(0),[w,T]=P.useState(1),[x,N]=P.useState(1),[L,O]=P.useState(100),[Z,Y]=P.useState(0),[H,le]=P.useState(0),ve=P.useRef(null),oe=P.useRef(null),I=P.useRef(!1);P.useEffect(()=>(U(),V(),F(),o&&(I.current=!0,o.play().then(()=>{console.log("Ringtone played successfully")}).catch(ie=>{console.log("Ringtone playback failed:",ie),I.current=!1})),navigator.vibrate&&(oe.current=setInterval(()=>{navigator.vibrate(1e3)},2e3)),()=>{ve.current&&cancelAnimationFrame(ve.current),clearInterval(oe.current),navigator.vibrate&&navigator.vibrate(0),A()}),[]);const A=()=>{o&&I.current&&(o.pause(),o.currentTime=0,console.log("Ringtone stopped"),I.current=!1)},R=ie=>{clearInterval(oe.current),navigator.vibrate&&navigator.vibrate(0),A(),ie&&ie()},U=()=>{let ie=null,me=1,be=1;const D=B=>{ie||(ie=B);const ee=B-ie;ee>1500&&(me*=-1,ie=B);const he=ee/1500;f(1+(me>0?he*.05:.05-he*.05)),ee>2e3&&(be*=-1,ie=B);const ye=ee/2e3;v(be>0?ye:1-ye),ve.current=requestAnimationFrame(D)};ve.current=requestAnimationFrame(D)},V=()=>{const me=Date.now(),be=()=>{const D=Date.now()-me,B=Math.min(D/800,1),ee=1-Math.pow(1-B,3),he=B;O(100*(1-ee)),Y(he),B<1&&requestAnimationFrame(be)};requestAnimationFrame(be)},F=()=>{let ie=1,me=null;const be=D=>{me||(me=D);const B=D-me;B>1e3&&(ie*=-1,me=D);const ee=B/1e3;le(ie>0?ee:1-ee),requestAnimationFrame(be)};requestAnimationFrame(be)},k=ie=>{ie(.9)},ge=(ie,me)=>{ie(1),setTimeout(()=>{me&&R(me)},150)},Se={backgroundColor:`rgba(0, 0, 0, ${.7-m*.3})`},j=1+H*.2,G=.7-H*.7;return _.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-5 incoming-call-overlay",children:[_.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600 via-pink-600 to-red-500 transition-colors duration-100",style:Se}),_.jsx("div",{className:"relative w-full max-w-md flex items-center justify-center",children:_.jsxs("div",{className:"w-full flex flex-col items-center text-center relative z-10 transition-all duration-300 ease-out",style:{opacity:Z,transform:`translateY(${L}px)`},children:[_.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center pointer-events-none",children:[0,1,2].map(ie=>_.jsx("div",{className:`absolute border-2 border-white/20 rounded-full animate-ping ${ie===0?"w-44 h-44":ie===1?"w-52 h-52":"w-60 h-60"}`,style:{transform:`scale(${j})`,opacity:G,borderWidth:ie===0?"2px":ie===1?"3px":"4px",animationDelay:`${ie*.2}s`,animationDuration:"2s"}},ie))}),_.jsx("div",{className:"mb-8",children:_.jsx("p",{className:"text-lg text-white/80 font-light tracking-wider uppercase mb-8",children:"Incoming Call"})}),_.jsx("div",{className:"mb-6 relative",children:_.jsxs("div",{className:"w-32 h-32 bg-white rounded-full shadow-2xl overflow-hidden relative transition-transform duration-200",style:{transform:`scale(${h})`},children:[e?_.jsx("img",{src:e,alt:n||"Caller",className:"w-full h-full object-cover rounded-full",onError:ie=>{ie.target.style.display="none"}}):_.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center",children:_.jsx(dh,{className:"w-12 h-12 text-white"})}),_.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-black/30 rounded-full"})]})}),_.jsxs("div",{className:"mb-12",children:[_.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-white mb-2 text-shadow-lg",children:n||"Unknown Caller"}),_.jsx("p",{className:"text-base text-white/70 font-normal",children:r?"Video Call":"Voice Call"})]}),_.jsxs("div",{className:"flex justify-center space-x-10 lg:space-x-12 w-full max-w-xs",children:[_.jsx("div",{className:"transition-transform duration-200",style:{transform:`scale(${w})`},children:_.jsx("button",{className:"w-20 h-20 lg:w-24 lg:h-24 rounded-full border-none cursor-pointer p-0 overflow-hidden shadow-2xl hover:shadow-3xl transition-all duration-300 hover:-translate-y-1 active:translate-y-0",onMouseDown:()=>k(T),onMouseUp:()=>ge(T,i),onMouseLeave:()=>T(1),onTouchStart:()=>k(T),onTouchEnd:()=>ge(T,i),children:_.jsxs("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-red-500 to-red-600 flex flex-col items-center justify-center text-white",children:[_.jsx(py,{className:"w-8 h-8 lg:w-10 lg:h-10 mb-1"}),_.jsx("span",{className:"text-xs font-semibold mt-1",children:"Decline"})]})})}),_.jsx("div",{className:"transition-transform duration-200",style:{transform:`scale(${x})`},children:_.jsx("button",{className:"w-20 h-20 lg:w-24 lg:h-24 rounded-full border-none cursor-pointer p-0 overflow-hidden shadow-2xl hover:shadow-3xl transition-all duration-300 hover:-translate-y-1 active:translate-y-0",onMouseDown:()=>k(N),onMouseUp:()=>ge(N,t),onMouseLeave:()=>N(1),onTouchStart:()=>k(N),onTouchEnd:()=>ge(N,t),children:_.jsxs("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-green-500 to-green-600 flex flex-col items-center justify-center text-white",children:[r?_.jsx(fh,{className:"w-8 h-8 lg:w-10 lg:h-10 mb-1"}):_.jsx(my,{className:"w-8 h-8 lg:w-10 lg:h-10 mb-1"}),_.jsx("span",{className:"text-xs font-semibold mt-1",children:r?"Video":"Audio"})]})})})]}),r&&_.jsxs("div",{className:"mt-8 flex items-center px-4 py-3 bg-white/10 backdrop-blur-lg rounded-2xl border border-white/20 transition-opacity duration-300",style:{opacity:Z},children:[_.jsx(dU,{className:"w-5 h-5 text-white/70 mr-2 animate-bounce"}),_.jsx("span",{className:"text-white/70 text-sm font-medium",children:"Click to answer with video"})]})]})}),_.jsx("style",{jsx:!0,children:`
        .text-shadow-lg {
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .shadow-3xl {
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        @keyframes ping {
          0%, 100% {
            transform: scale(1);
            opacity: 0.7;
          }
          50% {
            transform: scale(1.2);
            opacity: 0;
          }
        }
        
        .animate-ping {
          animation: ping 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes bounce {
          0%, 20%, 50%, 80%, 100% {
            transform: translateY(0);
          }
          40% {
            transform: translateY(-5px);
          }
          60% {
            transform: translateY(-3px);
          }
        }
        
        .animate-bounce {
          animation: bounce 2s infinite;
        }
        
        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
          .animate-ping,
          .animate-bounce,
          .transition-all {
            animation: none;
            transition: none;
          }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
          .incoming-call-overlay {
            background: linear-gradient(135deg, #2D3748 0%, #4A5568 100%);
          }
        }
        
        /* High contrast support */
        @media (prefers-contrast: high) {
          .text-white\\/80,
          .text-white\\/70 {
            color: white;
          }
        }
        
        /* Mobile responsiveness */
        @media (max-width: 480px) {
          .w-32.h-32 {
            width: 6rem;
            height: 6rem;
          }
          
          .text-3xl {
            font-size: 1.75rem;
          }
          
          .space-x-10 {
            gap: 2.5rem;
          }
          
          .w-20.h-20 {
            width: 5rem;
            height: 5rem;
          }
        }
        
        @media (max-width: 320px) {
          .text-3xl {
            font-size: 1.5rem;
          }
          
          .space-x-10 {
            gap: 2rem;
          }
          
          .w-20.h-20 {
            width: 4rem;
            height: 4rem;
          }
        }
      `})]})},h4="@firebase/installations",gy="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4=1e4,f4=`w:${gy}`,m4="FIS_v2",r7="https://firebaseinstallations.googleapis.com/v1",a7=3600*1e3,o7="installations",l7="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c7={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ao=new Ro(o7,l7,c7);function p4(n){return n instanceof Ns&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4({projectId:n}){return`${r7}/projects/${n}/installations`}function _4(n){return{token:n.token,requestStatus:2,expiresIn:h7(n.expiresIn),creationTime:Date.now()}}async function v4(n,e){const i=(await e.json()).error;return Ao.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function y4({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function u7(n,{refreshToken:e}){const t=y4(n);return t.append("Authorization",d7(e)),t}async function w4(n){const e=await n();return e.status>=500&&e.status<600?n():e}function h7(n){return Number(n.replace("s","000"))}function d7(n){return`${m4} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f7({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=g4(n),r=y4(n),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&r.append("x-firebase-client",m)}const c={fid:t,authVersion:m4,appId:n.appId,sdkVersion:f4},h={method:"POST",headers:r,body:JSON.stringify(c)},f=await w4(()=>fetch(i,h));if(f.ok){const m=await f.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:_4(m.authToken)}}else throw await v4("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m7(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p7=/^[cdef][\w-]{21}$/,M0="";function g7(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=_7(n);return p7.test(t)?t:M0}catch{return M0}}function _7(n){return m7(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4=new Map;function T4(n,e){const t=$m(n);S4(t,e),v7(t,e)}function S4(n,e){const t=E4.get(n);if(t)for(const i of t)i(e)}function v7(n,e){const t=y7();t&&t.postMessage({key:n,fid:e}),w7()}let _o=null;function y7(){return!_o&&"BroadcastChannel"in self&&(_o=new BroadcastChannel("[Firebase] FID Change"),_o.onmessage=n=>{S4(n.data.key,n.data.fid)}),_o}function w7(){E4.size===0&&_o&&(_o.close(),_o=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b7="firebase-installations-database",E7=1,Io="firebase-installations-store";let N_=null;function _y(){return N_||(N_=_m(b7,E7,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Io)}}})),N_}async function dm(n,e){const t=$m(n),r=(await _y()).transaction(Io,"readwrite"),o=r.objectStore(Io),c=await o.get(t);return await o.put(e,t),await r.done,(!c||c.fid!==e.fid)&&T4(n,e.fid),e}async function x4(n){const e=$m(n),i=(await _y()).transaction(Io,"readwrite");await i.objectStore(Io).delete(e),await i.done}async function Gm(n,e){const t=$m(n),r=(await _y()).transaction(Io,"readwrite"),o=r.objectStore(Io),c=await o.get(t),h=e(c);return h===void 0?await o.delete(t):await o.put(h,t),await r.done,h&&(!c||c.fid!==h.fid)&&T4(n,h.fid),h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vy(n){let e;const t=await Gm(n.appConfig,i=>{const r=T7(i),o=S7(n,r);return e=o.registrationPromise,o.installationEntry});return t.fid===M0?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function T7(n){const e=n||{fid:g7(),registrationStatus:0};return C4(e)}function S7(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(Ao.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=x7(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:C7(n)}:{installationEntry:e}}async function x7(n,e){try{const t=await f7(n,e);return dm(n.appConfig,t)}catch(t){throw p4(t)&&t.customData.serverCode===409?await x4(n.appConfig):await dm(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function C7(n){let e=await MT(n.appConfig);for(;e.registrationStatus===1;)await b4(100),e=await MT(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await vy(n);return i||t}return e}function MT(n){return Gm(n,e=>{if(!e)throw Ao.create("installation-not-found");return C4(e)})}function C4(n){return A7(n)?{fid:n.fid,registrationStatus:0}:n}function A7(n){return n.registrationStatus===1&&n.registrationTime+d4<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I7({appConfig:n,heartbeatServiceProvider:e},t){const i=R7(n,t),r=u7(n,t),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&r.append("x-firebase-client",m)}const c={installation:{sdkVersion:f4,appId:n.appId}},h={method:"POST",headers:r,body:JSON.stringify(c)},f=await w4(()=>fetch(i,h));if(f.ok){const m=await f.json();return _4(m)}else throw await v4("Generate Auth Token",f)}function R7(n,{fid:e}){return`${g4(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yy(n,e=!1){let t;const i=await Gm(n.appConfig,o=>{if(!A4(o))throw Ao.create("not-registered");const c=o.authToken;if(!e&&O7(c))return o;if(c.requestStatus===1)return t=N7(n,e),o;{if(!navigator.onLine)throw Ao.create("app-offline");const h=j7(o);return t=k7(n,h),h}});return t?await t:i.authToken}async function N7(n,e){let t=await LT(n.appConfig);for(;t.authToken.requestStatus===1;)await b4(100),t=await LT(n.appConfig);const i=t.authToken;return i.requestStatus===0?yy(n,e):i}function LT(n){return Gm(n,e=>{if(!A4(e))throw Ao.create("not-registered");const t=e.authToken;return P7(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function k7(n,e){try{const t=await I7(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await dm(n.appConfig,i),t}catch(t){if(p4(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await x4(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await dm(n.appConfig,i)}throw t}}function A4(n){return n!==void 0&&n.registrationStatus===2}function O7(n){return n.requestStatus===2&&!D7(n)}function D7(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+a7}function j7(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function P7(n){return n.requestStatus===1&&n.requestTime+d4<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M7(n){const e=n,{installationEntry:t,registrationPromise:i}=await vy(e);return i?i.catch(console.error):yy(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L7(n,e=!1){const t=n;return await U7(t),(await yy(t,e)).token}async function U7(n){const{registrationPromise:e}=await vy(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V7(n){if(!n||!n.options)throw k_("App Configuration");if(!n.name)throw k_("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw k_(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function k_(n){return Ao.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="installations",z7="installations-internal",B7=n=>{const e=n.getProvider("app").getImmediate(),t=V7(e),i=No(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},F7=n=>{const e=n.getProvider("app").getImmediate(),t=No(e,I4).getImmediate();return{getId:()=>M7(t),getToken:r=>L7(t,r)}};function q7(){os(new Hi(I4,B7,"PUBLIC")),os(new Hi(z7,F7,"PRIVATE"))}q7();_i(h4,gy);_i(h4,gy,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H7="/firebase-messaging-sw.js",$7="/firebase-cloud-messaging-push-scope",R4="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",G7="https://fcmregistrations.googleapis.com/v1",N4="google.c.a.c_id",K7="google.c.a.c_l",W7="google.c.a.ts",Y7="google.c.a.e";var UT;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(UT||(UT={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var mh;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(mh||(mh={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Q7(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),r=new Uint8Array(i.length);for(let o=0;o<i.length;++o)r[o]=i.charCodeAt(o);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="fcm_token_details_db",X7=5,VT="fcm_token_object_Store";async function J7(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(O_))return null;let e=null;return(await _m(O_,X7,{upgrade:async(i,r,o,c)=>{var h;if(r<2||!i.objectStoreNames.contains(VT))return;const f=c.objectStore(VT),m=await f.index("fcmSenderId").get(n);if(await f.clear(),!!m){if(r===2){const v=m;if(!v.auth||!v.p256dh||!v.endpoint)return;e={token:v.fcmToken,createTime:(h=v.createTime)!==null&&h!==void 0?h:Date.now(),subscriptionOptions:{auth:v.auth,p256dh:v.p256dh,endpoint:v.endpoint,swScope:v.swScope,vapidKey:typeof v.vapidKey=="string"?v.vapidKey:sr(v.vapidKey)}}}else if(r===3){const v=m;e={token:v.fcmToken,createTime:v.createTime,subscriptionOptions:{auth:sr(v.auth),p256dh:sr(v.p256dh),endpoint:v.endpoint,swScope:v.swScope,vapidKey:sr(v.vapidKey)}}}else if(r===4){const v=m;e={token:v.fcmToken,createTime:v.createTime,subscriptionOptions:{auth:sr(v.auth),p256dh:sr(v.p256dh),endpoint:v.endpoint,swScope:v.swScope,vapidKey:sr(v.vapidKey)}}}}}})).close(),await n_(O_),await n_("fcm_vapid_details_db"),await n_("undefined"),Z7(e)?e:null}function Z7(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV="firebase-messaging-database",tV=1,ph="firebase-messaging-store";let D_=null;function k4(){return D_||(D_=_m(eV,tV,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ph)}}})),D_}async function nV(n){const e=O4(n),i=await(await k4()).transaction(ph).objectStore(ph).get(e);if(i)return i;{const r=await J7(n.appConfig.senderId);if(r)return await wy(n,r),r}}async function wy(n,e){const t=O4(n),r=(await k4()).transaction(ph,"readwrite");return await r.objectStore(ph).put(e,t),await r.done,e}function O4({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Zn=new Ro("messaging","Messaging",iV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sV(n,e){const t=await Ey(n),i=D4(e),r={method:"POST",headers:t,body:JSON.stringify(i)};let o;try{o=await(await fetch(by(n.appConfig),r)).json()}catch(c){throw Zn.create("token-subscribe-failed",{errorInfo:c?.toString()})}if(o.error){const c=o.error.message;throw Zn.create("token-subscribe-failed",{errorInfo:c})}if(!o.token)throw Zn.create("token-subscribe-no-token");return o.token}async function rV(n,e){const t=await Ey(n),i=D4(e.subscriptionOptions),r={method:"PATCH",headers:t,body:JSON.stringify(i)};let o;try{o=await(await fetch(`${by(n.appConfig)}/${e.token}`,r)).json()}catch(c){throw Zn.create("token-update-failed",{errorInfo:c?.toString()})}if(o.error){const c=o.error.message;throw Zn.create("token-update-failed",{errorInfo:c})}if(!o.token)throw Zn.create("token-update-no-token");return o.token}async function aV(n,e){const i={method:"DELETE",headers:await Ey(n)};try{const o=await(await fetch(`${by(n.appConfig)}/${e}`,i)).json();if(o.error){const c=o.error.message;throw Zn.create("token-unsubscribe-failed",{errorInfo:c})}}catch(r){throw Zn.create("token-unsubscribe-failed",{errorInfo:r?.toString()})}}function by({projectId:n}){return`${G7}/projects/${n}/registrations`}async function Ey({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function D4({p256dh:n,auth:e,endpoint:t,vapidKey:i}){const r={web:{endpoint:t,auth:e,p256dh:n}};return i!==R4&&(r.web.applicationPubKey=i),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV=10080*60*1e3;async function lV(n){const e=await uV(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:sr(e.getKey("auth")),p256dh:sr(e.getKey("p256dh"))},i=await nV(n.firebaseDependencies);if(i){if(hV(i.subscriptionOptions,t))return Date.now()>=i.createTime+oV?cV(n,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await aV(n.firebaseDependencies,i.token)}catch(r){console.warn(r)}return zT(n.firebaseDependencies,t)}else return zT(n.firebaseDependencies,t)}async function cV(n,e){try{const t=await rV(n.firebaseDependencies,e),i=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return await wy(n.firebaseDependencies,i),t}catch(t){throw t}}async function zT(n,e){const i={token:await sV(n,e),createTime:Date.now(),subscriptionOptions:e};return await wy(n,i),i.token}async function uV(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Q7(e)})}function hV(n,e){const t=e.vapidKey===n.vapidKey,i=e.endpoint===n.endpoint,r=e.auth===n.auth,o=e.p256dh===n.p256dh;return t&&i&&r&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return dV(e,n),fV(e,n),mV(e,n),e}function dV(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const i=e.notification.body;i&&(n.notification.body=i);const r=e.notification.image;r&&(n.notification.image=r);const o=e.notification.icon;o&&(n.notification.icon=o)}function fV(n,e){e.data&&(n.data=e.data)}function mV(n,e){var t,i,r,o,c;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};const h=(r=(i=e.fcmOptions)===null||i===void 0?void 0:i.link)!==null&&r!==void 0?r:(o=e.notification)===null||o===void 0?void 0:o.click_action;h&&(n.fcmOptions.link=h);const f=(c=e.fcmOptions)===null||c===void 0?void 0:c.analytics_label;f&&(n.fcmOptions.analyticsLabel=f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pV(n){return typeof n=="object"&&!!n&&N4 in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gV(n){if(!n||!n.options)throw j_("App Configuration Object");if(!n.name)throw j_("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const i of e)if(!t[i])throw j_(i);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function j_(n){return Zn.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=gV(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vV(n){try{n.swRegistration=await navigator.serviceWorker.register(H7,{scope:$7}),n.swRegistration.update().catch(()=>{})}catch(e){throw Zn.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yV(n,e){if(!e&&!n.swRegistration&&await vV(n),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Zn.create("invalid-sw-registration");n.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wV(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=R4)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(n,e){if(!navigator)throw Zn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Zn.create("permission-blocked");return await wV(n,e?.vapidKey),await yV(n,e?.serviceWorkerRegistration),lV(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bV(n,e,t){const i=EV(e);(await n.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[N4],message_name:t[K7],message_time:t[W7],message_device_time:Math.floor(Date.now()/1e3)})}function EV(n){switch(n){case mh.NOTIFICATION_CLICKED:return"notification_open";case mh.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TV(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===mh.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(BT(t)):n.onMessageHandler.next(BT(t)));const i=t.data;pV(i)&&i[Y7]==="1"&&await bV(n,t.messageType,i)}const FT="@firebase/messaging",qT="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV=n=>{const e=new _V(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>TV(e,t)),e},xV=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:i=>j4(e,i)}};function CV(){os(new Hi("messaging",SV,"PUBLIC")),os(new Hi("messaging-internal",xV,"PRIVATE")),_i(FT,qT),_i(FT,qT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AV(){try{await fS()}catch{return!1}return typeof window<"u"&&dS()&&PN()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IV(n,e){if(!navigator)throw Zn.create("only-available-in-window");return n.onMessageHandler=e,()=>{n.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(n=vm()){return AV().then(e=>{if(!e)throw Zn.create("unsupported-browser")},e=>{throw Zn.create("indexed-db-unsupported")}),No(Yt(n),"messaging").getImmediate()}async function RV(n,e){return n=Yt(n),j4(n,e)}function NV(n,e){return n=Yt(n),IV(n,e)}CV();const kV={en:{login:"Login",email:"Email",password:"Password",forgotPassword:"Forgot password?",dontHave:"Don't have an account?",signup:"Sign Up",welcomeBack:"Welcome back!",signInContinue:"Please sign in to continue",selectLanguage:"Select Language",secureLogin:"Secure login with Firebase",stayConnected:"Stay connected with your community"},hi:{login:"",email:"",password:"",forgotPassword:"  ?",dontHave:"  ?",signup:" ",welcomeBack:"   !",signInContinue:"      ",selectLanguage:" ",secureLogin:"Firebase    ",stayConnected:"    "},pa:{login:"",email:"",password:"",forgotPassword:"  ?",dontHave:"  ?",signup:" ",welcomeBack:"   !",signInContinue:"     ",selectLanguage:" ",secureLogin:"Firebase   ",stayConnected:"    "},ta:{login:"",email:"",password:"",forgotPassword:" ?",dontHave:" ?",signup:" ",welcomeBack:" !",signInContinue:" ",selectLanguage:" ",secureLogin:"Firebase   ",stayConnected:"   "}};function OV(){const[n,e]=P.useState(""),[t,i]=P.useState(""),[r,o]=P.useState(!1),[c,h]=P.useState("English"),[f,m]=P.useState(!1),[v,w]=P.useState("en"),[T,x]=P.useState(!1),[N,L]=P.useState(!1),[O,Z]=P.useState(!1),Y=cs(),H=ge=>kV[v]?.[ge]||ge;P.useEffect(()=>{x(!0),le()},[]);const le=async()=>{const ge=localStorage.getItem("LANG")||"en";w(ge),h({en:"English",hi:"",pa:"",ta:""}[ge]||"English")},ve=()=>{Z(!0),setTimeout(()=>Z(!1),600)},oe=async ge=>{try{const Se=sj(PM,"users",ge);(await yj(Se)).exists()?(await bj(Se,{isActiveStatus:!0}),console.log("User is set online")):console.log("User document does not exist")}catch(Se){console.error("Error setting user online:",Se)}},I=async ge=>{try{const Se=sm(),j=E0(Se,"users/"+ge),G=await EM(j);return G.exists()?(console.log("User data from Realtime DB:",G.val()),G.val()):(console.log("No user data found in Realtime DB"),null)}catch(Se){return console.error("Error checking Realtime DB:",Se),null}},A=async()=>{try{return"Notification"in window?await Notification.requestPermission()==="granted":(console.log("This browser does not support notifications"),!1)}catch(ge){return console.log("Error requesting notification permission:",ge),!1}},R=async()=>{try{if(!await A()){console.log("Notification permission not granted");return}if(!P_||typeof P_!="function"){console.log("Firebase Messaging not available");return}const Se=P_(),j=await RV(Se,{vapidKey:"YOUR_VAPID_KEY_HERE"});j?(console.log("FCM Token:",j),Ye.currentUser?.email&&await U(Ye.currentUser.email,j),NV(Se,G=>{console.log("Message received:",G)})):console.log("No FCM token available")}catch(ge){console.log("Error setting up FCM token:",ge)}},U=async(ge,Se)=>{try{const{error:j}=await Te.from("users").update({fcmToken:Se,tokenUpdatedAt:new Date().toISOString()}).eq("email",ge);return j?(console.log("Error saving FCM token to Supabase:",j),!1):(console.log("FCM token saved to Supabase for user:",ge),!0)}catch(j){return console.log("Error saving FCM token:",j),!1}},V=async(ge,Se)=>{try{const j=sm(),G=E0(j,"users/"+ge);console.log("Would save to Realtime DB:",Se)}catch(j){console.error("Error saving to Realtime DB:",j)}},F=async ge=>{if(ge.preventDefault(),n!==""&&t!==""){L(!0);try{const j=(await W6(Ye,n,t)).user.email.trim().toLowerCase();localStorage.setItem("email",j);const{data:G,error:ie}=await Te.from("users").select("isTypeAdmin").eq("email",j).single();if(ie){alert("Supabase error: "+ie.message),ve();return}localStorage.setItem("isTypeAdmin",JSON.stringify(G.isTypeAdmin)),await Te.from("users").update({isactivestatus:!0,iscallingfrom:"",isoncallstatus:!1,password:t}).eq("email",j),await I(j),await oe(j),await R(),await V(j,{email:j,isOnline:!0,lastLogin:new Date().toISOString(),isTypeAdmin:G.isTypeAdmin}),Y("/chats")}catch(Se){alert("Login error: "+Se.message),ve()}finally{L(!1)}}else ve()},k=async ge=>{const j={English:"en",:"hi",:"pa",:"ta"}[ge];localStorage.setItem("LANG",j),w(j),h(ge),m(!1)};return _.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 sm:p-6 lg:p-8",style:{background:"linear-gradient(135deg, #FF512F 0%, #DD2476 50%, #FF512F 100%)"},children:[_.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[_.jsx("div",{className:"absolute -top-20 -left-20 w-40 h-40 bg-white/10 rounded-full animate-pulse"}),_.jsx("div",{className:"absolute top-1/4 -right-16 w-32 h-32 bg-white/10 rounded-full animate-bounce animation-delay-2000"}),_.jsx("div",{className:"absolute -bottom-16 left-1/4 w-36 h-36 bg-white/10 rounded-full animate-pulse delay-1000"}),_.jsx("div",{className:"absolute top-3/4 right-1/3 w-24 h-24 bg-white/10 rounded-full animate-ping animation-delay-3000"}),_.jsx("div",{className:"absolute top-10 left-10 w-20 h-20 bg-orange-300/20 rounded-full blur-xl animate-float"}),_.jsx("div",{className:"absolute bottom-20 right-20 w-24 h-24 bg-pink-300/20 rounded-full blur-xl animate-float animation-delay-1500"})]}),_.jsx("div",{className:"w-full max-w-md relative z-10",children:_.jsxs("div",{className:`bg-white/10 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-6 sm:p-8 transition-all duration-700 transform ${T?"translate-y-0 opacity-100":"translate-y-10 opacity-0"} ${O?"animate-shake":""}`,children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsxs("div",{className:"relative inline-flex items-center justify-center w-20 h-20 mb-4",children:[_.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full animate-ping animation-duration-2000"}),_.jsx("div",{className:"absolute inset-0 bg-white/10 rounded-full animate-pulse"}),_.jsx("div",{className:"relative bg-gradient-to-br from-white/30 to-white/10 rounded-2xl p-4 backdrop-blur-sm border border-white/20",children:_.jsx(mU,{className:"w-8 h-8 text-white"})})]}),_.jsx("h1",{className:"text-3xl font-bold text-white mb-2 tracking-tight",children:"ChatApp"}),_.jsx("p",{className:"text-white/80 text-sm font-medium",children:H("stayConnected")}),_.jsxs("div",{className:"inline-flex items-center gap-2 mt-3 px-3 py-1 bg-white/10 rounded-full border border-white/20",children:[_.jsx(EU,{className:"w-4 h-4 text-green-300"}),_.jsx("span",{className:"text-white/70 text-xs font-medium",children:H("secureLogin")}),_.jsx(yU,{className:"w-4 h-4 text-orange-300"})]})]}),_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white mb-3 bg-gradient-to-r from-white to-white/80 bg-clip-text text-transparent",children:H("welcomeBack")}),_.jsx("p",{className:"text-white/80 text-sm sm:text-base leading-relaxed",children:H("signInContinue")})]}),_.jsx("div",{className:"flex justify-center mb-6",children:_.jsxs("button",{className:"flex items-center gap-2 bg-white/15 hover:bg-white/25 text-white px-4 py-3 rounded-2xl border border-white/25 transition-all duration-300 hover:scale-105 active:scale-95 backdrop-blur-sm",onClick:()=>m(!0),children:[_.jsx(vU,{className:"w-4 h-4"}),_.jsx("span",{className:"text-sm font-medium",children:c}),_.jsx(i4,{className:"w-4 h-4"})]})}),_.jsxs("form",{className:"space-y-6",onSubmit:F,children:[_.jsxs("div",{className:"relative group",children:[_.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none transition-transform duration-300 group-focus-within:scale-110",children:_.jsx(r4,{className:"h-5 w-5 text-white/70 group-focus-within:text-white transition-colors"})}),_.jsx("input",{type:"email",placeholder:H("email"),value:n,onChange:ge=>e(ge.target.value),required:!0,className:"w-full bg-white/10 border border-white/20 rounded-2xl pl-12 pr-4 py-4 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent transition-all duration-300 backdrop-blur-sm focus:bg-white/15 focus:scale-105"})]}),_.jsxs("div",{className:"relative group",children:[_.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none transition-transform duration-300 group-focus-within:scale-110",children:_.jsx(s4,{className:"h-5 w-5 text-white/70 group-focus-within:text-white transition-colors"})}),_.jsx("input",{type:r?"text":"password",placeholder:H("password"),value:t,onChange:ge=>i(ge.target.value),required:!0,className:"w-full bg-white/10 border border-white/20 rounded-2xl pl-12 pr-12 py-4 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent transition-all duration-300 backdrop-blur-sm focus:bg-white/15 focus:scale-105"}),_.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-4 flex items-center transition-transform duration-300 hover:scale-110",onClick:()=>o(!r),children:r?_.jsx(t4,{className:"h-5 w-5 text-white/70 hover:text-white transition-colors"}):_.jsx(n4,{className:"h-5 w-5 text-white/70 hover:text-white transition-colors"})})]}),_.jsx("div",{className:"text-right",children:_.jsxs(z_,{to:"/forgot-password",className:"text-white/80 hover:text-white text-sm font-medium transition-all duration-300 hover:underline inline-flex items-center gap-1",children:[H("forgotPassword"),_.jsx(CT,{className:"w-3 h-3"})]})}),_.jsx("button",{type:"submit",disabled:N,className:`w-full bg-gradient-to-r from-white to-white/90 text-gray-800 rounded-2xl py-4 font-bold text-lg flex items-center justify-center gap-3 transition-all duration-300 hover:shadow-2xl hover:scale-105 active:scale-95 ${N?"opacity-50 cursor-not-allowed":"hover:from-white hover:to-white"} group`,children:N?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-800"}),_.jsx("span",{children:"Signing in..."})]}):_.jsxs(_.Fragment,{children:[_.jsx("span",{children:H("login")}),_.jsx(CT,{className:"w-5 h-5 transition-transform duration-300 group-hover:translate-x-1"})]})}),_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute inset-0 flex items-center",children:_.jsx("div",{className:"w-full border-t border-white/20"})}),_.jsx("div",{className:"relative flex justify-center text-sm",children:_.jsx("span",{className:"px-3 bg-transparent text-white/80 font-medium",children:"or continue with"})})]}),_.jsxs("div",{className:"text-center",children:[_.jsxs("span",{className:"text-white/80 text-sm",children:[H("dontHave")," "]}),_.jsxs(z_,{to:"/signup",className:"inline-flex items-center gap-2 text-white font-bold text-sm hover:underline transition-all duration-300 group",children:[H("signup"),_.jsx(l4,{className:"w-4 h-4 transition-transform duration-300 group-hover:scale-110 group-hover:rotate-12"})]})]})]})]})}),f&&_.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fadeIn",children:_.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-sm w-full transform animate-scaleIn border border-gray-200",children:[_.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:H("selectLanguage")}),_.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-xl transition-all duration-300 hover:scale-110",onClick:()=>m(!1),children:_.jsx(hh,{className:"w-5 h-5 text-gray-500"})})]}),_.jsx("div",{className:"p-4 space-y-3",children:["English","","",""].map(ge=>_.jsx("button",{className:`w-full text-left px-4 py-4 rounded-xl transition-all duration-300 transform hover:scale-105 ${c===ge?"bg-gradient-to-r from-[#FF512F] to-[#DD2476] text-white shadow-lg scale-105":"text-gray-700 hover:bg-gray-50 hover:shadow-md"}`,onClick:()=>k(ge),children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("span",{className:"font-medium",children:ge}),c===ge&&_.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})]})},ge))})]})})]})}const DV=({children:n})=>{const[e,t]=P.useState(!1),[i,r]=P.useState(null),o=P.useRef(null),c=cs();P.useEffect(()=>{const T=setTimeout(()=>{},5e3);return()=>{clearTimeout(T),m()}},[]);const h=T=>{r(T),t(!0),f()},f=()=>{m();const T=new Audio("/sounds/ringtone.mp3");T.loop=!0,T.play().then(()=>{console.log("Ringtone started playing"),o.current=T}).catch(x=>{console.log("Ringtone playback failed:",x)})},m=()=>{o.current&&(o.current.pause(),o.current.currentTime=0,o.current=null)},v=()=>{console.log("Call accepted"),m(),t(!1),i&&c("/joinscreen",{state:{roomId:i.roomId,peerEmail:i.peerEmail,isVideoCall:i.isVideoCall,avatar:i.callerImage}})},w=()=>{console.log("Call rejected"),m(),t(!1),r(null),i&&console.log("Rejecting call from:",i.peerEmail)};return P.useEffect(()=>{window.showIncomingCall=h},[]),_.jsxs(_.Fragment,{children:[n,e&&i&&_.jsx(s7,{callerName:i.callerName,callerImage:i.callerImage,onAccept:v,onReject:w,isVideoCall:i.isVideoCall,ringtone:o.current,stopRingtone:m})]})};function jV(){return _.jsx(_N,{children:_.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:_.jsxs(tS,{children:[_.jsx(pi,{path:"/",element:_.jsx(L_,{to:"/login",replace:!0})}),_.jsx(pi,{path:"/login",element:_.jsx(OV,{})}),_.jsx(pi,{path:"/signup",element:_.jsx(xU,{})}),_.jsx(pi,{path:"/*",element:_.jsx(DV,{children:_.jsx(PV,{})})})]})})})}const PV=()=>_.jsxs(tS,{children:[_.jsx(pi,{path:"/chats",element:_.jsx(CU,{})}),_.jsx(pi,{path:"/users",element:_.jsx(kT,{})}),_.jsx(pi,{path:"/discover",element:_.jsx(kT,{})}),_.jsx(pi,{path:"/chat",element:_.jsx(QU,{})}),_.jsx(pi,{path:"/callscreen",element:_.jsx(ZU,{})}),_.jsx(pi,{path:"/joinscreen",element:_.jsx(i7,{})}),_.jsx(pi,{path:"/home",element:_.jsx(L_,{to:"/discover",replace:!0})}),_.jsx(pi,{path:"/messages",element:_.jsx(L_,{to:"/chats",replace:!0})}),_.jsx(pi,{path:"*",element:_.jsx(MV,{})})]}),MV=()=>{const n=cs();return _.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:_.jsxs("div",{className:"text-center max-w-md",children:[_.jsx("div",{className:"text-6xl mb-4",children:""}),_.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Page Not Found"}),_.jsx("p",{className:"text-gray-600 mb-6",children:"The page you're looking for doesn't exist or has been moved."}),_.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[_.jsx("button",{onClick:()=>n(-1),className:"px-4 py-2 bg-gray-500 text-white rounded-lg font-medium hover:bg-gray-600 transition-colors",children:"Go Back"}),_.jsx("button",{onClick:()=>n("/login"),className:"px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Go to Login"})]})]})})};wR.createRoot(document.getElementById("root")).render(_.jsx(rs.StrictMode,{children:_.jsx(jV,{})}));
